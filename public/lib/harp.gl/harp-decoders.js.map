{"version":3,"sources":["webpack://@here/harp.gl/../harp-vectortile-datasource/lib/adapters/omv/proto/vector_tile.js","webpack://@here/harp.gl/../node_modules/@protobufjs/aspromise/index.js","webpack://@here/harp.gl/../node_modules/@protobufjs/base64/index.js","webpack://@here/harp.gl/../node_modules/@protobufjs/eventemitter/index.js","webpack://@here/harp.gl/../node_modules/@protobufjs/float/index.js","webpack://@here/harp.gl/../node_modules/@protobufjs/inquire/index.js","webpack://@here/harp.gl/../node_modules/@protobufjs/pool/index.js","webpack://@here/harp.gl/../node_modules/@protobufjs/utf8/index.js","webpack://@here/harp.gl/../node_modules/csscolorparser/csscolorparser.js","webpack://@here/harp.gl/../node_modules/earcut/src/earcut.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/clip.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/convert.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/feature.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/index.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/simplify.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/tile.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/transform.js","webpack://@here/harp.gl/../node_modules/geojson-vt/src/wrap.js","webpack://@here/harp.gl/../node_modules/long/src/long.js","webpack://@here/harp.gl/../node_modules/protobufjs/minimal.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/index-minimal.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/reader.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/reader_buffer.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/roots.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/rpc.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/rpc/service.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/util/longbits.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/util/minimal.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/writer.js","webpack://@here/harp.gl/../node_modules/protobufjs/src/writer_buffer.js","webpack://@here/harp.gl/../harp-datasource-protocol/index-decoder.ts","webpack://@here/harp.gl/../harp-datasource-protocol/index.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ColorUtils.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/DecodedTile.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/Env.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/Expr.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ExprEvaluator.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ExprInstantiator.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ExprParser.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ExprPool.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/GeoJsonDataType.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/IMeshBuffers.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ITiler.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/InterpolatedPropertyDefs.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/Outliner.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/Pixels.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/PostEffects.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/PropertyValue.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/RGBA.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/StringEncodedNumeral.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/StyleSetEvaluator.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/TechniqueAttr.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/TechniqueDescriptors.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/TechniqueParams.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/Techniques.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/Theme.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ThemeVisitor.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/ThreeBufferUtils.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/WorkerDecoderProtocol.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/WorkerServiceProtocol.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/WorkerTilerProtocol.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/ArrayOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/CastOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/ColorOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/ComparisonOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/FeatureOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/FlowOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/MapOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/MathOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/MiscOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/ObjectOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/StringOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/TypeOperators.ts","webpack://@here/harp.gl/../harp-datasource-protocol/lib/operators/VectorOperators.ts","webpack://@here/harp.gl/../harp-geometry/lib/ClipLineString.ts","webpack://@here/harp.gl/../harp-geometry/lib/ClipPolygon.ts","webpack://@here/harp.gl/../harp-geometry/lib/EdgeLengthGeometrySubdivisionModifier.ts","webpack://@here/harp.gl/../harp-geometry/lib/SphericalGeometrySubdivisionModifier.ts","webpack://@here/harp.gl/../harp-geometry/lib/SubdivisionModifier.ts","webpack://@here/harp.gl/../harp-geoutils/index.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoBox.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoBoxExtentLike.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoCoordLike.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoCoordinates.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoCoordinatesLike.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoPointLike.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoPolygon.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/GeoPolygonLike.ts","webpack://@here/harp.gl/../harp-geoutils/lib/coordinates/LatLngLike.ts","webpack://@here/harp.gl/../harp-geoutils/lib/math/Box3Like.ts","webpack://@here/harp.gl/../harp-geoutils/lib/math/MathUtils.ts","webpack://@here/harp.gl/../harp-geoutils/lib/math/OrientedBox3.ts","webpack://@here/harp.gl/../harp-geoutils/lib/math/OrientedBox3Like.ts","webpack://@here/harp.gl/../harp-geoutils/lib/math/TransformLike.ts","webpack://@here/harp.gl/../harp-geoutils/lib/math/Vector2Like.ts","webpack://@here/harp.gl/../harp-geoutils/lib/math/Vector3Like.ts","webpack://@here/harp.gl/../harp-geoutils/lib/projection/EarthConstants.ts","webpack://@here/harp.gl/../harp-geoutils/lib/projection/EquirectangularProjection.ts","webpack://@here/harp.gl/../harp-geoutils/lib/projection/IdentityProjection.ts","webpack://@here/harp.gl/../harp-geoutils/lib/projection/MercatorProjection.ts","webpack://@here/harp.gl/../harp-geoutils/lib/projection/Projection.ts","webpack://@here/harp.gl/../harp-geoutils/lib/projection/SphereProjection.ts","webpack://@here/harp.gl/../harp-geoutils/lib/projection/TransverseMercatorProjection.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/FlatTileBoundingBoxGenerator.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/HalfQuadTreeSubdivisionScheme.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/HereTilingScheme.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/MercatorTilingScheme.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/PolarTilingScheme.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/QuadTree.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/QuadTreeSubdivisionScheme.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/SubTiles.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/SubdivisionScheme.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/TileKey.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/TileKeyUtils.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/TileTreeTraverse.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/TilingScheme.ts","webpack://@here/harp.gl/../harp-geoutils/lib/tiling/WebMercatorTilingScheme.ts","webpack://@here/harp.gl/../harp-lines/lib/Lines.ts","webpack://@here/harp.gl/../harp-lines/lib/TriangulateLines.ts","webpack://@here/harp.gl/../harp-mapview-decoder/index-worker.ts","webpack://@here/harp.gl/../harp-mapview-decoder/lib/GeoJsonTiler.ts","webpack://@here/harp.gl/../harp-mapview-decoder/lib/ThemedTileDecoder.ts","webpack://@here/harp.gl/../harp-mapview-decoder/lib/TileDecoderService.ts","webpack://@here/harp.gl/../harp-mapview-decoder/lib/TilerService.ts","webpack://@here/harp.gl/../harp-mapview-decoder/lib/WorkerService.ts","webpack://@here/harp.gl/../harp-mapview-decoder/lib/WorkerServiceManager.ts","webpack://@here/harp.gl/../harp-mapview/lib/workers/WorkerBootstrapDefs.ts","webpack://@here/harp.gl/../harp-materials/lib/MapMeshMaterialsDefs.ts","webpack://@here/harp.gl/../harp-utils/index-common.ts","webpack://@here/harp.gl/../harp-utils/index.ts","webpack://@here/harp.gl/../harp-utils/lib/AuthenticationUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/CachedResource.ts","webpack://@here/harp.gl/../harp-utils/lib/ContextLogger.ts","webpack://@here/harp.gl/../harp-utils/lib/DOMUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/Functions.ts","webpack://@here/harp.gl/../harp-utils/lib/GlslUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/GroupedPriorityList.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/ConsoleChannel.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/IChannel.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/ILogger.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/Logger.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/LoggerManager.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/LoggerManagerImpl.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/MultiChannel.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/WorkerChannel.ts","webpack://@here/harp.gl/../harp-utils/lib/Logger/index.ts","webpack://@here/harp.gl/../harp-utils/lib/Math2D.ts","webpack://@here/harp.gl/../harp-utils/lib/MathUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/Mixins.ts","webpack://@here/harp.gl/../harp-utils/lib/ObjectUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/OptionsUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/PerformanceTimer.ts","webpack://@here/harp.gl/../harp-utils/lib/SampleBilinear.ts","webpack://@here/harp.gl/../harp-utils/lib/TaskQueue.ts","webpack://@here/harp.gl/../harp-utils/lib/UriResolver.ts","webpack://@here/harp.gl/../harp-utils/lib/UrlPlatformUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/UrlUtils.ts","webpack://@here/harp.gl/../harp-utils/lib/assert.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/index-worker.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/DataAdapter.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/DecodeInfo.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/GeoJsonTilerService.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/OmvDataFilter.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/OmvDecoderDefs.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/OmvPoliticalViewFeatureModifier.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/OmvUtils.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/Ring.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/StyleSetDataFilter.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/VectorTileDataEmitter.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/VectorTileDecoder.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/adapters/geojson-vt/GeoJsonVtDataAdapter.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/adapters/geojson/GeoJsonDataAdapter.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/adapters/omv/OmvData.ts","webpack://@here/harp.gl/../harp-vectortile-datasource/lib/adapters/omv/OmvDataAdapter.ts","webpack://@here/harp.gl/./lib/DecoderBootstrap.ts","webpack://@here/harp.gl/./lib/DecoderBundleMain.ts","webpack://@here/harp.gl/external \"THREE\"","webpack://@here/harp.gl/webpack/bootstrap","webpack://@here/harp.gl/webpack/runtime/define property getters","webpack://@here/harp.gl/webpack/runtime/global","webpack://@here/harp.gl/webpack/runtime/hasOwnProperty shorthand","webpack://@here/harp.gl/webpack/runtime/make namespace object","webpack://@here/harp.gl/webpack/startup"],"names":[],"mappings":";;;;;;;;;;AAAA;AACa;;AAEb,gBAAgB,mBAAO,CAAC,oEAAoB;;AAE5C;AACA;;AAEA;AACA,0EAA0E;;AAE1E;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,8BAA8B,uCAAuC;AACrE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA,uEAAuE,iBAAiB;AACxF;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,kCAAkC;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD,2BAA2B,OAAO;AAClC,6BAA6B,mBAAmB;AAChD,4BAA4B,MAAM;AAClC,4BAA4B,6BAA6B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD,6BAA6B,mBAAmB;AAChD,4BAA4B,MAAM;AAClC,4BAA4B,6BAA6B;AACzD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kBAAkB;AAC7C,6BAA6B,mBAAmB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,0BAA0B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB;AAC9C,2BAA2B,6BAA6B;AACxD,6BAA6B,kBAAkB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2BAA2B;AAClE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kBAAkB;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAA0B;AAC1B,8BAA8B,OAAO;AACrC,8BAA8B,OAAO;AACrC,8BAA8B,OAAO;AACrC,8BAA8B,OAAO;AACrC;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;;AAEA;AACA;AACA;AACA;AACA,kCAAkC,YAAY;AAC9C,kCAAkC,YAAY;AAC9C,kCAAkC,YAAY;AAC9C,kCAAkC,iBAAiB;AACnD,kCAAkC,iBAAiB;AACnD,kCAAkC,iBAAiB;AACnD,kCAAkC,aAAa;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2BAA2B;AAC1D;AACA;AACA;AACA,2EAA2E,iBAAiB;AAC5F;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,OAAO;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,OAAO;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,OAAO;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,QAAQ;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D,+BAA+B,OAAO;AACtC,iCAAiC,yBAAyB;AAC1D,gCAAgC,MAAM;AACtC,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D,iCAAiC,yBAAyB;AAC1D,gCAAgC,MAAM;AACtC,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kBAAkB;AACjD,iCAAiC,yBAAyB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD,+BAA+B,6BAA6B;AAC5D,iCAAiC,kBAAkB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAiC,kBAAkB;AACnD;AACA;AACA;AACA;;AAEA;AACA,iBAAiB;;AAEjB;;AAEA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD,kCAAkC,oBAAoB;AACtD,kCAAkC,iCAAiC;AACnE,kCAAkC,oBAAoB;AACtD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA,2EAA2E,iBAAiB;AAC5F;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D,+BAA+B,OAAO;AACtC,iCAAiC,2BAA2B;AAC5D,gCAAgC,MAAM;AACtC,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D,iCAAiC,2BAA2B;AAC5D,gCAAgC,MAAM;AACtC,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kBAAkB;AACjD,iCAAiC,2BAA2B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,4BAA4B;AACvE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2BAA2B;AAC1D,+BAA+B,6BAA6B;AAC5D,iCAAiC,kBAAkB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,yBAAyB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,6BAA6B;AACxE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAiC,kBAAkB;AACnD;AACA;AACA;AACA;;AAEA;AACA,iBAAiB;;AAEjB;;AAEA;AACA;AACA;AACA;AACA,kCAAkC,OAAO;AACzC,kCAAkC,OAAO;AACzC,kCAAkC,yCAAyC;AAC3E,kCAAkC,oBAAoB;AACtD,kCAAkC,uCAAuC;AACzE,kCAAkC,YAAY;AAC9C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2BAA2B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,iBAAiB;AAC5F;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,OAAO;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,OAAO;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,oCAAoC;AACpE;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,kCAAkC;AAClE;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAAgC,OAAO;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D,+BAA+B,OAAO;AACtC,iCAAiC,yBAAyB;AAC1D,gCAAgC,MAAM;AACtC,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAqF,oBAAoB;AACzG;AACA,kFAAkF,oBAAoB;AACtG;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D,iCAAiC,yBAAyB;AAC1D,gCAAgC,MAAM;AACtC,gCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kBAAkB;AACjD,iCAAiC,yBAAyB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,4BAA4B;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,0BAA0B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD,+BAA+B,6BAA6B;AAC5D,iCAAiC,kBAAkB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,6BAA6B;AACxE;AACA;AACA;AACA;AACA,2CAA2C,yBAAyB;AACpE;AACA;AACA;AACA;AACA,2CAA2C,2BAA2B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAiC,kBAAkB;AACnD;AACA;AACA;AACA;;AAEA;AACA,iBAAiB;;AAEjB;AACA,aAAa;;AAEb;AACA,SAAS;;AAET;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;;;;;;;;;;;;ACv9Ba;AACb;;AAEA;AACA,wBAAwB,qBAAqB;AAC7C;AACA,UAAU;AACV,WAAW,WAAW;AACtB,WAAW,KAAK;AAChB,aAAa;AACb;;AAEA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B,WAAW,EAAE;AACb,WAAW,KAAK;AAChB,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;;;;;;;;;;ACnDa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,eAAe,QAAQ;AACvB;;AAEA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA,UAAU;AACV,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA,8BAA8B,EAAE,mBAAmB,EAAE,iBAAiB,EAAE;AACxE;;;;;;;;;;;;AC1Ia;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,aAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,aAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,sBAAsB;AACpC;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;;;;;;;;;;;;AC3Ea;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK,IAAI;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK,IAAI;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa,0CAA0C;AACvD;AACA;AACA,aAAa;AACb;AACA,oDAAoD;AACpD;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9Ua;AACb;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA,KAAK,aAAa;AAClB;AACA;;;;;;;;;;;;AChBa;AACb;;AAEA;AACA,4BAA4B,gBAAgB;AAC5C;AACA,UAAU;AACV,WAAW,OAAO;AAClB,aAAa,WAAW;AACxB;;AAEA;AACA,wBAAwB,gBAAgB;AACxC;AACA,UAAU;AACV,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,WAAW;AACxB,UAAU;AACV;;AAEA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC/Ca;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,WAAW;AACX,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B;AAC5B,oBAAoB;AACpB;AACA;;AAEA,6BAA6B;AAC7B;AACA;;AAEA,6BAA6B;AAC7B;AACA;AACA;AACA;;AAEA,+BAA+B;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gEAAgE;;AAEhE;AACA;AACA;AACA,2CAA2C;AAC3C,iDAAiD;AACjD;AACA;AACA;AACA;AACA,KAAK;AACL,2CAA2C;AAC3C,oDAAoD;AACpD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,KAAK,CAAC,qBAAqB,kBAAkB,WAAW;;;;;;;;;;;;ACxM3C;;AAEb;AACA,sBAAsB;;AAEtB;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,0EAA0E;AAC1E;AACA;AACA;;AAEA,yBAAyB,cAAc;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uBAAuB,SAAS;AAChC,KAAK;AACL,2BAA2B,YAAY;AACvC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;;AAEA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,yCAAyC;;AAEzC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,yCAAyC;;AAEzC,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,eAAe,kBAAkB;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA,4BAA4B,+BAA+B;;AAE3D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,kDAAkD;;AAElD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wFAAwF;AACxF;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C;;AAE5C,uDAAuD;AACvD,uDAAuD;AACvD,uDAAuD;AACvD,uDAAuD;;AAEvD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,sBAAsB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,sCAAsC,SAAS;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAkB,yCAAyC;AAC3D;;AAEA,mBAAmB,iBAAiB;AACpC,uBAAuB,oBAAoB;AAC3C,2BAA2B,SAAS;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACrqBsC;;AAEtC;AACA;AACA;AACA;AACA;AACA;;AAEe;;AAEf;AACA;;AAEA,qDAAqD;AACrD,sDAAsD;;AAEtD;;AAEA,mBAAmB,qBAAqB;;AAExC;AACA;AACA;;AAEA;AACA;;AAEA,oCAAoC;AACpC;AACA;AACA,SAAS,kCAAkC;AAC3C;AACA;;AAEA;;AAEA;AACA;;AAEA,SAAS;AACT;;AAEA,SAAS;AACT;;AAEA,SAAS;AACT;;AAEA,SAAS;AACT,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,wBAAwB;AACnD,iCAAiC,iDAAa;AAC9C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAyB,iDAAa;AACtC;AACA;;AAEA;AACA;;AAEA;AACA,mBAAmB,iBAAiB;AACpC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AC9MkC;AACI;;AAEtC;;AAEe;AACf;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;;AAEA,KAAK;AACL;;AAEA,KAAK;AACL;AACA,kCAAkC,eAAe;AACjD;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,KAAK;AACL,uBAAuB,mBAAmB;AAC1C;AACA;;AAEA,KAAK;AACL;;AAEA,KAAK;AACL;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA,8BAA8B,iDAAa;AAC3C;AACA;AACA,SAAS;AACT;AACA;;AAEA,KAAK;AACL;;AAEA,KAAK;AACL,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA,KAAK;AACL,mBAAmB,wCAAwC;AAC3D;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;;AAEA,kBAAkB,iDAAa;AAC/B;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,8CAA8C;AAC9C,aAAa;AACb,6EAA6E;AAC7E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI,kDAAQ;AACZ;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AC5Ie;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;AACL,uBAAuB,iBAAiB;AACxC;AACA;;AAEA,KAAK;AACL,mBAAmB,iBAAiB;AACpC,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AC3CgC;AACN;AACA;AACU;AACJ;;AAEjB;AACf;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,mBAAmB,iDAAO;;AAE1B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe,8CAAI;;AAEnB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,oCAAoC,8CAAU;AAC9C,kCAAkC,iBAAiB;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,gBAAgB,8CAAI;AACpB,gBAAgB,8CAAI;AACpB;;AAEA;AACA,iBAAiB,8CAAI;AACrB,iBAAiB,8CAAI;AACrB;AACA;;AAEA;AACA,iBAAiB,8CAAI;AACrB,iBAAiB,8CAAI;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,6BAA6B;;AAE7B;AACA,+BAA+B,mDAAS;;AAExC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,4BAA4B,mDAAS;AACrC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACtMA;;AAEe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,2BAA2B,UAAU;AACrC;;AAEA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;AC/De;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;;AAEA,KAAK;AACL,mBAAmB,iBAAiB;AACpC;AACA;;AAEA,KAAK;;AAEL,uBAAuB,iBAAiB;AACxC;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,mDAAmD,SAAS;AAC5D;AACA;AACA;AACA,sCAAsC,aAAa;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AC9HA;AACA;AACe;AACf;;AAEA;AACA;AACA;AACA;;AAEA,eAAe,0BAA0B;AACzC;AACA;AACA;;AAEA;;AAEA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA,SAAS;AACT,uBAAuB,iBAAiB;AACxC;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACzC0B;AACY;;AAEvB;AACf;AACA;AACA,gBAAgB,8CAAI,0DAA0D;AAC9E,gBAAgB,8CAAI,0DAA0D;;AAE9E;AACA,iBAAiB,8CAAI,4DAA4D;;AAEjF,sEAAsE;AACtE,yEAAyE;AACzE;;AAEA;AACA;;AAEA;AACA;;AAEA,mBAAmB,qBAAqB;AACxC;AACA;;AAEA;;AAEA;AACA;;AAEA,SAAS;AACT;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA,SAAS;AACT;AACA,uBAAuB,6BAA6B;AACpD;AACA,+BAA+B,gCAAgC;AAC/D;AACA;AACA;AACA;AACA;;AAEA,yBAAyB,iDAAa;AACtC;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;;;;;;;;;;;ACnEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA,qDAAqD,cAAc;;AAEnE;AACA;AACA,WAAW,EAAE;AACb,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa;AACb;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA,uBAAuB;;AAEvB;AACA,WAAW,OAAO;AAClB,WAAW,kBAAkB;AAC7B,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,kBAAkB;AAC7B,WAAW,QAAQ;AACnB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,WAAW,sBAAsB,8CAA8C;AAC/E,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,sBAAsB,8CAA8C;AAC/E,WAAW,SAAS;AACpB,aAAa;AACb;AACA;;AAEA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAS;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,gEAAgE,kBAAkB;AAClF,aAAa;AACb;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2EAA2E,kBAAkB;AAC7F;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,iFAAiF,qBAAqB;AACtG;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA,iFAAiF,qBAAqB;AACtG;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,iFAAiF,oBAAoB;AACrG;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,0FAA0F,2BAA2B;AACrH;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA,0FAA0F,2BAA2B;AACrH;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,oFAAoF,uBAAuB;AAC3G;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,6FAA6F,8BAA8B;AAC3H;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA,6FAA6F,8BAA8B;AAC3H;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yEAAyE,mBAAmB;AAC5F;AACA,WAAW,oBAAoB;AAC/B,aAAa,OAAO;AACpB;AACA;AACA;;AAEA;AACA;AACA,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mDAAmD,kBAAkB;AACrE;AACA,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+EAA+E,oBAAoB;AACnG;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4EAA4E,oBAAoB;AAChG;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,mBAAmB;AAC1E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,oEAAoE,kBAAkB;AACtF;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,gEAAgE,kBAAkB;AAClF;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;;AAEA;AACA,gEAAgE,kBAAkB;AAClF;AACA,WAAW,oBAAoB;AAC/B,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,oBAAoB;AAC/B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6FAA6F,qBAAqB;AAClH;AACA,WAAW,aAAa;AACxB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6GAA6G,sBAAsB;AACnI;AACA,WAAW,aAAa;AACxB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA,wGAAwG,8BAA8B;AACtI;AACA,WAAW,aAAa;AACxB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA,wGAAwG,8BAA8B;AACtI;AACA,WAAW,aAAa;AACxB,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;AACA,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB,aAAa,KAAK;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,aAAa,KAAK;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,aAAa,KAAK;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC1yCA;;AAEa;AACb,qHAA+C;;;;;;;;;;;;ACHlC;AACb;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA,wBAAwB,mBAAO,CAAC,6DAAU;AAC1C,wBAAwB,mBAAO,CAAC,2EAAiB;AACjD,wBAAwB,mBAAO,CAAC,6DAAU;AAC1C,wBAAwB,mBAAO,CAAC,2EAAiB;;AAEjD;AACA,wBAAwB,mBAAO,CAAC,yEAAgB;AAChD,wBAAwB,mBAAO,CAAC,uDAAO;AACvC,wBAAwB,mBAAO,CAAC,2DAAS;AACzC;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACnCa;AACb;;AAEA,gBAAgB,mBAAO,CAAC,yEAAgB;;AAExC,iBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B,aAAa,oBAAoB,IAAI,mBAAmB,uCAAuC;AAC/F,YAAY,MAAM;AAClB;AACA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA,2BAA2B;AAC3B;AACA,iEAAiE;AACjE,iEAAiE;AACjE,iEAAiE;AACjE,iEAAiE;AACjE,iEAAiE;;AAEjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kCAAkC;AAClC,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEA;AACA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEA;AACA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEA;AACA;AACA;AACA;AACA,aAAa,KAAK;AAClB;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA;;AAEA,KAAK;AACL;;;;;;;;;;;;AC1Za;AACb;;AAEA;AACA,aAAa,mBAAO,CAAC,6DAAU;AAC/B;;AAEA,WAAW,mBAAO,CAAC,yEAAgB;;AAEnC;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;;AAEA;;;;;;;;;;;;AClDa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACjBa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA,iCAAiC,qBAAqB;AACtD;AACA,UAAU;AACV,WAAW,mCAAmC,YAAY,GAAG;AAC7D,WAAW,WAAW;AACtB,WAAW,gBAAgB;AAC3B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA,mCAAmC,cAAc;AACjD;AACA,UAAU;AACV,WAAW,WAAW;AACtB,WAAW,gBAAgB;AAC3B,aAAa;AACb;;AAEA,cAAc,mBAAO,CAAC,uEAAe;;;;;;;;;;;;ACnCxB;AACb;;AAEA,WAAW,mBAAO,CAAC,0EAAiB;;AAEpC;AACA;;AAEA;AACA,yCAAyC,sCAAsC;AAC/E;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA,UAAU;AACV,WAAW,WAAW;AACtB,WAAW,KAAK;AAChB,aAAa;AACb;;AAEA;AACA,+BAA+B,kBAAkB,gBAAgB,qBAAqB;AACtF;AACA;AACA;AACA,UAAU;AACV,WAAW,sBAAsB;AACjC,WAAW,gCAAgC;AAC3C,aAAa,uBAAuB;AACpC;;AAEA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA,mCAAmC,kCAAkC;AACrE,WAAW,oCAAoC;AAC/C,WAAW,kBAAkB;AAC7B,WAAW,kBAAkB;AAC7B,WAAW,sBAAsB;AACjC,WAAW,gCAAgC;AAC3C,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,+BAA+B,kCAAkC,EAAE;AACnE;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,+BAA+B,eAAe,EAAE;AAChD;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,YAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC7Ia;AACb;;AAEA,WAAW,mBAAO,CAAC,0EAAiB;;AAEpC;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA,4BAA4B,UAAU;AACtC,4CAA4C,aAAa;AACzD,0BAA0B,UAAU;;AAEpC;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,mBAAmB;AAC9B,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,KAAK;AAClB;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACvMa;AACb;;AAEA;AACA,iBAAiB,mBAAO,CAAC,gFAAuB;;AAEhD;AACA,cAAc,mB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;AACA;AACA;AACA,uBAAuB;AACvB,+DAA+D,QAAQ;AACvE;AACA;AACA;AACA;;AAEA;AACA,kCAAkC,uBAAuB;AACzD;AACA,UAAU;AACV,WAAW,iBAAiB;AAC5B,aAAa;AACb;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa,YAAY;AACzB;AACA;;AAEA;AACA,eAAe,OAAO;AACtB,iBAAiB;AACjB;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpaa;AACb;;AAEA,gBAAgB,mBAAO,CAAC,yEAAgB;;AAExC,iBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,gCAAgC;AAC3C,WAAW,OAAO;AAClB,WAAW,EAAE;AACb;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA,mBAAmB;AACnB;;AAEA;AACA,kBAAkB;;AAElB;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,oBAAoB,IAAI,mBAAmB,0CAA0C;AAClG;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,WAAW;AACxB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,gCAAgC;AAC3C,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,mBAAmB;AAC9B,aAAa,OAAO;AACpB,YAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,aAAa,OAAO;AACpB,YAAY,UAAU;AACtB;AACA;;AAEA;AACA;AACA,WAAW,mBAAmB;AAC9B,aAAa,OAAO;AACpB,YAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;;AAEA;AACA;AACA,WAAW,mBAAmB;AAC9B,aAAa,OAAO;AACpB,YAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,aAAa,OAAO;AACpB,YAAY,UAAU;AACtB;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;;AAEA;AACA;AACA,WAAW,kBAAkB;AAC7B,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,yBAAyB,KAAK,2BAA2B;AACrE,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChda;AACb;;AAEA;AACA,aAAa,mBAAO,CAAC,6DAAU;AAC/B;;AAEA,WAAW,mBAAO,CAAC,yEAAgB;;AAEnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAA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","file":"harp-decoders.js","sourcesContent":["/*eslint-disable block-scoped-var, id-length, no-control-regex, no-magic-numbers, no-prototype-builtins, no-redeclare, no-shadow, no-var, sort-vars*/\r\n\"use strict\";\r\n\r\nvar $protobuf = require(\"protobufjs/minimal\");\r\n\r\n// Common aliases\r\nvar $Reader = $protobuf.Reader, $util = $protobuf.util;\r\n\r\n// Exported root namespace\r\nvar $root = $protobuf.roots[\"default\"] || ($protobuf.roots[\"default\"] = {});\r\n\r\n$root.com = (function() {\r\n\r\n    /**\r\n     * Namespace com.\r\n     * @exports com\r\n     * @namespace\r\n     */\r\n    var com = {};\r\n\r\n    com.mapbox = (function() {\r\n\r\n        /**\r\n         * Namespace mapbox.\r\n         * @memberof com\r\n         * @namespace\r\n         */\r\n        var mapbox = {};\r\n\r\n        mapbox.pb = (function() {\r\n\r\n            /**\r\n             * Namespace pb.\r\n             * @memberof com.mapbox\r\n             * @namespace\r\n             */\r\n            var pb = {};\r\n\r\n            pb.Tile = (function() {\r\n\r\n                /**\r\n                 * Properties of a Tile.\r\n                 * @memberof com.mapbox.pb\r\n                 * @interface ITile\r\n                 * @property {Array.<com.mapbox.pb.Tile.ILayer>|null} [layers] Tile layers\r\n                 */\r\n\r\n                /**\r\n                 * Constructs a new Tile.\r\n                 * @memberof com.mapbox.pb\r\n                 * @classdesc Represents a Tile.\r\n                 * @implements ITile\r\n                 * @constructor\r\n                 * @param {com.mapbox.pb.ITile=} [properties] Properties to set\r\n                 */\r\n                function Tile(properties) {\r\n                    this.layers = [];\r\n                    if (properties)\r\n                        for (var keys = Object.keys(properties), i = 0; i < keys.length; ++i)\r\n                            if (properties[keys[i]] != null)\r\n                                this[keys[i]] = properties[keys[i]];\r\n                }\r\n\r\n                /**\r\n                 * Tile layers.\r\n                 * @member {Array.<com.mapbox.pb.Tile.ILayer>} layers\r\n                 * @memberof com.mapbox.pb.Tile\r\n                 * @instance\r\n                 */\r\n                Tile.prototype.layers = $util.emptyArray;\r\n\r\n                /**\r\n                 * Decodes a Tile message from the specified reader or buffer.\r\n                 * @function decode\r\n                 * @memberof com.mapbox.pb.Tile\r\n                 * @static\r\n                 * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                 * @param {number} [length] Message length if known beforehand\r\n                 * @returns {com.mapbox.pb.Tile} Tile\r\n                 * @throws {Error} If the payload is not a reader or valid buffer\r\n                 * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                 */\r\n                Tile.decode = function decode(reader, length) {\r\n                    if (!(reader instanceof $Reader))\r\n                        reader = $Reader.create(reader);\r\n                    var end = length === undefined ? reader.len : reader.pos + length, message = new $root.com.mapbox.pb.Tile();\r\n                    while (reader.pos < end) {\r\n                        var tag = reader.uint32();\r\n                        switch (tag >>> 3) {\r\n                        case 3:\r\n                            if (!(message.layers && message.layers.length))\r\n                                message.layers = [];\r\n                            message.layers.push($root.com.mapbox.pb.Tile.Layer.decode(reader, reader.uint32()));\r\n                            break;\r\n                        default:\r\n                            reader.skipType(tag & 7);\r\n                            break;\r\n                        }\r\n                    }\r\n                    return message;\r\n                };\r\n\r\n                /**\r\n                 * Decodes a Tile message from the specified reader or buffer, length delimited.\r\n                 * @function decodeDelimited\r\n                 * @memberof com.mapbox.pb.Tile\r\n                 * @static\r\n                 * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                 * @returns {com.mapbox.pb.Tile} Tile\r\n                 * @throws {Error} If the payload is not a reader or valid buffer\r\n                 * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                 */\r\n                Tile.decodeDelimited = function decodeDelimited(reader) {\r\n                    if (!(reader instanceof $Reader))\r\n                        reader = new $Reader(reader);\r\n                    return this.decode(reader, reader.uint32());\r\n                };\r\n\r\n                /**\r\n                 * Creates a Tile message from a plain object. Also converts values to their respective internal types.\r\n                 * @function fromObject\r\n                 * @memberof com.mapbox.pb.Tile\r\n                 * @static\r\n                 * @param {Object.<string,*>} object Plain object\r\n                 * @returns {com.mapbox.pb.Tile} Tile\r\n                 */\r\n                Tile.fromObject = function fromObject(object) {\r\n                    if (object instanceof $root.com.mapbox.pb.Tile)\r\n                        return object;\r\n                    var message = new $root.com.mapbox.pb.Tile();\r\n                    if (object.layers) {\r\n                        if (!Array.isArray(object.layers))\r\n                            throw TypeError(\".com.mapbox.pb.Tile.layers: array expected\");\r\n                        message.layers = [];\r\n                        for (var i = 0; i < object.layers.length; ++i) {\r\n                            if (typeof object.layers[i] !== \"object\")\r\n                                throw TypeError(\".com.mapbox.pb.Tile.layers: object expected\");\r\n                            message.layers[i] = $root.com.mapbox.pb.Tile.Layer.fromObject(object.layers[i]);\r\n                        }\r\n                    }\r\n                    return message;\r\n                };\r\n\r\n                /**\r\n                 * Creates a plain object from a Tile message. Also converts values to other types if specified.\r\n                 * @function toObject\r\n                 * @memberof com.mapbox.pb.Tile\r\n                 * @static\r\n                 * @param {com.mapbox.pb.Tile} message Tile\r\n                 * @param {$protobuf.IConversionOptions} [options] Conversion options\r\n                 * @returns {Object.<string,*>} Plain object\r\n                 */\r\n                Tile.toObject = function toObject(message, options) {\r\n                    if (!options)\r\n                        options = {};\r\n                    var object = {};\r\n                    if (options.arrays || options.defaults)\r\n                        object.layers = [];\r\n                    if (message.layers && message.layers.length) {\r\n                        object.layers = [];\r\n                        for (var j = 0; j < message.layers.length; ++j)\r\n                            object.layers[j] = $root.com.mapbox.pb.Tile.Layer.toObject(message.layers[j], options);\r\n                    }\r\n                    return object;\r\n                };\r\n\r\n                /**\r\n                 * Converts this Tile to JSON.\r\n                 * @function toJSON\r\n                 * @memberof com.mapbox.pb.Tile\r\n                 * @instance\r\n                 * @returns {Object.<string,*>} JSON object\r\n                 */\r\n                Tile.prototype.toJSON = function toJSON() {\r\n                    return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\r\n                };\r\n\r\n                /**\r\n                 * GeomType enum.\r\n                 * @name com.mapbox.pb.Tile.GeomType\r\n                 * @enum {number}\r\n                 * @property {number} UNKNOWN=0 UNKNOWN value\r\n                 * @property {number} POINT=1 POINT value\r\n                 * @property {number} LINESTRING=2 LINESTRING value\r\n                 * @property {number} POLYGON=3 POLYGON value\r\n                 */\r\n                Tile.GeomType = (function() {\r\n                    var valuesById = {}, values = Object.create(valuesById);\r\n                    values[valuesById[0] = \"UNKNOWN\"] = 0;\r\n                    values[valuesById[1] = \"POINT\"] = 1;\r\n                    values[valuesById[2] = \"LINESTRING\"] = 2;\r\n                    values[valuesById[3] = \"POLYGON\"] = 3;\r\n                    return values;\r\n                })();\r\n\r\n                Tile.Value = (function() {\r\n\r\n                    /**\r\n                     * Properties of a Value.\r\n                     * @memberof com.mapbox.pb.Tile\r\n                     * @interface IValue\r\n                     * @property {string|null} [stringValue] Value stringValue\r\n                     * @property {number|null} [floatValue] Value floatValue\r\n                     * @property {number|null} [doubleValue] Value doubleValue\r\n                     * @property {number|Long|null} [intValue] Value intValue\r\n                     * @property {number|Long|null} [uintValue] Value uintValue\r\n                     * @property {number|Long|null} [sintValue] Value sintValue\r\n                     * @property {boolean|null} [boolValue] Value boolValue\r\n                     */\r\n\r\n                    /**\r\n                     * Constructs a new Value.\r\n                     * @memberof com.mapbox.pb.Tile\r\n                     * @classdesc Represents a Value.\r\n                     * @implements IValue\r\n                     * @constructor\r\n                     * @param {com.mapbox.pb.Tile.IValue=} [properties] Properties to set\r\n                     */\r\n                    function Value(properties) {\r\n                        if (properties)\r\n                            for (var keys = Object.keys(properties), i = 0; i < keys.length; ++i)\r\n                                if (properties[keys[i]] != null)\r\n                                    this[keys[i]] = properties[keys[i]];\r\n                    }\r\n\r\n                    /**\r\n                     * Value stringValue.\r\n                     * @member {string} stringValue\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     */\r\n                    Value.prototype.stringValue = \"\";\r\n\r\n                    /**\r\n                     * Value floatValue.\r\n                     * @member {number} floatValue\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     */\r\n                    Value.prototype.floatValue = 0;\r\n\r\n                    /**\r\n                     * Value doubleValue.\r\n                     * @member {number} doubleValue\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     */\r\n                    Value.prototype.doubleValue = 0;\r\n\r\n                    /**\r\n                     * Value intValue.\r\n                     * @member {number|Long} intValue\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     */\r\n                    Value.prototype.intValue = $util.Long ? $util.Long.fromBits(0,0,false) : 0;\r\n\r\n                    /**\r\n                     * Value uintValue.\r\n                     * @member {number|Long} uintValue\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     */\r\n                    Value.prototype.uintValue = $util.Long ? $util.Long.fromBits(0,0,true) : 0;\r\n\r\n                    /**\r\n                     * Value sintValue.\r\n                     * @member {number|Long} sintValue\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     */\r\n                    Value.prototype.sintValue = $util.Long ? $util.Long.fromBits(0,0,false) : 0;\r\n\r\n                    /**\r\n                     * Value boolValue.\r\n                     * @member {boolean} boolValue\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     */\r\n                    Value.prototype.boolValue = false;\r\n\r\n                    /**\r\n                     * Decodes a Value message from the specified reader or buffer.\r\n                     * @function decode\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @static\r\n                     * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                     * @param {number} [length] Message length if known beforehand\r\n                     * @returns {com.mapbox.pb.Tile.Value} Value\r\n                     * @throws {Error} If the payload is not a reader or valid buffer\r\n                     * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                     */\r\n                    Value.decode = function decode(reader, length) {\r\n                        if (!(reader instanceof $Reader))\r\n                            reader = $Reader.create(reader);\r\n                        var end = length === undefined ? reader.len : reader.pos + length, message = new $root.com.mapbox.pb.Tile.Value();\r\n                        while (reader.pos < end) {\r\n                            var tag = reader.uint32();\r\n                            switch (tag >>> 3) {\r\n                            case 1:\r\n                                message.stringValue = reader.string();\r\n                                break;\r\n                            case 2:\r\n                                message.floatValue = reader.float();\r\n                                break;\r\n                            case 3:\r\n                                message.doubleValue = reader.double();\r\n                                break;\r\n                            case 4:\r\n                                message.intValue = reader.int64();\r\n                                break;\r\n                            case 5:\r\n                                message.uintValue = reader.uint64();\r\n                                break;\r\n                            case 6:\r\n                                message.sintValue = reader.sint64();\r\n                                break;\r\n                            case 7:\r\n                                message.boolValue = reader.bool();\r\n                                break;\r\n                            default:\r\n                                reader.skipType(tag & 7);\r\n                                break;\r\n                            }\r\n                        }\r\n                        return message;\r\n                    };\r\n\r\n                    /**\r\n                     * Decodes a Value message from the specified reader or buffer, length delimited.\r\n                     * @function decodeDelimited\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @static\r\n                     * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                     * @returns {com.mapbox.pb.Tile.Value} Value\r\n                     * @throws {Error} If the payload is not a reader or valid buffer\r\n                     * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                     */\r\n                    Value.decodeDelimited = function decodeDelimited(reader) {\r\n                        if (!(reader instanceof $Reader))\r\n                            reader = new $Reader(reader);\r\n                        return this.decode(reader, reader.uint32());\r\n                    };\r\n\r\n                    /**\r\n                     * Creates a Value message from a plain object. Also converts values to their respective internal types.\r\n                     * @function fromObject\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @static\r\n                     * @param {Object.<string,*>} object Plain object\r\n                     * @returns {com.mapbox.pb.Tile.Value} Value\r\n                     */\r\n                    Value.fromObject = function fromObject(object) {\r\n                        if (object instanceof $root.com.mapbox.pb.Tile.Value)\r\n                            return object;\r\n                        var message = new $root.com.mapbox.pb.Tile.Value();\r\n                        if (object.stringValue != null)\r\n                            message.stringValue = String(object.stringValue);\r\n                        if (object.floatValue != null)\r\n                            message.floatValue = Number(object.floatValue);\r\n                        if (object.doubleValue != null)\r\n                            message.doubleValue = Number(object.doubleValue);\r\n                        if (object.intValue != null)\r\n                            if ($util.Long)\r\n                                (message.intValue = $util.Long.fromValue(object.intValue)).unsigned = false;\r\n                            else if (typeof object.intValue === \"string\")\r\n                                message.intValue = parseInt(object.intValue, 10);\r\n                            else if (typeof object.intValue === \"number\")\r\n                                message.intValue = object.intValue;\r\n                            else if (typeof object.intValue === \"object\")\r\n                                message.intValue = new $util.LongBits(object.intValue.low >>> 0, object.intValue.high >>> 0).toNumber();\r\n                        if (object.uintValue != null)\r\n                            if ($util.Long)\r\n                                (message.uintValue = $util.Long.fromValue(object.uintValue)).unsigned = true;\r\n                            else if (typeof object.uintValue === \"string\")\r\n                                message.uintValue = parseInt(object.uintValue, 10);\r\n                            else if (typeof object.uintValue === \"number\")\r\n                                message.uintValue = object.uintValue;\r\n                            else if (typeof object.uintValue === \"object\")\r\n                                message.uintValue = new $util.LongBits(object.uintValue.low >>> 0, object.uintValue.high >>> 0).toNumber(true);\r\n                        if (object.sintValue != null)\r\n                            if ($util.Long)\r\n                                (message.sintValue = $util.Long.fromValue(object.sintValue)).unsigned = false;\r\n                            else if (typeof object.sintValue === \"string\")\r\n                                message.sintValue = parseInt(object.sintValue, 10);\r\n                            else if (typeof object.sintValue === \"number\")\r\n                                message.sintValue = object.sintValue;\r\n                            else if (typeof object.sintValue === \"object\")\r\n                                message.sintValue = new $util.LongBits(object.sintValue.low >>> 0, object.sintValue.high >>> 0).toNumber();\r\n                        if (object.boolValue != null)\r\n                            message.boolValue = Boolean(object.boolValue);\r\n                        return message;\r\n                    };\r\n\r\n                    /**\r\n                     * Creates a plain object from a Value message. Also converts values to other types if specified.\r\n                     * @function toObject\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @static\r\n                     * @param {com.mapbox.pb.Tile.Value} message Value\r\n                     * @param {$protobuf.IConversionOptions} [options] Conversion options\r\n                     * @returns {Object.<string,*>} Plain object\r\n                     */\r\n                    Value.toObject = function toObject(message, options) {\r\n                        if (!options)\r\n                            options = {};\r\n                        var object = {};\r\n                        if (options.defaults) {\r\n                            object.stringValue = \"\";\r\n                            object.floatValue = 0;\r\n                            object.doubleValue = 0;\r\n                            if ($util.Long) {\r\n                                var long = new $util.Long(0, 0, false);\r\n                                object.intValue = options.longs === String ? long.toString() : options.longs === Number ? long.toNumber() : long;\r\n                            } else\r\n                                object.intValue = options.longs === String ? \"0\" : 0;\r\n                            if ($util.Long) {\r\n                                var long = new $util.Long(0, 0, true);\r\n                                object.uintValue = options.longs === String ? long.toString() : options.longs === Number ? long.toNumber() : long;\r\n                            } else\r\n                                object.uintValue = options.longs === String ? \"0\" : 0;\r\n                            if ($util.Long) {\r\n                                var long = new $util.Long(0, 0, false);\r\n                                object.sintValue = options.longs === String ? long.toString() : options.longs === Number ? long.toNumber() : long;\r\n                            } else\r\n                                object.sintValue = options.longs === String ? \"0\" : 0;\r\n                            object.boolValue = false;\r\n                        }\r\n                        if (message.stringValue != null && message.hasOwnProperty(\"stringValue\"))\r\n                            object.stringValue = message.stringValue;\r\n                        if (message.floatValue != null && message.hasOwnProperty(\"floatValue\"))\r\n                            object.floatValue = options.json && !isFinite(message.floatValue) ? String(message.floatValue) : message.floatValue;\r\n                        if (message.doubleValue != null && message.hasOwnProperty(\"doubleValue\"))\r\n                            object.doubleValue = options.json && !isFinite(message.doubleValue) ? String(message.doubleValue) : message.doubleValue;\r\n                        if (message.intValue != null && message.hasOwnProperty(\"intValue\"))\r\n                            if (typeof message.intValue === \"number\")\r\n                                object.intValue = options.longs === String ? String(message.intValue) : message.intValue;\r\n                            else\r\n                                object.intValue = options.longs === String ? $util.Long.prototype.toString.call(message.intValue) : options.longs === Number ? new $util.LongBits(message.intValue.low >>> 0, message.intValue.high >>> 0).toNumber() : message.intValue;\r\n                        if (message.uintValue != null && message.hasOwnProperty(\"uintValue\"))\r\n                            if (typeof message.uintValue === \"number\")\r\n                                object.uintValue = options.longs === String ? String(message.uintValue) : message.uintValue;\r\n                            else\r\n                                object.uintValue = options.longs === String ? $util.Long.prototype.toString.call(message.uintValue) : options.longs === Number ? new $util.LongBits(message.uintValue.low >>> 0, message.uintValue.high >>> 0).toNumber(true) : message.uintValue;\r\n                        if (message.sintValue != null && message.hasOwnProperty(\"sintValue\"))\r\n                            if (typeof message.sintValue === \"number\")\r\n                                object.sintValue = options.longs === String ? String(message.sintValue) : message.sintValue;\r\n                            else\r\n                                object.sintValue = options.longs === String ? $util.Long.prototype.toString.call(message.sintValue) : options.longs === Number ? new $util.LongBits(message.sintValue.low >>> 0, message.sintValue.high >>> 0).toNumber() : message.sintValue;\r\n                        if (message.boolValue != null && message.hasOwnProperty(\"boolValue\"))\r\n                            object.boolValue = message.boolValue;\r\n                        return object;\r\n                    };\r\n\r\n                    /**\r\n                     * Converts this Value to JSON.\r\n                     * @function toJSON\r\n                     * @memberof com.mapbox.pb.Tile.Value\r\n                     * @instance\r\n                     * @returns {Object.<string,*>} JSON object\r\n                     */\r\n                    Value.prototype.toJSON = function toJSON() {\r\n                        return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\r\n                    };\r\n\r\n                    return Value;\r\n                })();\r\n\r\n                Tile.Feature = (function() {\r\n\r\n                    /**\r\n                     * Properties of a Feature.\r\n                     * @memberof com.mapbox.pb.Tile\r\n                     * @interface IFeature\r\n                     * @property {number|Long|null} [id] Feature id\r\n                     * @property {Array.<number>|null} [tags] Feature tags\r\n                     * @property {com.mapbox.pb.Tile.GeomType|null} [type] Feature type\r\n                     * @property {Array.<number>|null} [geometry] Feature geometry\r\n                     */\r\n\r\n                    /**\r\n                     * Constructs a new Feature.\r\n                     * @memberof com.mapbox.pb.Tile\r\n                     * @classdesc Represents a Feature.\r\n                     * @implements IFeature\r\n                     * @constructor\r\n                     * @param {com.mapbox.pb.Tile.IFeature=} [properties] Properties to set\r\n                     */\r\n                    function Feature(properties) {\r\n                        this.tags = [];\r\n                        this.geometry = [];\r\n                        if (properties)\r\n                            for (var keys = Object.keys(properties), i = 0; i < keys.length; ++i)\r\n                                if (properties[keys[i]] != null)\r\n                                    this[keys[i]] = properties[keys[i]];\r\n                    }\r\n\r\n                    /**\r\n                     * Feature id.\r\n                     * @member {number|Long} id\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @instance\r\n                     */\r\n                    Feature.prototype.id = $util.Long ? $util.Long.fromBits(0,0,true) : 0;\r\n\r\n                    /**\r\n                     * Feature tags.\r\n                     * @member {Array.<number>} tags\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @instance\r\n                     */\r\n                    Feature.prototype.tags = $util.emptyArray;\r\n\r\n                    /**\r\n                     * Feature type.\r\n                     * @member {com.mapbox.pb.Tile.GeomType} type\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @instance\r\n                     */\r\n                    Feature.prototype.type = 0;\r\n\r\n                    /**\r\n                     * Feature geometry.\r\n                     * @member {Array.<number>} geometry\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @instance\r\n                     */\r\n                    Feature.prototype.geometry = $util.emptyArray;\r\n\r\n                    /**\r\n                     * Decodes a Feature message from the specified reader or buffer.\r\n                     * @function decode\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @static\r\n                     * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                     * @param {number} [length] Message length if known beforehand\r\n                     * @returns {com.mapbox.pb.Tile.Feature} Feature\r\n                     * @throws {Error} If the payload is not a reader or valid buffer\r\n                     * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                     */\r\n                    Feature.decode = function decode(reader, length) {\r\n                        if (!(reader instanceof $Reader))\r\n                            reader = $Reader.create(reader);\r\n                        var end = length === undefined ? reader.len : reader.pos + length, message = new $root.com.mapbox.pb.Tile.Feature();\r\n                        while (reader.pos < end) {\r\n                            var tag = reader.uint32();\r\n                            switch (tag >>> 3) {\r\n                            case 1:\r\n                                message.id = reader.uint64();\r\n                                break;\r\n                            case 2:\r\n                                if (!(message.tags && message.tags.length))\r\n                                    message.tags = [];\r\n                                if ((tag & 7) === 2) {\r\n                                    var end2 = reader.uint32() + reader.pos;\r\n                                    while (reader.pos < end2)\r\n                                        message.tags.push(reader.uint32());\r\n                                } else\r\n                                    message.tags.push(reader.uint32());\r\n                                break;\r\n                            case 3:\r\n                                message.type = reader.int32();\r\n                                break;\r\n                            case 4:\r\n                                if (!(message.geometry && message.geometry.length))\r\n                                    message.geometry = [];\r\n                                if ((tag & 7) === 2) {\r\n                                    var end2 = reader.uint32() + reader.pos;\r\n                                    while (reader.pos < end2)\r\n                                        message.geometry.push(reader.uint32());\r\n                                } else\r\n                                    message.geometry.push(reader.uint32());\r\n                                break;\r\n                            default:\r\n                                reader.skipType(tag & 7);\r\n                                break;\r\n                            }\r\n                        }\r\n                        return message;\r\n                    };\r\n\r\n                    /**\r\n                     * Decodes a Feature message from the specified reader or buffer, length delimited.\r\n                     * @function decodeDelimited\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @static\r\n                     * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                     * @returns {com.mapbox.pb.Tile.Feature} Feature\r\n                     * @throws {Error} If the payload is not a reader or valid buffer\r\n                     * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                     */\r\n                    Feature.decodeDelimited = function decodeDelimited(reader) {\r\n                        if (!(reader instanceof $Reader))\r\n                            reader = new $Reader(reader);\r\n                        return this.decode(reader, reader.uint32());\r\n                    };\r\n\r\n                    /**\r\n                     * Creates a Feature message from a plain object. Also converts values to their respective internal types.\r\n                     * @function fromObject\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @static\r\n                     * @param {Object.<string,*>} object Plain object\r\n                     * @returns {com.mapbox.pb.Tile.Feature} Feature\r\n                     */\r\n                    Feature.fromObject = function fromObject(object) {\r\n                        if (object instanceof $root.com.mapbox.pb.Tile.Feature)\r\n                            return object;\r\n                        var message = new $root.com.mapbox.pb.Tile.Feature();\r\n                        if (object.id != null)\r\n                            if ($util.Long)\r\n                                (message.id = $util.Long.fromValue(object.id)).unsigned = true;\r\n                            else if (typeof object.id === \"string\")\r\n                                message.id = parseInt(object.id, 10);\r\n                            else if (typeof object.id === \"number\")\r\n                                message.id = object.id;\r\n                            else if (typeof object.id === \"object\")\r\n                                message.id = new $util.LongBits(object.id.low >>> 0, object.id.high >>> 0).toNumber(true);\r\n                        if (object.tags) {\r\n                            if (!Array.isArray(object.tags))\r\n                                throw TypeError(\".com.mapbox.pb.Tile.Feature.tags: array expected\");\r\n                            message.tags = [];\r\n                            for (var i = 0; i < object.tags.length; ++i)\r\n                                message.tags[i] = object.tags[i] >>> 0;\r\n                        }\r\n                        switch (object.type) {\r\n                        case \"UNKNOWN\":\r\n                        case 0:\r\n                            message.type = 0;\r\n                            break;\r\n                        case \"POINT\":\r\n                        case 1:\r\n                            message.type = 1;\r\n                            break;\r\n                        case \"LINESTRING\":\r\n                        case 2:\r\n                            message.type = 2;\r\n                            break;\r\n                        case \"POLYGON\":\r\n                        case 3:\r\n                            message.type = 3;\r\n                            break;\r\n                        }\r\n                        if (object.geometry) {\r\n                            if (!Array.isArray(object.geometry))\r\n                                throw TypeError(\".com.mapbox.pb.Tile.Feature.geometry: array expected\");\r\n                            message.geometry = [];\r\n                            for (var i = 0; i < object.geometry.length; ++i)\r\n                                message.geometry[i] = object.geometry[i] >>> 0;\r\n                        }\r\n                        return message;\r\n                    };\r\n\r\n                    /**\r\n                     * Creates a plain object from a Feature message. Also converts values to other types if specified.\r\n                     * @function toObject\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @static\r\n                     * @param {com.mapbox.pb.Tile.Feature} message Feature\r\n                     * @param {$protobuf.IConversionOptions} [options] Conversion options\r\n                     * @returns {Object.<string,*>} Plain object\r\n                     */\r\n                    Feature.toObject = function toObject(message, options) {\r\n                        if (!options)\r\n                            options = {};\r\n                        var object = {};\r\n                        if (options.arrays || options.defaults) {\r\n                            object.tags = [];\r\n                            object.geometry = [];\r\n                        }\r\n                        if (options.defaults) {\r\n                            if ($util.Long) {\r\n                                var long = new $util.Long(0, 0, true);\r\n                                object.id = options.longs === String ? long.toString() : options.longs === Number ? long.toNumber() : long;\r\n                            } else\r\n                                object.id = options.longs === String ? \"0\" : 0;\r\n                            object.type = options.enums === String ? \"UNKNOWN\" : 0;\r\n                        }\r\n                        if (message.id != null && message.hasOwnProperty(\"id\"))\r\n                            if (typeof message.id === \"number\")\r\n                                object.id = options.longs === String ? String(message.id) : message.id;\r\n                            else\r\n                                object.id = options.longs === String ? $util.Long.prototype.toString.call(message.id) : options.longs === Number ? new $util.LongBits(message.id.low >>> 0, message.id.high >>> 0).toNumber(true) : message.id;\r\n                        if (message.tags && message.tags.length) {\r\n                            object.tags = [];\r\n                            for (var j = 0; j < message.tags.length; ++j)\r\n                                object.tags[j] = message.tags[j];\r\n                        }\r\n                        if (message.type != null && message.hasOwnProperty(\"type\"))\r\n                            object.type = options.enums === String ? $root.com.mapbox.pb.Tile.GeomType[message.type] : message.type;\r\n                        if (message.geometry && message.geometry.length) {\r\n                            object.geometry = [];\r\n                            for (var j = 0; j < message.geometry.length; ++j)\r\n                                object.geometry[j] = message.geometry[j];\r\n                        }\r\n                        return object;\r\n                    };\r\n\r\n                    /**\r\n                     * Converts this Feature to JSON.\r\n                     * @function toJSON\r\n                     * @memberof com.mapbox.pb.Tile.Feature\r\n                     * @instance\r\n                     * @returns {Object.<string,*>} JSON object\r\n                     */\r\n                    Feature.prototype.toJSON = function toJSON() {\r\n                        return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\r\n                    };\r\n\r\n                    return Feature;\r\n                })();\r\n\r\n                Tile.Layer = (function() {\r\n\r\n                    /**\r\n                     * Properties of a Layer.\r\n                     * @memberof com.mapbox.pb.Tile\r\n                     * @interface ILayer\r\n                     * @property {number} version Layer version\r\n                     * @property {string} name Layer name\r\n                     * @property {Array.<com.mapbox.pb.Tile.IFeature>|null} [features] Layer features\r\n                     * @property {Array.<string>|null} [keys] Layer keys\r\n                     * @property {Array.<com.mapbox.pb.Tile.IValue>|null} [values] Layer values\r\n                     * @property {number|null} [extent] Layer extent\r\n                     */\r\n\r\n                    /**\r\n                     * Constructs a new Layer.\r\n                     * @memberof com.mapbox.pb.Tile\r\n                     * @classdesc Represents a Layer.\r\n                     * @implements ILayer\r\n                     * @constructor\r\n                     * @param {com.mapbox.pb.Tile.ILayer=} [properties] Properties to set\r\n                     */\r\n                    function Layer(properties) {\r\n                        this.features = [];\r\n                        this.keys = [];\r\n                        this.values = [];\r\n                        if (properties)\r\n                            for (var keys = Object.keys(properties), i = 0; i < keys.length; ++i)\r\n                                if (properties[keys[i]] != null)\r\n                                    this[keys[i]] = properties[keys[i]];\r\n                    }\r\n\r\n                    /**\r\n                     * Layer version.\r\n                     * @member {number} version\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @instance\r\n                     */\r\n                    Layer.prototype.version = 1;\r\n\r\n                    /**\r\n                     * Layer name.\r\n                     * @member {string} name\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @instance\r\n                     */\r\n                    Layer.prototype.name = \"\";\r\n\r\n                    /**\r\n                     * Layer features.\r\n                     * @member {Array.<com.mapbox.pb.Tile.IFeature>} features\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @instance\r\n                     */\r\n                    Layer.prototype.features = $util.emptyArray;\r\n\r\n                    /**\r\n                     * Layer keys.\r\n                     * @member {Array.<string>} keys\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @instance\r\n                     */\r\n                    Layer.prototype.keys = $util.emptyArray;\r\n\r\n                    /**\r\n                     * Layer values.\r\n                     * @member {Array.<com.mapbox.pb.Tile.IValue>} values\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @instance\r\n                     */\r\n                    Layer.prototype.values = $util.emptyArray;\r\n\r\n                    /**\r\n                     * Layer extent.\r\n                     * @member {number} extent\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @instance\r\n                     */\r\n                    Layer.prototype.extent = 4096;\r\n\r\n                    /**\r\n                     * Decodes a Layer message from the specified reader or buffer.\r\n                     * @function decode\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @static\r\n                     * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                     * @param {number} [length] Message length if known beforehand\r\n                     * @returns {com.mapbox.pb.Tile.Layer} Layer\r\n                     * @throws {Error} If the payload is not a reader or valid buffer\r\n                     * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                     */\r\n                    Layer.decode = function decode(reader, length) {\r\n                        if (!(reader instanceof $Reader))\r\n                            reader = $Reader.create(reader);\r\n                        var end = length === undefined ? reader.len : reader.pos + length, message = new $root.com.mapbox.pb.Tile.Layer();\r\n                        while (reader.pos < end) {\r\n                            var tag = reader.uint32();\r\n                            switch (tag >>> 3) {\r\n                            case 15:\r\n                                message.version = reader.uint32();\r\n                                break;\r\n                            case 1:\r\n                                message.name = reader.string();\r\n                                break;\r\n                            case 2:\r\n                                if (!(message.features && message.features.length))\r\n                                    message.features = [];\r\n                                message.features.push($root.com.mapbox.pb.Tile.Feature.decode(reader, reader.uint32()));\r\n                                break;\r\n                            case 3:\r\n                                if (!(message.keys && message.keys.length))\r\n                                    message.keys = [];\r\n                                message.keys.push(reader.string());\r\n                                break;\r\n                            case 4:\r\n                                if (!(message.values && message.values.length))\r\n                                    message.values = [];\r\n                                message.values.push($root.com.mapbox.pb.Tile.Value.decode(reader, reader.uint32()));\r\n                                break;\r\n                            case 5:\r\n                                message.extent = reader.uint32();\r\n                                break;\r\n                            default:\r\n                                reader.skipType(tag & 7);\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (!message.hasOwnProperty(\"version\"))\r\n                            throw $util.ProtocolError(\"missing required 'version'\", { instance: message });\r\n                        if (!message.hasOwnProperty(\"name\"))\r\n                            throw $util.ProtocolError(\"missing required 'name'\", { instance: message });\r\n                        return message;\r\n                    };\r\n\r\n                    /**\r\n                     * Decodes a Layer message from the specified reader or buffer, length delimited.\r\n                     * @function decodeDelimited\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @static\r\n                     * @param {$protobuf.Reader|Uint8Array} reader Reader or buffer to decode from\r\n                     * @returns {com.mapbox.pb.Tile.Layer} Layer\r\n                     * @throws {Error} If the payload is not a reader or valid buffer\r\n                     * @throws {$protobuf.util.ProtocolError} If required fields are missing\r\n                     */\r\n                    Layer.decodeDelimited = function decodeDelimited(reader) {\r\n                        if (!(reader instanceof $Reader))\r\n                            reader = new $Reader(reader);\r\n                        return this.decode(reader, reader.uint32());\r\n                    };\r\n\r\n                    /**\r\n                     * Creates a Layer message from a plain object. Also converts values to their respective internal types.\r\n                     * @function fromObject\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @static\r\n                     * @param {Object.<string,*>} object Plain object\r\n                     * @returns {com.mapbox.pb.Tile.Layer} Layer\r\n                     */\r\n                    Layer.fromObject = function fromObject(object) {\r\n                        if (object instanceof $root.com.mapbox.pb.Tile.Layer)\r\n                            return object;\r\n                        var message = new $root.com.mapbox.pb.Tile.Layer();\r\n                        if (object.version != null)\r\n                            message.version = object.version >>> 0;\r\n                        if (object.name != null)\r\n                            message.name = String(object.name);\r\n                        if (object.features) {\r\n                            if (!Array.isArray(object.features))\r\n                                throw TypeError(\".com.mapbox.pb.Tile.Layer.features: array expected\");\r\n                            message.features = [];\r\n                            for (var i = 0; i < object.features.length; ++i) {\r\n                                if (typeof object.features[i] !== \"object\")\r\n                                    throw TypeError(\".com.mapbox.pb.Tile.Layer.features: object expected\");\r\n                                message.features[i] = $root.com.mapbox.pb.Tile.Feature.fromObject(object.features[i]);\r\n                            }\r\n                        }\r\n                        if (object.keys) {\r\n                            if (!Array.isArray(object.keys))\r\n                                throw TypeError(\".com.mapbox.pb.Tile.Layer.keys: array expected\");\r\n                            message.keys = [];\r\n                            for (var i = 0; i < object.keys.length; ++i)\r\n                                message.keys[i] = String(object.keys[i]);\r\n                        }\r\n                        if (object.values) {\r\n                            if (!Array.isArray(object.values))\r\n                                throw TypeError(\".com.mapbox.pb.Tile.Layer.values: array expected\");\r\n                            message.values = [];\r\n                            for (var i = 0; i < object.values.length; ++i) {\r\n                                if (typeof object.values[i] !== \"object\")\r\n                                    throw TypeError(\".com.mapbox.pb.Tile.Layer.values: object expected\");\r\n                                message.values[i] = $root.com.mapbox.pb.Tile.Value.fromObject(object.values[i]);\r\n                            }\r\n                        }\r\n                        if (object.extent != null)\r\n                            message.extent = object.extent >>> 0;\r\n                        return message;\r\n                    };\r\n\r\n                    /**\r\n                     * Creates a plain object from a Layer message. Also converts values to other types if specified.\r\n                     * @function toObject\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @static\r\n                     * @param {com.mapbox.pb.Tile.Layer} message Layer\r\n                     * @param {$protobuf.IConversionOptions} [options] Conversion options\r\n                     * @returns {Object.<string,*>} Plain object\r\n                     */\r\n                    Layer.toObject = function toObject(message, options) {\r\n                        if (!options)\r\n                            options = {};\r\n                        var object = {};\r\n                        if (options.arrays || options.defaults) {\r\n                            object.features = [];\r\n                            object.keys = [];\r\n                            object.values = [];\r\n                        }\r\n                        if (options.defaults) {\r\n                            object.name = \"\";\r\n                            object.extent = 4096;\r\n                            object.version = 1;\r\n                        }\r\n                        if (message.name != null && message.hasOwnProperty(\"name\"))\r\n                            object.name = message.name;\r\n                        if (message.features && message.features.length) {\r\n                            object.features = [];\r\n                            for (var j = 0; j < message.features.length; ++j)\r\n                                object.features[j] = $root.com.mapbox.pb.Tile.Feature.toObject(message.features[j], options);\r\n                        }\r\n                        if (message.keys && message.keys.length) {\r\n                            object.keys = [];\r\n                            for (var j = 0; j < message.keys.length; ++j)\r\n                                object.keys[j] = message.keys[j];\r\n                        }\r\n                        if (message.values && message.values.length) {\r\n                            object.values = [];\r\n                            for (var j = 0; j < message.values.length; ++j)\r\n                                object.values[j] = $root.com.mapbox.pb.Tile.Value.toObject(message.values[j], options);\r\n                        }\r\n                        if (message.extent != null && message.hasOwnProperty(\"extent\"))\r\n                            object.extent = message.extent;\r\n                        if (message.version != null && message.hasOwnProperty(\"version\"))\r\n                            object.version = message.version;\r\n                        return object;\r\n                    };\r\n\r\n                    /**\r\n                     * Converts this Layer to JSON.\r\n                     * @function toJSON\r\n                     * @memberof com.mapbox.pb.Tile.Layer\r\n                     * @instance\r\n                     * @returns {Object.<string,*>} JSON object\r\n                     */\r\n                    Layer.prototype.toJSON = function toJSON() {\r\n                        return this.constructor.toObject(this, $protobuf.util.toJSONOptions);\r\n                    };\r\n\r\n                    return Layer;\r\n                })();\r\n\r\n                return Tile;\r\n            })();\r\n\r\n            return pb;\r\n        })();\r\n\r\n        return mapbox;\r\n    })();\r\n\r\n    return com;\r\n})();\r\n\r\nmodule.exports = $root;\r\n","\"use strict\";\r\nmodule.exports = asPromise;\r\n\r\n/**\r\n * Callback as used by {@link util.asPromise}.\r\n * @typedef asPromiseCallback\r\n * @type {function}\r\n * @param {Error|null} error Error, if any\r\n * @param {...*} params Additional arguments\r\n * @returns {undefined}\r\n */\r\n\r\n/**\r\n * Returns a promise from a node-style callback function.\r\n * @memberof util\r\n * @param {asPromiseCallback} fn Function to call\r\n * @param {*} ctx Function context\r\n * @param {...*} params Function arguments\r\n * @returns {Promise<*>} Promisified function\r\n */\r\nfunction asPromise(fn, ctx/*, varargs */) {\r\n    var params  = new Array(arguments.length - 1),\r\n        offset  = 0,\r\n        index   = 2,\r\n        pending = true;\r\n    while (index < arguments.length)\r\n        params[offset++] = arguments[index++];\r\n    return new Promise(function executor(resolve, reject) {\r\n        params[offset] = function callback(err/*, varargs */) {\r\n            if (pending) {\r\n                pending = false;\r\n                if (err)\r\n                    reject(err);\r\n                else {\r\n                    var params = new Array(arguments.length - 1),\r\n                        offset = 0;\r\n                    while (offset < params.length)\r\n                        params[offset++] = arguments[offset];\r\n                    resolve.apply(null, params);\r\n                }\r\n            }\r\n        };\r\n        try {\r\n            fn.apply(ctx || null, params);\r\n        } catch (err) {\r\n            if (pending) {\r\n                pending = false;\r\n                reject(err);\r\n            }\r\n        }\r\n    });\r\n}\r\n","\"use strict\";\r\n\r\n/**\r\n * A minimal base64 implementation for number arrays.\r\n * @memberof util\r\n * @namespace\r\n */\r\nvar base64 = exports;\r\n\r\n/**\r\n * Calculates the byte length of a base64 encoded string.\r\n * @param {string} string Base64 encoded string\r\n * @returns {number} Byte length\r\n */\r\nbase64.length = function length(string) {\r\n    var p = string.length;\r\n    if (!p)\r\n        return 0;\r\n    var n = 0;\r\n    while (--p % 4 > 1 && string.charAt(p) === \"=\")\r\n        ++n;\r\n    return Math.ceil(string.length * 3) / 4 - n;\r\n};\r\n\r\n// Base64 encoding table\r\nvar b64 = new Array(64);\r\n\r\n// Base64 decoding table\r\nvar s64 = new Array(123);\r\n\r\n// 65..90, 97..122, 48..57, 43, 47\r\nfor (var i = 0; i < 64;)\r\n    s64[b64[i] = i < 26 ? i + 65 : i < 52 ? i + 71 : i < 62 ? i - 4 : i - 59 | 43] = i++;\r\n\r\n/**\r\n * Encodes a buffer to a base64 encoded string.\r\n * @param {Uint8Array} buffer Source buffer\r\n * @param {number} start Source start\r\n * @param {number} end Source end\r\n * @returns {string} Base64 encoded string\r\n */\r\nbase64.encode = function encode(buffer, start, end) {\r\n    var parts = null,\r\n        chunk = [];\r\n    var i = 0, // output index\r\n        j = 0, // goto index\r\n        t;     // temporary\r\n    while (start < end) {\r\n        var b = buffer[start++];\r\n        switch (j) {\r\n            case 0:\r\n                chunk[i++] = b64[b >> 2];\r\n                t = (b & 3) << 4;\r\n                j = 1;\r\n                break;\r\n            case 1:\r\n                chunk[i++] = b64[t | b >> 4];\r\n                t = (b & 15) << 2;\r\n                j = 2;\r\n                break;\r\n            case 2:\r\n                chunk[i++] = b64[t | b >> 6];\r\n                chunk[i++] = b64[b & 63];\r\n                j = 0;\r\n                break;\r\n        }\r\n        if (i > 8191) {\r\n            (parts || (parts = [])).push(String.fromCharCode.apply(String, chunk));\r\n            i = 0;\r\n        }\r\n    }\r\n    if (j) {\r\n        chunk[i++] = b64[t];\r\n        chunk[i++] = 61;\r\n        if (j === 1)\r\n            chunk[i++] = 61;\r\n    }\r\n    if (parts) {\r\n        if (i)\r\n            parts.push(String.fromCharCode.apply(String, chunk.slice(0, i)));\r\n        return parts.join(\"\");\r\n    }\r\n    return String.fromCharCode.apply(String, chunk.slice(0, i));\r\n};\r\n\r\nvar invalidEncoding = \"invalid encoding\";\r\n\r\n/**\r\n * Decodes a base64 encoded string to a buffer.\r\n * @param {string} string Source string\r\n * @param {Uint8Array} buffer Destination buffer\r\n * @param {number} offset Destination offset\r\n * @returns {number} Number of bytes written\r\n * @throws {Error} If encoding is invalid\r\n */\r\nbase64.decode = function decode(string, buffer, offset) {\r\n    var start = offset;\r\n    var j = 0, // goto index\r\n        t;     // temporary\r\n    for (var i = 0; i < string.length;) {\r\n        var c = string.charCodeAt(i++);\r\n        if (c === 61 && j > 1)\r\n            break;\r\n        if ((c = s64[c]) === undefined)\r\n            throw Error(invalidEncoding);\r\n        switch (j) {\r\n            case 0:\r\n                t = c;\r\n                j = 1;\r\n                break;\r\n            case 1:\r\n                buffer[offset++] = t << 2 | (c & 48) >> 4;\r\n                t = c;\r\n                j = 2;\r\n                break;\r\n            case 2:\r\n                buffer[offset++] = (t & 15) << 4 | (c & 60) >> 2;\r\n                t = c;\r\n                j = 3;\r\n                break;\r\n            case 3:\r\n                buffer[offset++] = (t & 3) << 6 | c;\r\n                j = 0;\r\n                break;\r\n        }\r\n    }\r\n    if (j === 1)\r\n        throw Error(invalidEncoding);\r\n    return offset - start;\r\n};\r\n\r\n/**\r\n * Tests if the specified string appears to be base64 encoded.\r\n * @param {string} string String to test\r\n * @returns {boolean} `true` if probably base64 encoded, otherwise false\r\n */\r\nbase64.test = function test(string) {\r\n    return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(string);\r\n};\r\n","\"use strict\";\r\nmodule.exports = EventEmitter;\r\n\r\n/**\r\n * Constructs a new event emitter instance.\r\n * @classdesc A minimal event emitter.\r\n * @memberof util\r\n * @constructor\r\n */\r\nfunction EventEmitter() {\r\n\r\n    /**\r\n     * Registered listeners.\r\n     * @type {Object.<string,*>}\r\n     * @private\r\n     */\r\n    this._listeners = {};\r\n}\r\n\r\n/**\r\n * Registers an event listener.\r\n * @param {string} evt Event name\r\n * @param {function} fn Listener\r\n * @param {*} [ctx] Listener context\r\n * @returns {util.EventEmitter} `this`\r\n */\r\nEventEmitter.prototype.on = function on(evt, fn, ctx) {\r\n    (this._listeners[evt] || (this._listeners[evt] = [])).push({\r\n        fn  : fn,\r\n        ctx : ctx || this\r\n    });\r\n    return this;\r\n};\r\n\r\n/**\r\n * Removes an event listener or any matching listeners if arguments are omitted.\r\n * @param {string} [evt] Event name. Removes all listeners if omitted.\r\n * @param {function} [fn] Listener to remove. Removes all listeners of `evt` if omitted.\r\n * @returns {util.EventEmitter} `this`\r\n */\r\nEventEmitter.prototype.off = function off(evt, fn) {\r\n    if (evt === undefined)\r\n        this._listeners = {};\r\n    else {\r\n        if (fn === undefined)\r\n            this._listeners[evt] = [];\r\n        else {\r\n            var listeners = this._listeners[evt];\r\n            for (var i = 0; i < listeners.length;)\r\n                if (listeners[i].fn === fn)\r\n                    listeners.splice(i, 1);\r\n                else\r\n                    ++i;\r\n        }\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Emits an event by calling its listeners with the specified arguments.\r\n * @param {string} evt Event name\r\n * @param {...*} args Arguments\r\n * @returns {util.EventEmitter} `this`\r\n */\r\nEventEmitter.prototype.emit = function emit(evt) {\r\n    var listeners = this._listeners[evt];\r\n    if (listeners) {\r\n        var args = [],\r\n            i = 1;\r\n        for (; i < arguments.length;)\r\n            args.push(arguments[i++]);\r\n        for (i = 0; i < listeners.length;)\r\n            listeners[i].fn.apply(listeners[i++].ctx, args);\r\n    }\r\n    return this;\r\n};\r\n","\"use strict\";\r\n\r\nmodule.exports = factory(factory);\r\n\r\n/**\r\n * Reads / writes floats / doubles from / to buffers.\r\n * @name util.float\r\n * @namespace\r\n */\r\n\r\n/**\r\n * Writes a 32 bit float to a buffer using little endian byte order.\r\n * @name util.float.writeFloatLE\r\n * @function\r\n * @param {number} val Value to write\r\n * @param {Uint8Array} buf Target buffer\r\n * @param {number} pos Target buffer offset\r\n * @returns {undefined}\r\n */\r\n\r\n/**\r\n * Writes a 32 bit float to a buffer using big endian byte order.\r\n * @name util.float.writeFloatBE\r\n * @function\r\n * @param {number} val Value to write\r\n * @param {Uint8Array} buf Target buffer\r\n * @param {number} pos Target buffer offset\r\n * @returns {undefined}\r\n */\r\n\r\n/**\r\n * Reads a 32 bit float from a buffer using little endian byte order.\r\n * @name util.float.readFloatLE\r\n * @function\r\n * @param {Uint8Array} buf Source buffer\r\n * @param {number} pos Source buffer offset\r\n * @returns {number} Value read\r\n */\r\n\r\n/**\r\n * Reads a 32 bit float from a buffer using big endian byte order.\r\n * @name util.float.readFloatBE\r\n * @function\r\n * @param {Uint8Array} buf Source buffer\r\n * @param {number} pos Source buffer offset\r\n * @returns {number} Value read\r\n */\r\n\r\n/**\r\n * Writes a 64 bit double to a buffer using little endian byte order.\r\n * @name util.float.writeDoubleLE\r\n * @function\r\n * @param {number} val Value to write\r\n * @param {Uint8Array} buf Target buffer\r\n * @param {number} pos Target buffer offset\r\n * @returns {undefined}\r\n */\r\n\r\n/**\r\n * Writes a 64 bit double to a buffer using big endian byte order.\r\n * @name util.float.writeDoubleBE\r\n * @function\r\n * @param {number} val Value to write\r\n * @param {Uint8Array} buf Target buffer\r\n * @param {number} pos Target buffer offset\r\n * @returns {undefined}\r\n */\r\n\r\n/**\r\n * Reads a 64 bit double from a buffer using little endian byte order.\r\n * @name util.float.readDoubleLE\r\n * @function\r\n * @param {Uint8Array} buf Source buffer\r\n * @param {number} pos Source buffer offset\r\n * @returns {number} Value read\r\n */\r\n\r\n/**\r\n * Reads a 64 bit double from a buffer using big endian byte order.\r\n * @name util.float.readDoubleBE\r\n * @function\r\n * @param {Uint8Array} buf Source buffer\r\n * @param {number} pos Source buffer offset\r\n * @returns {number} Value read\r\n */\r\n\r\n// Factory function for the purpose of node-based testing in modified global environments\r\nfunction factory(exports) {\r\n\r\n    // float: typed array\r\n    if (typeof Float32Array !== \"undefined\") (function() {\r\n\r\n        var f32 = new Float32Array([ -0 ]),\r\n            f8b = new Uint8Array(f32.buffer),\r\n            le  = f8b[3] === 128;\r\n\r\n        function writeFloat_f32_cpy(val, buf, pos) {\r\n            f32[0] = val;\r\n            buf[pos    ] = f8b[0];\r\n            buf[pos + 1] = f8b[1];\r\n            buf[pos + 2] = f8b[2];\r\n            buf[pos + 3] = f8b[3];\r\n        }\r\n\r\n        function writeFloat_f32_rev(val, buf, pos) {\r\n            f32[0] = val;\r\n            buf[pos    ] = f8b[3];\r\n            buf[pos + 1] = f8b[2];\r\n            buf[pos + 2] = f8b[1];\r\n            buf[pos + 3] = f8b[0];\r\n        }\r\n\r\n        /* istanbul ignore next */\r\n        exports.writeFloatLE = le ? writeFloat_f32_cpy : writeFloat_f32_rev;\r\n        /* istanbul ignore next */\r\n        exports.writeFloatBE = le ? writeFloat_f32_rev : writeFloat_f32_cpy;\r\n\r\n        function readFloat_f32_cpy(buf, pos) {\r\n            f8b[0] = buf[pos    ];\r\n            f8b[1] = buf[pos + 1];\r\n            f8b[2] = buf[pos + 2];\r\n            f8b[3] = buf[pos + 3];\r\n            return f32[0];\r\n        }\r\n\r\n        function readFloat_f32_rev(buf, pos) {\r\n            f8b[3] = buf[pos    ];\r\n            f8b[2] = buf[pos + 1];\r\n            f8b[1] = buf[pos + 2];\r\n            f8b[0] = buf[pos + 3];\r\n            return f32[0];\r\n        }\r\n\r\n        /* istanbul ignore next */\r\n        exports.readFloatLE = le ? readFloat_f32_cpy : readFloat_f32_rev;\r\n        /* istanbul ignore next */\r\n        exports.readFloatBE = le ? readFloat_f32_rev : readFloat_f32_cpy;\r\n\r\n    // float: ieee754\r\n    })(); else (function() {\r\n\r\n        function writeFloat_ieee754(writeUint, val, buf, pos) {\r\n            var sign = val < 0 ? 1 : 0;\r\n            if (sign)\r\n                val = -val;\r\n            if (val === 0)\r\n                writeUint(1 / val > 0 ? /* positive */ 0 : /* negative 0 */ 2147483648, buf, pos);\r\n            else if (isNaN(val))\r\n                writeUint(2143289344, buf, pos);\r\n            else if (val > 3.4028234663852886e+38) // +-Infinity\r\n                writeUint((sign << 31 | 2139095040) >>> 0, buf, pos);\r\n            else if (val < 1.1754943508222875e-38) // denormal\r\n                writeUint((sign << 31 | Math.round(val / 1.401298464324817e-45)) >>> 0, buf, pos);\r\n            else {\r\n                var exponent = Math.floor(Math.log(val) / Math.LN2),\r\n                    mantissa = Math.round(val * Math.pow(2, -exponent) * 8388608) & 8388607;\r\n                writeUint((sign << 31 | exponent + 127 << 23 | mantissa) >>> 0, buf, pos);\r\n            }\r\n        }\r\n\r\n        exports.writeFloatLE = writeFloat_ieee754.bind(null, writeUintLE);\r\n        exports.writeFloatBE = writeFloat_ieee754.bind(null, writeUintBE);\r\n\r\n        function readFloat_ieee754(readUint, buf, pos) {\r\n            var uint = readUint(buf, pos),\r\n                sign = (uint >> 31) * 2 + 1,\r\n                exponent = uint >>> 23 & 255,\r\n                mantissa = uint & 8388607;\r\n            return exponent === 255\r\n                ? mantissa\r\n                ? NaN\r\n                : sign * Infinity\r\n                : exponent === 0 // denormal\r\n                ? sign * 1.401298464324817e-45 * mantissa\r\n                : sign * Math.pow(2, exponent - 150) * (mantissa + 8388608);\r\n        }\r\n\r\n        exports.readFloatLE = readFloat_ieee754.bind(null, readUintLE);\r\n        exports.readFloatBE = readFloat_ieee754.bind(null, readUintBE);\r\n\r\n    })();\r\n\r\n    // double: typed array\r\n    if (typeof Float64Array !== \"undefined\") (function() {\r\n\r\n        var f64 = new Float64Array([-0]),\r\n            f8b = new Uint8Array(f64.buffer),\r\n            le  = f8b[7] === 128;\r\n\r\n        function writeDouble_f64_cpy(val, buf, pos) {\r\n            f64[0] = val;\r\n            buf[pos    ] = f8b[0];\r\n            buf[pos + 1] = f8b[1];\r\n            buf[pos + 2] = f8b[2];\r\n            buf[pos + 3] = f8b[3];\r\n            buf[pos + 4] = f8b[4];\r\n            buf[pos + 5] = f8b[5];\r\n            buf[pos + 6] = f8b[6];\r\n            buf[pos + 7] = f8b[7];\r\n        }\r\n\r\n        function writeDouble_f64_rev(val, buf, pos) {\r\n            f64[0] = val;\r\n            buf[pos    ] = f8b[7];\r\n            buf[pos + 1] = f8b[6];\r\n            buf[pos + 2] = f8b[5];\r\n            buf[pos + 3] = f8b[4];\r\n            buf[pos + 4] = f8b[3];\r\n            buf[pos + 5] = f8b[2];\r\n            buf[pos + 6] = f8b[1];\r\n            buf[pos + 7] = f8b[0];\r\n        }\r\n\r\n        /* istanbul ignore next */\r\n        exports.writeDoubleLE = le ? writeDouble_f64_cpy : writeDouble_f64_rev;\r\n        /* istanbul ignore next */\r\n        exports.writeDoubleBE = le ? writeDouble_f64_rev : writeDouble_f64_cpy;\r\n\r\n        function readDouble_f64_cpy(buf, pos) {\r\n            f8b[0] = buf[pos    ];\r\n            f8b[1] = buf[pos + 1];\r\n            f8b[2] = buf[pos + 2];\r\n            f8b[3] = buf[pos + 3];\r\n            f8b[4] = buf[pos + 4];\r\n            f8b[5] = buf[pos + 5];\r\n            f8b[6] = buf[pos + 6];\r\n            f8b[7] = buf[pos + 7];\r\n            return f64[0];\r\n        }\r\n\r\n        function readDouble_f64_rev(buf, pos) {\r\n            f8b[7] = buf[pos    ];\r\n            f8b[6] = buf[pos + 1];\r\n            f8b[5] = buf[pos + 2];\r\n            f8b[4] = buf[pos + 3];\r\n            f8b[3] = buf[pos + 4];\r\n            f8b[2] = buf[pos + 5];\r\n            f8b[1] = buf[pos + 6];\r\n            f8b[0] = buf[pos + 7];\r\n            return f64[0];\r\n        }\r\n\r\n        /* istanbul ignore next */\r\n        exports.readDoubleLE = le ? readDouble_f64_cpy : readDouble_f64_rev;\r\n        /* istanbul ignore next */\r\n        exports.readDoubleBE = le ? readDouble_f64_rev : readDouble_f64_cpy;\r\n\r\n    // double: ieee754\r\n    })(); else (function() {\r\n\r\n        function writeDouble_ieee754(writeUint, off0, off1, val, buf, pos) {\r\n            var sign = val < 0 ? 1 : 0;\r\n            if (sign)\r\n                val = -val;\r\n            if (val === 0) {\r\n                writeUint(0, buf, pos + off0);\r\n                writeUint(1 / val > 0 ? /* positive */ 0 : /* negative 0 */ 2147483648, buf, pos + off1);\r\n            } else if (isNaN(val)) {\r\n                writeUint(0, buf, pos + off0);\r\n                writeUint(2146959360, buf, pos + off1);\r\n            } else if (val > 1.7976931348623157e+308) { // +-Infinity\r\n                writeUint(0, buf, pos + off0);\r\n                writeUint((sign << 31 | 2146435072) >>> 0, buf, pos + off1);\r\n            } else {\r\n                var mantissa;\r\n                if (val < 2.2250738585072014e-308) { // denormal\r\n                    mantissa = val / 5e-324;\r\n                    writeUint(mantissa >>> 0, buf, pos + off0);\r\n                    writeUint((sign << 31 | mantissa / 4294967296) >>> 0, buf, pos + off1);\r\n                } else {\r\n                    var exponent = Math.floor(Math.log(val) / Math.LN2);\r\n                    if (exponent === 1024)\r\n                        exponent = 1023;\r\n                    mantissa = val * Math.pow(2, -exponent);\r\n                    writeUint(mantissa * 4503599627370496 >>> 0, buf, pos + off0);\r\n                    writeUint((sign << 31 | exponent + 1023 << 20 | mantissa * 1048576 & 1048575) >>> 0, buf, pos + off1);\r\n                }\r\n            }\r\n        }\r\n\r\n        exports.writeDoubleLE = writeDouble_ieee754.bind(null, writeUintLE, 0, 4);\r\n        exports.writeDoubleBE = writeDouble_ieee754.bind(null, writeUintBE, 4, 0);\r\n\r\n        function readDouble_ieee754(readUint, off0, off1, buf, pos) {\r\n            var lo = readUint(buf, pos + off0),\r\n                hi = readUint(buf, pos + off1);\r\n            var sign = (hi >> 31) * 2 + 1,\r\n                exponent = hi >>> 20 & 2047,\r\n                mantissa = 4294967296 * (hi & 1048575) + lo;\r\n            return exponent === 2047\r\n                ? mantissa\r\n                ? NaN\r\n                : sign * Infinity\r\n                : exponent === 0 // denormal\r\n                ? sign * 5e-324 * mantissa\r\n                : sign * Math.pow(2, exponent - 1075) * (mantissa + 4503599627370496);\r\n        }\r\n\r\n        exports.readDoubleLE = readDouble_ieee754.bind(null, readUintLE, 0, 4);\r\n        exports.readDoubleBE = readDouble_ieee754.bind(null, readUintBE, 4, 0);\r\n\r\n    })();\r\n\r\n    return exports;\r\n}\r\n\r\n// uint helpers\r\n\r\nfunction writeUintLE(val, buf, pos) {\r\n    buf[pos    ] =  val        & 255;\r\n    buf[pos + 1] =  val >>> 8  & 255;\r\n    buf[pos + 2] =  val >>> 16 & 255;\r\n    buf[pos + 3] =  val >>> 24;\r\n}\r\n\r\nfunction writeUintBE(val, buf, pos) {\r\n    buf[pos    ] =  val >>> 24;\r\n    buf[pos + 1] =  val >>> 16 & 255;\r\n    buf[pos + 2] =  val >>> 8  & 255;\r\n    buf[pos + 3] =  val        & 255;\r\n}\r\n\r\nfunction readUintLE(buf, pos) {\r\n    return (buf[pos    ]\r\n          | buf[pos + 1] << 8\r\n          | buf[pos + 2] << 16\r\n          | buf[pos + 3] << 24) >>> 0;\r\n}\r\n\r\nfunction readUintBE(buf, pos) {\r\n    return (buf[pos    ] << 24\r\n          | buf[pos + 1] << 16\r\n          | buf[pos + 2] << 8\r\n          | buf[pos + 3]) >>> 0;\r\n}\r\n","\"use strict\";\r\nmodule.exports = inquire;\r\n\r\n/**\r\n * Requires a module only if available.\r\n * @memberof util\r\n * @param {string} moduleName Module to require\r\n * @returns {?Object} Required module if available and not empty, otherwise `null`\r\n */\r\nfunction inquire(moduleName) {\r\n    try {\r\n        var mod = eval(\"quire\".replace(/^/,\"re\"))(moduleName); // eslint-disable-line no-eval\r\n        if (mod && (mod.length || Object.keys(mod).length))\r\n            return mod;\r\n    } catch (e) {} // eslint-disable-line no-empty\r\n    return null;\r\n}\r\n","\"use strict\";\r\nmodule.exports = pool;\r\n\r\n/**\r\n * An allocator as used by {@link util.pool}.\r\n * @typedef PoolAllocator\r\n * @type {function}\r\n * @param {number} size Buffer size\r\n * @returns {Uint8Array} Buffer\r\n */\r\n\r\n/**\r\n * A slicer as used by {@link util.pool}.\r\n * @typedef PoolSlicer\r\n * @type {function}\r\n * @param {number} start Start offset\r\n * @param {number} end End offset\r\n * @returns {Uint8Array} Buffer slice\r\n * @this {Uint8Array}\r\n */\r\n\r\n/**\r\n * A general purpose buffer pool.\r\n * @memberof util\r\n * @function\r\n * @param {PoolAllocator} alloc Allocator\r\n * @param {PoolSlicer} slice Slicer\r\n * @param {number} [size=8192] Slab size\r\n * @returns {PoolAllocator} Pooled allocator\r\n */\r\nfunction pool(alloc, slice, size) {\r\n    var SIZE   = size || 8192;\r\n    var MAX    = SIZE >>> 1;\r\n    var slab   = null;\r\n    var offset = SIZE;\r\n    return function pool_alloc(size) {\r\n        if (size < 1 || size > MAX)\r\n            return alloc(size);\r\n        if (offset + size > SIZE) {\r\n            slab = alloc(SIZE);\r\n            offset = 0;\r\n        }\r\n        var buf = slice.call(slab, offset, offset += size);\r\n        if (offset & 7) // align to 32 bit\r\n            offset = (offset | 7) + 1;\r\n        return buf;\r\n    };\r\n}\r\n","\"use strict\";\r\n\r\n/**\r\n * A minimal UTF8 implementation for number arrays.\r\n * @memberof util\r\n * @namespace\r\n */\r\nvar utf8 = exports;\r\n\r\n/**\r\n * Calculates the UTF8 byte length of a string.\r\n * @param {string} string String\r\n * @returns {number} Byte length\r\n */\r\nutf8.length = function utf8_length(string) {\r\n    var len = 0,\r\n        c = 0;\r\n    for (var i = 0; i < string.length; ++i) {\r\n        c = string.charCodeAt(i);\r\n        if (c < 128)\r\n            len += 1;\r\n        else if (c < 2048)\r\n            len += 2;\r\n        else if ((c & 0xFC00) === 0xD800 && (string.charCodeAt(i + 1) & 0xFC00) === 0xDC00) {\r\n            ++i;\r\n            len += 4;\r\n        } else\r\n            len += 3;\r\n    }\r\n    return len;\r\n};\r\n\r\n/**\r\n * Reads UTF8 bytes as a string.\r\n * @param {Uint8Array} buffer Source buffer\r\n * @param {number} start Source start\r\n * @param {number} end Source end\r\n * @returns {string} String read\r\n */\r\nutf8.read = function utf8_read(buffer, start, end) {\r\n    var len = end - start;\r\n    if (len < 1)\r\n        return \"\";\r\n    var parts = null,\r\n        chunk = [],\r\n        i = 0, // char offset\r\n        t;     // temporary\r\n    while (start < end) {\r\n        t = buffer[start++];\r\n        if (t < 128)\r\n            chunk[i++] = t;\r\n        else if (t > 191 && t < 224)\r\n            chunk[i++] = (t & 31) << 6 | buffer[start++] & 63;\r\n        else if (t > 239 && t < 365) {\r\n            t = ((t & 7) << 18 | (buffer[start++] & 63) << 12 | (buffer[start++] & 63) << 6 | buffer[start++] & 63) - 0x10000;\r\n            chunk[i++] = 0xD800 + (t >> 10);\r\n            chunk[i++] = 0xDC00 + (t & 1023);\r\n        } else\r\n            chunk[i++] = (t & 15) << 12 | (buffer[start++] & 63) << 6 | buffer[start++] & 63;\r\n        if (i > 8191) {\r\n            (parts || (parts = [])).push(String.fromCharCode.apply(String, chunk));\r\n            i = 0;\r\n        }\r\n    }\r\n    if (parts) {\r\n        if (i)\r\n            parts.push(String.fromCharCode.apply(String, chunk.slice(0, i)));\r\n        return parts.join(\"\");\r\n    }\r\n    return String.fromCharCode.apply(String, chunk.slice(0, i));\r\n};\r\n\r\n/**\r\n * Writes a string as UTF8 bytes.\r\n * @param {string} string Source string\r\n * @param {Uint8Array} buffer Destination buffer\r\n * @param {number} offset Destination offset\r\n * @returns {number} Bytes written\r\n */\r\nutf8.write = function utf8_write(string, buffer, offset) {\r\n    var start = offset,\r\n        c1, // character 1\r\n        c2; // character 2\r\n    for (var i = 0; i < string.length; ++i) {\r\n        c1 = string.charCodeAt(i);\r\n        if (c1 < 128) {\r\n            buffer[offset++] = c1;\r\n        } else if (c1 < 2048) {\r\n            buffer[offset++] = c1 >> 6       | 192;\r\n            buffer[offset++] = c1       & 63 | 128;\r\n        } else if ((c1 & 0xFC00) === 0xD800 && ((c2 = string.charCodeAt(i + 1)) & 0xFC00) === 0xDC00) {\r\n            c1 = 0x10000 + ((c1 & 0x03FF) << 10) + (c2 & 0x03FF);\r\n            ++i;\r\n            buffer[offset++] = c1 >> 18      | 240;\r\n            buffer[offset++] = c1 >> 12 & 63 | 128;\r\n            buffer[offset++] = c1 >> 6  & 63 | 128;\r\n            buffer[offset++] = c1       & 63 | 128;\r\n        } else {\r\n            buffer[offset++] = c1 >> 12      | 224;\r\n            buffer[offset++] = c1 >> 6  & 63 | 128;\r\n            buffer[offset++] = c1       & 63 | 128;\r\n        }\r\n    }\r\n    return offset - start;\r\n};\r\n","// (c) Dean McNamee <dean@gmail.com>, 2012.\n//\n// https://github.com/deanm/css-color-parser-js\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n// FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n// IN THE SOFTWARE.\n\n// http://www.w3.org/TR/css3-color/\nvar kCSSColorTable = {\n  \"transparent\": [0,0,0,0], \"aliceblue\": [240,248,255,1],\n  \"antiquewhite\": [250,235,215,1], \"aqua\": [0,255,255,1],\n  \"aquamarine\": [127,255,212,1], \"azure\": [240,255,255,1],\n  \"beige\": [245,245,220,1], \"bisque\": [255,228,196,1],\n  \"black\": [0,0,0,1], \"blanchedalmond\": [255,235,205,1],\n  \"blue\": [0,0,255,1], \"blueviolet\": [138,43,226,1],\n  \"brown\": [165,42,42,1], \"burlywood\": [222,184,135,1],\n  \"cadetblue\": [95,158,160,1], \"chartreuse\": [127,255,0,1],\n  \"chocolate\": [210,105,30,1], \"coral\": [255,127,80,1],\n  \"cornflowerblue\": [100,149,237,1], \"cornsilk\": [255,248,220,1],\n  \"crimson\": [220,20,60,1], \"cyan\": [0,255,255,1],\n  \"darkblue\": [0,0,139,1], \"darkcyan\": [0,139,139,1],\n  \"darkgoldenrod\": [184,134,11,1], \"darkgray\": [169,169,169,1],\n  \"darkgreen\": [0,100,0,1], \"darkgrey\": [169,169,169,1],\n  \"darkkhaki\": [189,183,107,1], \"darkmagenta\": [139,0,139,1],\n  \"darkolivegreen\": [85,107,47,1], \"darkorange\": [255,140,0,1],\n  \"darkorchid\": [153,50,204,1], \"darkred\": [139,0,0,1],\n  \"darksalmon\": [233,150,122,1], \"darkseagreen\": [143,188,143,1],\n  \"darkslateblue\": [72,61,139,1], \"darkslategray\": [47,79,79,1],\n  \"darkslategrey\": [47,79,79,1], \"darkturquoise\": [0,206,209,1],\n  \"darkviolet\": [148,0,211,1], \"deeppink\": [255,20,147,1],\n  \"deepskyblue\": [0,191,255,1], \"dimgray\": [105,105,105,1],\n  \"dimgrey\": [105,105,105,1], \"dodgerblue\": [30,144,255,1],\n  \"firebrick\": [178,34,34,1], \"floralwhite\": [255,250,240,1],\n  \"forestgreen\": [34,139,34,1], \"fuchsia\": [255,0,255,1],\n  \"gainsboro\": [220,220,220,1], \"ghostwhite\": [248,248,255,1],\n  \"gold\": [255,215,0,1], \"goldenrod\": [218,165,32,1],\n  \"gray\": [128,128,128,1], \"green\": [0,128,0,1],\n  \"greenyellow\": [173,255,47,1], \"grey\": [128,128,128,1],\n  \"honeydew\": [240,255,240,1], \"hotpink\": [255,105,180,1],\n  \"indianred\": [205,92,92,1], \"indigo\": [75,0,130,1],\n  \"ivory\": [255,255,240,1], \"khaki\": [240,230,140,1],\n  \"lavender\": [230,230,250,1], \"lavenderblush\": [255,240,245,1],\n  \"lawngreen\": [124,252,0,1], \"lemonchiffon\": [255,250,205,1],\n  \"lightblue\": [173,216,230,1], \"lightcoral\": [240,128,128,1],\n  \"lightcyan\": [224,255,255,1], \"lightgoldenrodyellow\": [250,250,210,1],\n  \"lightgray\": [211,211,211,1], \"lightgreen\": [144,238,144,1],\n  \"lightgrey\": [211,211,211,1], \"lightpink\": [255,182,193,1],\n  \"lightsalmon\": [255,160,122,1], \"lightseagreen\": [32,178,170,1],\n  \"lightskyblue\": [135,206,250,1], \"lightslategray\": [119,136,153,1],\n  \"lightslategrey\": [119,136,153,1], \"lightsteelblue\": [176,196,222,1],\n  \"lightyellow\": [255,255,224,1], \"lime\": [0,255,0,1],\n  \"limegreen\": [50,205,50,1], \"linen\": [250,240,230,1],\n  \"magenta\": [255,0,255,1], \"maroon\": [128,0,0,1],\n  \"mediumaquamarine\": [102,205,170,1], \"mediumblue\": [0,0,205,1],\n  \"mediumorchid\": [186,85,211,1], \"mediumpurple\": [147,112,219,1],\n  \"mediumseagreen\": [60,179,113,1], \"mediumslateblue\": [123,104,238,1],\n  \"mediumspringgreen\": [0,250,154,1], \"mediumturquoise\": [72,209,204,1],\n  \"mediumvioletred\": [199,21,133,1], \"midnightblue\": [25,25,112,1],\n  \"mintcream\": [245,255,250,1], \"mistyrose\": [255,228,225,1],\n  \"moccasin\": [255,228,181,1], \"navajowhite\": [255,222,173,1],\n  \"navy\": [0,0,128,1], \"oldlace\": [253,245,230,1],\n  \"olive\": [128,128,0,1], \"olivedrab\": [107,142,35,1],\n  \"orange\": [255,165,0,1], \"orangered\": [255,69,0,1],\n  \"orchid\": [218,112,214,1], \"palegoldenrod\": [238,232,170,1],\n  \"palegreen\": [152,251,152,1], \"paleturquoise\": [175,238,238,1],\n  \"palevioletred\": [219,112,147,1], \"papayawhip\": [255,239,213,1],\n  \"peachpuff\": [255,218,185,1], \"peru\": [205,133,63,1],\n  \"pink\": [255,192,203,1], \"plum\": [221,160,221,1],\n  \"powderblue\": [176,224,230,1], \"purple\": [128,0,128,1],\n  \"rebeccapurple\": [102,51,153,1],\n  \"red\": [255,0,0,1], \"rosybrown\": [188,143,143,1],\n  \"royalblue\": [65,105,225,1], \"saddlebrown\": [139,69,19,1],\n  \"salmon\": [250,128,114,1], \"sandybrown\": [244,164,96,1],\n  \"seagreen\": [46,139,87,1], \"seashell\": [255,245,238,1],\n  \"sienna\": [160,82,45,1], \"silver\": [192,192,192,1],\n  \"skyblue\": [135,206,235,1], \"slateblue\": [106,90,205,1],\n  \"slategray\": [112,128,144,1], \"slategrey\": [112,128,144,1],\n  \"snow\": [255,250,250,1], \"springgreen\": [0,255,127,1],\n  \"steelblue\": [70,130,180,1], \"tan\": [210,180,140,1],\n  \"teal\": [0,128,128,1], \"thistle\": [216,191,216,1],\n  \"tomato\": [255,99,71,1], \"turquoise\": [64,224,208,1],\n  \"violet\": [238,130,238,1], \"wheat\": [245,222,179,1],\n  \"white\": [255,255,255,1], \"whitesmoke\": [245,245,245,1],\n  \"yellow\": [255,255,0,1], \"yellowgreen\": [154,205,50,1]}\n\nfunction clamp_css_byte(i) {  // Clamp to integer 0 .. 255.\n  i = Math.round(i);  // Seems to be what Chrome does (vs truncation).\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clamp_css_float(f) {  // Clamp to float 0.0 .. 1.0.\n  return f < 0 ? 0 : f > 1 ? 1 : f;\n}\n\nfunction parse_css_int(str) {  // int or percentage.\n  if (str[str.length - 1] === '%')\n    return clamp_css_byte(parseFloat(str) / 100 * 255);\n  return clamp_css_byte(parseInt(str));\n}\n\nfunction parse_css_float(str) {  // float or percentage.\n  if (str[str.length - 1] === '%')\n    return clamp_css_float(parseFloat(str) / 100);\n  return clamp_css_float(parseFloat(str));\n}\n\nfunction css_hue_to_rgb(m1, m2, h) {\n  if (h < 0) h += 1;\n  else if (h > 1) h -= 1;\n\n  if (h * 6 < 1) return m1 + (m2 - m1) * h * 6;\n  if (h * 2 < 1) return m2;\n  if (h * 3 < 2) return m1 + (m2 - m1) * (2/3 - h) * 6;\n  return m1;\n}\n\nfunction parseCSSColor(css_str) {\n  // Remove all whitespace, not compliant, but should just be more accepting.\n  var str = css_str.replace(/ /g, '').toLowerCase();\n\n  // Color keywords (and transparent) lookup.\n  if (str in kCSSColorTable) return kCSSColorTable[str].slice();  // dup.\n\n  // #abc and #abc123 syntax.\n  if (str[0] === '#') {\n    if (str.length === 4) {\n      var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n      if (!(iv >= 0 && iv <= 0xfff)) return null;  // Covers NaN.\n      return [((iv & 0xf00) >> 4) | ((iv & 0xf00) >> 8),\n              (iv & 0xf0) | ((iv & 0xf0) >> 4),\n              (iv & 0xf) | ((iv & 0xf) << 4),\n              1];\n    } else if (str.length === 7) {\n      var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n      if (!(iv >= 0 && iv <= 0xffffff)) return null;  // Covers NaN.\n      return [(iv & 0xff0000) >> 16,\n              (iv & 0xff00) >> 8,\n              iv & 0xff,\n              1];\n    }\n\n    return null;\n  }\n\n  var op = str.indexOf('('), ep = str.indexOf(')');\n  if (op !== -1 && ep + 1 === str.length) {\n    var fname = str.substr(0, op);\n    var params = str.substr(op+1, ep-(op+1)).split(',');\n    var alpha = 1;  // To allow case fallthrough.\n    switch (fname) {\n      case 'rgba':\n        if (params.length !== 4) return null;\n        alpha = parse_css_float(params.pop());\n        // Fall through.\n      case 'rgb':\n        if (params.length !== 3) return null;\n        return [parse_css_int(params[0]),\n                parse_css_int(params[1]),\n                parse_css_int(params[2]),\n                alpha];\n      case 'hsla':\n        if (params.length !== 4) return null;\n        alpha = parse_css_float(params.pop());\n        // Fall through.\n      case 'hsl':\n        if (params.length !== 3) return null;\n        var h = (((parseFloat(params[0]) % 360) + 360) % 360) / 360;  // 0 .. 1\n        // NOTE(deanm): According to the CSS spec s/l should only be\n        // percentages, but we don't bother and let float or percentage.\n        var s = parse_css_float(params[1]);\n        var l = parse_css_float(params[2]);\n        var m2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\n        var m1 = l * 2 - m2;\n        return [clamp_css_byte(css_hue_to_rgb(m1, m2, h+1/3) * 255),\n                clamp_css_byte(css_hue_to_rgb(m1, m2, h) * 255),\n                clamp_css_byte(css_hue_to_rgb(m1, m2, h-1/3) * 255),\n                alpha];\n      default:\n        return null;\n    }\n  }\n\n  return null;\n}\n\ntry { exports.parseCSSColor = parseCSSColor } catch(e) { }\n","'use strict';\n\nmodule.exports = earcut;\nmodule.exports.default = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 1 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim);\n            triangles.push(ear.i / dim);\n            triangles.push(next.i / dim);\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var p = ear.next.next;\n\n    while (p !== ear.prev) {\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // triangle bbox; min & max are calculated like this for speed\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(minTX, minTY, minX, minY, invSize),\n        maxZ = zOrder(maxTX, maxTY, minX, minY, invSize);\n\n    var p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim);\n            triangles.push(p.i / dim);\n            triangles.push(b.i / dim);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize);\n                earcutLinked(c, triangles, dim, minX, minY, invSize);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        eliminateHole(queue[i], outerNode);\n        outerNode = filterPoints(outerNode, outerNode.next);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    outerNode = findHoleBridge(hole, outerNode);\n    if (outerNode) {\n        var b = splitPolygon(outerNode, hole);\n\n        // filter collinear points around the cuts\n        filterPoints(outerNode, outerNode.next);\n        filterPoints(b, b.next);\n    }\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                if (x === hx) {\n                    if (hy === p.y) return p;\n                    if (hy === p.next.y) return p.next;\n                }\n                m = p.x < p.next.x ? p : p.next;\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    if (hx === qx) return m; // hole touches outer segment; pick leftmost endpoint\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    var p = start;\n    do {\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = 32767 * (x - minX) * invSize;\n    y = 32767 * (y - minY) * invSize;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // dones't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    var o1 = sign(area(p1, q1, p2));\n    var o2 = sign(area(p1, q1, q2));\n    var o3 = sign(area(p2, q2, p1));\n    var o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertex index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertex nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = null;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n","\nimport createFeature from './feature';\n\n/* clip features between two axis-parallel lines:\n *     |        |\n *  ___|___     |     /\n * /   |   \\____|____/\n *     |        |\n */\n\nexport default function clip(features, scale, k1, k2, axis, minAll, maxAll, options) {\n\n    k1 /= scale;\n    k2 /= scale;\n\n    if (minAll >= k1 && maxAll < k2) return features; // trivial accept\n    else if (maxAll < k1 || minAll >= k2) return null; // trivial reject\n\n    var clipped = [];\n\n    for (var i = 0; i < features.length; i++) {\n\n        var feature = features[i];\n        var geometry = feature.geometry;\n        var type = feature.type;\n\n        var min = axis === 0 ? feature.minX : feature.minY;\n        var max = axis === 0 ? feature.maxX : feature.maxY;\n\n        if (min >= k1 && max < k2) { // trivial accept\n            clipped.push(feature);\n            continue;\n        } else if (max < k1 || min >= k2) { // trivial reject\n            continue;\n        }\n\n        var newGeometry = [];\n\n        if (type === 'Point' || type === 'MultiPoint') {\n            clipPoints(geometry, newGeometry, k1, k2, axis);\n\n        } else if (type === 'LineString') {\n            clipLine(geometry, newGeometry, k1, k2, axis, false, options.lineMetrics);\n\n        } else if (type === 'MultiLineString') {\n            clipLines(geometry, newGeometry, k1, k2, axis, false);\n\n        } else if (type === 'Polygon') {\n            clipLines(geometry, newGeometry, k1, k2, axis, true);\n\n        } else if (type === 'MultiPolygon') {\n            for (var j = 0; j < geometry.length; j++) {\n                var polygon = [];\n                clipLines(geometry[j], polygon, k1, k2, axis, true);\n                if (polygon.length) {\n                    newGeometry.push(polygon);\n                }\n            }\n        }\n\n        if (newGeometry.length) {\n            if (options.lineMetrics && type === 'LineString') {\n                for (j = 0; j < newGeometry.length; j++) {\n                    clipped.push(createFeature(feature.id, type, newGeometry[j], feature.tags));\n                }\n                continue;\n            }\n\n            if (type === 'LineString' || type === 'MultiLineString') {\n                if (newGeometry.length === 1) {\n                    type = 'LineString';\n                    newGeometry = newGeometry[0];\n                } else {\n                    type = 'MultiLineString';\n                }\n            }\n            if (type === 'Point' || type === 'MultiPoint') {\n                type = newGeometry.length === 3 ? 'Point' : 'MultiPoint';\n            }\n\n            clipped.push(createFeature(feature.id, type, newGeometry, feature.tags));\n        }\n    }\n\n    return clipped.length ? clipped : null;\n}\n\nfunction clipPoints(geom, newGeom, k1, k2, axis) {\n    for (var i = 0; i < geom.length; i += 3) {\n        var a = geom[i + axis];\n\n        if (a >= k1 && a <= k2) {\n            newGeom.push(geom[i]);\n            newGeom.push(geom[i + 1]);\n            newGeom.push(geom[i + 2]);\n        }\n    }\n}\n\nfunction clipLine(geom, newGeom, k1, k2, axis, isPolygon, trackMetrics) {\n\n    var slice = newSlice(geom);\n    var intersect = axis === 0 ? intersectX : intersectY;\n    var len = geom.start;\n    var segLen, t;\n\n    for (var i = 0; i < geom.length - 3; i += 3) {\n        var ax = geom[i];\n        var ay = geom[i + 1];\n        var az = geom[i + 2];\n        var bx = geom[i + 3];\n        var by = geom[i + 4];\n        var a = axis === 0 ? ax : ay;\n        var b = axis === 0 ? bx : by;\n        var exited = false;\n\n        if (trackMetrics) segLen = Math.sqrt(Math.pow(ax - bx, 2) + Math.pow(ay - by, 2));\n\n        if (a < k1) {\n            // ---|-->  | (line enters the clip region from the left)\n            if (b > k1) {\n                t = intersect(slice, ax, ay, bx, by, k1);\n                if (trackMetrics) slice.start = len + segLen * t;\n            }\n        } else if (a > k2) {\n            // |  <--|--- (line enters the clip region from the right)\n            if (b < k2) {\n                t = intersect(slice, ax, ay, bx, by, k2);\n                if (trackMetrics) slice.start = len + segLen * t;\n            }\n        } else {\n            addPoint(slice, ax, ay, az);\n        }\n        if (b < k1 && a >= k1) {\n            // <--|---  | or <--|-----|--- (line exits the clip region on the left)\n            t = intersect(slice, ax, ay, bx, by, k1);\n            exited = true;\n        }\n        if (b > k2 && a <= k2) {\n            // |  ---|--> or ---|-----|--> (line exits the clip region on the right)\n            t = intersect(slice, ax, ay, bx, by, k2);\n            exited = true;\n        }\n\n        if (!isPolygon && exited) {\n            if (trackMetrics) slice.end = len + segLen * t;\n            newGeom.push(slice);\n            slice = newSlice(geom);\n        }\n\n        if (trackMetrics) len += segLen;\n    }\n\n    // add the last point\n    var last = geom.length - 3;\n    ax = geom[last];\n    ay = geom[last + 1];\n    az = geom[last + 2];\n    a = axis === 0 ? ax : ay;\n    if (a >= k1 && a <= k2) addPoint(slice, ax, ay, az);\n\n    // close the polygon if its endpoints are not the same after clipping\n    last = slice.length - 3;\n    if (isPolygon && last >= 3 && (slice[last] !== slice[0] || slice[last + 1] !== slice[1])) {\n        addPoint(slice, slice[0], slice[1], slice[2]);\n    }\n\n    // add the final slice\n    if (slice.length) {\n        newGeom.push(slice);\n    }\n}\n\nfunction newSlice(line) {\n    var slice = [];\n    slice.size = line.size;\n    slice.start = line.start;\n    slice.end = line.end;\n    return slice;\n}\n\nfunction clipLines(geom, newGeom, k1, k2, axis, isPolygon) {\n    for (var i = 0; i < geom.length; i++) {\n        clipLine(geom[i], newGeom, k1, k2, axis, isPolygon, false);\n    }\n}\n\nfunction addPoint(out, x, y, z) {\n    out.push(x);\n    out.push(y);\n    out.push(z);\n}\n\nfunction intersectX(out, ax, ay, bx, by, x) {\n    var t = (x - ax) / (bx - ax);\n    out.push(x);\n    out.push(ay + (by - ay) * t);\n    out.push(1);\n    return t;\n}\n\nfunction intersectY(out, ax, ay, bx, by, y) {\n    var t = (y - ay) / (by - ay);\n    out.push(ax + (bx - ax) * t);\n    out.push(y);\n    out.push(1);\n    return t;\n}\n","\nimport simplify from './simplify';\nimport createFeature from './feature';\n\n// converts GeoJSON feature into an intermediate projected JSON vector format with simplification data\n\nexport default function convert(data, options) {\n    var features = [];\n    if (data.type === 'FeatureCollection') {\n        for (var i = 0; i < data.features.length; i++) {\n            convertFeature(features, data.features[i], options, i);\n        }\n\n    } else if (data.type === 'Feature') {\n        convertFeature(features, data, options);\n\n    } else {\n        // single geometry or a geometry collection\n        convertFeature(features, {geometry: data}, options);\n    }\n\n    return features;\n}\n\nfunction convertFeature(features, geojson, options, index) {\n    if (!geojson.geometry) return;\n\n    var coords = geojson.geometry.coordinates;\n    var type = geojson.geometry.type;\n    var tolerance = Math.pow(options.tolerance / ((1 << options.maxZoom) * options.extent), 2);\n    var geometry = [];\n    var id = geojson.id;\n    if (options.promoteId) {\n        id = geojson.properties[options.promoteId];\n    } else if (options.generateId) {\n        id = index || 0;\n    }\n    if (type === 'Point') {\n        convertPoint(coords, geometry);\n\n    } else if (type === 'MultiPoint') {\n        for (var i = 0; i < coords.length; i++) {\n            convertPoint(coords[i], geometry);\n        }\n\n    } else if (type === 'LineString') {\n        convertLine(coords, geometry, tolerance, false);\n\n    } else if (type === 'MultiLineString') {\n        if (options.lineMetrics) {\n            // explode into linestrings to be able to track metrics\n            for (i = 0; i < coords.length; i++) {\n                geometry = [];\n                convertLine(coords[i], geometry, tolerance, false);\n                features.push(createFeature(id, 'LineString', geometry, geojson.properties));\n            }\n            return;\n        } else {\n            convertLines(coords, geometry, tolerance, false);\n        }\n\n    } else if (type === 'Polygon') {\n        convertLines(coords, geometry, tolerance, true);\n\n    } else if (type === 'MultiPolygon') {\n        for (i = 0; i < coords.length; i++) {\n            var polygon = [];\n            convertLines(coords[i], polygon, tolerance, true);\n            geometry.push(polygon);\n        }\n    } else if (type === 'GeometryCollection') {\n        for (i = 0; i < geojson.geometry.geometries.length; i++) {\n            convertFeature(features, {\n                id: id,\n                geometry: geojson.geometry.geometries[i],\n                properties: geojson.properties\n            }, options, index);\n        }\n        return;\n    } else {\n        throw new Error('Input data is not a valid GeoJSON object.');\n    }\n\n    features.push(createFeature(id, type, geometry, geojson.properties));\n}\n\nfunction convertPoint(coords, out) {\n    out.push(projectX(coords[0]));\n    out.push(projectY(coords[1]));\n    out.push(0);\n}\n\nfunction convertLine(ring, out, tolerance, isPolygon) {\n    var x0, y0;\n    var size = 0;\n\n    for (var j = 0; j < ring.length; j++) {\n        var x = projectX(ring[j][0]);\n        var y = projectY(ring[j][1]);\n\n        out.push(x);\n        out.push(y);\n        out.push(0);\n\n        if (j > 0) {\n            if (isPolygon) {\n                size += (x0 * y - x * y0) / 2; // area\n            } else {\n                size += Math.sqrt(Math.pow(x - x0, 2) + Math.pow(y - y0, 2)); // length\n            }\n        }\n        x0 = x;\n        y0 = y;\n    }\n\n    var last = out.length - 3;\n    out[2] = 1;\n    simplify(out, 0, last, tolerance);\n    out[last + 2] = 1;\n\n    out.size = Math.abs(size);\n    out.start = 0;\n    out.end = out.size;\n}\n\nfunction convertLines(rings, out, tolerance, isPolygon) {\n    for (var i = 0; i < rings.length; i++) {\n        var geom = [];\n        convertLine(rings[i], geom, tolerance, isPolygon);\n        out.push(geom);\n    }\n}\n\nfunction projectX(x) {\n    return x / 360 + 0.5;\n}\n\nfunction projectY(y) {\n    var sin = Math.sin(y * Math.PI / 180);\n    var y2 = 0.5 - 0.25 * Math.log((1 + sin) / (1 - sin)) / Math.PI;\n    return y2 < 0 ? 0 : y2 > 1 ? 1 : y2;\n}\n","\nexport default function createFeature(id, type, geom, tags) {\n    var feature = {\n        id: typeof id === 'undefined' ? null : id,\n        type: type,\n        geometry: geom,\n        tags: tags,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n    calcBBox(feature);\n    return feature;\n}\n\nfunction calcBBox(feature) {\n    var geom = feature.geometry;\n    var type = feature.type;\n\n    if (type === 'Point' || type === 'MultiPoint' || type === 'LineString') {\n        calcLineBBox(feature, geom);\n\n    } else if (type === 'Polygon' || type === 'MultiLineString') {\n        for (var i = 0; i < geom.length; i++) {\n            calcLineBBox(feature, geom[i]);\n        }\n\n    } else if (type === 'MultiPolygon') {\n        for (i = 0; i < geom.length; i++) {\n            for (var j = 0; j < geom[i].length; j++) {\n                calcLineBBox(feature, geom[i][j]);\n            }\n        }\n    }\n}\n\nfunction calcLineBBox(feature, geom) {\n    for (var i = 0; i < geom.length; i += 3) {\n        feature.minX = Math.min(feature.minX, geom[i]);\n        feature.minY = Math.min(feature.minY, geom[i + 1]);\n        feature.maxX = Math.max(feature.maxX, geom[i]);\n        feature.maxY = Math.max(feature.maxY, geom[i + 1]);\n    }\n}\n","\nimport convert from './convert';     // GeoJSON conversion and preprocessing\nimport clip from './clip';           // stripe clipping algorithm\nimport wrap from './wrap';           // date line processing\nimport transform from './transform'; // coordinate transformation\nimport createTile from './tile';     // final simplified tile generation\n\nexport default function geojsonvt(data, options) {\n    return new GeoJSONVT(data, options);\n}\n\nfunction GeoJSONVT(data, options) {\n    options = this.options = extend(Object.create(this.options), options);\n\n    var debug = options.debug;\n\n    if (debug) console.time('preprocess data');\n\n    if (options.maxZoom < 0 || options.maxZoom > 24) throw new Error('maxZoom should be in the 0-24 range');\n    if (options.promoteId && options.generateId) throw new Error('promoteId and generateId cannot be used together.');\n\n    var features = convert(data, options);\n\n    this.tiles = {};\n    this.tileCoords = [];\n\n    if (debug) {\n        console.timeEnd('preprocess data');\n        console.log('index: maxZoom: %d, maxPoints: %d', options.indexMaxZoom, options.indexMaxPoints);\n        console.time('generate tiles');\n        this.stats = {};\n        this.total = 0;\n    }\n\n    features = wrap(features, options);\n\n    // start slicing from the top tile down\n    if (features.length) this.splitTile(features, 0, 0, 0);\n\n    if (debug) {\n        if (features.length) console.log('features: %d, points: %d', this.tiles[0].numFeatures, this.tiles[0].numPoints);\n        console.timeEnd('generate tiles');\n        console.log('tiles generated:', this.total, JSON.stringify(this.stats));\n    }\n}\n\nGeoJSONVT.prototype.options = {\n    maxZoom: 14,            // max zoom to preserve detail on\n    indexMaxZoom: 5,        // max zoom in the tile index\n    indexMaxPoints: 100000, // max number of points per tile in the tile index\n    tolerance: 3,           // simplification tolerance (higher means simpler)\n    extent: 4096,           // tile extent\n    buffer: 64,             // tile buffer on each side\n    lineMetrics: false,     // whether to calculate line metrics\n    promoteId: null,        // name of a feature property to be promoted to feature.id\n    generateId: false,      // whether to generate feature ids. Cannot be used with promoteId\n    debug: 0                // logging level (0, 1 or 2)\n};\n\nGeoJSONVT.prototype.splitTile = function (features, z, x, y, cz, cx, cy) {\n\n    var stack = [features, z, x, y],\n        options = this.options,\n        debug = options.debug;\n\n    // avoid recursion by using a processing queue\n    while (stack.length) {\n        y = stack.pop();\n        x = stack.pop();\n        z = stack.pop();\n        features = stack.pop();\n\n        var z2 = 1 << z,\n            id = toID(z, x, y),\n            tile = this.tiles[id];\n\n        if (!tile) {\n            if (debug > 1) console.time('creation');\n\n            tile = this.tiles[id] = createTile(features, z, x, y, options);\n            this.tileCoords.push({z: z, x: x, y: y});\n\n            if (debug) {\n                if (debug > 1) {\n                    console.log('tile z%d-%d-%d (features: %d, points: %d, simplified: %d)',\n                        z, x, y, tile.numFeatures, tile.numPoints, tile.numSimplified);\n                    console.timeEnd('creation');\n                }\n                var key = 'z' + z;\n                this.stats[key] = (this.stats[key] || 0) + 1;\n                this.total++;\n            }\n        }\n\n        // save reference to original geometry in tile so that we can drill down later if we stop now\n        tile.source = features;\n\n        // if it's the first-pass tiling\n        if (!cz) {\n            // stop tiling if we reached max zoom, or if the tile is too simple\n            if (z === options.indexMaxZoom || tile.numPoints <= options.indexMaxPoints) continue;\n\n        // if a drilldown to a specific tile\n        } else {\n            // stop tiling if we reached base zoom or our target tile zoom\n            if (z === options.maxZoom || z === cz) continue;\n\n            // stop tiling if it's not an ancestor of the target tile\n            var m = 1 << (cz - z);\n            if (x !== Math.floor(cx / m) || y !== Math.floor(cy / m)) continue;\n        }\n\n        // if we slice further down, no need to keep source geometry\n        tile.source = null;\n\n        if (features.length === 0) continue;\n\n        if (debug > 1) console.time('clipping');\n\n        // values we'll use for clipping\n        var k1 = 0.5 * options.buffer / options.extent,\n            k2 = 0.5 - k1,\n            k3 = 0.5 + k1,\n            k4 = 1 + k1,\n            tl, bl, tr, br, left, right;\n\n        tl = bl = tr = br = null;\n\n        left  = clip(features, z2, x - k1, x + k3, 0, tile.minX, tile.maxX, options);\n        right = clip(features, z2, x + k2, x + k4, 0, tile.minX, tile.maxX, options);\n        features = null;\n\n        if (left) {\n            tl = clip(left, z2, y - k1, y + k3, 1, tile.minY, tile.maxY, options);\n            bl = clip(left, z2, y + k2, y + k4, 1, tile.minY, tile.maxY, options);\n            left = null;\n        }\n\n        if (right) {\n            tr = clip(right, z2, y - k1, y + k3, 1, tile.minY, tile.maxY, options);\n            br = clip(right, z2, y + k2, y + k4, 1, tile.minY, tile.maxY, options);\n            right = null;\n        }\n\n        if (debug > 1) console.timeEnd('clipping');\n\n        stack.push(tl || [], z + 1, x * 2,     y * 2);\n        stack.push(bl || [], z + 1, x * 2,     y * 2 + 1);\n        stack.push(tr || [], z + 1, x * 2 + 1, y * 2);\n        stack.push(br || [], z + 1, x * 2 + 1, y * 2 + 1);\n    }\n};\n\nGeoJSONVT.prototype.getTile = function (z, x, y) {\n    var options = this.options,\n        extent = options.extent,\n        debug = options.debug;\n\n    if (z < 0 || z > 24) return null;\n\n    var z2 = 1 << z;\n    x = ((x % z2) + z2) % z2; // wrap tile x coordinate\n\n    var id = toID(z, x, y);\n    if (this.tiles[id]) return transform(this.tiles[id], extent);\n\n    if (debug > 1) console.log('drilling down to z%d-%d-%d', z, x, y);\n\n    var z0 = z,\n        x0 = x,\n        y0 = y,\n        parent;\n\n    while (!parent && z0 > 0) {\n        z0--;\n        x0 = Math.floor(x0 / 2);\n        y0 = Math.floor(y0 / 2);\n        parent = this.tiles[toID(z0, x0, y0)];\n    }\n\n    if (!parent || !parent.source) return null;\n\n    // if we found a parent tile containing the original geometry, we can drill down from it\n    if (debug > 1) console.log('found parent tile z%d-%d-%d', z0, x0, y0);\n\n    if (debug > 1) console.time('drilling down');\n    this.splitTile(parent.source, z0, x0, y0, z, x, y);\n    if (debug > 1) console.timeEnd('drilling down');\n\n    return this.tiles[id] ? transform(this.tiles[id], extent) : null;\n};\n\nfunction toID(z, x, y) {\n    return (((1 << z) * y + x) * 32) + z;\n}\n\nfunction extend(dest, src) {\n    for (var i in src) dest[i] = src[i];\n    return dest;\n}\n","\n// calculate simplification data using optimized Douglas-Peucker algorithm\n\nexport default function simplify(coords, first, last, sqTolerance) {\n    var maxSqDist = sqTolerance;\n    var mid = (last - first) >> 1;\n    var minPosToMid = last - first;\n    var index;\n\n    var ax = coords[first];\n    var ay = coords[first + 1];\n    var bx = coords[last];\n    var by = coords[last + 1];\n\n    for (var i = first + 3; i < last; i += 3) {\n        var d = getSqSegDist(coords[i], coords[i + 1], ax, ay, bx, by);\n\n        if (d > maxSqDist) {\n            index = i;\n            maxSqDist = d;\n\n        } else if (d === maxSqDist) {\n            // a workaround to ensure we choose a pivot close to the middle of the list,\n            // reducing recursion depth, for certain degenerate inputs\n            // https://github.com/mapbox/geojson-vt/issues/104\n            var posToMid = Math.abs(i - mid);\n            if (posToMid < minPosToMid) {\n                index = i;\n                minPosToMid = posToMid;\n            }\n        }\n    }\n\n    if (maxSqDist > sqTolerance) {\n        if (index - first > 3) simplify(coords, first, index, sqTolerance);\n        coords[index + 2] = maxSqDist;\n        if (last - index > 3) simplify(coords, index, last, sqTolerance);\n    }\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(px, py, x, y, bx, by) {\n\n    var dx = bx - x;\n    var dy = by - y;\n\n    if (dx !== 0 || dy !== 0) {\n\n        var t = ((px - x) * dx + (py - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n            x = bx;\n            y = by;\n\n        } else if (t > 0) {\n            x += dx * t;\n            y += dy * t;\n        }\n    }\n\n    dx = px - x;\n    dy = py - y;\n\n    return dx * dx + dy * dy;\n}\n","\nexport default function createTile(features, z, tx, ty, options) {\n    var tolerance = z === options.maxZoom ? 0 : options.tolerance / ((1 << z) * options.extent);\n    var tile = {\n        features: [],\n        numPoints: 0,\n        numSimplified: 0,\n        numFeatures: 0,\n        source: null,\n        x: tx,\n        y: ty,\n        z: z,\n        transformed: false,\n        minX: 2,\n        minY: 1,\n        maxX: -1,\n        maxY: 0\n    };\n    for (var i = 0; i < features.length; i++) {\n        tile.numFeatures++;\n        addFeature(tile, features[i], tolerance, options);\n\n        var minX = features[i].minX;\n        var minY = features[i].minY;\n        var maxX = features[i].maxX;\n        var maxY = features[i].maxY;\n\n        if (minX < tile.minX) tile.minX = minX;\n        if (minY < tile.minY) tile.minY = minY;\n        if (maxX > tile.maxX) tile.maxX = maxX;\n        if (maxY > tile.maxY) tile.maxY = maxY;\n    }\n    return tile;\n}\n\nfunction addFeature(tile, feature, tolerance, options) {\n\n    var geom = feature.geometry,\n        type = feature.type,\n        simplified = [];\n\n    if (type === 'Point' || type === 'MultiPoint') {\n        for (var i = 0; i < geom.length; i += 3) {\n            simplified.push(geom[i]);\n            simplified.push(geom[i + 1]);\n            tile.numPoints++;\n            tile.numSimplified++;\n        }\n\n    } else if (type === 'LineString') {\n        addLine(simplified, geom, tile, tolerance, false, false);\n\n    } else if (type === 'MultiLineString' || type === 'Polygon') {\n        for (i = 0; i < geom.length; i++) {\n            addLine(simplified, geom[i], tile, tolerance, type === 'Polygon', i === 0);\n        }\n\n    } else if (type === 'MultiPolygon') {\n\n        for (var k = 0; k < geom.length; k++) {\n            var polygon = geom[k];\n            for (i = 0; i < polygon.length; i++) {\n                addLine(simplified, polygon[i], tile, tolerance, true, i === 0);\n            }\n        }\n    }\n\n    if (simplified.length) {\n        var tags = feature.tags || null;\n        if (type === 'LineString' && options.lineMetrics) {\n            tags = {};\n            for (var key in feature.tags) tags[key] = feature.tags[key];\n            tags['mapbox_clip_start'] = geom.start / geom.size;\n            tags['mapbox_clip_end'] = geom.end / geom.size;\n        }\n        var tileFeature = {\n            geometry: simplified,\n            type: type === 'Polygon' || type === 'MultiPolygon' ? 3 :\n                type === 'LineString' || type === 'MultiLineString' ? 2 : 1,\n            tags: tags\n        };\n        if (feature.id !== null) {\n            tileFeature.id = feature.id;\n        }\n        tile.features.push(tileFeature);\n    }\n}\n\nfunction addLine(result, geom, tile, tolerance, isPolygon, isOuter) {\n    var sqTolerance = tolerance * tolerance;\n\n    if (tolerance > 0 && (geom.size < (isPolygon ? sqTolerance : tolerance))) {\n        tile.numPoints += geom.length / 3;\n        return;\n    }\n\n    var ring = [];\n\n    for (var i = 0; i < geom.length; i += 3) {\n        if (tolerance === 0 || geom[i + 2] > sqTolerance) {\n            tile.numSimplified++;\n            ring.push(geom[i]);\n            ring.push(geom[i + 1]);\n        }\n        tile.numPoints++;\n    }\n\n    if (isPolygon) rewind(ring, isOuter);\n\n    result.push(ring);\n}\n\nfunction rewind(ring, clockwise) {\n    var area = 0;\n    for (var i = 0, len = ring.length, j = len - 2; i < len; j = i, i += 2) {\n        area += (ring[i] - ring[j]) * (ring[i + 1] + ring[j + 1]);\n    }\n    if (area > 0 === clockwise) {\n        for (i = 0, len = ring.length; i < len / 2; i += 2) {\n            var x = ring[i];\n            var y = ring[i + 1];\n            ring[i] = ring[len - 2 - i];\n            ring[i + 1] = ring[len - 1 - i];\n            ring[len - 2 - i] = x;\n            ring[len - 1 - i] = y;\n        }\n    }\n}\n","\n// Transforms the coordinates of each feature in the given tile from\n// mercator-projected space into (extent x extent) tile space.\nexport default function transformTile(tile, extent) {\n    if (tile.transformed) return tile;\n\n    var z2 = 1 << tile.z,\n        tx = tile.x,\n        ty = tile.y,\n        i, j, k;\n\n    for (i = 0; i < tile.features.length; i++) {\n        var feature = tile.features[i],\n            geom = feature.geometry,\n            type = feature.type;\n\n        feature.geometry = [];\n\n        if (type === 1) {\n            for (j = 0; j < geom.length; j += 2) {\n                feature.geometry.push(transformPoint(geom[j], geom[j + 1], extent, z2, tx, ty));\n            }\n        } else {\n            for (j = 0; j < geom.length; j++) {\n                var ring = [];\n                for (k = 0; k < geom[j].length; k += 2) {\n                    ring.push(transformPoint(geom[j][k], geom[j][k + 1], extent, z2, tx, ty));\n                }\n                feature.geometry.push(ring);\n            }\n        }\n    }\n\n    tile.transformed = true;\n\n    return tile;\n}\n\nfunction transformPoint(x, y, extent, z2, tx, ty) {\n    return [\n        Math.round(extent * (x * z2 - tx)),\n        Math.round(extent * (y * z2 - ty))];\n}\n","\nimport clip from './clip';\nimport createFeature from './feature';\n\nexport default function wrap(features, options) {\n    var buffer = options.buffer / options.extent;\n    var merged = features;\n    var left  = clip(features, 1, -1 - buffer, buffer,     0, -1, 2, options); // left world copy\n    var right = clip(features, 1,  1 - buffer, 2 + buffer, 0, -1, 2, options); // right world copy\n\n    if (left || right) {\n        merged = clip(features, 1, -buffer, 1 + buffer, 0, -1, 2, options) || []; // center world copy\n\n        if (left) merged = shiftFeatureCoords(left, 1).concat(merged); // merge left into center\n        if (right) merged = merged.concat(shiftFeatureCoords(right, -1)); // merge right into center\n    }\n\n    return merged;\n}\n\nfunction shiftFeatureCoords(features, offset) {\n    var newFeatures = [];\n\n    for (var i = 0; i < features.length; i++) {\n        var feature = features[i],\n            type = feature.type;\n\n        var newGeometry;\n\n        if (type === 'Point' || type === 'MultiPoint' || type === 'LineString') {\n            newGeometry = shiftCoords(feature.geometry, offset);\n\n        } else if (type === 'MultiLineString' || type === 'Polygon') {\n            newGeometry = [];\n            for (var j = 0; j < feature.geometry.length; j++) {\n                newGeometry.push(shiftCoords(feature.geometry[j], offset));\n            }\n        } else if (type === 'MultiPolygon') {\n            newGeometry = [];\n            for (j = 0; j < feature.geometry.length; j++) {\n                var newPolygon = [];\n                for (var k = 0; k < feature.geometry[j].length; k++) {\n                    newPolygon.push(shiftCoords(feature.geometry[j][k], offset));\n                }\n                newGeometry.push(newPolygon);\n            }\n        }\n\n        newFeatures.push(createFeature(feature.id, type, newGeometry, feature.tags));\n    }\n\n    return newFeatures;\n}\n\nfunction shiftCoords(points, offset) {\n    var newPoints = [];\n    newPoints.size = points.size;\n\n    if (points.start !== undefined) {\n        newPoints.start = points.start;\n        newPoints.end = points.end;\n    }\n\n    for (var i = 0; i < points.length; i += 3) {\n        newPoints.push(points[i] + offset, points[i + 1], points[i + 2]);\n    }\n    return newPoints;\n}\n","module.exports = Long;\r\n\r\n/**\r\n * wasm optimizations, to do native i64 multiplication and divide\r\n */\r\nvar wasm = null;\r\n\r\ntry {\r\n  wasm = new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([\r\n    0, 97, 115, 109, 1, 0, 0, 0, 1, 13, 2, 96, 0, 1, 127, 96, 4, 127, 127, 127, 127, 1, 127, 3, 7, 6, 0, 1, 1, 1, 1, 1, 6, 6, 1, 127, 1, 65, 0, 11, 7, 50, 6, 3, 109, 117, 108, 0, 1, 5, 100, 105, 118, 95, 115, 0, 2, 5, 100, 105, 118, 95, 117, 0, 3, 5, 114, 101, 109, 95, 115, 0, 4, 5, 114, 101, 109, 95, 117, 0, 5, 8, 103, 101, 116, 95, 104, 105, 103, 104, 0, 0, 10, 191, 1, 6, 4, 0, 35, 0, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 126, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 127, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 128, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 129, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11, 36, 1, 1, 126, 32, 0, 173, 32, 1, 173, 66, 32, 134, 132, 32, 2, 173, 32, 3, 173, 66, 32, 134, 132, 130, 34, 4, 66, 32, 135, 167, 36, 0, 32, 4, 167, 11\r\n  ])), {}).exports;\r\n} catch (e) {\r\n  // no wasm support :(\r\n}\r\n\r\n/**\r\n * Constructs a 64 bit two's-complement integer, given its low and high 32 bit values as *signed* integers.\r\n *  See the from* functions below for more convenient ways of constructing Longs.\r\n * @exports Long\r\n * @class A Long class for representing a 64 bit two's-complement integer value.\r\n * @param {number} low The low (signed) 32 bits of the long\r\n * @param {number} high The high (signed) 32 bits of the long\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @constructor\r\n */\r\nfunction Long(low, high, unsigned) {\r\n\r\n    /**\r\n     * The low 32 bits as a signed value.\r\n     * @type {number}\r\n     */\r\n    this.low = low | 0;\r\n\r\n    /**\r\n     * The high 32 bits as a signed value.\r\n     * @type {number}\r\n     */\r\n    this.high = high | 0;\r\n\r\n    /**\r\n     * Whether unsigned or not.\r\n     * @type {boolean}\r\n     */\r\n    this.unsigned = !!unsigned;\r\n}\r\n\r\n// The internal representation of a long is the two given signed, 32-bit values.\r\n// We use 32-bit pieces because these are the size of integers on which\r\n// Javascript performs bit-operations.  For operations like addition and\r\n// multiplication, we split each number into 16 bit pieces, which can easily be\r\n// multiplied within Javascript's floating-point representation without overflow\r\n// or change in sign.\r\n//\r\n// In the algorithms below, we frequently reduce the negative case to the\r\n// positive case by negating the input(s) and then post-processing the result.\r\n// Note that we must ALWAYS check specially whether those values are MIN_VALUE\r\n// (-2^63) because -MIN_VALUE == MIN_VALUE (since 2^63 cannot be represented as\r\n// a positive number, it overflows back into a negative).  Not handling this\r\n// case would often result in infinite recursion.\r\n//\r\n// Common constant values ZERO, ONE, NEG_ONE, etc. are defined below the from*\r\n// methods on which they depend.\r\n\r\n/**\r\n * An indicator used to reliably determine if an object is a Long or not.\r\n * @type {boolean}\r\n * @const\r\n * @private\r\n */\r\nLong.prototype.__isLong__;\r\n\r\nObject.defineProperty(Long.prototype, \"__isLong__\", { value: true });\r\n\r\n/**\r\n * @function\r\n * @param {*} obj Object\r\n * @returns {boolean}\r\n * @inner\r\n */\r\nfunction isLong(obj) {\r\n    return (obj && obj[\"__isLong__\"]) === true;\r\n}\r\n\r\n/**\r\n * Tests if the specified object is a Long.\r\n * @function\r\n * @param {*} obj Object\r\n * @returns {boolean}\r\n */\r\nLong.isLong = isLong;\r\n\r\n/**\r\n * A cache of the Long representations of small integer values.\r\n * @type {!Object}\r\n * @inner\r\n */\r\nvar INT_CACHE = {};\r\n\r\n/**\r\n * A cache of the Long representations of small unsigned integer values.\r\n * @type {!Object}\r\n * @inner\r\n */\r\nvar UINT_CACHE = {};\r\n\r\n/**\r\n * @param {number} value\r\n * @param {boolean=} unsigned\r\n * @returns {!Long}\r\n * @inner\r\n */\r\nfunction fromInt(value, unsigned) {\r\n    var obj, cachedObj, cache;\r\n    if (unsigned) {\r\n        value >>>= 0;\r\n        if (cache = (0 <= value && value < 256)) {\r\n            cachedObj = UINT_CACHE[value];\r\n            if (cachedObj)\r\n                return cachedObj;\r\n        }\r\n        obj = fromBits(value, (value | 0) < 0 ? -1 : 0, true);\r\n        if (cache)\r\n            UINT_CACHE[value] = obj;\r\n        return obj;\r\n    } else {\r\n        value |= 0;\r\n        if (cache = (-128 <= value && value < 128)) {\r\n            cachedObj = INT_CACHE[value];\r\n            if (cachedObj)\r\n                return cachedObj;\r\n        }\r\n        obj = fromBits(value, value < 0 ? -1 : 0, false);\r\n        if (cache)\r\n            INT_CACHE[value] = obj;\r\n        return obj;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns a Long representing the given 32 bit integer value.\r\n * @function\r\n * @param {number} value The 32 bit integer in question\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @returns {!Long} The corresponding Long value\r\n */\r\nLong.fromInt = fromInt;\r\n\r\n/**\r\n * @param {number} value\r\n * @param {boolean=} unsigned\r\n * @returns {!Long}\r\n * @inner\r\n */\r\nfunction fromNumber(value, unsigned) {\r\n    if (isNaN(value))\r\n        return unsigned ? UZERO : ZERO;\r\n    if (unsigned) {\r\n        if (value < 0)\r\n            return UZERO;\r\n        if (value >= TWO_PWR_64_DBL)\r\n            return MAX_UNSIGNED_VALUE;\r\n    } else {\r\n        if (value <= -TWO_PWR_63_DBL)\r\n            return MIN_VALUE;\r\n        if (value + 1 >= TWO_PWR_63_DBL)\r\n            return MAX_VALUE;\r\n    }\r\n    if (value < 0)\r\n        return fromNumber(-value, unsigned).neg();\r\n    return fromBits((value % TWO_PWR_32_DBL) | 0, (value / TWO_PWR_32_DBL) | 0, unsigned);\r\n}\r\n\r\n/**\r\n * Returns a Long representing the given value, provided that it is a finite number. Otherwise, zero is returned.\r\n * @function\r\n * @param {number} value The number in question\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @returns {!Long} The corresponding Long value\r\n */\r\nLong.fromNumber = fromNumber;\r\n\r\n/**\r\n * @param {number} lowBits\r\n * @param {number} highBits\r\n * @param {boolean=} unsigned\r\n * @returns {!Long}\r\n * @inner\r\n */\r\nfunction fromBits(lowBits, highBits, unsigned) {\r\n    return new Long(lowBits, highBits, unsigned);\r\n}\r\n\r\n/**\r\n * Returns a Long representing the 64 bit integer that comes by concatenating the given low and high bits. Each is\r\n *  assumed to use 32 bits.\r\n * @function\r\n * @param {number} lowBits The low 32 bits\r\n * @param {number} highBits The high 32 bits\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @returns {!Long} The corresponding Long value\r\n */\r\nLong.fromBits = fromBits;\r\n\r\n/**\r\n * @function\r\n * @param {number} base\r\n * @param {number} exponent\r\n * @returns {number}\r\n * @inner\r\n */\r\nvar pow_dbl = Math.pow; // Used 4 times (4*8 to 15+4)\r\n\r\n/**\r\n * @param {string} str\r\n * @param {(boolean|number)=} unsigned\r\n * @param {number=} radix\r\n * @returns {!Long}\r\n * @inner\r\n */\r\nfunction fromString(str, unsigned, radix) {\r\n    if (str.length === 0)\r\n        throw Error('empty string');\r\n    if (str === \"NaN\" || str === \"Infinity\" || str === \"+Infinity\" || str === \"-Infinity\")\r\n        return ZERO;\r\n    if (typeof unsigned === 'number') {\r\n        // For goog.math.long compatibility\r\n        radix = unsigned,\r\n        unsigned = false;\r\n    } else {\r\n        unsigned = !! unsigned;\r\n    }\r\n    radix = radix || 10;\r\n    if (radix < 2 || 36 < radix)\r\n        throw RangeError('radix');\r\n\r\n    var p;\r\n    if ((p = str.indexOf('-')) > 0)\r\n        throw Error('interior hyphen');\r\n    else if (p === 0) {\r\n        return fromString(str.substring(1), unsigned, radix).neg();\r\n    }\r\n\r\n    // Do several (8) digits each time through the loop, so as to\r\n    // minimize the calls to the very expensive emulated div.\r\n    var radixToPower = fromNumber(pow_dbl(radix, 8));\r\n\r\n    var result = ZERO;\r\n    for (var i = 0; i < str.length; i += 8) {\r\n        var size = Math.min(8, str.length - i),\r\n            value = parseInt(str.substring(i, i + size), radix);\r\n        if (size < 8) {\r\n            var power = fromNumber(pow_dbl(radix, size));\r\n            result = result.mul(power).add(fromNumber(value));\r\n        } else {\r\n            result = result.mul(radixToPower);\r\n            result = result.add(fromNumber(value));\r\n        }\r\n    }\r\n    result.unsigned = unsigned;\r\n    return result;\r\n}\r\n\r\n/**\r\n * Returns a Long representation of the given string, written using the specified radix.\r\n * @function\r\n * @param {string} str The textual representation of the Long\r\n * @param {(boolean|number)=} unsigned Whether unsigned or not, defaults to signed\r\n * @param {number=} radix The radix in which the text is written (2-36), defaults to 10\r\n * @returns {!Long} The corresponding Long value\r\n */\r\nLong.fromString = fromString;\r\n\r\n/**\r\n * @function\r\n * @param {!Long|number|string|!{low: number, high: number, unsigned: boolean}} val\r\n * @param {boolean=} unsigned\r\n * @returns {!Long}\r\n * @inner\r\n */\r\nfunction fromValue(val, unsigned) {\r\n    if (typeof val === 'number')\r\n        return fromNumber(val, unsigned);\r\n    if (typeof val === 'string')\r\n        return fromString(val, unsigned);\r\n    // Throws for non-objects, converts non-instanceof Long:\r\n    return fromBits(val.low, val.high, typeof unsigned === 'boolean' ? unsigned : val.unsigned);\r\n}\r\n\r\n/**\r\n * Converts the specified value to a Long using the appropriate from* function for its type.\r\n * @function\r\n * @param {!Long|number|string|!{low: number, high: number, unsigned: boolean}} val Value\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @returns {!Long}\r\n */\r\nLong.fromValue = fromValue;\r\n\r\n// NOTE: the compiler should inline these constant values below and then remove these variables, so there should be\r\n// no runtime penalty for these.\r\n\r\n/**\r\n * @type {number}\r\n * @const\r\n * @inner\r\n */\r\nvar TWO_PWR_16_DBL = 1 << 16;\r\n\r\n/**\r\n * @type {number}\r\n * @const\r\n * @inner\r\n */\r\nvar TWO_PWR_24_DBL = 1 << 24;\r\n\r\n/**\r\n * @type {number}\r\n * @const\r\n * @inner\r\n */\r\nvar TWO_PWR_32_DBL = TWO_PWR_16_DBL * TWO_PWR_16_DBL;\r\n\r\n/**\r\n * @type {number}\r\n * @const\r\n * @inner\r\n */\r\nvar TWO_PWR_64_DBL = TWO_PWR_32_DBL * TWO_PWR_32_DBL;\r\n\r\n/**\r\n * @type {number}\r\n * @const\r\n * @inner\r\n */\r\nvar TWO_PWR_63_DBL = TWO_PWR_64_DBL / 2;\r\n\r\n/**\r\n * @type {!Long}\r\n * @const\r\n * @inner\r\n */\r\nvar TWO_PWR_24 = fromInt(TWO_PWR_24_DBL);\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar ZERO = fromInt(0);\r\n\r\n/**\r\n * Signed zero.\r\n * @type {!Long}\r\n */\r\nLong.ZERO = ZERO;\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar UZERO = fromInt(0, true);\r\n\r\n/**\r\n * Unsigned zero.\r\n * @type {!Long}\r\n */\r\nLong.UZERO = UZERO;\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar ONE = fromInt(1);\r\n\r\n/**\r\n * Signed one.\r\n * @type {!Long}\r\n */\r\nLong.ONE = ONE;\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar UONE = fromInt(1, true);\r\n\r\n/**\r\n * Unsigned one.\r\n * @type {!Long}\r\n */\r\nLong.UONE = UONE;\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar NEG_ONE = fromInt(-1);\r\n\r\n/**\r\n * Signed negative one.\r\n * @type {!Long}\r\n */\r\nLong.NEG_ONE = NEG_ONE;\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar MAX_VALUE = fromBits(0xFFFFFFFF|0, 0x7FFFFFFF|0, false);\r\n\r\n/**\r\n * Maximum signed value.\r\n * @type {!Long}\r\n */\r\nLong.MAX_VALUE = MAX_VALUE;\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar MAX_UNSIGNED_VALUE = fromBits(0xFFFFFFFF|0, 0xFFFFFFFF|0, true);\r\n\r\n/**\r\n * Maximum unsigned value.\r\n * @type {!Long}\r\n */\r\nLong.MAX_UNSIGNED_VALUE = MAX_UNSIGNED_VALUE;\r\n\r\n/**\r\n * @type {!Long}\r\n * @inner\r\n */\r\nvar MIN_VALUE = fromBits(0, 0x80000000|0, false);\r\n\r\n/**\r\n * Minimum signed value.\r\n * @type {!Long}\r\n */\r\nLong.MIN_VALUE = MIN_VALUE;\r\n\r\n/**\r\n * @alias Long.prototype\r\n * @inner\r\n */\r\nvar LongPrototype = Long.prototype;\r\n\r\n/**\r\n * Converts the Long to a 32 bit integer, assuming it is a 32 bit integer.\r\n * @returns {number}\r\n */\r\nLongPrototype.toInt = function toInt() {\r\n    return this.unsigned ? this.low >>> 0 : this.low;\r\n};\r\n\r\n/**\r\n * Converts the Long to a the nearest floating-point representation of this value (double, 53 bit mantissa).\r\n * @returns {number}\r\n */\r\nLongPrototype.toNumber = function toNumber() {\r\n    if (this.unsigned)\r\n        return ((this.high >>> 0) * TWO_PWR_32_DBL) + (this.low >>> 0);\r\n    return this.high * TWO_PWR_32_DBL + (this.low >>> 0);\r\n};\r\n\r\n/**\r\n * Converts the Long to a string written in the specified radix.\r\n * @param {number=} radix Radix (2-36), defaults to 10\r\n * @returns {string}\r\n * @override\r\n * @throws {RangeError} If `radix` is out of range\r\n */\r\nLongPrototype.toString = function toString(radix) {\r\n    radix = radix || 10;\r\n    if (radix < 2 || 36 < radix)\r\n        throw RangeError('radix');\r\n    if (this.isZero())\r\n        return '0';\r\n    if (this.isNegative()) { // Unsigned Longs are never negative\r\n        if (this.eq(MIN_VALUE)) {\r\n            // We need to change the Long value before it can be negated, so we remove\r\n            // the bottom-most digit in this base and then recurse to do the rest.\r\n            var radixLong = fromNumber(radix),\r\n                div = this.div(radixLong),\r\n                rem1 = div.mul(radixLong).sub(this);\r\n            return div.toString(radix) + rem1.toInt().toString(radix);\r\n        } else\r\n            return '-' + this.neg().toString(radix);\r\n    }\r\n\r\n    // Do several (6) digits each time through the loop, so as to\r\n    // minimize the calls to the very expensive emulated div.\r\n    var radixToPower = fromNumber(pow_dbl(radix, 6), this.unsigned),\r\n        rem = this;\r\n    var result = '';\r\n    while (true) {\r\n        var remDiv = rem.div(radixToPower),\r\n            intval = rem.sub(remDiv.mul(radixToPower)).toInt() >>> 0,\r\n            digits = intval.toString(radix);\r\n        rem = remDiv;\r\n        if (rem.isZero())\r\n            return digits + result;\r\n        else {\r\n            while (digits.length < 6)\r\n                digits = '0' + digits;\r\n            result = '' + digits + result;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Gets the high 32 bits as a signed integer.\r\n * @returns {number} Signed high bits\r\n */\r\nLongPrototype.getHighBits = function getHighBits() {\r\n    return this.high;\r\n};\r\n\r\n/**\r\n * Gets the high 32 bits as an unsigned integer.\r\n * @returns {number} Unsigned high bits\r\n */\r\nLongPrototype.getHighBitsUnsigned = function getHighBitsUnsigned() {\r\n    return this.high >>> 0;\r\n};\r\n\r\n/**\r\n * Gets the low 32 bits as a signed integer.\r\n * @returns {number} Signed low bits\r\n */\r\nLongPrototype.getLowBits = function getLowBits() {\r\n    return this.low;\r\n};\r\n\r\n/**\r\n * Gets the low 32 bits as an unsigned integer.\r\n * @returns {number} Unsigned low bits\r\n */\r\nLongPrototype.getLowBitsUnsigned = function getLowBitsUnsigned() {\r\n    return this.low >>> 0;\r\n};\r\n\r\n/**\r\n * Gets the number of bits needed to represent the absolute value of this Long.\r\n * @returns {number}\r\n */\r\nLongPrototype.getNumBitsAbs = function getNumBitsAbs() {\r\n    if (this.isNegative()) // Unsigned Longs are never negative\r\n        return this.eq(MIN_VALUE) ? 64 : this.neg().getNumBitsAbs();\r\n    var val = this.high != 0 ? this.high : this.low;\r\n    for (var bit = 31; bit > 0; bit--)\r\n        if ((val & (1 << bit)) != 0)\r\n            break;\r\n    return this.high != 0 ? bit + 33 : bit + 1;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value equals zero.\r\n * @returns {boolean}\r\n */\r\nLongPrototype.isZero = function isZero() {\r\n    return this.high === 0 && this.low === 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value equals zero. This is an alias of {@link Long#isZero}.\r\n * @returns {boolean}\r\n */\r\nLongPrototype.eqz = LongPrototype.isZero;\r\n\r\n/**\r\n * Tests if this Long's value is negative.\r\n * @returns {boolean}\r\n */\r\nLongPrototype.isNegative = function isNegative() {\r\n    return !this.unsigned && this.high < 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value is positive.\r\n * @returns {boolean}\r\n */\r\nLongPrototype.isPositive = function isPositive() {\r\n    return this.unsigned || this.high >= 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value is odd.\r\n * @returns {boolean}\r\n */\r\nLongPrototype.isOdd = function isOdd() {\r\n    return (this.low & 1) === 1;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value is even.\r\n * @returns {boolean}\r\n */\r\nLongPrototype.isEven = function isEven() {\r\n    return (this.low & 1) === 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value equals the specified's.\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.equals = function equals(other) {\r\n    if (!isLong(other))\r\n        other = fromValue(other);\r\n    if (this.unsigned !== other.unsigned && (this.high >>> 31) === 1 && (other.high >>> 31) === 1)\r\n        return false;\r\n    return this.high === other.high && this.low === other.low;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value equals the specified's. This is an alias of {@link Long#equals}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.eq = LongPrototype.equals;\r\n\r\n/**\r\n * Tests if this Long's value differs from the specified's.\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.notEquals = function notEquals(other) {\r\n    return !this.eq(/* validates */ other);\r\n};\r\n\r\n/**\r\n * Tests if this Long's value differs from the specified's. This is an alias of {@link Long#notEquals}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.neq = LongPrototype.notEquals;\r\n\r\n/**\r\n * Tests if this Long's value differs from the specified's. This is an alias of {@link Long#notEquals}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.ne = LongPrototype.notEquals;\r\n\r\n/**\r\n * Tests if this Long's value is less than the specified's.\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.lessThan = function lessThan(other) {\r\n    return this.comp(/* validates */ other) < 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value is less than the specified's. This is an alias of {@link Long#lessThan}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.lt = LongPrototype.lessThan;\r\n\r\n/**\r\n * Tests if this Long's value is less than or equal the specified's.\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.lessThanOrEqual = function lessThanOrEqual(other) {\r\n    return this.comp(/* validates */ other) <= 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value is less than or equal the specified's. This is an alias of {@link Long#lessThanOrEqual}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.lte = LongPrototype.lessThanOrEqual;\r\n\r\n/**\r\n * Tests if this Long's value is less than or equal the specified's. This is an alias of {@link Long#lessThanOrEqual}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.le = LongPrototype.lessThanOrEqual;\r\n\r\n/**\r\n * Tests if this Long's value is greater than the specified's.\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.greaterThan = function greaterThan(other) {\r\n    return this.comp(/* validates */ other) > 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value is greater than the specified's. This is an alias of {@link Long#greaterThan}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.gt = LongPrototype.greaterThan;\r\n\r\n/**\r\n * Tests if this Long's value is greater than or equal the specified's.\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.greaterThanOrEqual = function greaterThanOrEqual(other) {\r\n    return this.comp(/* validates */ other) >= 0;\r\n};\r\n\r\n/**\r\n * Tests if this Long's value is greater than or equal the specified's. This is an alias of {@link Long#greaterThanOrEqual}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.gte = LongPrototype.greaterThanOrEqual;\r\n\r\n/**\r\n * Tests if this Long's value is greater than or equal the specified's. This is an alias of {@link Long#greaterThanOrEqual}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {boolean}\r\n */\r\nLongPrototype.ge = LongPrototype.greaterThanOrEqual;\r\n\r\n/**\r\n * Compares this Long's value with the specified's.\r\n * @param {!Long|number|string} other Other value\r\n * @returns {number} 0 if they are the same, 1 if the this is greater and -1\r\n *  if the given one is greater\r\n */\r\nLongPrototype.compare = function compare(other) {\r\n    if (!isLong(other))\r\n        other = fromValue(other);\r\n    if (this.eq(other))\r\n        return 0;\r\n    var thisNeg = this.isNegative(),\r\n        otherNeg = other.isNegative();\r\n    if (thisNeg && !otherNeg)\r\n        return -1;\r\n    if (!thisNeg && otherNeg)\r\n        return 1;\r\n    // At this point the sign bits are the same\r\n    if (!this.unsigned)\r\n        return this.sub(other).isNegative() ? -1 : 1;\r\n    // Both are positive if at least one is unsigned\r\n    return (other.high >>> 0) > (this.high >>> 0) || (other.high === this.high && (other.low >>> 0) > (this.low >>> 0)) ? -1 : 1;\r\n};\r\n\r\n/**\r\n * Compares this Long's value with the specified's. This is an alias of {@link Long#compare}.\r\n * @function\r\n * @param {!Long|number|string} other Other value\r\n * @returns {number} 0 if they are the same, 1 if the this is greater and -1\r\n *  if the given one is greater\r\n */\r\nLongPrototype.comp = LongPrototype.compare;\r\n\r\n/**\r\n * Negates this Long's value.\r\n * @returns {!Long} Negated Long\r\n */\r\nLongPrototype.negate = function negate() {\r\n    if (!this.unsigned && this.eq(MIN_VALUE))\r\n        return MIN_VALUE;\r\n    return this.not().add(ONE);\r\n};\r\n\r\n/**\r\n * Negates this Long's value. This is an alias of {@link Long#negate}.\r\n * @function\r\n * @returns {!Long} Negated Long\r\n */\r\nLongPrototype.neg = LongPrototype.negate;\r\n\r\n/**\r\n * Returns the sum of this and the specified Long.\r\n * @param {!Long|number|string} addend Addend\r\n * @returns {!Long} Sum\r\n */\r\nLongPrototype.add = function add(addend) {\r\n    if (!isLong(addend))\r\n        addend = fromValue(addend);\r\n\r\n    // Divide each number into 4 chunks of 16 bits, and then sum the chunks.\r\n\r\n    var a48 = this.high >>> 16;\r\n    var a32 = this.high & 0xFFFF;\r\n    var a16 = this.low >>> 16;\r\n    var a00 = this.low & 0xFFFF;\r\n\r\n    var b48 = addend.high >>> 16;\r\n    var b32 = addend.high & 0xFFFF;\r\n    var b16 = addend.low >>> 16;\r\n    var b00 = addend.low & 0xFFFF;\r\n\r\n    var c48 = 0, c32 = 0, c16 = 0, c00 = 0;\r\n    c00 += a00 + b00;\r\n    c16 += c00 >>> 16;\r\n    c00 &= 0xFFFF;\r\n    c16 += a16 + b16;\r\n    c32 += c16 >>> 16;\r\n    c16 &= 0xFFFF;\r\n    c32 += a32 + b32;\r\n    c48 += c32 >>> 16;\r\n    c32 &= 0xFFFF;\r\n    c48 += a48 + b48;\r\n    c48 &= 0xFFFF;\r\n    return fromBits((c16 << 16) | c00, (c48 << 16) | c32, this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns the difference of this and the specified Long.\r\n * @param {!Long|number|string} subtrahend Subtrahend\r\n * @returns {!Long} Difference\r\n */\r\nLongPrototype.subtract = function subtract(subtrahend) {\r\n    if (!isLong(subtrahend))\r\n        subtrahend = fromValue(subtrahend);\r\n    return this.add(subtrahend.neg());\r\n};\r\n\r\n/**\r\n * Returns the difference of this and the specified Long. This is an alias of {@link Long#subtract}.\r\n * @function\r\n * @param {!Long|number|string} subtrahend Subtrahend\r\n * @returns {!Long} Difference\r\n */\r\nLongPrototype.sub = LongPrototype.subtract;\r\n\r\n/**\r\n * Returns the product of this and the specified Long.\r\n * @param {!Long|number|string} multiplier Multiplier\r\n * @returns {!Long} Product\r\n */\r\nLongPrototype.multiply = function multiply(multiplier) {\r\n    if (this.isZero())\r\n        return ZERO;\r\n    if (!isLong(multiplier))\r\n        multiplier = fromValue(multiplier);\r\n\r\n    // use wasm support if present\r\n    if (wasm) {\r\n        var low = wasm.mul(this.low,\r\n                           this.high,\r\n                           multiplier.low,\r\n                           multiplier.high);\r\n        return fromBits(low, wasm.get_high(), this.unsigned);\r\n    }\r\n\r\n    if (multiplier.isZero())\r\n        return ZERO;\r\n    if (this.eq(MIN_VALUE))\r\n        return multiplier.isOdd() ? MIN_VALUE : ZERO;\r\n    if (multiplier.eq(MIN_VALUE))\r\n        return this.isOdd() ? MIN_VALUE : ZERO;\r\n\r\n    if (this.isNegative()) {\r\n        if (multiplier.isNegative())\r\n            return this.neg().mul(multiplier.neg());\r\n        else\r\n            return this.neg().mul(multiplier).neg();\r\n    } else if (multiplier.isNegative())\r\n        return this.mul(multiplier.neg()).neg();\r\n\r\n    // If both longs are small, use float multiplication\r\n    if (this.lt(TWO_PWR_24) && multiplier.lt(TWO_PWR_24))\r\n        return fromNumber(this.toNumber() * multiplier.toNumber(), this.unsigned);\r\n\r\n    // Divide each long into 4 chunks of 16 bits, and then add up 4x4 products.\r\n    // We can skip products that would overflow.\r\n\r\n    var a48 = this.high >>> 16;\r\n    var a32 = this.high & 0xFFFF;\r\n    var a16 = this.low >>> 16;\r\n    var a00 = this.low & 0xFFFF;\r\n\r\n    var b48 = multiplier.high >>> 16;\r\n    var b32 = multiplier.high & 0xFFFF;\r\n    var b16 = multiplier.low >>> 16;\r\n    var b00 = multiplier.low & 0xFFFF;\r\n\r\n    var c48 = 0, c32 = 0, c16 = 0, c00 = 0;\r\n    c00 += a00 * b00;\r\n    c16 += c00 >>> 16;\r\n    c00 &= 0xFFFF;\r\n    c16 += a16 * b00;\r\n    c32 += c16 >>> 16;\r\n    c16 &= 0xFFFF;\r\n    c16 += a00 * b16;\r\n    c32 += c16 >>> 16;\r\n    c16 &= 0xFFFF;\r\n    c32 += a32 * b00;\r\n    c48 += c32 >>> 16;\r\n    c32 &= 0xFFFF;\r\n    c32 += a16 * b16;\r\n    c48 += c32 >>> 16;\r\n    c32 &= 0xFFFF;\r\n    c32 += a00 * b32;\r\n    c48 += c32 >>> 16;\r\n    c32 &= 0xFFFF;\r\n    c48 += a48 * b00 + a32 * b16 + a16 * b32 + a00 * b48;\r\n    c48 &= 0xFFFF;\r\n    return fromBits((c16 << 16) | c00, (c48 << 16) | c32, this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns the product of this and the specified Long. This is an alias of {@link Long#multiply}.\r\n * @function\r\n * @param {!Long|number|string} multiplier Multiplier\r\n * @returns {!Long} Product\r\n */\r\nLongPrototype.mul = LongPrototype.multiply;\r\n\r\n/**\r\n * Returns this Long divided by the specified. The result is signed if this Long is signed or\r\n *  unsigned if this Long is unsigned.\r\n * @param {!Long|number|string} divisor Divisor\r\n * @returns {!Long} Quotient\r\n */\r\nLongPrototype.divide = function divide(divisor) {\r\n    if (!isLong(divisor))\r\n        divisor = fromValue(divisor);\r\n    if (divisor.isZero())\r\n        throw Error('division by zero');\r\n\r\n    // use wasm support if present\r\n    if (wasm) {\r\n        // guard against signed division overflow: the largest\r\n        // negative number / -1 would be 1 larger than the largest\r\n        // positive number, due to two's complement.\r\n        if (!this.unsigned &&\r\n            this.high === -0x80000000 &&\r\n            divisor.low === -1 && divisor.high === -1) {\r\n            // be consistent with non-wasm code path\r\n            return this;\r\n        }\r\n        var low = (this.unsigned ? wasm.div_u : wasm.div_s)(\r\n            this.low,\r\n            this.high,\r\n            divisor.low,\r\n            divisor.high\r\n        );\r\n        return fromBits(low, wasm.get_high(), this.unsigned);\r\n    }\r\n\r\n    if (this.isZero())\r\n        return this.unsigned ? UZERO : ZERO;\r\n    var approx, rem, res;\r\n    if (!this.unsigned) {\r\n        // This section is only relevant for signed longs and is derived from the\r\n        // closure library as a whole.\r\n        if (this.eq(MIN_VALUE)) {\r\n            if (divisor.eq(ONE) || divisor.eq(NEG_ONE))\r\n                return MIN_VALUE;  // recall that -MIN_VALUE == MIN_VALUE\r\n            else if (divisor.eq(MIN_VALUE))\r\n                return ONE;\r\n            else {\r\n                // At this point, we have |other| >= 2, so |this/other| < |MIN_VALUE|.\r\n                var halfThis = this.shr(1);\r\n                approx = halfThis.div(divisor).shl(1);\r\n                if (approx.eq(ZERO)) {\r\n                    return divisor.isNegative() ? ONE : NEG_ONE;\r\n                } else {\r\n                    rem = this.sub(divisor.mul(approx));\r\n                    res = approx.add(rem.div(divisor));\r\n                    return res;\r\n                }\r\n            }\r\n        } else if (divisor.eq(MIN_VALUE))\r\n            return this.unsigned ? UZERO : ZERO;\r\n        if (this.isNegative()) {\r\n            if (divisor.isNegative())\r\n                return this.neg().div(divisor.neg());\r\n            return this.neg().div(divisor).neg();\r\n        } else if (divisor.isNegative())\r\n            return this.div(divisor.neg()).neg();\r\n        res = ZERO;\r\n    } else {\r\n        // The algorithm below has not been made for unsigned longs. It's therefore\r\n        // required to take special care of the MSB prior to running it.\r\n        if (!divisor.unsigned)\r\n            divisor = divisor.toUnsigned();\r\n        if (divisor.gt(this))\r\n            return UZERO;\r\n        if (divisor.gt(this.shru(1))) // 15 >>> 1 = 7 ; with divisor = 8 ; true\r\n            return UONE;\r\n        res = UZERO;\r\n    }\r\n\r\n    // Repeat the following until the remainder is less than other:  find a\r\n    // floating-point that approximates remainder / other *from below*, add this\r\n    // into the result, and subtract it from the remainder.  It is critical that\r\n    // the approximate value is less than or equal to the real value so that the\r\n    // remainder never becomes negative.\r\n    rem = this;\r\n    while (rem.gte(divisor)) {\r\n        // Approximate the result of division. This may be a little greater or\r\n        // smaller than the actual value.\r\n        approx = Math.max(1, Math.floor(rem.toNumber() / divisor.toNumber()));\r\n\r\n        // We will tweak the approximate result by changing it in the 48-th digit or\r\n        // the smallest non-fractional digit, whichever is larger.\r\n        var log2 = Math.ceil(Math.log(approx) / Math.LN2),\r\n            delta = (log2 <= 48) ? 1 : pow_dbl(2, log2 - 48),\r\n\r\n        // Decrease the approximation until it is smaller than the remainder.  Note\r\n        // that if it is too large, the product overflows and is negative.\r\n            approxRes = fromNumber(approx),\r\n            approxRem = approxRes.mul(divisor);\r\n        while (approxRem.isNegative() || approxRem.gt(rem)) {\r\n            approx -= delta;\r\n            approxRes = fromNumber(approx, this.unsigned);\r\n            approxRem = approxRes.mul(divisor);\r\n        }\r\n\r\n        // We know the answer can't be zero... and actually, zero would cause\r\n        // infinite recursion since we would make no progress.\r\n        if (approxRes.isZero())\r\n            approxRes = ONE;\r\n\r\n        res = res.add(approxRes);\r\n        rem = rem.sub(approxRem);\r\n    }\r\n    return res;\r\n};\r\n\r\n/**\r\n * Returns this Long divided by the specified. This is an alias of {@link Long#divide}.\r\n * @function\r\n * @param {!Long|number|string} divisor Divisor\r\n * @returns {!Long} Quotient\r\n */\r\nLongPrototype.div = LongPrototype.divide;\r\n\r\n/**\r\n * Returns this Long modulo the specified.\r\n * @param {!Long|number|string} divisor Divisor\r\n * @returns {!Long} Remainder\r\n */\r\nLongPrototype.modulo = function modulo(divisor) {\r\n    if (!isLong(divisor))\r\n        divisor = fromValue(divisor);\r\n\r\n    // use wasm support if present\r\n    if (wasm) {\r\n        var low = (this.unsigned ? wasm.rem_u : wasm.rem_s)(\r\n            this.low,\r\n            this.high,\r\n            divisor.low,\r\n            divisor.high\r\n        );\r\n        return fromBits(low, wasm.get_high(), this.unsigned);\r\n    }\r\n\r\n    return this.sub(this.div(divisor).mul(divisor));\r\n};\r\n\r\n/**\r\n * Returns this Long modulo the specified. This is an alias of {@link Long#modulo}.\r\n * @function\r\n * @param {!Long|number|string} divisor Divisor\r\n * @returns {!Long} Remainder\r\n */\r\nLongPrototype.mod = LongPrototype.modulo;\r\n\r\n/**\r\n * Returns this Long modulo the specified. This is an alias of {@link Long#modulo}.\r\n * @function\r\n * @param {!Long|number|string} divisor Divisor\r\n * @returns {!Long} Remainder\r\n */\r\nLongPrototype.rem = LongPrototype.modulo;\r\n\r\n/**\r\n * Returns the bitwise NOT of this Long.\r\n * @returns {!Long}\r\n */\r\nLongPrototype.not = function not() {\r\n    return fromBits(~this.low, ~this.high, this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns the bitwise AND of this Long and the specified.\r\n * @param {!Long|number|string} other Other Long\r\n * @returns {!Long}\r\n */\r\nLongPrototype.and = function and(other) {\r\n    if (!isLong(other))\r\n        other = fromValue(other);\r\n    return fromBits(this.low & other.low, this.high & other.high, this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns the bitwise OR of this Long and the specified.\r\n * @param {!Long|number|string} other Other Long\r\n * @returns {!Long}\r\n */\r\nLongPrototype.or = function or(other) {\r\n    if (!isLong(other))\r\n        other = fromValue(other);\r\n    return fromBits(this.low | other.low, this.high | other.high, this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns the bitwise XOR of this Long and the given one.\r\n * @param {!Long|number|string} other Other Long\r\n * @returns {!Long}\r\n */\r\nLongPrototype.xor = function xor(other) {\r\n    if (!isLong(other))\r\n        other = fromValue(other);\r\n    return fromBits(this.low ^ other.low, this.high ^ other.high, this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns this Long with bits shifted to the left by the given amount.\r\n * @param {number|!Long} numBits Number of bits\r\n * @returns {!Long} Shifted Long\r\n */\r\nLongPrototype.shiftLeft = function shiftLeft(numBits) {\r\n    if (isLong(numBits))\r\n        numBits = numBits.toInt();\r\n    if ((numBits &= 63) === 0)\r\n        return this;\r\n    else if (numBits < 32)\r\n        return fromBits(this.low << numBits, (this.high << numBits) | (this.low >>> (32 - numBits)), this.unsigned);\r\n    else\r\n        return fromBits(0, this.low << (numBits - 32), this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns this Long with bits shifted to the left by the given amount. This is an alias of {@link Long#shiftLeft}.\r\n * @function\r\n * @param {number|!Long} numBits Number of bits\r\n * @returns {!Long} Shifted Long\r\n */\r\nLongPrototype.shl = LongPrototype.shiftLeft;\r\n\r\n/**\r\n * Returns this Long with bits arithmetically shifted to the right by the given amount.\r\n * @param {number|!Long} numBits Number of bits\r\n * @returns {!Long} Shifted Long\r\n */\r\nLongPrototype.shiftRight = function shiftRight(numBits) {\r\n    if (isLong(numBits))\r\n        numBits = numBits.toInt();\r\n    if ((numBits &= 63) === 0)\r\n        return this;\r\n    else if (numBits < 32)\r\n        return fromBits((this.low >>> numBits) | (this.high << (32 - numBits)), this.high >> numBits, this.unsigned);\r\n    else\r\n        return fromBits(this.high >> (numBits - 32), this.high >= 0 ? 0 : -1, this.unsigned);\r\n};\r\n\r\n/**\r\n * Returns this Long with bits arithmetically shifted to the right by the given amount. This is an alias of {@link Long#shiftRight}.\r\n * @function\r\n * @param {number|!Long} numBits Number of bits\r\n * @returns {!Long} Shifted Long\r\n */\r\nLongPrototype.shr = LongPrototype.shiftRight;\r\n\r\n/**\r\n * Returns this Long with bits logically shifted to the right by the given amount.\r\n * @param {number|!Long} numBits Number of bits\r\n * @returns {!Long} Shifted Long\r\n */\r\nLongPrototype.shiftRightUnsigned = function shiftRightUnsigned(numBits) {\r\n    if (isLong(numBits))\r\n        numBits = numBits.toInt();\r\n    numBits &= 63;\r\n    if (numBits === 0)\r\n        return this;\r\n    else {\r\n        var high = this.high;\r\n        if (numBits < 32) {\r\n            var low = this.low;\r\n            return fromBits((low >>> numBits) | (high << (32 - numBits)), high >>> numBits, this.unsigned);\r\n        } else if (numBits === 32)\r\n            return fromBits(high, 0, this.unsigned);\r\n        else\r\n            return fromBits(high >>> (numBits - 32), 0, this.unsigned);\r\n    }\r\n};\r\n\r\n/**\r\n * Returns this Long with bits logically shifted to the right by the given amount. This is an alias of {@link Long#shiftRightUnsigned}.\r\n * @function\r\n * @param {number|!Long} numBits Number of bits\r\n * @returns {!Long} Shifted Long\r\n */\r\nLongPrototype.shru = LongPrototype.shiftRightUnsigned;\r\n\r\n/**\r\n * Returns this Long with bits logically shifted to the right by the given amount. This is an alias of {@link Long#shiftRightUnsigned}.\r\n * @function\r\n * @param {number|!Long} numBits Number of bits\r\n * @returns {!Long} Shifted Long\r\n */\r\nLongPrototype.shr_u = LongPrototype.shiftRightUnsigned;\r\n\r\n/**\r\n * Converts this Long to signed.\r\n * @returns {!Long} Signed long\r\n */\r\nLongPrototype.toSigned = function toSigned() {\r\n    if (!this.unsigned)\r\n        return this;\r\n    return fromBits(this.low, this.high, false);\r\n};\r\n\r\n/**\r\n * Converts this Long to unsigned.\r\n * @returns {!Long} Unsigned long\r\n */\r\nLongPrototype.toUnsigned = function toUnsigned() {\r\n    if (this.unsigned)\r\n        return this;\r\n    return fromBits(this.low, this.high, true);\r\n};\r\n\r\n/**\r\n * Converts this Long to its byte representation.\r\n * @param {boolean=} le Whether little or big endian, defaults to big endian\r\n * @returns {!Array.<number>} Byte representation\r\n */\r\nLongPrototype.toBytes = function toBytes(le) {\r\n    return le ? this.toBytesLE() : this.toBytesBE();\r\n};\r\n\r\n/**\r\n * Converts this Long to its little endian byte representation.\r\n * @returns {!Array.<number>} Little endian byte representation\r\n */\r\nLongPrototype.toBytesLE = function toBytesLE() {\r\n    var hi = this.high,\r\n        lo = this.low;\r\n    return [\r\n        lo        & 0xff,\r\n        lo >>>  8 & 0xff,\r\n        lo >>> 16 & 0xff,\r\n        lo >>> 24       ,\r\n        hi        & 0xff,\r\n        hi >>>  8 & 0xff,\r\n        hi >>> 16 & 0xff,\r\n        hi >>> 24\r\n    ];\r\n};\r\n\r\n/**\r\n * Converts this Long to its big endian byte representation.\r\n * @returns {!Array.<number>} Big endian byte representation\r\n */\r\nLongPrototype.toBytesBE = function toBytesBE() {\r\n    var hi = this.high,\r\n        lo = this.low;\r\n    return [\r\n        hi >>> 24       ,\r\n        hi >>> 16 & 0xff,\r\n        hi >>>  8 & 0xff,\r\n        hi        & 0xff,\r\n        lo >>> 24       ,\r\n        lo >>> 16 & 0xff,\r\n        lo >>>  8 & 0xff,\r\n        lo        & 0xff\r\n    ];\r\n};\r\n\r\n/**\r\n * Creates a Long from its byte representation.\r\n * @param {!Array.<number>} bytes Byte representation\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @param {boolean=} le Whether little or big endian, defaults to big endian\r\n * @returns {Long} The corresponding Long value\r\n */\r\nLong.fromBytes = function fromBytes(bytes, unsigned, le) {\r\n    return le ? Long.fromBytesLE(bytes, unsigned) : Long.fromBytesBE(bytes, unsigned);\r\n};\r\n\r\n/**\r\n * Creates a Long from its little endian byte representation.\r\n * @param {!Array.<number>} bytes Little endian byte representation\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @returns {Long} The corresponding Long value\r\n */\r\nLong.fromBytesLE = function fromBytesLE(bytes, unsigned) {\r\n    return new Long(\r\n        bytes[0]       |\r\n        bytes[1] <<  8 |\r\n        bytes[2] << 16 |\r\n        bytes[3] << 24,\r\n        bytes[4]       |\r\n        bytes[5] <<  8 |\r\n        bytes[6] << 16 |\r\n        bytes[7] << 24,\r\n        unsigned\r\n    );\r\n};\r\n\r\n/**\r\n * Creates a Long from its big endian byte representation.\r\n * @param {!Array.<number>} bytes Big endian byte representation\r\n * @param {boolean=} unsigned Whether unsigned or not, defaults to signed\r\n * @returns {Long} The corresponding Long value\r\n */\r\nLong.fromBytesBE = function fromBytesBE(bytes, unsigned) {\r\n    return new Long(\r\n        bytes[4] << 24 |\r\n        bytes[5] << 16 |\r\n        bytes[6] <<  8 |\r\n        bytes[7],\r\n        bytes[0] << 24 |\r\n        bytes[1] << 16 |\r\n        bytes[2] <<  8 |\r\n        bytes[3],\r\n        unsigned\r\n    );\r\n};\r\n","// minimal library entry point.\n\n\"use strict\";\nmodule.exports = require(\"./src/index-minimal\");\n","\"use strict\";\nvar protobuf = exports;\n\n/**\n * Build type, one of `\"full\"`, `\"light\"` or `\"minimal\"`.\n * @name build\n * @type {string}\n * @const\n */\nprotobuf.build = \"minimal\";\n\n// Serialization\nprotobuf.Writer       = require(\"./writer\");\nprotobuf.BufferWriter = require(\"./writer_buffer\");\nprotobuf.Reader       = require(\"./reader\");\nprotobuf.BufferReader = require(\"./reader_buffer\");\n\n// Utility\nprotobuf.util         = require(\"./util/minimal\");\nprotobuf.rpc          = require(\"./rpc\");\nprotobuf.roots        = require(\"./roots\");\nprotobuf.configure    = configure;\n\n/* istanbul ignore next */\n/**\n * Reconfigures the library according to the environment.\n * @returns {undefined}\n */\nfunction configure() {\n    protobuf.util._configure();\n    protobuf.Writer._configure(protobuf.BufferWriter);\n    protobuf.Reader._configure(protobuf.BufferReader);\n}\n\n// Set up buffer utility according to the environment\nconfigure();\n","\"use strict\";\nmodule.exports = Reader;\n\nvar util      = require(\"./util/minimal\");\n\nvar BufferReader; // cyclic\n\nvar LongBits  = util.LongBits,\n    utf8      = util.utf8;\n\n/* istanbul ignore next */\nfunction indexOutOfRange(reader, writeLength) {\n    return RangeError(\"index out of range: \" + reader.pos + \" + \" + (writeLength || 1) + \" > \" + reader.len);\n}\n\n/**\n * Constructs a new reader instance using the specified buffer.\n * @classdesc Wire format reader using `Uint8Array` if available, otherwise `Array`.\n * @constructor\n * @param {Uint8Array} buffer Buffer to read from\n */\nfunction Reader(buffer) {\n\n    /**\n     * Read buffer.\n     * @type {Uint8Array}\n     */\n    this.buf = buffer;\n\n    /**\n     * Read buffer position.\n     * @type {number}\n     */\n    this.pos = 0;\n\n    /**\n     * Read buffer length.\n     * @type {number}\n     */\n    this.len = buffer.length;\n}\n\nvar create_array = typeof Uint8Array !== \"undefined\"\n    ? function create_typed_array(buffer) {\n        if (buffer instanceof Uint8Array || Array.isArray(buffer))\n            return new Reader(buffer);\n        throw Error(\"illegal buffer\");\n    }\n    /* istanbul ignore next */\n    : function create_array(buffer) {\n        if (Array.isArray(buffer))\n            return new Reader(buffer);\n        throw Error(\"illegal buffer\");\n    };\n\nvar create = function create() {\n    return util.Buffer\n        ? function create_buffer_setup(buffer) {\n            return (Reader.create = function create_buffer(buffer) {\n                return util.Buffer.isBuffer(buffer)\n                    ? new BufferReader(buffer)\n                    /* istanbul ignore next */\n                    : create_array(buffer);\n            })(buffer);\n        }\n        /* istanbul ignore next */\n        : create_array;\n};\n\n/**\n * Creates a new reader using the specified buffer.\n * @function\n * @param {Uint8Array|Buffer} buffer Buffer to read from\n * @returns {Reader|BufferReader} A {@link BufferReader} if `buffer` is a Buffer, otherwise a {@link Reader}\n * @throws {Error} If `buffer` is not a valid buffer\n */\nReader.create = create();\n\nReader.prototype._slice = util.Array.prototype.subarray || /* istanbul ignore next */ util.Array.prototype.slice;\n\n/**\n * Reads a varint as an unsigned 32 bit value.\n * @function\n * @returns {number} Value read\n */\nReader.prototype.uint32 = (function read_uint32_setup() {\n    var value = 4294967295; // optimizer type-hint, tends to deopt otherwise (?!)\n    return function read_uint32() {\n        value = (         this.buf[this.pos] & 127       ) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] & 127) <<  7) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] & 127) << 14) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] & 127) << 21) >>> 0; if (this.buf[this.pos++] < 128) return value;\n        value = (value | (this.buf[this.pos] &  15) << 28) >>> 0; if (this.buf[this.pos++] < 128) return value;\n\n        /* istanbul ignore if */\n        if ((this.pos += 5) > this.len) {\n            this.pos = this.len;\n            throw indexOutOfRange(this, 10);\n        }\n        return value;\n    };\n})();\n\n/**\n * Reads a varint as a signed 32 bit value.\n * @returns {number} Value read\n */\nReader.prototype.int32 = function read_int32() {\n    return this.uint32() | 0;\n};\n\n/**\n * Reads a zig-zag encoded varint as a signed 32 bit value.\n * @returns {number} Value read\n */\nReader.prototype.sint32 = function read_sint32() {\n    var value = this.uint32();\n    return value >>> 1 ^ -(value & 1) | 0;\n};\n\n/* eslint-disable no-invalid-this */\n\nfunction readLongVarint() {\n    // tends to deopt with local vars for octet etc.\n    var bits = new LongBits(0, 0);\n    var i = 0;\n    if (this.len - this.pos > 4) { // fast route (lo)\n        for (; i < 4; ++i) {\n            // 1st..4th\n            bits.lo = (bits.lo | (this.buf[this.pos] & 127) << i * 7) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n        // 5th\n        bits.lo = (bits.lo | (this.buf[this.pos] & 127) << 28) >>> 0;\n        bits.hi = (bits.hi | (this.buf[this.pos] & 127) >>  4) >>> 0;\n        if (this.buf[this.pos++] < 128)\n            return bits;\n        i = 0;\n    } else {\n        for (; i < 3; ++i) {\n            /* istanbul ignore if */\n            if (this.pos >= this.len)\n                throw indexOutOfRange(this);\n            // 1st..3th\n            bits.lo = (bits.lo | (this.buf[this.pos] & 127) << i * 7) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n        // 4th\n        bits.lo = (bits.lo | (this.buf[this.pos++] & 127) << i * 7) >>> 0;\n        return bits;\n    }\n    if (this.len - this.pos > 4) { // fast route (hi)\n        for (; i < 5; ++i) {\n            // 6th..10th\n            bits.hi = (bits.hi | (this.buf[this.pos] & 127) << i * 7 + 3) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n    } else {\n        for (; i < 5; ++i) {\n            /* istanbul ignore if */\n            if (this.pos >= this.len)\n                throw indexOutOfRange(this);\n            // 6th..10th\n            bits.hi = (bits.hi | (this.buf[this.pos] & 127) << i * 7 + 3) >>> 0;\n            if (this.buf[this.pos++] < 128)\n                return bits;\n        }\n    }\n    /* istanbul ignore next */\n    throw Error(\"invalid varint encoding\");\n}\n\n/* eslint-enable no-invalid-this */\n\n/**\n * Reads a varint as a signed 64 bit value.\n * @name Reader#int64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a varint as an unsigned 64 bit value.\n * @name Reader#uint64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a zig-zag encoded varint as a signed 64 bit value.\n * @name Reader#sint64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a varint as a boolean.\n * @returns {boolean} Value read\n */\nReader.prototype.bool = function read_bool() {\n    return this.uint32() !== 0;\n};\n\nfunction readFixed32_end(buf, end) { // note that this uses `end`, not `pos`\n    return (buf[end - 4]\n          | buf[end - 3] << 8\n          | buf[end - 2] << 16\n          | buf[end - 1] << 24) >>> 0;\n}\n\n/**\n * Reads fixed 32 bits as an unsigned 32 bit integer.\n * @returns {number} Value read\n */\nReader.prototype.fixed32 = function read_fixed32() {\n\n    /* istanbul ignore if */\n    if (this.pos + 4 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    return readFixed32_end(this.buf, this.pos += 4);\n};\n\n/**\n * Reads fixed 32 bits as a signed 32 bit integer.\n * @returns {number} Value read\n */\nReader.prototype.sfixed32 = function read_sfixed32() {\n\n    /* istanbul ignore if */\n    if (this.pos + 4 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    return readFixed32_end(this.buf, this.pos += 4) | 0;\n};\n\n/* eslint-disable no-invalid-this */\n\nfunction readFixed64(/* this: Reader */) {\n\n    /* istanbul ignore if */\n    if (this.pos + 8 > this.len)\n        throw indexOutOfRange(this, 8);\n\n    return new LongBits(readFixed32_end(this.buf, this.pos += 4), readFixed32_end(this.buf, this.pos += 4));\n}\n\n/* eslint-enable no-invalid-this */\n\n/**\n * Reads fixed 64 bits.\n * @name Reader#fixed64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads zig-zag encoded fixed 64 bits.\n * @name Reader#sfixed64\n * @function\n * @returns {Long} Value read\n */\n\n/**\n * Reads a float (32 bit) as a number.\n * @function\n * @returns {number} Value read\n */\nReader.prototype.float = function read_float() {\n\n    /* istanbul ignore if */\n    if (this.pos + 4 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    var value = util.float.readFloatLE(this.buf, this.pos);\n    this.pos += 4;\n    return value;\n};\n\n/**\n * Reads a double (64 bit float) as a number.\n * @function\n * @returns {number} Value read\n */\nReader.prototype.double = function read_double() {\n\n    /* istanbul ignore if */\n    if (this.pos + 8 > this.len)\n        throw indexOutOfRange(this, 4);\n\n    var value = util.float.readDoubleLE(this.buf, this.pos);\n    this.pos += 8;\n    return value;\n};\n\n/**\n * Reads a sequence of bytes preceeded by its length as a varint.\n * @returns {Uint8Array} Value read\n */\nReader.prototype.bytes = function read_bytes() {\n    var length = this.uint32(),\n        start  = this.pos,\n        end    = this.pos + length;\n\n    /* istanbul ignore if */\n    if (end > this.len)\n        throw indexOutOfRange(this, length);\n\n    this.pos += length;\n    if (Array.isArray(this.buf)) // plain array\n        return this.buf.slice(start, end);\n    return start === end // fix for IE 10/Win8 and others' subarray returning array of size 1\n        ? new this.buf.constructor(0)\n        : this._slice.call(this.buf, start, end);\n};\n\n/**\n * Reads a string preceeded by its byte length as a varint.\n * @returns {string} Value read\n */\nReader.prototype.string = function read_string() {\n    var bytes = this.bytes();\n    return utf8.read(bytes, 0, bytes.length);\n};\n\n/**\n * Skips the specified number of bytes if specified, otherwise skips a varint.\n * @param {number} [length] Length if known, otherwise a varint is assumed\n * @returns {Reader} `this`\n */\nReader.prototype.skip = function skip(length) {\n    if (typeof length === \"number\") {\n        /* istanbul ignore if */\n        if (this.pos + length > this.len)\n            throw indexOutOfRange(this, length);\n        this.pos += length;\n    } else {\n        do {\n            /* istanbul ignore if */\n            if (this.pos >= this.len)\n                throw indexOutOfRange(this);\n        } while (this.buf[this.pos++] & 128);\n    }\n    return this;\n};\n\n/**\n * Skips the next element of the specified wire type.\n * @param {number} wireType Wire type received\n * @returns {Reader} `this`\n */\nReader.prototype.skipType = function(wireType) {\n    switch (wireType) {\n        case 0:\n            this.skip();\n            break;\n        case 1:\n            this.skip(8);\n            break;\n        case 2:\n            this.skip(this.uint32());\n            break;\n        case 3:\n            while ((wireType = this.uint32() & 7) !== 4) {\n                this.skipType(wireType);\n            }\n            break;\n        case 5:\n            this.skip(4);\n            break;\n\n        /* istanbul ignore next */\n        default:\n            throw Error(\"invalid wire type \" + wireType + \" at offset \" + this.pos);\n    }\n    return this;\n};\n\nReader._configure = function(BufferReader_) {\n    BufferReader = BufferReader_;\n    Reader.create = create();\n    BufferReader._configure();\n\n    var fn = util.Long ? \"toLong\" : /* istanbul ignore next */ \"toNumber\";\n    util.merge(Reader.prototype, {\n\n        int64: function read_int64() {\n            return readLongVarint.call(this)[fn](false);\n        },\n\n        uint64: function read_uint64() {\n            return readLongVarint.call(this)[fn](true);\n        },\n\n        sint64: function read_sint64() {\n            return readLongVarint.call(this).zzDecode()[fn](false);\n        },\n\n        fixed64: function read_fixed64() {\n            return readFixed64.call(this)[fn](true);\n        },\n\n        sfixed64: function read_sfixed64() {\n            return readFixed64.call(this)[fn](false);\n        }\n\n    });\n};\n","\"use strict\";\nmodule.exports = BufferReader;\n\n// extends Reader\nvar Reader = require(\"./reader\");\n(BufferReader.prototype = Object.create(Reader.prototype)).constructor = BufferReader;\n\nvar util = require(\"./util/minimal\");\n\n/**\n * Constructs a new buffer reader instance.\n * @classdesc Wire format reader using node buffers.\n * @extends Reader\n * @constructor\n * @param {Buffer} buffer Buffer to read from\n */\nfunction BufferReader(buffer) {\n    Reader.call(this, buffer);\n\n    /**\n     * Read buffer.\n     * @name BufferReader#buf\n     * @type {Buffer}\n     */\n}\n\nBufferReader._configure = function () {\n    /* istanbul ignore else */\n    if (util.Buffer)\n        BufferReader.prototype._slice = util.Buffer.prototype.slice;\n};\n\n\n/**\n * @override\n */\nBufferReader.prototype.string = function read_string_buffer() {\n    var len = this.uint32(); // modifies pos\n    return this.buf.utf8Slice\n        ? this.buf.utf8Slice(this.pos, this.pos = Math.min(this.pos + len, this.len))\n        : this.buf.toString(\"utf-8\", this.pos, this.pos = Math.min(this.pos + len, this.len));\n};\n\n/**\n * Reads a sequence of bytes preceeded by its length as a varint.\n * @name BufferReader#bytes\n * @function\n * @returns {Buffer} Value read\n */\n\nBufferReader._configure();\n","\"use strict\";\nmodule.exports = {};\n\n/**\n * Named roots.\n * This is where pbjs stores generated structures (the option `-r, --root` specifies a name).\n * Can also be used manually to make roots available accross modules.\n * @name roots\n * @type {Object.<string,Root>}\n * @example\n * // pbjs -r myroot -o compiled.js ...\n *\n * // in another module:\n * require(\"./compiled.js\");\n *\n * // in any subsequent module:\n * var root = protobuf.roots[\"myroot\"];\n */\n","\"use strict\";\n\n/**\n * Streaming RPC helpers.\n * @namespace\n */\nvar rpc = exports;\n\n/**\n * RPC implementation passed to {@link Service#create} performing a service request on network level, i.e. by utilizing http requests or websockets.\n * @typedef RPCImpl\n * @type {function}\n * @param {Method|rpc.ServiceMethod<Message<{}>,Message<{}>>} method Reflected or static method being called\n * @param {Uint8Array} requestData Request data\n * @param {RPCImplCallback} callback Callback function\n * @returns {undefined}\n * @example\n * function rpcImpl(method, requestData, callback) {\n *     if (protobuf.util.lcFirst(method.name) !== \"myMethod\") // compatible with static code\n *         throw Error(\"no such method\");\n *     asynchronouslyObtainAResponse(requestData, function(err, responseData) {\n *         callback(err, responseData);\n *     });\n * }\n */\n\n/**\n * Node-style callback as used by {@link RPCImpl}.\n * @typedef RPCImplCallback\n * @type {function}\n * @param {Error|null} error Error, if any, otherwise `null`\n * @param {Uint8Array|null} [response] Response data or `null` to signal end of stream, if there hasn't been an error\n * @returns {undefined}\n */\n\nrpc.Service = require(\"./rpc/service\");\n","\"use strict\";\nmodule.exports = Service;\n\nvar util = require(\"../util/minimal\");\n\n// Extends EventEmitter\n(Service.prototype = Object.create(util.EventEmitter.prototype)).constructor = Service;\n\n/**\n * A service method callback as used by {@link rpc.ServiceMethod|ServiceMethod}.\n *\n * Differs from {@link RPCImplCallback} in that it is an actual callback of a service method which may not return `response = null`.\n * @typedef rpc.ServiceMethodCallback\n * @template TRes extends Message<TRes>\n * @type {function}\n * @param {Error|null} error Error, if any\n * @param {TRes} [response] Response message\n * @returns {undefined}\n */\n\n/**\n * A service method part of a {@link rpc.Service} as created by {@link Service.create}.\n * @typedef rpc.ServiceMethod\n * @template TReq extends Message<TReq>\n * @template TRes extends Message<TRes>\n * @type {function}\n * @param {TReq|Properties<TReq>} request Request message or plain object\n * @param {rpc.ServiceMethodCallback<TRes>} [callback] Node-style callback called with the error, if any, and the response message\n * @returns {Promise<Message<TRes>>} Promise if `callback` has been omitted, otherwise `undefined`\n */\n\n/**\n * Constructs a new RPC service instance.\n * @classdesc An RPC service as returned by {@link Service#create}.\n * @exports rpc.Service\n * @extends util.EventEmitter\n * @constructor\n * @param {RPCImpl} rpcImpl RPC implementation\n * @param {boolean} [requestDelimited=false] Whether requests are length-delimited\n * @param {boolean} [responseDelimited=false] Whether responses are length-delimited\n */\nfunction Service(rpcImpl, requestDelimited, responseDelimited) {\n\n    if (typeof rpcImpl !== \"function\")\n        throw TypeError(\"rpcImpl must be a function\");\n\n    util.EventEmitter.call(this);\n\n    /**\n     * RPC implementation. Becomes `null` once the service is ended.\n     * @type {RPCImpl|null}\n     */\n    this.rpcImpl = rpcImpl;\n\n    /**\n     * Whether requests are length-delimited.\n     * @type {boolean}\n     */\n    this.requestDelimited = Boolean(requestDelimited);\n\n    /**\n     * Whether responses are length-delimited.\n     * @type {boolean}\n     */\n    this.responseDelimited = Boolean(responseDelimited);\n}\n\n/**\n * Calls a service method through {@link rpc.Service#rpcImpl|rpcImpl}.\n * @param {Method|rpc.ServiceMethod<TReq,TRes>} method Reflected or static method\n * @param {Constructor<TReq>} requestCtor Request constructor\n * @param {Constructor<TRes>} responseCtor Response constructor\n * @param {TReq|Properties<TReq>} request Request message or plain object\n * @param {rpc.ServiceMethodCallback<TRes>} callback Service callback\n * @returns {undefined}\n * @template TReq extends Message<TReq>\n * @template TRes extends Message<TRes>\n */\nService.prototype.rpcCall = function rpcCall(method, requestCtor, responseCtor, request, callback) {\n\n    if (!request)\n        throw TypeError(\"request must be specified\");\n\n    var self = this;\n    if (!callback)\n        return util.asPromise(rpcCall, self, method, requestCtor, responseCtor, request);\n\n    if (!self.rpcImpl) {\n        setTimeout(function() { callback(Error(\"already ended\")); }, 0);\n        return undefined;\n    }\n\n    try {\n        return self.rpcImpl(\n            method,\n            requestCtor[self.requestDelimited ? \"encodeDelimited\" : \"encode\"](request).finish(),\n            function rpcCallback(err, response) {\n\n                if (err) {\n                    self.emit(\"error\", err, method);\n                    return callback(err);\n                }\n\n                if (response === null) {\n                    self.end(/* endedByRPC */ true);\n                    return undefined;\n                }\n\n                if (!(response instanceof responseCtor)) {\n                    try {\n                        response = responseCtor[self.responseDelimited ? \"decodeDelimited\" : \"decode\"](response);\n                    } catch (err) {\n                        self.emit(\"error\", err, method);\n                        return callback(err);\n                    }\n                }\n\n                self.emit(\"data\", response, method);\n                return callback(null, response);\n            }\n        );\n    } catch (err) {\n        self.emit(\"error\", err, method);\n        setTimeout(function() { callback(err); }, 0);\n        return undefined;\n    }\n};\n\n/**\n * Ends this service and emits the `end` event.\n * @param {boolean} [endedByRPC=false] Whether the service has been ended by the RPC implementation.\n * @returns {rpc.Service} `this`\n */\nService.prototype.end = function end(endedByRPC) {\n    if (this.rpcImpl) {\n        if (!endedByRPC) // signal end to rpcImpl\n            this.rpcImpl(null, null, null);\n        this.rpcImpl = null;\n        this.emit(\"end\").off();\n    }\n    return this;\n};\n","\"use strict\";\nmodule.exports = LongBits;\n\nvar util = require(\"../util/minimal\");\n\n/**\n * Constructs new long bits.\n * @classdesc Helper class for working with the low and high bits of a 64 bit value.\n * @memberof util\n * @constructor\n * @param {number} lo Low 32 bits, unsigned\n * @param {number} hi High 32 bits, unsigned\n */\nfunction LongBits(lo, hi) {\n\n    // note that the casts below are theoretically unnecessary as of today, but older statically\n    // generated converter code might still call the ctor with signed 32bits. kept for compat.\n\n    /**\n     * Low bits.\n     * @type {number}\n     */\n    this.lo = lo >>> 0;\n\n    /**\n     * High bits.\n     * @type {number}\n     */\n    this.hi = hi >>> 0;\n}\n\n/**\n * Zero bits.\n * @memberof util.LongBits\n * @type {util.LongBits}\n */\nvar zero = LongBits.zero = new LongBits(0, 0);\n\nzero.toNumber = function() { return 0; };\nzero.zzEncode = zero.zzDecode = function() { return this; };\nzero.length = function() { return 1; };\n\n/**\n * Zero hash.\n * @memberof util.LongBits\n * @type {string}\n */\nvar zeroHash = LongBits.zeroHash = \"\\0\\0\\0\\0\\0\\0\\0\\0\";\n\n/**\n * Constructs new long bits from the specified number.\n * @param {number} value Value\n * @returns {util.LongBits} Instance\n */\nLongBits.fromNumber = function fromNumber(value) {\n    if (value === 0)\n        return zero;\n    var sign = value < 0;\n    if (sign)\n        value = -value;\n    var lo = value >>> 0,\n        hi = (value - lo) / 4294967296 >>> 0;\n    if (sign) {\n        hi = ~hi >>> 0;\n        lo = ~lo >>> 0;\n        if (++lo > 4294967295) {\n            lo = 0;\n            if (++hi > 4294967295)\n                hi = 0;\n        }\n    }\n    return new LongBits(lo, hi);\n};\n\n/**\n * Constructs new long bits from a number, long or string.\n * @param {Long|number|string} value Value\n * @returns {util.LongBits} Instance\n */\nLongBits.from = function from(value) {\n    if (typeof value === \"number\")\n        return LongBits.fromNumber(value);\n    if (util.isString(value)) {\n        /* istanbul ignore else */\n        if (util.Long)\n            value = util.Long.fromString(value);\n        else\n            return LongBits.fromNumber(parseInt(value, 10));\n    }\n    return value.low || value.high ? new LongBits(value.low >>> 0, value.high >>> 0) : zero;\n};\n\n/**\n * Converts this long bits to a possibly unsafe JavaScript number.\n * @param {boolean} [unsigned=false] Whether unsigned or not\n * @returns {number} Possibly unsafe number\n */\nLongBits.prototype.toNumber = function toNumber(unsigned) {\n    if (!unsigned && this.hi >>> 31) {\n        var lo = ~this.lo + 1 >>> 0,\n            hi = ~this.hi     >>> 0;\n        if (!lo)\n            hi = hi + 1 >>> 0;\n        return -(lo + hi * 4294967296);\n    }\n    return this.lo + this.hi * 4294967296;\n};\n\n/**\n * Converts this long bits to a long.\n * @param {boolean} [unsigned=false] Whether unsigned or not\n * @returns {Long} Long\n */\nLongBits.prototype.toLong = function toLong(unsigned) {\n    return util.Long\n        ? new util.Long(this.lo | 0, this.hi | 0, Boolean(unsigned))\n        /* istanbul ignore next */\n        : { low: this.lo | 0, high: this.hi | 0, unsigned: Boolean(unsigned) };\n};\n\nvar charCodeAt = String.prototype.charCodeAt;\n\n/**\n * Constructs new long bits from the specified 8 characters long hash.\n * @param {string} hash Hash\n * @returns {util.LongBits} Bits\n */\nLongBits.fromHash = function fromHash(hash) {\n    if (hash === zeroHash)\n        return zero;\n    return new LongBits(\n        ( charCodeAt.call(hash, 0)\n        | charCodeAt.call(hash, 1) << 8\n        | charCodeAt.call(hash, 2) << 16\n        | charCodeAt.call(hash, 3) << 24) >>> 0\n    ,\n        ( charCodeAt.call(hash, 4)\n        | charCodeAt.call(hash, 5) << 8\n        | charCodeAt.call(hash, 6) << 16\n        | charCodeAt.call(hash, 7) << 24) >>> 0\n    );\n};\n\n/**\n * Converts this long bits to a 8 characters long hash.\n * @returns {string} Hash\n */\nLongBits.prototype.toHash = function toHash() {\n    return String.fromCharCode(\n        this.lo        & 255,\n        this.lo >>> 8  & 255,\n        this.lo >>> 16 & 255,\n        this.lo >>> 24      ,\n        this.hi        & 255,\n        this.hi >>> 8  & 255,\n        this.hi >>> 16 & 255,\n        this.hi >>> 24\n    );\n};\n\n/**\n * Zig-zag encodes this long bits.\n * @returns {util.LongBits} `this`\n */\nLongBits.prototype.zzEncode = function zzEncode() {\n    var mask =   this.hi >> 31;\n    this.hi  = ((this.hi << 1 | this.lo >>> 31) ^ mask) >>> 0;\n    this.lo  = ( this.lo << 1                   ^ mask) >>> 0;\n    return this;\n};\n\n/**\n * Zig-zag decodes this long bits.\n * @returns {util.LongBits} `this`\n */\nLongBits.prototype.zzDecode = function zzDecode() {\n    var mask = -(this.lo & 1);\n    this.lo  = ((this.lo >>> 1 | this.hi << 31) ^ mask) >>> 0;\n    this.hi  = ( this.hi >>> 1                  ^ mask) >>> 0;\n    return this;\n};\n\n/**\n * Calculates the length of this longbits when encoded as a varint.\n * @returns {number} Length\n */\nLongBits.prototype.length = function length() {\n    var part0 =  this.lo,\n        part1 = (this.lo >>> 28 | this.hi << 4) >>> 0,\n        part2 =  this.hi >>> 24;\n    return part2 === 0\n         ? part1 === 0\n           ? part0 < 16384\n             ? part0 < 128 ? 1 : 2\n             : part0 < 2097152 ? 3 : 4\n           : part1 < 16384\n             ? part1 < 128 ? 5 : 6\n             : part1 < 2097152 ? 7 : 8\n         : part2 < 128 ? 9 : 10;\n};\n","\"use strict\";\nvar util = exports;\n\n// used to return a Promise where callback is omitted\nutil.asPromise = require(\"@protobufjs/aspromise\");\n\n// converts to / from base64 encoded strings\nutil.base64 = require(\"@protobufjs/base64\");\n\n// base class of rpc.Service\nutil.EventEmitter = require(\"@protobufjs/eventemitter\");\n\n// float handling accross browsers\nutil.float = require(\"@protobufjs/float\");\n\n// requires modules optionally and hides the call from bundlers\nutil.inquire = require(\"@protobufjs/inquire\");\n\n// converts to / from utf8 encoded strings\nutil.utf8 = require(\"@protobufjs/utf8\");\n\n// provides a node-like buffer pool in the browser\nutil.pool = require(\"@protobufjs/pool\");\n\n// utility to work with the low and high bits of a 64 bit value\nutil.LongBits = require(\"./longbits\");\n\n/**\n * Whether running within node or not.\n * @memberof util\n * @type {boolean}\n */\nutil.isNode = Boolean(typeof global !== \"undefined\"\n                   && global\n                   && global.process\n                   && global.process.versions\n                   && global.process.versions.node);\n\n/**\n * Global object reference.\n * @memberof util\n * @type {Object}\n */\nutil.global = util.isNode && global\n           || typeof window !== \"undefined\" && window\n           || typeof self   !== \"undefined\" && self\n           || this; // eslint-disable-line no-invalid-this\n\n/**\n * An immuable empty array.\n * @memberof util\n * @type {Array.<*>}\n * @const\n */\nutil.emptyArray = Object.freeze ? Object.freeze([]) : /* istanbul ignore next */ []; // used on prototypes\n\n/**\n * An immutable empty object.\n * @type {Object}\n * @const\n */\nutil.emptyObject = Object.freeze ? Object.freeze({}) : /* istanbul ignore next */ {}; // used on prototypes\n\n/**\n * Tests if the specified value is an integer.\n * @function\n * @param {*} value Value to test\n * @returns {boolean} `true` if the value is an integer\n */\nutil.isInteger = Number.isInteger || /* istanbul ignore next */ function isInteger(value) {\n    return typeof value === \"number\" && isFinite(value) && Math.floor(value) === value;\n};\n\n/**\n * Tests if the specified value is a string.\n * @param {*} value Value to test\n * @returns {boolean} `true` if the value is a string\n */\nutil.isString = function isString(value) {\n    return typeof value === \"string\" || value instanceof String;\n};\n\n/**\n * Tests if the specified value is a non-null object.\n * @param {*} value Value to test\n * @returns {boolean} `true` if the value is a non-null object\n */\nutil.isObject = function isObject(value) {\n    return value && typeof value === \"object\";\n};\n\n/**\n * Checks if a property on a message is considered to be present.\n * This is an alias of {@link util.isSet}.\n * @function\n * @param {Object} obj Plain object or message instance\n * @param {string} prop Property name\n * @returns {boolean} `true` if considered to be present, otherwise `false`\n */\nutil.isset =\n\n/**\n * Checks if a property on a message is considered to be present.\n * @param {Object} obj Plain object or message instance\n * @param {string} prop Property name\n * @returns {boolean} `true` if considered to be present, otherwise `false`\n */\nutil.isSet = function isSet(obj, prop) {\n    var value = obj[prop];\n    if (value != null && obj.hasOwnProperty(prop)) // eslint-disable-line eqeqeq, no-prototype-builtins\n        return typeof value !== \"object\" || (Array.isArray(value) ? value.length : Object.keys(value).length) > 0;\n    return false;\n};\n\n/**\n * Any compatible Buffer instance.\n * This is a minimal stand-alone definition of a Buffer instance. The actual type is that exported by node's typings.\n * @interface Buffer\n * @extends Uint8Array\n */\n\n/**\n * Node's Buffer class if available.\n * @type {Constructor<Buffer>}\n */\nutil.Buffer = (function() {\n    try {\n        var Buffer = util.inquire(\"buffer\").Buffer;\n        // refuse to use non-node buffers if not explicitly assigned (perf reasons):\n        return Buffer.prototype.utf8Write ? Buffer : /* istanbul ignore next */ null;\n    } catch (e) {\n        /* istanbul ignore next */\n        return null;\n    }\n})();\n\n// Internal alias of or polyfull for Buffer.from.\nutil._Buffer_from = null;\n\n// Internal alias of or polyfill for Buffer.allocUnsafe.\nutil._Buffer_allocUnsafe = null;\n\n/**\n * Creates a new buffer of whatever type supported by the environment.\n * @param {number|number[]} [sizeOrArray=0] Buffer size or number array\n * @returns {Uint8Array|Buffer} Buffer\n */\nutil.newBuffer = function newBuffer(sizeOrArray) {\n    /* istanbul ignore next */\n    return typeof sizeOrArray === \"number\"\n        ? util.Buffer\n            ? util._Buffer_allocUnsafe(sizeOrArray)\n            : new util.Array(sizeOrArray)\n        : util.Buffer\n            ? util._Buffer_from(sizeOrArray)\n            : typeof Uint8Array === \"undefined\"\n                ? sizeOrArray\n                : new Uint8Array(sizeOrArray);\n};\n\n/**\n * Array implementation used in the browser. `Uint8Array` if supported, otherwise `Array`.\n * @type {Constructor<Uint8Array>}\n */\nutil.Array = typeof Uint8Array !== \"undefined\" ? Uint8Array /* istanbul ignore next */ : Array;\n\n/**\n * Any compatible Long instance.\n * This is a minimal stand-alone definition of a Long instance. The actual type is that exported by long.js.\n * @interface Long\n * @property {number} low Low bits\n * @property {number} high High bits\n * @property {boolean} unsigned Whether unsigned or not\n */\n\n/**\n * Long.js's Long class if available.\n * @type {Constructor<Long>}\n */\nutil.Long = /* istanbul ignore next */ util.global.dcodeIO && /* istanbul ignore next */ util.global.dcodeIO.Long\n         || /* istanbul ignore next */ util.global.Long\n         || util.inquire(\"long\");\n\n/**\n * Regular expression used to verify 2 bit (`bool`) map keys.\n * @type {RegExp}\n * @const\n */\nutil.key2Re = /^true|false|0|1$/;\n\n/**\n * Regular expression used to verify 32 bit (`int32` etc.) map keys.\n * @type {RegExp}\n * @const\n */\nutil.key32Re = /^-?(?:0|[1-9][0-9]*)$/;\n\n/**\n * Regular expression used to verify 64 bit (`int64` etc.) map keys.\n * @type {RegExp}\n * @const\n */\nutil.key64Re = /^(?:[\\\\x00-\\\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;\n\n/**\n * Converts a number or long to an 8 characters long hash string.\n * @param {Long|number} value Value to convert\n * @returns {string} Hash\n */\nutil.longToHash = function longToHash(value) {\n    return value\n        ? util.LongBits.from(value).toHash()\n        : util.LongBits.zeroHash;\n};\n\n/**\n * Converts an 8 characters long hash string to a long or number.\n * @param {string} hash Hash\n * @param {boolean} [unsigned=false] Whether unsigned or not\n * @returns {Long|number} Original value\n */\nutil.longFromHash = function longFromHash(hash, unsigned) {\n    var bits = util.LongBits.fromHash(hash);\n    if (util.Long)\n        return util.Long.fromBits(bits.lo, bits.hi, unsigned);\n    return bits.toNumber(Boolean(unsigned));\n};\n\n/**\n * Merges the properties of the source object into the destination object.\n * @memberof util\n * @param {Object.<string,*>} dst Destination object\n * @param {Object.<string,*>} src Source object\n * @param {boolean} [ifNotSet=false] Merges only if the key is not already set\n * @returns {Object.<string,*>} Destination object\n */\nfunction merge(dst, src, ifNotSet) { // used by converters\n    for (var keys = Object.keys(src), i = 0; i < keys.length; ++i)\n        if (dst[keys[i]] === undefined || !ifNotSet)\n            dst[keys[i]] = src[keys[i]];\n    return dst;\n}\n\nutil.merge = merge;\n\n/**\n * Converts the first character of a string to lower case.\n * @param {string} str String to convert\n * @returns {string} Converted string\n */\nutil.lcFirst = function lcFirst(str) {\n    return str.charAt(0).toLowerCase() + str.substring(1);\n};\n\n/**\n * Creates a custom error constructor.\n * @memberof util\n * @param {string} name Error name\n * @returns {Constructor<Error>} Custom error constructor\n */\nfunction newError(name) {\n\n    function CustomError(message, properties) {\n\n        if (!(this instanceof CustomError))\n            return new CustomError(message, properties);\n\n        // Error.call(this, message);\n        // ^ just returns a new error instance because the ctor can be called as a function\n\n        Object.defineProperty(this, \"message\", { get: function() { return message; } });\n\n        /* istanbul ignore next */\n        if (Error.captureStackTrace) // node\n            Error.captureStackTrace(this, CustomError);\n        else\n            Object.defineProperty(this, \"stack\", { value: new Error().stack || \"\" });\n\n        if (properties)\n            merge(this, properties);\n    }\n\n    (CustomError.prototype = Object.create(Error.prototype)).constructor = CustomError;\n\n    Object.defineProperty(CustomError.prototype, \"name\", { get: function() { return name; } });\n\n    CustomError.prototype.toString = function toString() {\n        return this.name + \": \" + this.message;\n    };\n\n    return CustomError;\n}\n\nutil.newError = newError;\n\n/**\n * Constructs a new protocol error.\n * @classdesc Error subclass indicating a protocol specifc error.\n * @memberof util\n * @extends Error\n * @template T extends Message<T>\n * @constructor\n * @param {string} message Error message\n * @param {Object.<string,*>} [properties] Additional properties\n * @example\n * try {\n *     MyMessage.decode(someBuffer); // throws if required fields are missing\n * } catch (e) {\n *     if (e instanceof ProtocolError && e.instance)\n *         console.log(\"decoded so far: \" + JSON.stringify(e.instance));\n * }\n */\nutil.ProtocolError = newError(\"ProtocolError\");\n\n/**\n * So far decoded message instance.\n * @name util.ProtocolError#instance\n * @type {Message<T>}\n */\n\n/**\n * A OneOf getter as returned by {@link util.oneOfGetter}.\n * @typedef OneOfGetter\n * @type {function}\n * @returns {string|undefined} Set field name, if any\n */\n\n/**\n * Builds a getter for a oneof's present field name.\n * @param {string[]} fieldNames Field names\n * @returns {OneOfGetter} Unbound getter\n */\nutil.oneOfGetter = function getOneOf(fieldNames) {\n    var fieldMap = {};\n    for (var i = 0; i < fieldNames.length; ++i)\n        fieldMap[fieldNames[i]] = 1;\n\n    /**\n     * @returns {string|undefined} Set field name, if any\n     * @this Object\n     * @ignore\n     */\n    return function() { // eslint-disable-line consistent-return\n        for (var keys = Object.keys(this), i = keys.length - 1; i > -1; --i)\n            if (fieldMap[keys[i]] === 1 && this[keys[i]] !== undefined && this[keys[i]] !== null)\n                return keys[i];\n    };\n};\n\n/**\n * A OneOf setter as returned by {@link util.oneOfSetter}.\n * @typedef OneOfSetter\n * @type {function}\n * @param {string|undefined} value Field name\n * @returns {undefined}\n */\n\n/**\n * Builds a setter for a oneof's present field name.\n * @param {string[]} fieldNames Field names\n * @returns {OneOfSetter} Unbound setter\n */\nutil.oneOfSetter = function setOneOf(fieldNames) {\n\n    /**\n     * @param {string} name Field name\n     * @returns {undefined}\n     * @this Object\n     * @ignore\n     */\n    return function(name) {\n        for (var i = 0; i < fieldNames.length; ++i)\n            if (fieldNames[i] !== name)\n                delete this[fieldNames[i]];\n    };\n};\n\n/**\n * Default conversion options used for {@link Message#toJSON} implementations.\n *\n * These options are close to proto3's JSON mapping with the exception that internal types like Any are handled just like messages. More precisely:\n *\n * - Longs become strings\n * - Enums become string keys\n * - Bytes become base64 encoded strings\n * - (Sub-)Messages become plain objects\n * - Maps become plain objects with all string keys\n * - Repeated fields become arrays\n * - NaN and Infinity for float and double fields become strings\n *\n * @type {IConversionOptions}\n * @see https://developers.google.com/protocol-buffers/docs/proto3?hl=en#json\n */\nutil.toJSONOptions = {\n    longs: String,\n    enums: String,\n    bytes: String,\n    json: true\n};\n\n// Sets up buffer utility according to the environment (called in index-minimal)\nutil._configure = function() {\n    var Buffer = util.Buffer;\n    /* istanbul ignore if */\n    if (!Buffer) {\n        util._Buffer_from = util._Buffer_allocUnsafe = null;\n        return;\n    }\n    // because node 4.x buffers are incompatible & immutable\n    // see: https://github.com/dcodeIO/protobuf.js/pull/665\n    util._Buffer_from = Buffer.from !== Uint8Array.from && Buffer.from ||\n        /* istanbul ignore next */\n        function Buffer_from(value, encoding) {\n            return new Buffer(value, encoding);\n        };\n    util._Buffer_allocUnsafe = Buffer.allocUnsafe ||\n        /* istanbul ignore next */\n        function Buffer_allocUnsafe(size) {\n            return new Buffer(size);\n        };\n};\n","\"use strict\";\nmodule.exports = Writer;\n\nvar util      = require(\"./util/minimal\");\n\nvar BufferWriter; // cyclic\n\nvar LongBits  = util.LongBits,\n    base64    = util.base64,\n    utf8      = util.utf8;\n\n/**\n * Constructs a new writer operation instance.\n * @classdesc Scheduled writer operation.\n * @constructor\n * @param {function(*, Uint8Array, number)} fn Function to call\n * @param {number} len Value byte length\n * @param {*} val Value to write\n * @ignore\n */\nfunction Op(fn, len, val) {\n\n    /**\n     * Function to call.\n     * @type {function(Uint8Array, number, *)}\n     */\n    this.fn = fn;\n\n    /**\n     * Value byte length.\n     * @type {number}\n     */\n    this.len = len;\n\n    /**\n     * Next operation.\n     * @type {Writer.Op|undefined}\n     */\n    this.next = undefined;\n\n    /**\n     * Value to write.\n     * @type {*}\n     */\n    this.val = val; // type varies\n}\n\n/* istanbul ignore next */\nfunction noop() {} // eslint-disable-line no-empty-function\n\n/**\n * Constructs a new writer state instance.\n * @classdesc Copied writer state.\n * @memberof Writer\n * @constructor\n * @param {Writer} writer Writer to copy state from\n * @ignore\n */\nfunction State(writer) {\n\n    /**\n     * Current head.\n     * @type {Writer.Op}\n     */\n    this.head = writer.head;\n\n    /**\n     * Current tail.\n     * @type {Writer.Op}\n     */\n    this.tail = writer.tail;\n\n    /**\n     * Current buffer length.\n     * @type {number}\n     */\n    this.len = writer.len;\n\n    /**\n     * Next state.\n     * @type {State|null}\n     */\n    this.next = writer.states;\n}\n\n/**\n * Constructs a new writer instance.\n * @classdesc Wire format writer using `Uint8Array` if available, otherwise `Array`.\n * @constructor\n */\nfunction Writer() {\n\n    /**\n     * Current length.\n     * @type {number}\n     */\n    this.len = 0;\n\n    /**\n     * Operations head.\n     * @type {Object}\n     */\n    this.head = new Op(noop, 0, 0);\n\n    /**\n     * Operations tail\n     * @type {Object}\n     */\n    this.tail = this.head;\n\n    /**\n     * Linked forked states.\n     * @type {Object|null}\n     */\n    this.states = null;\n\n    // When a value is written, the writer calculates its byte length and puts it into a linked\n    // list of operations to perform when finish() is called. This both allows us to allocate\n    // buffers of the exact required size and reduces the amount of work we have to do compared\n    // to first calculating over objects and then encoding over objects. In our case, the encoding\n    // part is just a linked list walk calling operations with already prepared values.\n}\n\nvar create = function create() {\n    return util.Buffer\n        ? function create_buffer_setup() {\n            return (Writer.create = function create_buffer() {\n                return new BufferWriter();\n            })();\n        }\n        /* istanbul ignore next */\n        : function create_array() {\n            return new Writer();\n        };\n};\n\n/**\n * Creates a new writer.\n * @function\n * @returns {BufferWriter|Writer} A {@link BufferWriter} when Buffers are supported, otherwise a {@link Writer}\n */\nWriter.create = create();\n\n/**\n * Allocates a buffer of the specified size.\n * @param {number} size Buffer size\n * @returns {Uint8Array} Buffer\n */\nWriter.alloc = function alloc(size) {\n    return new util.Array(size);\n};\n\n// Use Uint8Array buffer pool in the browser, just like node does with buffers\n/* istanbul ignore else */\nif (util.Array !== Array)\n    Writer.alloc = util.pool(Writer.alloc, util.Array.prototype.subarray);\n\n/**\n * Pushes a new operation to the queue.\n * @param {function(Uint8Array, number, *)} fn Function to call\n * @param {number} len Value byte length\n * @param {number} val Value to write\n * @returns {Writer} `this`\n * @private\n */\nWriter.prototype._push = function push(fn, len, val) {\n    this.tail = this.tail.next = new Op(fn, len, val);\n    this.len += len;\n    return this;\n};\n\nfunction writeByte(val, buf, pos) {\n    buf[pos] = val & 255;\n}\n\nfunction writeVarint32(val, buf, pos) {\n    while (val > 127) {\n        buf[pos++] = val & 127 | 128;\n        val >>>= 7;\n    }\n    buf[pos] = val;\n}\n\n/**\n * Constructs a new varint writer operation instance.\n * @classdesc Scheduled varint writer operation.\n * @extends Op\n * @constructor\n * @param {number} len Value byte length\n * @param {number} val Value to write\n * @ignore\n */\nfunction VarintOp(len, val) {\n    this.len = len;\n    this.next = undefined;\n    this.val = val;\n}\n\nVarintOp.prototype = Object.create(Op.prototype);\nVarintOp.prototype.fn = writeVarint32;\n\n/**\n * Writes an unsigned 32 bit value as a varint.\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.uint32 = function write_uint32(value) {\n    // here, the call to this.push has been inlined and a varint specific Op subclass is used.\n    // uint32 is by far the most frequently used operation and benefits significantly from this.\n    this.len += (this.tail = this.tail.next = new VarintOp(\n        (value = value >>> 0)\n                < 128       ? 1\n        : value < 16384     ? 2\n        : value < 2097152   ? 3\n        : value < 268435456 ? 4\n        :                     5,\n    value)).len;\n    return this;\n};\n\n/**\n * Writes a signed 32 bit value as a varint.\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.int32 = function write_int32(value) {\n    return value < 0\n        ? this._push(writeVarint64, 10, LongBits.fromNumber(value)) // 10 bytes per spec\n        : this.uint32(value);\n};\n\n/**\n * Writes a 32 bit value as a varint, zig-zag encoded.\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.sint32 = function write_sint32(value) {\n    return this.uint32((value << 1 ^ value >> 31) >>> 0);\n};\n\nfunction writeVarint64(val, buf, pos) {\n    while (val.hi) {\n        buf[pos++] = val.lo & 127 | 128;\n        val.lo = (val.lo >>> 7 | val.hi << 25) >>> 0;\n        val.hi >>>= 7;\n    }\n    while (val.lo > 127) {\n        buf[pos++] = val.lo & 127 | 128;\n        val.lo = val.lo >>> 7;\n    }\n    buf[pos++] = val.lo;\n}\n\n/**\n * Writes an unsigned 64 bit value as a varint.\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.uint64 = function write_uint64(value) {\n    var bits = LongBits.from(value);\n    return this._push(writeVarint64, bits.length(), bits);\n};\n\n/**\n * Writes a signed 64 bit value as a varint.\n * @function\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.int64 = Writer.prototype.uint64;\n\n/**\n * Writes a signed 64 bit value as a varint, zig-zag encoded.\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.sint64 = function write_sint64(value) {\n    var bits = LongBits.from(value).zzEncode();\n    return this._push(writeVarint64, bits.length(), bits);\n};\n\n/**\n * Writes a boolish value as a varint.\n * @param {boolean} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.bool = function write_bool(value) {\n    return this._push(writeByte, 1, value ? 1 : 0);\n};\n\nfunction writeFixed32(val, buf, pos) {\n    buf[pos    ] =  val         & 255;\n    buf[pos + 1] =  val >>> 8   & 255;\n    buf[pos + 2] =  val >>> 16  & 255;\n    buf[pos + 3] =  val >>> 24;\n}\n\n/**\n * Writes an unsigned 32 bit value as fixed 32 bits.\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.fixed32 = function write_fixed32(value) {\n    return this._push(writeFixed32, 4, value >>> 0);\n};\n\n/**\n * Writes a signed 32 bit value as fixed 32 bits.\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.sfixed32 = Writer.prototype.fixed32;\n\n/**\n * Writes an unsigned 64 bit value as fixed 64 bits.\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.fixed64 = function write_fixed64(value) {\n    var bits = LongBits.from(value);\n    return this._push(writeFixed32, 4, bits.lo)._push(writeFixed32, 4, bits.hi);\n};\n\n/**\n * Writes a signed 64 bit value as fixed 64 bits.\n * @function\n * @param {Long|number|string} value Value to write\n * @returns {Writer} `this`\n * @throws {TypeError} If `value` is a string and no long library is present.\n */\nWriter.prototype.sfixed64 = Writer.prototype.fixed64;\n\n/**\n * Writes a float (32 bit).\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.float = function write_float(value) {\n    return this._push(util.float.writeFloatLE, 4, value);\n};\n\n/**\n * Writes a double (64 bit float).\n * @function\n * @param {number} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.double = function write_double(value) {\n    return this._push(util.float.writeDoubleLE, 8, value);\n};\n\nvar writeBytes = util.Array.prototype.set\n    ? function writeBytes_set(val, buf, pos) {\n        buf.set(val, pos); // also works for plain array values\n    }\n    /* istanbul ignore next */\n    : function writeBytes_for(val, buf, pos) {\n        for (var i = 0; i < val.length; ++i)\n            buf[pos + i] = val[i];\n    };\n\n/**\n * Writes a sequence of bytes.\n * @param {Uint8Array|string} value Buffer or base64 encoded string to write\n * @returns {Writer} `this`\n */\nWriter.prototype.bytes = function write_bytes(value) {\n    var len = value.length >>> 0;\n    if (!len)\n        return this._push(writeByte, 1, 0);\n    if (util.isString(value)) {\n        var buf = Writer.alloc(len = base64.length(value));\n        base64.decode(value, buf, 0);\n        value = buf;\n    }\n    return this.uint32(len)._push(writeBytes, len, value);\n};\n\n/**\n * Writes a string.\n * @param {string} value Value to write\n * @returns {Writer} `this`\n */\nWriter.prototype.string = function write_string(value) {\n    var len = utf8.length(value);\n    return len\n        ? this.uint32(len)._push(utf8.write, len, value)\n        : this._push(writeByte, 1, 0);\n};\n\n/**\n * Forks this writer's state by pushing it to a stack.\n * Calling {@link Writer#reset|reset} or {@link Writer#ldelim|ldelim} resets the writer to the previous state.\n * @returns {Writer} `this`\n */\nWriter.prototype.fork = function fork() {\n    this.states = new State(this);\n    this.head = this.tail = new Op(noop, 0, 0);\n    this.len = 0;\n    return this;\n};\n\n/**\n * Resets this instance to the last state.\n * @returns {Writer} `this`\n */\nWriter.prototype.reset = function reset() {\n    if (this.states) {\n        this.head   = this.states.head;\n        this.tail   = this.states.tail;\n        this.len    = this.states.len;\n        this.states = this.states.next;\n    } else {\n        this.head = this.tail = new Op(noop, 0, 0);\n        this.len  = 0;\n    }\n    return this;\n};\n\n/**\n * Resets to the last state and appends the fork state's current write length as a varint followed by its operations.\n * @returns {Writer} `this`\n */\nWriter.prototype.ldelim = function ldelim() {\n    var head = this.head,\n        tail = this.tail,\n        len  = this.len;\n    this.reset().uint32(len);\n    if (len) {\n        this.tail.next = head.next; // skip noop\n        this.tail = tail;\n        this.len += len;\n    }\n    return this;\n};\n\n/**\n * Finishes the write operation.\n * @returns {Uint8Array} Finished buffer\n */\nWriter.prototype.finish = function finish() {\n    var head = this.head.next, // skip noop\n        buf  = this.constructor.alloc(this.len),\n        pos  = 0;\n    while (head) {\n        head.fn(head.val, buf, pos);\n        pos += head.len;\n        head = head.next;\n    }\n    // this.head = this.tail = null;\n    return buf;\n};\n\nWriter._configure = function(BufferWriter_) {\n    BufferWriter = BufferWriter_;\n    Writer.create = create();\n    BufferWriter._configure();\n};\n","\"use strict\";\nmodule.exports = BufferWriter;\n\n// extends Writer\nvar Writer = require(\"./writer\");\n(BufferWriter.prototype = Object.create(Writer.prototype)).constructor = BufferWriter;\n\nvar util = require(\"./util/minimal\");\n\n/**\n * Constructs a new buffer writer instance.\n * @classdesc Wire format writer using node buffers.\n * @extends Writer\n * @constructor\n */\nfunction BufferWriter() {\n    Writer.call(this);\n}\n\nBufferWriter._configure = function () {\n    /**\n     * Allocates a buffer of the specified size.\n     * @function\n     * @param {number} size Buffer size\n     * @returns {Buffer} Buffer\n     */\n    BufferWriter.alloc = util._Buffer_allocUnsafe;\n\n    BufferWriter.writeBytesBuffer = util.Buffer && util.Buffer.prototype instanceof Uint8Array && util.Buffer.prototype.set.name === \"set\"\n        ? function writeBytesBuffer_set(val, buf, pos) {\n          buf.set(val, pos); // faster than copy (requires node >= 4 where Buffers extend Uint8Array and set is properly inherited)\n          // also works for plain array values\n        }\n        /* istanbul ignore next */\n        : function writeBytesBuffer_copy(val, buf, pos) {\n          if (val.copy) // Buffer values\n            val.copy(buf, pos, 0, val.length);\n          else for (var i = 0; i < val.length;) // plain array values\n            buf[pos++] = val[i++];\n        };\n};\n\n\n/**\n * @override\n */\nBufferWriter.prototype.bytes = function write_bytes_buffer(value) {\n    if (util.isString(value))\n        value = util._Buffer_from(value, \"base64\");\n    var len = value.length >>> 0;\n    this.uint32(len);\n    if (len)\n        this._push(BufferWriter.writeBytesBuffer, len, value);\n    return this;\n};\n\nfunction writeStringBuffer(val, buf, pos) {\n    if (val.length < 40) // plain js is faster for short strings (probably due to redundant assertions)\n        util.utf8.write(val, buf, pos);\n    else if (buf.utf8Write)\n        buf.utf8Write(val, pos);\n    else\n        buf.write(val, pos);\n}\n\n/**\n * @override\n */\nBufferWriter.prototype.string = function write_string_buffer(value) {\n    var len = util.Buffer.byteLength(value);\n    this.uint32(len);\n    if (len)\n        this._push(writeStringBuffer, len, value);\n    return this;\n};\n\n\n/**\n * Finishes the write operation.\n * @name BufferWriter#finish\n * @function\n * @returns {Buffer} Finished buffer\n */\n\nBufferWriter._configure();\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport * from \"./lib/StyleSetEvaluator\";\r\nexport * from \"./lib/IMeshBuffers\";\r\nexport * from \"./lib/Outliner\";\r\nexport * from \"./lib/Expr\";\r\nexport * from \"./lib/ThreeBufferUtils\";\r\nexport * from \"./lib/GeoJsonDataType\";\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Components used for the decoding and styling of data that is used by the Datasources.\r\n *\r\n * @remarks\r\n * The DataSource Protocol package contains components used for the decoding and styling\r\n * of data that is used by the Datasources.\r\n * This code is shared between the ui-thread and the web-workers which are\r\n * used to parallelise the decoding of the data.\r\n * This module contains interfaces for choosing techniques form the techniques\r\n * catalog that are applied via the {@link Theme} files to draw geometries on the map canvas.\r\n *\r\n * @packageDocumentation\r\n */\r\n\r\nexport * from \"./lib/ColorUtils\";\r\nexport * from \"./lib/Expr\";\r\nexport * from \"./lib/Techniques\";\r\nexport * from \"./lib/TechniqueParams\";\r\nexport * from \"./lib/Theme\";\r\nexport * from \"./lib/PostEffects\";\r\nexport * from \"./lib/PropertyValue\";\r\nexport * from \"./lib/InterpolatedPropertyDefs\";\r\nexport * from \"./lib/WorkerServiceProtocol\";\r\nexport * from \"./lib/WorkerTilerProtocol\";\r\nexport * from \"./lib/WorkerDecoderProtocol\";\r\nexport * from \"./lib/ITileDecoder\";\r\nexport * from \"./lib/ITiler\";\r\nexport * from \"./lib/DecodedTile\";\r\nexport * from \"./lib/TileInfo\";\r\nexport * from \"./lib/GeoJsonDataType\";\r\nexport * from \"./lib/ThemeVisitor\";\r\nexport * from \"./lib/StringEncodedNumeral\";\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { assert } from \"@here/harp-utils\";\r\nimport * as THREE from \"three\";\r\n\r\nimport { RGBA } from \"./RGBA\";\r\n\r\nconst SHIFT_TRANSPARENCY: number = 24;\r\nconst SHIFT_RED: number = 16;\r\nconst SHIFT_GREEN: number = 8;\r\nconst SHIFT_BLUE: number = 0;\r\n\r\n//    Allow bitwise operations for colors decoding\r\n\r\nconst HEX_FULL_CHANNEL: number = 0xff;\r\nconst HEX_RGB_MASK: number = 0xffffff;\r\nconst HEX_TRGB_MASK: number = 0xffffffff;\r\n\r\nconst tmpColor = new THREE.Color();\r\n\r\n/**\r\n * Utilities to convert RGBA colors encoded in custom number (hex) format to THREE.Color objects.\r\n *\r\n * The functions provided allows for conversion from and to our custom number based color format,\r\n * which contains transparency, red, green and blue color channels in a way that each channel\r\n * occupies 8 bits of resulting number (color format 0xTTRRGGBB).\r\n * In order to preserve compatibility with THREE.Color class and its hexadecimal color\r\n * representation, we do not store __alpha__ channel in encoded color's number, but replace it\r\n * with __transparency__ channel, which is simply opposite to alpha:\r\n * ```transparency = 0xFF - alpha```\r\n * Such channel value is stored on the oldest bits (octet) in the integral color (numeric) value,\r\n * so it is fully compatible with THREE.Color numerical representation (@see [[THREE.Color.getHex]],\r\n * [[THREE.Color.setHex]]).\r\n * See also [[getHexFromRgba]] and [[getRgbaFromHex]] for more info about conversion.\r\n */\r\nexport namespace ColorUtils {\r\n    /**\r\n     * Encodes RGBA channels in custom number coded format (represented in hex as 0xTTRRGGBB).\r\n     *\r\n     * We do not use direct alpha channel mapping to hex in order to preserve compatibility\r\n     * with THREE.js color format (0xRRGGBB). This is done by encoding transparency\r\n     * (255 - alpha) instead of alpha on the oldest bits, shifted by [[SHIFT_TRANSPARENCY]].\r\n     * This way simple 0xRRGGBB color is equal to 0x00RRGGBB without transparency and\r\n     * color defining transparency (alpha < 255) is always recognizable by the oldest\r\n     * bit set:\r\n     * ```typescript\r\n     * (color >> SHIFT_TRANSPARENCY) !== 0.\r\n     * ```\r\n     * @note All input components are floating points in <0, 1> range (inclusively).\r\n     * @note Although method encodes transparency channel in single number value, it is still\r\n     * compatible with THREE.js number based color coding (0xRRGGBB), so you may pass this value to\r\n     * [[THREE.Color]] c-tor, but keep in mind that transparency will be silently ignored.\r\n     */\r\n    export function getHexFromRgba(r: number, g: number, b: number, a: number): number {\r\n        assert(a >= 0 && a <= 1);\r\n        const t = HEX_FULL_CHANNEL - Math.floor(a * HEX_FULL_CHANNEL);\r\n        return (\r\n            (t << SHIFT_TRANSPARENCY) ^\r\n            ((r * HEX_FULL_CHANNEL) << SHIFT_RED) ^\r\n            ((g * HEX_FULL_CHANNEL) << SHIFT_GREEN) ^\r\n            ((b * HEX_FULL_CHANNEL) << SHIFT_BLUE)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Encodes RGB all color channels in single number with format 0xRRGGBB.\r\n     *\r\n     * All input channels should be in <0, 1> range (inclusively).\r\n     * See also [[getHexFromRgba]] for more information about [[THREE.Color]] compatibility.\r\n     *\r\n     * @note This method is fully compatible with THREE.js color encoding, so\r\n     * you may pass this value directly to THREE.Color c-tor.\r\n     */\r\n    export function getHexFromRgb(r: number, g: number, b: number): number {\r\n        assert(r >= 0 && r <= 1);\r\n        assert(g >= 0 && g <= 1);\r\n        assert(b >= 0 && b <= 1);\r\n        return (\r\n            ((r * HEX_FULL_CHANNEL) << SHIFT_RED) ^\r\n            ((g * HEX_FULL_CHANNEL) << SHIFT_GREEN) ^\r\n            ((b * HEX_FULL_CHANNEL) << SHIFT_BLUE)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Encode and convert HSL value to number coded color format (0xRRGGBB).\r\n     *\r\n     * @see getHexFromRgb.\r\n     * @param h - Hue component value between 0 and 1.\r\n     * @param s - Saturation value between 0 and 1.\r\n     * @param l - Lightness channel between 0 and 1.\r\n     */\r\n    export function getHexFromHsl(h: number, s: number, l: number): number {\r\n        assert(h >= 0 && h <= 1);\r\n        assert(s >= 0 && s <= 1);\r\n        assert(l >= 0 && l <= 1);\r\n        return tmpColor.setHSL(h, s, l).getHex();\r\n    }\r\n\r\n    /**\r\n     * Retrieve RGBA channels separately from number encoded custom color format.\r\n     *\r\n     * Provides an easy way for channels extraction (r, g, b, a) from custom number coded color\r\n     * format.\r\n     *\r\n     * @see getHexFromRgba.\r\n     * @param hex - The number encoded color value (0xRRGGBB or 0xTTRRGGBB in hex).\r\n     * @returns r, g, b, a channels in simple object, where each channel value is saved as floating\r\n     * point from 0 to 1 inclusively.\r\n     */\r\n    export function getRgbaFromHex(hex: number, target = new RGBA()): RGBA {\r\n        assert((hex & ~HEX_TRGB_MASK) === 0, \"Wrong hex format\");\r\n        target.r = ((hex >> SHIFT_RED) & HEX_FULL_CHANNEL) / HEX_FULL_CHANNEL;\r\n        target.g = ((hex >> SHIFT_GREEN) & HEX_FULL_CHANNEL) / HEX_FULL_CHANNEL;\r\n        target.b = ((hex >> SHIFT_BLUE) & HEX_FULL_CHANNEL) / HEX_FULL_CHANNEL;\r\n        target.a =\r\n            (HEX_FULL_CHANNEL - ((hex >> SHIFT_TRANSPARENCY) & HEX_FULL_CHANNEL)) /\r\n            HEX_FULL_CHANNEL;\r\n        return target;\r\n    }\r\n\r\n    /**\r\n     * Determines if number encoded color contains alpha (opacity) defined and different then 255.\r\n     *\r\n     * @param hex - The number encoded color (0xRRGGBB or 0xTTRRGGBB in hex).\r\n     * @returns True if color has transparency defined.\r\n     */\r\n    export function hasAlphaInHex(hex: number): boolean {\r\n        assert((hex & ~HEX_TRGB_MASK) === 0, \"Wrong hex format\");\r\n        return hex >> SHIFT_TRANSPARENCY !== 0;\r\n    }\r\n\r\n    /**\r\n     * Retrieves alpha color channel from hex encoded color value.\r\n     *\r\n     * @see getHexFromRgba.\r\n     * @param hex - The number encoded color value (representable as 0xRRGGBB or 0xTTRRGGBB in hex).\r\n     * @returns The floating point alpha component in <0, 1> range.\r\n     */\r\n    export function getAlphaFromHex(hex: number): number {\r\n        assert((hex & ~HEX_TRGB_MASK) === 0, \"Wrong hex format\");\r\n        return (\r\n            ((HEX_FULL_CHANNEL - (hex >> SHIFT_TRANSPARENCY)) & HEX_FULL_CHANNEL) / HEX_FULL_CHANNEL\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Remove transparency info from the number coded color, makes it compatible with external libs.\r\n     *\r\n     * @see getAlphaFromHex.\r\n     * @param hex - The number encoded color value (representable as 0xRRGGBB or 0xTTRRGGBB in hex).\r\n     * @returns number coded color value representable as 0xRRGGBB in hex.\r\n     */\r\n    export function removeAlphaFromHex(hex: number): number {\r\n        assert((hex & ~HEX_TRGB_MASK) === 0, \"Wrong hex format\");\r\n        return hex & HEX_RGB_MASK;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport {\r\n    equirectangularProjection,\r\n    mercatorProjection,\r\n    normalizedEquirectangularProjection,\r\n    OrientedBox3,\r\n    Projection,\r\n    sphereProjection,\r\n    Vector3Like,\r\n    webMercatorProjection\r\n} from \"@here/harp-geoutils\";\r\n\r\nimport { Env } from \"./Expr\";\r\nimport { AttrEvaluationContext, evaluateTechniqueAttr } from \"./TechniqueAttr\";\r\nimport {\r\n    IndexedTechnique,\r\n    isLineMarkerTechnique,\r\n    isPoiTechnique,\r\n    isTextTechnique,\r\n    Technique\r\n} from \"./Techniques\";\r\nimport { TileInfo } from \"./TileInfo\";\r\n\r\n/**\r\n * This object has geometry data in the form of geometries buffers ready to be used by WebGL.\r\n * These geometries are not `three.js` objects. They are pure data stored as `ArrayBuffer`s and\r\n * metadata describing these buffers.\r\n */\r\nexport interface DecodedTile {\r\n    techniques: IndexedTechnique[];\r\n    geometries: Geometry[];\r\n    pathGeometries?: PathGeometry[];\r\n    textPathGeometries?: TextPathGeometry[];\r\n    textGeometries?: TextGeometry[]; // ### deprecate\r\n    poiGeometries?: PoiGeometry[];\r\n    tileInfo?: TileInfo;\r\n    decodeTime?: number; // time used to decode (in ms)\r\n\r\n    /**\r\n     * The default bounding box in [[Tile]] is based on the geo box of the tile.\r\n     * For data-sources that have 3d data this is not sufficient so the data-source can provide a\r\n     * more accurate bounding box once the data is decoded.\r\n     */\r\n    boundingBox?: OrientedBox3;\r\n\r\n    /**\r\n     * Data sources not defining a bounding box may define alternatively a maximum geometry height\r\n     * in meters. The bounding box of the resulting tile will be extended to encompass this height.\r\n     */\r\n    maxGeometryHeight?: number;\r\n\r\n    /**\r\n     * Data sources not defining a bounding box may define alternatively a minimum geometry height\r\n     * in meters. The bounding box of the resulting tile will be extended to encompass this height.\r\n     */\r\n    minGeometryHeight?: number;\r\n\r\n    /**\r\n     * Tile data Copyright holder identifiers.\r\n     *\r\n     * `id`s should be unique. It is recommended to build them from unique identifiers like\r\n     * registered domain names.\r\n     *\r\n     * @see [[CopyrightInfo]]\r\n     */\r\n    copyrightHolderIds?: string[];\r\n\r\n    /**\r\n     * List of {@link @here/harp-geoutils#TileKey}s stored as mortonCodes representing\r\n     * {@link @here/harp-mapview#Tile}s that have geometry covering this `Tile`.\r\n     */\r\n    dependencies?: number[];\r\n}\r\n\r\n/**\r\n * This object keeps the path of the geometry. Space of the path depends on the\r\n * use case, so could be either world or local tile space.\r\n */\r\nexport interface PathGeometry {\r\n    path: Vector3Like[];\r\n}\r\n\r\n/**\r\n * Attributes corresponding to some decoded geometry. It may be either a map\r\n * of multiple attributes or just a string with the geometry's feature id (id numbers are\r\n * deprecated).\r\n */\r\nexport type AttributeMap = {} | string | number;\r\n\r\n/**\r\n * This object keeps textual data together with metadata to place it on the map.\r\n */\r\nexport interface TextPathGeometry {\r\n    path: number[];\r\n    pathLengthSqr: number;\r\n    text: string;\r\n    technique: number;\r\n    objInfos?: AttributeMap;\r\n}\r\n\r\n/**\r\n * Returns an array with the data type specified as parameter.\r\n *\r\n * @param attr - specifies which type of data is being stored in the array\r\n */\r\nexport function getArrayConstructor(attr: BufferElementType) {\r\n    switch (attr) {\r\n        case \"float\":\r\n            return Float32Array;\r\n        case \"uint8\":\r\n            return Uint8Array;\r\n        case \"uint16\":\r\n            return Uint16Array;\r\n        case \"uint32\":\r\n            return Uint32Array;\r\n        case \"int8\":\r\n            return Int8Array;\r\n        case \"int16\":\r\n            return Int16Array;\r\n        case \"int32\":\r\n            return Int32Array;\r\n    }\r\n}\r\n\r\n/**\r\n * Structured clone compliant WebGL interleaved buffer with its metadata attached.\r\n */\r\nexport interface InterleavedBufferAttribute {\r\n    buffer: ArrayBufferLike;\r\n    stride: number;\r\n    type: BufferElementType;\r\n    attributes: Array<{\r\n        name: string;\r\n        itemSize: number;\r\n        offset: number;\r\n    }>;\r\n}\r\n\r\n/**\r\n * Geometry types supported by [[Geometry]] objects.\r\n */\r\nexport enum GeometryType {\r\n    Unspecified = 0,\r\n    Point,\r\n    Line,\r\n    SolidLine,\r\n    Text,\r\n    TextPath,\r\n    ExtrudedLine,\r\n    Polygon,\r\n    ExtrudedPolygon,\r\n    Object3D,\r\n    Other = 1000\r\n}\r\n\r\n/**\r\n * Structured clone compliant version of a `three.js` geometry object, consisting of buffers with\r\n * metadata for map features and objects for example roads, trees or parks.\r\n */\r\nexport interface Geometry {\r\n    type: GeometryType;\r\n    vertexAttributes?: BufferAttribute[];\r\n    interleavedVertexAttributes?: InterleavedBufferAttribute[];\r\n    index?: BufferAttribute;\r\n    edgeIndex?: BufferAttribute;\r\n    groups: Group[];\r\n    uuid?: string;\r\n\r\n    /**\r\n     * Optional sorted list of feature start indices. The indices point into the index attribute.\r\n     * Feature i starts at featureStarts[i] and ends at featureStarts[i+1]-1, except for the last\r\n     * feature, which ends at index[index.length-1].\r\n     */\r\n    featureStarts?: number[];\r\n\r\n    /**\r\n     * Optional sorted list of feature start indices for the outline geometry.\r\n     * Equivalent to {@link featureStarts} but pointing into the edgeIndex attribute.\r\n     */\r\n    edgeFeatureStarts?: number[];\r\n\r\n    /**\r\n     * Optional array of objects. It can be used to pass user data from the geometry to the mesh.\r\n     */\r\n    objInfos?: AttributeMap[];\r\n\r\n    /**\r\n     * Optional [[Array]] of [[Attachment]]s.\r\n     */\r\n    attachments?: Attachment[];\r\n}\r\n\r\n/**\r\n * Attachments together with [[Geometry]] define the meshes and the objects\r\n * of a [[Scene]].\r\n */\r\nexport interface Attachment {\r\n    /**\r\n     * The unique uuid of this [[Attachment]].\r\n     */\r\n    uuid?: string;\r\n\r\n    /**\r\n     * The name of this [[Attachment]].\r\n     */\r\n    name?: string;\r\n\r\n    /**\r\n     * The index [[BufferAttribute]]. If not provided the index\r\n     * buffer of the [[Geometry]] will be used.\r\n     */\r\n    index?: BufferAttribute;\r\n\r\n    /**\r\n     * Optional additional buffer index used to create an edge object.\r\n     */\r\n    edgeIndex?: BufferAttribute;\r\n\r\n    /**\r\n     * The draw [[Group]]]s of this [[Attachment]].\r\n     */\r\n    groups: Group[];\r\n}\r\n\r\n/**\r\n * The data stored in Buffers' elements can be of the following elementary types: float, signed or\r\n * unsigned integers (8-bit, 16-bit or 32-bit long).\r\n */\r\nexport type BufferElementType =\r\n    | \"float\"\r\n    | \"uint8\"\r\n    | \"uint16\"\r\n    | \"uint32\"\r\n    | \"int8\"\r\n    | \"int16\"\r\n    | \"int32\";\r\n\r\n/**\r\n * Structured clone compliant WebGL buffer and its metadata.\r\n */\r\nexport interface BufferAttribute {\r\n    name: string;\r\n    buffer: ArrayBufferLike;\r\n    type: BufferElementType;\r\n    itemCount: number;\r\n    normalized?: boolean;\r\n}\r\n\r\n/**\r\n * Structured clone compliant version of a `three.js` geometry object with text to be rendered.\r\n * It is composed of buffers with metadata for text objects.\r\n */\r\nexport interface TextGeometry {\r\n    positions: BufferAttribute;\r\n    texts: number[];\r\n    technique?: number;\r\n    stringCatalog: Array<string | undefined>;\r\n    objInfos?: AttributeMap[];\r\n}\r\n\r\n/**\r\n * Structured clone compliant version of a `three.js` geometry object with points of interest (POIs)\r\n * to be rendered. It is composed of buffers with metadata for POI objects.\r\n */\r\nexport interface PoiGeometry extends TextGeometry {\r\n    /**\r\n     * Names of the image texture or the name of the POI as indices into the array `stringCatalog`.\r\n     */\r\n    imageTextures?: number[];\r\n    // Angle in degrees from north clockwise specifying the directions the icons can be shifted.\r\n    offsetDirections?: number[];\r\n}\r\n\r\n/**\r\n * Structured clone compliant WebGL group object and its metadata.\r\n * Its purpose is to make working with groups of objects easier.\r\n */\r\nexport interface Group {\r\n    start: number;\r\n    count: number;\r\n    technique: number;\r\n\r\n    /**\r\n     * Contains tile offsets if its [[Geometry]] has been created.\r\n     */\r\n    createdOffsets?: number[];\r\n}\r\n\r\n/**\r\n * Returns the projection object specified in the parameter.\r\n *\r\n * @param projectionName - string describing projection to be used\r\n */\r\nexport function getProjection(projectionName: string): Projection | never {\r\n    switch (projectionName) {\r\n        case \"mercator\":\r\n            return mercatorProjection;\r\n        case \"webMercator\":\r\n            return webMercatorProjection;\r\n        case \"sphere\":\r\n            return sphereProjection;\r\n        case \"normalizedEquirectangular\":\r\n            return normalizedEquirectangularProjection;\r\n        case \"equirectangular\":\r\n            return equirectangularProjection;\r\n        default:\r\n            throw new Error(`Unknown projection ${projectionName}`);\r\n    } // switch\r\n}\r\n\r\n/**\r\n * String with the projection's name.\r\n *\r\n * @param projection - `Projection` object containing the name of the projection to retrieve\r\n */\r\nexport function getProjectionName(projection: Projection): string | never {\r\n    if (projection === mercatorProjection) {\r\n        return \"mercator\";\r\n    } else if (projection === webMercatorProjection) {\r\n        return \"webMercator\";\r\n    } else if (projection === sphereProjection) {\r\n        return \"sphere\";\r\n    } else if (projection === normalizedEquirectangularProjection) {\r\n        return \"normalizedEquirectangular\";\r\n    } else if (projection === equirectangularProjection) {\r\n        return \"equirectangular\";\r\n    }\r\n    throw new Error(\"Unknown projection\");\r\n}\r\n\r\n/**\r\n * @returns Feature id from the provided attribute map.\r\n * @internal\r\n */\r\nexport function getFeatureId(attributeMap: AttributeMap | undefined): string | number {\r\n    if (attributeMap === undefined) {\r\n        return 0;\r\n    }\r\n\r\n    if (typeof attributeMap === \"string\" || typeof attributeMap === \"number\") {\r\n        return attributeMap;\r\n    } else if (attributeMap.hasOwnProperty(\"$id\")) {\r\n        const id = (attributeMap as any).$id;\r\n\r\n        if (typeof id === \"string\" || typeof id === \"number\") {\r\n            return id;\r\n        }\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\n/**\r\n * Determine the name of (OMV) feature. It implements the special handling required\r\n * to determine the text content of a feature from its tags, which are passed in as the `env`.\r\n *\r\n * @param env - Environment containing the tags from the (OMV) feature.\r\n * @param useAbbreviation - `true` to use the abbreviation if available.\r\n * @param useIsoCode - `true` to use the tag \"iso_code\".\r\n * @param languages - List of languages to use, for example: Specify \"en\" to use the tag \"name_en\"\r\n *                  as the text of the string. Order reflects priority.\r\n */\r\nexport function getFeatureName(\r\n    env: Env,\r\n    basePropName: string | undefined,\r\n    useAbbreviation?: boolean,\r\n    useIsoCode?: boolean,\r\n    languages?: string[]\r\n): string | undefined {\r\n    let name;\r\n    if (basePropName === undefined) {\r\n        basePropName = \"name\";\r\n    }\r\n    if (useAbbreviation) {\r\n        const abbreviation = env.lookup(`${basePropName}:short`);\r\n        if (typeof abbreviation === \"string\" && abbreviation.length > 0) {\r\n            return abbreviation;\r\n        }\r\n    }\r\n    if (useIsoCode) {\r\n        const isoCode = env.lookup(`iso_code`);\r\n        if (typeof isoCode === \"string\" && isoCode.length > 0) {\r\n            return isoCode;\r\n        }\r\n    }\r\n    if (languages !== undefined) {\r\n        for (const lang of languages) {\r\n            name = env.lookup(`${basePropName}:${lang}`) ?? env.lookup(`${basePropName}_${lang}`);\r\n            if (typeof name === \"string\" && name.length > 0) {\r\n                return name;\r\n            }\r\n        }\r\n    }\r\n    name = env.lookup(basePropName);\r\n    if (typeof name === \"string\") {\r\n        return name;\r\n    }\r\n    return undefined;\r\n}\r\n\r\n/**\r\n * Determine the text string of the map feature. It implements the special handling required\r\n * to determine the text content of a feature from its tags, which are passed in as the `env`.\r\n *\r\n * @param feature - Feature, including properties from the (OMV) feature.\r\n * @param technique - technique defining how text should be created from feature\r\n * @param languages - List of languages to use, for example: Specify \"en\" to use the tag \"name_en\"\r\n *                  as the text of the string. Order reflects priority.\r\n */\r\nexport function getFeatureText(\r\n    context: Env | AttrEvaluationContext,\r\n    technique: Technique,\r\n    languages?: string[]\r\n): string | undefined {\r\n    let useAbbreviation: boolean | undefined;\r\n    let useIsoCode: boolean | undefined;\r\n    const env = context instanceof Env ? context : context.env;\r\n    let propName: string = \"name\";\r\n    if (\r\n        isTextTechnique(technique) ||\r\n        isPoiTechnique(technique) ||\r\n        isLineMarkerTechnique(technique)\r\n    ) {\r\n        if (technique.text !== undefined) {\r\n            return evaluateTechniqueAttr(context, technique.text);\r\n        }\r\n        if (technique.label !== undefined) {\r\n            propName = evaluateTechniqueAttr(context, technique.label)!;\r\n            if (typeof propName !== \"string\") {\r\n                return undefined;\r\n            }\r\n        }\r\n        useAbbreviation = technique.useAbbreviation;\r\n        useIsoCode = technique.useIsoCode;\r\n    }\r\n\r\n    return getFeatureName(env, propName, useAbbreviation, useIsoCode, languages);\r\n}\r\n\r\n/**\r\n * Determine whether to scale heights by the projection scale factor for geometry\r\n * using the given technique.\r\n * @remarks Unless explicitly defined, the scale factor to convert meters to world space units\r\n * won't be applied if the tile's level is less than a fixed storage level.\r\n * @param context - Context for evaluation of technique attributes.\r\n * @param technique - Technique to be evaluated.\r\n * @param tileLevel - The level of the tile where the geometry is stored.\r\n * @returns `true` if height must be scaled, `false` otherwise.\r\n */\r\nexport function scaleHeight(\r\n    context: Env | AttrEvaluationContext,\r\n    technique: Technique,\r\n    tileLevel: number\r\n): boolean {\r\n    const SCALED_HEIGHT_MIN_STORAGE_LEVEL = 12;\r\n    const useConstantHeight = evaluateTechniqueAttr(\r\n        context,\r\n        technique.constantHeight,\r\n        tileLevel < SCALED_HEIGHT_MIN_STORAGE_LEVEL\r\n    );\r\n    return !useConstantHeight;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * The type representing the value of a property.\r\n */\r\nexport type Value = null | boolean | number | string | object;\r\n\r\n/**\r\n * An interface defining a collection of named properties.\r\n *\r\n * @example\r\n * ```typescript\r\n * const properties: ValueMap = {\r\n *    $id: 123,\r\n *    color: \"rgba(255, 0, 0, 1)\"\r\n * }\r\n * ```\r\n */\r\nexport interface ValueMap {\r\n    [name: string]: Value;\r\n}\r\n\r\n/**\r\n * A class used to lookup properties by name.\r\n *\r\n * @remarks\r\n * Concrete implementation of `Env` like {@link MapEnv} are used\r\n * to resolve the property names used in {@link Expr | style expressions}.\r\n *\r\n * @example\r\n * ```typescript\r\n * const env = new MapEnv({\r\n *     kind: \"landuse\",\r\n * });\r\n *\r\n * const expr = Expr.fromJson([\"get\", \"kind\"]);\r\n *\r\n * const value = expr.evaluate(env);\r\n *\r\n * console.log(`kind is '${value}`);\r\n * ```\r\n */\r\nexport class Env {\r\n    /**\r\n     * Returns `true` if the given object is an instance of {@link Env}.\r\n     *\r\n     * @param object - The object to test.\r\n     */\r\n    static isEnv(object: any): object is Env {\r\n        return object instanceof Env;\r\n    }\r\n\r\n    /**\r\n     * Returns property in {@link Env} by name.\r\n     *\r\n     * @param name - Name of property.\r\n     */\r\n    lookup(name: string): Value | undefined {\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Return an object containing all properties of this environment. (Here: empty object).\r\n     */\r\n    unmap(): ValueMap {\r\n        return {};\r\n    }\r\n}\r\n\r\n/**\r\n * `MapEnv` is a concrete implementation of {@link Env} that\r\n * creates a lookup environment from a set of properties.\r\n *\r\n * @example\r\n * ```typescript\r\n * const baseEnv = new MapEnv({\r\n *     $zoom: 14,\r\n * });\r\n *\r\n * // extends baseEnv with a the new binding (kind, \"landuse\").\r\n * const env = new MapEnv({ kind: \"landuse\" }, baseEnv);\r\n *\r\n * const zoom = env.lookup(\"$zoom\"); // zoom is 14\r\n * const kind = env.lookup(\"kind\"); // kind is is \"landuse\"\r\n *\r\n * const expr = Expr.fromJson([\"get\", \"kind\"]);\r\n * const value = expr.evaluate(env); // value is \"landuse\"\r\n * ```\r\n */\r\nexport class MapEnv extends Env {\r\n    constructor(readonly entries: ValueMap, private readonly parent?: Env) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Returns property in {@link Env} by name.\r\n     *\r\n     * @param name - Name of property.\r\n     * @override\r\n     */\r\n    lookup(name: string): Value | undefined {\r\n        if (this.entries.hasOwnProperty(name)) {\r\n            const value = this.entries[name];\r\n            if (value !== undefined) {\r\n                return value;\r\n            }\r\n        }\r\n        return this.parent ? this.parent.lookup(name) : undefined;\r\n    }\r\n\r\n    /**\r\n     * Return an object containing all properties of this environment, takes care of the parent\r\n     * object.\r\n     * @override\r\n     */\r\n    unmap(): ValueMap {\r\n        const obj: any = this.parent ? this.parent.unmap() : {};\r\n        for (const key in this.entries) {\r\n            if (this.entries.hasOwnProperty(key)) {\r\n                obj[key] = this.entries[key];\r\n            }\r\n        }\r\n        return obj;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2022 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport * as THREE from \"three\";\r\n\r\nimport { Env, Value } from \"./Env\";\r\nimport { ExprEvaluator, ExprEvaluatorContext, OperatorDescriptor } from \"./ExprEvaluator\";\r\nimport { ExprInstantiator, InstantiationContext } from \"./ExprInstantiator\";\r\nimport { ExprParser } from \"./ExprParser\";\r\nimport { ExprPool } from \"./ExprPool\";\r\nimport {\r\n    interpolatedPropertyDefinitionToJsonExpr,\r\n    isInterpolatedPropertyDefinition\r\n} from \"./InterpolatedPropertyDefs\";\r\nimport { Pixels } from \"./Pixels\";\r\nimport { RGBA } from \"./RGBA\";\r\nimport { Definition, Definitions, getDefinitionValue } from \"./Theme\";\r\n\r\nexport * from \"./Env\";\r\n\r\nconst exprEvaluator = new ExprEvaluator();\r\n\r\nconst exprInstantiator = new ExprInstantiator();\r\n\r\n/**\r\n * A visitor for {@link Expr} nodes.\r\n * @internal\r\n */\r\nexport interface ExprVisitor<Result, Context> {\r\n    visitNullLiteralExpr(expr: NullLiteralExpr, context: Context): Result;\r\n    visitBooleanLiteralExpr(expr: BooleanLiteralExpr, context: Context): Result;\r\n    visitNumberLiteralExpr(expr: NumberLiteralExpr, context: Context): Result;\r\n    visitStringLiteralExpr(expr: StringLiteralExpr, context: Context): Result;\r\n    visitObjectLiteralExpr(expr: ObjectLiteralExpr, context: Context): Result;\r\n    visitVarExpr(expr: VarExpr, context: Context): Result;\r\n    visitHasAttributeExpr(expr: HasAttributeExpr, context: Context): Result;\r\n    visitCallExpr(expr: CallExpr, context: Context): Result;\r\n    visitLookupExpr(expr: LookupExpr, context: Context): Result;\r\n    visitMatchExpr(expr: MatchExpr, context: Context): Result;\r\n    visitCaseExpr(expr: CaseExpr, context: Context): Result;\r\n    visitStepExpr(expr: StepExpr, context: Context): Result;\r\n    visitInterpolateExpr(expr: InterpolateExpr, context: Context): Result;\r\n}\r\n\r\n/**\r\n * The dependencies of an {@link Expr}.\r\n * @internal\r\n */\r\nexport class ExprDependencies {\r\n    /**\r\n     * The properties needed to evaluate the {@link Expr}.\r\n     */\r\n    readonly properties = new Set<string>();\r\n\r\n    /**\r\n     * `true` if the expression depends on the feature state.\r\n     */\r\n    featureState?: boolean;\r\n\r\n    /**\r\n     * `true` if this expression cannot be cached.\r\n     */\r\n    volatile?: boolean;\r\n}\r\n\r\nclass ComputeExprDependencies implements ExprVisitor<void, ExprDependencies> {\r\n    static instance = new ComputeExprDependencies();\r\n\r\n    /**\r\n     * Gets the dependencies of an {@link Expr}.\r\n     *\r\n     * @param expr - The {@link Expr} to process.\r\n     * @param scope - The evaluation scope. Defaults to [[ExprScope.Value]].\r\n     * @param dependencies - The output [[Set]] of dependency names.\r\n     */\r\n    static of(expr: Expr) {\r\n        const dependencies = new ExprDependencies();\r\n        expr.accept(this.instance, dependencies);\r\n        return dependencies;\r\n    }\r\n\r\n    visitNullLiteralExpr(expr: NullLiteralExpr, context: ExprDependencies): void {\r\n        // nothing to do\r\n    }\r\n\r\n    visitBooleanLiteralExpr(expr: BooleanLiteralExpr, context: ExprDependencies): void {\r\n        // nothing to do\r\n    }\r\n\r\n    visitNumberLiteralExpr(expr: NumberLiteralExpr, context: ExprDependencies): void {\r\n        // nothing to do\r\n    }\r\n\r\n    visitStringLiteralExpr(expr: StringLiteralExpr, context: ExprDependencies): void {\r\n        // nothing to do\r\n    }\r\n\r\n    visitObjectLiteralExpr(expr: ObjectLiteralExpr, context: ExprDependencies): void {\r\n        // nothing to do\r\n    }\r\n\r\n    visitVarExpr(expr: VarExpr, context: ExprDependencies): void {\r\n        context.properties.add(expr.name);\r\n    }\r\n\r\n    visitHasAttributeExpr(expr: HasAttributeExpr, context: ExprDependencies): void {\r\n        context.properties.add(expr.name);\r\n    }\r\n\r\n    visitCallExpr(expr: CallExpr, context: ExprDependencies): void {\r\n        expr.args.forEach(childExpr => childExpr.accept(this, context));\r\n\r\n        switch (expr.op) {\r\n            case \"dynamic-properties\":\r\n                context.volatile = true;\r\n                break;\r\n            case \"feature-state\":\r\n                context.featureState = true;\r\n                context.properties.add(\"$state\");\r\n                context.properties.add(\"$id\");\r\n                break;\r\n            case \"id\":\r\n                context.properties.add(\"$id\");\r\n                break;\r\n            case \"zoom\":\r\n            case \"world-ppi-scale\":\r\n            case \"world-discrete-ppi-scale\":\r\n                context.properties.add(\"$zoom\");\r\n                break;\r\n            case \"geometry-type\":\r\n                context.properties.add(\"$geometryType\");\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    visitLookupExpr(expr: LookupExpr, context: ExprDependencies): void {\r\n        // Same behaviour as call expressions.\r\n        return this.visitCallExpr(expr, context);\r\n    }\r\n\r\n    visitMatchExpr(expr: MatchExpr, context: ExprDependencies): void {\r\n        expr.value.accept(this, context);\r\n        expr.branches.forEach(([_, branch]) => branch.accept(this, context));\r\n        expr.fallback.accept(this, context);\r\n    }\r\n\r\n    visitCaseExpr(expr: CaseExpr, context: ExprDependencies): void {\r\n        expr.branches.forEach(([condition, branch]) => {\r\n            condition.accept(this, context);\r\n            branch.accept(this, context);\r\n        });\r\n        expr.fallback.accept(this, context);\r\n    }\r\n\r\n    visitStepExpr(expr: StepExpr, context: ExprDependencies): void {\r\n        expr.input.accept(this, context);\r\n        expr.defaultValue.accept(this, context);\r\n        expr.stops.forEach(([_, value]) => value.accept(this, context));\r\n    }\r\n\r\n    visitInterpolateExpr(expr: InterpolateExpr, context: ExprDependencies): void {\r\n        expr.input.accept(this, context);\r\n        expr.stops.forEach(([_, value]) => value.accept(this, context));\r\n    }\r\n}\r\n\r\n/**\r\n * A type represeting JSON values.\r\n */\r\nexport type JsonValue = null | boolean | number | string | JsonObject | JsonArray;\r\n\r\n/**\r\n * A type representing JSON arrays.\r\n */\r\nexport type JsonArray = JsonValue[];\r\n\r\n/**\r\n * A type representing JSON objects.\r\n */\r\nexport interface JsonObject {\r\n    [name: string]: JsonValue;\r\n}\r\n\r\n/**\r\n * The JSON representation of an {@link Expr} object.\r\n */\r\nexport type JsonExpr = JsonArray;\r\n\r\nexport function isJsonExpr(v: any): v is JsonExpr {\r\n    return Array.isArray(v) && v.length > 0 && typeof v[0] === \"string\";\r\n}\r\n\r\n/**\r\n * Internal state needed by {@link Expr.fromJSON} to resolve `\"ref\"` expressions.\r\n */\r\ninterface ReferenceResolverState {\r\n    definitions: Definitions;\r\n    lockedNames: Set<string>;\r\n    cache: Map<string, Expr>;\r\n}\r\n\r\n/**\r\n * The evaluation scope of an {@link Expr}.\r\n * @internal\r\n */\r\nexport enum ExprScope {\r\n    /**\r\n     * The scope of an {@link Expr} used as value of an attribute.\r\n     */\r\n    Value,\r\n\r\n    /**\r\n     * The scope of an {@link Expr} used in a [[Technique]] `when` condition.\r\n     */\r\n    Condition,\r\n\r\n    /**\r\n     * The scope of an {@link Expr} used as dynamic property attribute value.\r\n     */\r\n    Dynamic\r\n}\r\n\r\n/**\r\n * Abstract class representing the\r\n * {@link https://github.com/heremaps/harp.gl/blob/master/%40here/harp-datasource-protocol/StyleExpressions.md | style expressions}\r\n * used in {@link Theme}.\r\n */\r\nexport abstract class Expr {\r\n    /**\r\n     * Tests of given value is an {@link Expr}.\r\n     *\r\n     * @param value - The object to test.\r\n     */\r\n    static isExpr(value: any): value is Expr {\r\n        return value instanceof Expr;\r\n    }\r\n\r\n    /**\r\n     * Creates an expression from the given `code`.\r\n     *\r\n     * @param code - The code to parse.\r\n     * @returns The parsed {@link Expr}.\r\n     * @deprecated `string` encoded expression are deprecated. Use {@link Expr.fromJSON} instead.\r\n     */\r\n    static parse(code: string): Expr | never {\r\n        const parser = new ExprParser(code);\r\n        const expr = parser.parse();\r\n        return expr;\r\n    }\r\n\r\n    /**\r\n     * Creates a style expression from JSON.\r\n     *\r\n     * @remarks\r\n     * The optional set of {@link Theme.definitions | definitions} is used\r\n     * to resolve the {@link https://github.com/heremaps/harp.gl/blob/master/%40here/harp-datasource-protocol/StyleExpressions.md#ref | ref expressions}.\r\n     *\r\n     * @param json - JSON object representing the expression to parse.\r\n     * @param definitions - Optional set of definitions used to expand references.\r\n     * @param definitionExprCache - Optional cache of `Expr` instances\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const expr = Expr.fromJSON([\"all\",\r\n     *     [\"==\", [\"geometry-type\"], \"LineString\"],\r\n     *     [\"has\", \"text\"]\r\n     * ]);\r\n     * ```\r\n     */\r\n    static fromJSON(\r\n        json: JsonValue,\r\n        definitions?: Definitions,\r\n        definitionExprCache?: Map<string, Expr>\r\n    ) {\r\n        const referenceResolverState: ReferenceResolverState | undefined =\r\n            definitions !== undefined\r\n                ? {\r\n                      definitions,\r\n                      lockedNames: new Set(),\r\n                      cache: definitionExprCache ?? new Map<string, Expr>()\r\n                  }\r\n                : undefined;\r\n\r\n        return parseNode(json, referenceResolverState);\r\n    }\r\n\r\n    private m_dependencies?: ExprDependencies;\r\n    private m_isDynamic?: boolean;\r\n\r\n    /**\r\n     * Evaluate an expression returning a {@link Value} object.\r\n     *\r\n     * @param env - The {@link Env} used to lookup symbols.\r\n     * @param scope - The evaluation scope. Defaults to [[ExprScope.Value]].\r\n     * @param cache - A cache of previously computed results.\r\n     */\r\n    evaluate(\r\n        env: Env,\r\n        scope: ExprScope = ExprScope.Value,\r\n        cache?: Map<Expr, Value>\r\n    ): Value | never {\r\n        return this.accept(\r\n            exprEvaluator,\r\n            new ExprEvaluatorContext(exprEvaluator, env, scope, cache)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Instantiates this {@link Expr}.\r\n     *\r\n     * @remarks\r\n     * references to the `get` and `has` operator using the given instantiation context.\r\n     *\r\n     * @param context - The [[InstantationContext]] used to resolve names.\r\n     */\r\n    instantiate(context: InstantiationContext): Expr {\r\n        return this.accept(exprInstantiator, context);\r\n    }\r\n\r\n    /**\r\n     * Gets the dependencies of this {@link Expr}.\r\n     */\r\n    dependencies(): ExprDependencies {\r\n        if (!this.m_dependencies) {\r\n            this.m_dependencies = ComputeExprDependencies.of(this);\r\n        }\r\n        return this.m_dependencies;\r\n    }\r\n\r\n    /**\r\n     * Create a unique object that is structurally equivalent to this {@link Expr}.\r\n     *\r\n     * @param pool - The [[ExprPool]] used to create a unique\r\n     * equivalent object of this {@link Expr}.\r\n     */\r\n    intern(pool: ExprPool): Expr {\r\n        return pool.add(this);\r\n    }\r\n\r\n    toJSON(): JsonValue {\r\n        return new ExprSerializer().serialize(this);\r\n    }\r\n\r\n    /**\r\n     * Returns `true` if a dynamic execution context is required to evaluate this {@link Expr}.\r\n     */\r\n    isDynamic(): boolean {\r\n        if (this.m_isDynamic === undefined) {\r\n            this.m_isDynamic = this.exprIsDynamic();\r\n        }\r\n        return this.m_isDynamic;\r\n    }\r\n\r\n    /**\r\n     * Visits this expression.\r\n     *\r\n     * @param visitor The visitor used to visit the expression.\r\n     * @param context The context passed to the vistor.\r\n     */\r\n    abstract accept<Result, Context>(\r\n        visitor: ExprVisitor<Result, Context>,\r\n        context: Context\r\n    ): Result;\r\n\r\n    /**\r\n     * Update the dynamic state of this {@link Expr}.\r\n     *\r\n     * `exprIsDynamic` must never be called directly.\r\n     * @internal\r\n     */\r\n    protected abstract exprIsDynamic(): boolean;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport type RelationalOp = \"<\" | \">\" | \"<=\" | \">=\";\r\n\r\n/**\r\n * @internal\r\n */\r\nexport type EqualityOp = \"~=\" | \"^=\" | \"$=\" | \"==\" | \"!=\";\r\n\r\n/**\r\n * @internal\r\n */\r\nexport type BinaryOp = RelationalOp | EqualityOp;\r\n\r\n/**\r\n * A node representing a `get` expression.\r\n * @internal\r\n */\r\nexport class VarExpr extends Expr {\r\n    constructor(readonly name: string) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitVarExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic() {\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * A node representing a `literal` expression.\r\n * @internal\r\n */\r\nexport abstract class LiteralExpr extends Expr {\r\n    /**\r\n     * Create a [[LiteralExpr]] from the given value.\r\n     *\r\n     * @param value - A constant value.\r\n     */\r\n    static fromValue(value: Value): Expr {\r\n        switch (typeof value) {\r\n            case \"boolean\":\r\n                return new BooleanLiteralExpr(value);\r\n            case \"number\":\r\n                return new NumberLiteralExpr(value);\r\n            case \"string\":\r\n                return new StringLiteralExpr(value);\r\n            case \"object\":\r\n                return value === null ? NullLiteralExpr.instance : new ObjectLiteralExpr(value);\r\n            default:\r\n                throw new Error(`failed to create a literal from '${value}'`);\r\n        } // switch\r\n    }\r\n\r\n    abstract get value(): Value;\r\n\r\n    /** @override */\r\n    protected exprIsDynamic() {\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Null literal expression.\r\n * @internal\r\n */\r\nexport class NullLiteralExpr extends LiteralExpr {\r\n    static instance = new NullLiteralExpr();\r\n    /** @override */\r\n    readonly value: Value = null;\r\n\r\n    protected constructor() {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitNullLiteralExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic() {\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Boolean literal expression.\r\n * @internal\r\n */\r\nexport class BooleanLiteralExpr extends LiteralExpr {\r\n    constructor(readonly value: boolean) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitBooleanLiteralExpr(this, context);\r\n    }\r\n}\r\n\r\n/**\r\n * Number literal expression.\r\n * @internal\r\n */\r\nexport class NumberLiteralExpr extends LiteralExpr {\r\n    constructor(readonly value: number) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitNumberLiteralExpr(this, context);\r\n    }\r\n}\r\n\r\n/**\r\n * String literal expression.\r\n * @internal\r\n */\r\nexport class StringLiteralExpr extends LiteralExpr {\r\n    private m_promotedValue?: RGBA | Pixels | null;\r\n\r\n    constructor(readonly value: string) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Returns the value of parsing this string as [[RGBA]] or [[Pixels]] constant.\r\n     */\r\n    get promotedValue(): RGBA | Pixels | undefined {\r\n        if (this.m_promotedValue === undefined) {\r\n            this.m_promotedValue = RGBA.parse(this.value) ?? Pixels.parse(this.value) ?? null;\r\n        }\r\n        return this.m_promotedValue ?? undefined;\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitStringLiteralExpr(this, context);\r\n    }\r\n}\r\n\r\n/**\r\n * Object literal expression.\r\n * @internal\r\n */\r\nexport class ObjectLiteralExpr extends LiteralExpr {\r\n    constructor(readonly value: object) {\r\n        super();\r\n    }\r\n\r\n    get isArrayLiteral() {\r\n        return Array.isArray(this.value);\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitObjectLiteralExpr(this, context);\r\n    }\r\n}\r\n\r\n/**\r\n * A node reperesenting a `has` expression.\r\n * @internal\r\n */\r\nexport class HasAttributeExpr extends Expr {\r\n    constructor(readonly name: string) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitHasAttributeExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic() {\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * A node representing a `call` expression.\r\n * @internal\r\n */\r\nexport class CallExpr extends Expr {\r\n    descriptor?: OperatorDescriptor;\r\n\r\n    constructor(readonly op: string, readonly args: Expr[]) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Returns the child nodes of this {@link Expr}.\r\n     *\r\n     * @deprecated Use {@link CallExpr.args} instead.\r\n     */\r\n    get children() {\r\n        return this.args;\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitCallExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic() {\r\n        const descriptor = this.descriptor ?? ExprEvaluator.getOperator(this.op);\r\n\r\n        if (descriptor && descriptor.isDynamicOperator && descriptor.isDynamicOperator(this)) {\r\n            return true;\r\n        }\r\n\r\n        return this.args.some(e => e.isDynamic());\r\n    }\r\n}\r\n\r\n/**\r\n * A `lookup` expression is a call expression using the `lookup` operator. Then only difference is\r\n * that the lookup table definition (first argument) is cached as a map for fast search\r\n * (see {@link ExprEvaluator.visitLookupExpr}).\r\n * @internal\r\n */\r\n\r\nexport class LookupExpr extends CallExpr {\r\n    /**\r\n     * Creates a lookup expression from a {@link JsonArray}.\r\n     * @param node The {@link JsonArray} to parse.\r\n     * @param referenceResolverState Used to resolve references to definitions.\r\n     * @returns A LookupExpr instance.\r\n     */\r\n    static parseArray(node: JsonArray, referenceResolverState?: ReferenceResolverState): Expr {\r\n        const lookupTableNode = node[1];\r\n        if (lookupTableNode === undefined) {\r\n            throw new Error(\"missing lookup table in 'lookup' expression\");\r\n        }\r\n\r\n        const lookupTableExpr = parseNode(lookupTableNode, referenceResolverState);\r\n        if (!Array.isArray(lookupTableNode) || !(lookupTableExpr instanceof ObjectLiteralExpr)) {\r\n            throw new Error(\r\n                `Invalid lookup table expression for operator 'lookup'. It must be a literal or a ref to one.`\r\n            );\r\n        }\r\n        const lookupTable = lookupTableExpr.value;\r\n        if (!Array.isArray(lookupTable)) {\r\n            throw new Error(\r\n                `Invalid lookup table type (${typeof lookupTable}) for operator 'lookup'`\r\n            );\r\n        }\r\n\r\n        // Skip the operator name and the lookup table and parse the rest of the arguments. Then add\r\n        // the lookup table expr as first argument.\r\n        const args = node.slice(2).map(childExpr => parseNode(childExpr, referenceResolverState));\r\n        args.unshift(lookupTableExpr);\r\n\r\n        return new LookupExpr(args);\r\n    }\r\n\r\n    /**\r\n     * Constructs a LookupExpr instance.\r\n     * @param args Arguments of the lookup expression. At least an argument for the lookup table.\r\n     */\r\n    constructor(readonly args: Expr[]) {\r\n        super(\"lookup\", args);\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitLookupExpr(this, context);\r\n    }\r\n}\r\n\r\n/**\r\n * The labels of a {@link MatchExpr} expression.\r\n * @internal\r\n */\r\nexport type MatchLabel = number | string | number[] | string[];\r\n\r\n/**\r\n * A node representing a `match` expression.\r\n * @internal\r\n */\r\nexport class MatchExpr extends Expr {\r\n    /**\r\n     * Tests if the given JSON node is a valid label for the `\"match\"` operator.\r\n     *\r\n     * @param node - A JSON value.\r\n     */\r\n    static isValidMatchLabel(node: JsonValue): node is MatchLabel {\r\n        switch (typeof node) {\r\n            case \"number\":\r\n            case \"string\":\r\n                return true;\r\n            case \"object\":\r\n                if (!Array.isArray(node) || node.length === 0) {\r\n                    return false;\r\n                }\r\n                const elementTy = typeof node[0];\r\n                if (elementTy === \"number\" || elementTy === \"string\") {\r\n                    return node.every(t => typeof t === elementTy);\r\n                }\r\n                return false;\r\n            default:\r\n                return false;\r\n        } // switch\r\n    }\r\n\r\n    constructor(\r\n        readonly value: Expr,\r\n        readonly branches: Array<[MatchLabel, Expr]>,\r\n        readonly fallback: Expr\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitMatchExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic() {\r\n        return (\r\n            this.value.isDynamic() ||\r\n            this.branches.some(([_, branch]) => branch.isDynamic()) ||\r\n            this.fallback.isDynamic()\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * A node representing a `case` expression.\r\n * @internal\r\n */\r\nexport class CaseExpr extends Expr {\r\n    constructor(readonly branches: Array<[Expr, Expr]>, readonly fallback: Expr) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitCaseExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic() {\r\n        return (\r\n            this.branches.some(([cond, branch]) => cond.isDynamic() || branch.isDynamic()) ||\r\n            this.fallback.isDynamic()\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * A node representing a `step` expression.\r\n * @internal\r\n */\r\nexport class StepExpr extends Expr {\r\n    constructor(\r\n        readonly input: Expr,\r\n        readonly defaultValue: Expr,\r\n        readonly stops: Array<[number, Expr]>\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitStepExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic(): boolean {\r\n        return (\r\n            this.input.isDynamic() ||\r\n            this.defaultValue.isDynamic() ||\r\n            this.stops.some(([_, value]) => value.isDynamic())\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * The type of the interpolation mode.\r\n */\r\nexport type InterpolateMode = [\"discrete\"] | [\"linear\"] | [\"cubic\"] | [\"exponential\", number];\r\n\r\n/**\r\n * A node representing an `interpolate` expression.\r\n * @internal\r\n */\r\nexport class InterpolateExpr extends Expr {\r\n    constructor(\r\n        readonly mode: InterpolateMode,\r\n        readonly input: Expr,\r\n        readonly stops: Array<[number, Expr]>\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    accept<Result, Context>(visitor: ExprVisitor<Result, Context>, context: Context): Result {\r\n        return visitor.visitInterpolateExpr(this, context);\r\n    }\r\n\r\n    /** @override */\r\n    protected exprIsDynamic(): boolean {\r\n        return this.input.isDynamic() || this.stops.some(([_, value]) => value.isDynamic());\r\n    }\r\n}\r\n\r\n/**\r\n * Serializes the Expr to JSON.\r\n *\r\n * @internal\r\n */\r\nclass ExprSerializer implements ExprVisitor<JsonValue, void> {\r\n    serialize(expr: Expr): JsonValue {\r\n        return expr.accept(this, undefined);\r\n    }\r\n\r\n    visitNullLiteralExpr(expr: NullLiteralExpr, context: void): JsonValue {\r\n        return null;\r\n    }\r\n\r\n    visitBooleanLiteralExpr(expr: BooleanLiteralExpr, context: void): JsonValue {\r\n        return expr.value;\r\n    }\r\n\r\n    visitNumberLiteralExpr(expr: NumberLiteralExpr, context: void): JsonValue {\r\n        return expr.value;\r\n    }\r\n\r\n    visitStringLiteralExpr(expr: StringLiteralExpr, context: void): JsonValue {\r\n        return expr.value;\r\n    }\r\n\r\n    visitObjectLiteralExpr(expr: ObjectLiteralExpr, context: void): JsonValue {\r\n        if (expr.value instanceof THREE.Vector2) {\r\n            return [\"make-vector\", expr.value.x, expr.value.y];\r\n        } else if (expr.value instanceof THREE.Vector3) {\r\n            return [\"make-vector\", expr.value.x, expr.value.y, expr.value.z];\r\n        } else if (expr.value instanceof THREE.Vector4) {\r\n            return [\"make-vector\", expr.value.x, expr.value.y, expr.value.z, expr.value.w];\r\n        }\r\n        return [\"literal\", expr.value as JsonObject];\r\n    }\r\n\r\n    visitVarExpr(expr: VarExpr, context: void): JsonValue {\r\n        return [\"get\", expr.name];\r\n    }\r\n\r\n    visitHasAttributeExpr(expr: HasAttributeExpr, context: void): JsonValue {\r\n        return [\"has\", expr.name];\r\n    }\r\n\r\n    visitCallExpr(expr: CallExpr, context: void): JsonValue {\r\n        return [expr.op, ...expr.args.map(childExpr => this.serialize(childExpr))];\r\n    }\r\n\r\n    visitLookupExpr(expr: LookupExpr, context: void): JsonValue {\r\n        // Same serialization as call expressions.\r\n        return this.visitCallExpr(expr, context);\r\n    }\r\n\r\n    visitMatchExpr(expr: MatchExpr, context: void): JsonValue {\r\n        const branches: JsonValue[] = [];\r\n        for (const [label, body] of expr.branches) {\r\n            branches.push(label, this.serialize(body));\r\n        }\r\n        return [\"match\", this.serialize(expr.value), ...branches, this.serialize(expr.fallback)];\r\n    }\r\n\r\n    visitCaseExpr(expr: CaseExpr, context: void): JsonValue {\r\n        const branches: JsonValue[] = [];\r\n        for (const [condition, body] of expr.branches) {\r\n            branches.push(this.serialize(condition), this.serialize(body));\r\n        }\r\n        return [\"case\", ...branches, this.serialize(expr.fallback)];\r\n    }\r\n\r\n    visitStepExpr(expr: StepExpr, context: void): JsonValue {\r\n        const result: JsonArray = [\"step\"];\r\n        result.push(this.serialize(expr.input));\r\n        result.push(this.serialize(expr.defaultValue));\r\n        expr.stops.forEach(([key, value]) => {\r\n            result.push(key);\r\n            result.push(this.serialize(value));\r\n        });\r\n        return result;\r\n    }\r\n\r\n    visitInterpolateExpr(expr: InterpolateExpr, context: void): JsonValue {\r\n        const result: JsonArray = [\"interpolate\", expr.mode];\r\n        result.push(this.serialize(expr.input));\r\n        expr.stops.forEach(([key, value]) => {\r\n            result.push(key);\r\n            result.push(this.serialize(value));\r\n        });\r\n        return result;\r\n    }\r\n}\r\n\r\nfunction parseNode(\r\n    node: JsonValue,\r\n    referenceResolverState: ReferenceResolverState | undefined\r\n): Expr {\r\n    if (Array.isArray(node)) {\r\n        return parseCall(node, referenceResolverState);\r\n    } else if (node === null) {\r\n        return NullLiteralExpr.instance;\r\n    } else if (typeof node === \"boolean\") {\r\n        return new BooleanLiteralExpr(node);\r\n    } else if (typeof node === \"number\") {\r\n        return new NumberLiteralExpr(node);\r\n    } else if (typeof node === \"string\") {\r\n        return new StringLiteralExpr(node);\r\n    }\r\n    throw new Error(`failed to create expression from: ${JSON.stringify(node)}`);\r\n}\r\n\r\nfunction parseCall(node: JsonArray, referenceResolverState?: ReferenceResolverState): Expr {\r\n    const op = node[0];\r\n\r\n    if (typeof op !== \"string\") {\r\n        throw new Error(\"expected a builtin function name\");\r\n    }\r\n\r\n    switch (op) {\r\n        case \"!has\":\r\n        case \"!in\":\r\n            return new CallExpr(\"!\", [parseCall([op.slice(1), ...node.slice(1)])]);\r\n\r\n        case \"ref\":\r\n            return resolveReference(node, referenceResolverState);\r\n\r\n        case \"get\":\r\n            return parseGetExpr(node, referenceResolverState);\r\n\r\n        case \"has\":\r\n            return parseHasExpr(node, referenceResolverState);\r\n\r\n        case \"literal\":\r\n            return parseLiteralExpr(node);\r\n\r\n        case \"match\":\r\n            return parseMatchExpr(node, referenceResolverState);\r\n\r\n        case \"case\":\r\n            return parseCaseExpr(node, referenceResolverState);\r\n\r\n        case \"interpolate\":\r\n            return parseInterpolateExpr(node, referenceResolverState);\r\n\r\n        case \"step\":\r\n            return parseStepExpr(node, referenceResolverState);\r\n\r\n        case \"lookup\":\r\n            return LookupExpr.parseArray(node, referenceResolverState);\r\n\r\n        default:\r\n            return makeCallExpr(op, node, referenceResolverState);\r\n    } // switch\r\n}\r\n\r\nfunction parseGetExpr(node: JsonArray, referenceResolverState?: ReferenceResolverState) {\r\n    if (node[2] !== undefined) {\r\n        return makeCallExpr(\"get\", node, referenceResolverState);\r\n    }\r\n    const name = node[1];\r\n    if (typeof name !== \"string\") {\r\n        throw new Error(`expected the name of an attribute`);\r\n    }\r\n    return new VarExpr(name);\r\n}\r\n\r\nfunction parseHasExpr(node: JsonArray, referenceResolverState?: ReferenceResolverState) {\r\n    if (node[2] !== undefined) {\r\n        return makeCallExpr(\"has\", node, referenceResolverState);\r\n    }\r\n    const name = node[1];\r\n    if (typeof name !== \"string\") {\r\n        throw new Error(`expected the name of an attribute`);\r\n    }\r\n    return new HasAttributeExpr(name);\r\n}\r\n\r\nfunction parseLiteralExpr(node: JsonArray) {\r\n    const obj = node[1];\r\n    if (obj === null || typeof obj !== \"object\") {\r\n        throw new Error(\"expected an object or array literal\");\r\n    }\r\n    return new ObjectLiteralExpr(obj);\r\n}\r\n\r\nfunction parseMatchExpr(node: JsonArray, referenceResolverState?: ReferenceResolverState) {\r\n    if (node.length < 4) {\r\n        throw new Error(\"not enough arguments\");\r\n    }\r\n    if (!(node.length % 2)) {\r\n        throw new Error(\"fallback is missing in 'match' expression\");\r\n    }\r\n    const value = parseNode(node[1], referenceResolverState);\r\n    const conditions: Array<[MatchLabel, Expr]> = [];\r\n    for (let i = 2; i < node.length - 1; i += 2) {\r\n        const label = node[i];\r\n        if (!MatchExpr.isValidMatchLabel(label)) {\r\n            throw new Error(`'${JSON.stringify(label)}' is not a valid label for 'match'`);\r\n        }\r\n        const expr = parseNode(node[i + 1], referenceResolverState);\r\n        conditions.push([label, expr]);\r\n    }\r\n    const fallback = parseNode(node[node.length - 1], referenceResolverState);\r\n    return new MatchExpr(value, conditions, fallback);\r\n}\r\n\r\nfunction parseCaseExpr(node: JsonArray, referenceResolverState?: ReferenceResolverState) {\r\n    if (node.length < 3) {\r\n        throw new Error(\"not enough arguments\");\r\n    }\r\n    if (node.length % 2) {\r\n        throw new Error(\"fallback is missing in 'case' expression\");\r\n    }\r\n    const branches: Array<[Expr, Expr]> = [];\r\n    for (let i = 1; i < node.length - 1; i += 2) {\r\n        const condition = parseNode(node[i], referenceResolverState);\r\n        const expr = parseNode(node[i + 1], referenceResolverState);\r\n        branches.push([condition, expr]);\r\n    }\r\n    const caseFallback = parseNode(node[node.length - 1], referenceResolverState);\r\n    return new CaseExpr(branches, caseFallback);\r\n}\r\n\r\nfunction isInterpolationMode(object: any): object is InterpolateMode {\r\n    if (!Array.isArray(object)) {\r\n        return false;\r\n    }\r\n    switch (object[0]) {\r\n        case \"discrete\":\r\n        case \"linear\":\r\n        case \"cubic\":\r\n        case \"exponential\":\r\n            return true;\r\n        default:\r\n            return false;\r\n    }\r\n}\r\n\r\nfunction parseInterpolateExpr(node: JsonArray, referenceResolverState?: ReferenceResolverState) {\r\n    const mode: InterpolateMode = node[1] as any;\r\n    if (!isInterpolationMode(mode)) {\r\n        throw new Error(\"expected an interpolation type\");\r\n    }\r\n    if (mode[0] === \"exponential\" && typeof mode[1] !== \"number\") {\r\n        throw new Error(\"expected the base of the exponential interpolation\");\r\n    }\r\n    const input = node[2] !== undefined ? parseNode(node[2], referenceResolverState) : undefined;\r\n    if (!Expr.isExpr(input)) {\r\n        throw new Error(`expected the input of the interpolation`);\r\n    }\r\n    if (node.length === 3 || !(node.length % 2)) {\r\n        throw new Error(\"invalid number of samples\");\r\n    }\r\n\r\n    const stops: Array<[number, Expr]> = [];\r\n    for (let i = 3; i < node.length - 1; i += 2) {\r\n        const key = node[i] as number;\r\n        const value = parseNode(node[i + 1], referenceResolverState);\r\n        stops.push([key, value]);\r\n    }\r\n    return new InterpolateExpr(mode, input, stops);\r\n}\r\n\r\nfunction parseStepExpr(node: JsonArray, referenceResolverState?: ReferenceResolverState) {\r\n    if (node.length < 2) {\r\n        throw new Error(\"expected the input of the 'step' operator\");\r\n    }\r\n    if (node.length < 3 || !(node.length % 2)) {\r\n        throw new Error(\"not enough arguments\");\r\n    }\r\n    const input = parseNode(node[1], referenceResolverState);\r\n    const defaultValue = parseNode(node[2], referenceResolverState);\r\n    const stops: Array<[number, Expr]> = [];\r\n    for (let i = 3; i < node.length; i += 2) {\r\n        const key = node[i] as number;\r\n        const value = parseNode(node[i + 1], referenceResolverState);\r\n        stops.push([key, value]);\r\n    }\r\n    return new StepExpr(input, defaultValue, stops);\r\n}\r\n\r\nfunction makeCallExpr(\r\n    op: string,\r\n    node: any[],\r\n    referenceResolverState?: ReferenceResolverState\r\n): Expr {\r\n    return new CallExpr(\r\n        op,\r\n        node.slice(1).map(childExpr => parseNode(childExpr, referenceResolverState))\r\n    );\r\n}\r\n\r\nfunction resolveReference(node: JsonArray, referenceResolverState?: ReferenceResolverState) {\r\n    if (typeof node[1] !== \"string\") {\r\n        throw new Error(`expected the name of an attribute`);\r\n    }\r\n    if (referenceResolverState === undefined) {\r\n        throw new Error(`ref used with no definitions`);\r\n    }\r\n    const name = node[1] as string;\r\n\r\n    if (referenceResolverState.lockedNames.has(name)) {\r\n        throw new Error(`circular referene to '${name}'`);\r\n    }\r\n\r\n    if (!(name in referenceResolverState.definitions)) {\r\n        throw new Error(`definition '${name}' not found`);\r\n    }\r\n\r\n    const cachedEntry = referenceResolverState.cache.get(name);\r\n    if (cachedEntry !== undefined) {\r\n        return cachedEntry;\r\n    }\r\n    let definitionEntry = referenceResolverState.definitions[name] as any;\r\n    let result: Expr;\r\n    const definitionValue: Definition = getDefinitionValue(definitionEntry);\r\n    if (isInterpolatedPropertyDefinition(definitionValue)) {\r\n        // found a reference to an interpolation using\r\n        // the deprecated object-like syntax.\r\n        return Expr.fromJSON(interpolatedPropertyDefinitionToJsonExpr(definitionEntry));\r\n    } else if (isJsonExpr(definitionValue)) {\r\n        definitionEntry = definitionValue;\r\n    } else {\r\n        return Expr.fromJSON(definitionValue);\r\n    }\r\n\r\n    if (isJsonExpr(definitionEntry)) {\r\n        referenceResolverState.lockedNames.add(name);\r\n        try {\r\n            result = parseNode(definitionEntry, referenceResolverState);\r\n        } finally {\r\n            referenceResolverState.lockedNames.delete(name);\r\n        }\r\n    } else {\r\n        throw new Error(`unsupported definition ${name}`);\r\n    }\r\n    referenceResolverState.cache.set(name, result);\r\n    return result;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport {\r\n    BooleanLiteralExpr,\r\n    CallExpr,\r\n    CaseExpr,\r\n    Env,\r\n    Expr,\r\n    ExprScope,\r\n    ExprVisitor,\r\n    HasAttributeExpr,\r\n    InterpolateExpr,\r\n    LiteralExpr,\r\n    LookupExpr,\r\n    MatchExpr,\r\n    NullLiteralExpr,\r\n    NumberLiteralExpr,\r\n    ObjectLiteralExpr,\r\n    StepExpr,\r\n    StringLiteralExpr,\r\n    Value,\r\n    VarExpr\r\n} from \"./Expr\";\r\nimport { ArrayOperators } from \"./operators/ArrayOperators\";\r\nimport { CastOperators } from \"./operators/CastOperators\";\r\nimport { ColorOperators } from \"./operators/ColorOperators\";\r\nimport { ComparisonOperators } from \"./operators/ComparisonOperators\";\r\nimport { FeatureOperators } from \"./operators/FeatureOperators\";\r\nimport { FlowOperators } from \"./operators/FlowOperators\";\r\nimport { MapOperators } from \"./operators/MapOperators\";\r\nimport { MathOperators } from \"./operators/MathOperators\";\r\nimport { MiscOperators } from \"./operators/MiscOperators\";\r\nimport { ObjectOperators } from \"./operators/ObjectOperators\";\r\nimport { StringOperators } from \"./operators/StringOperators\";\r\nimport { TypeOperators } from \"./operators/TypeOperators\";\r\nimport { VectorOperators } from \"./operators/VectorOperators\";\r\nimport { Pixels } from \"./Pixels\";\r\nimport { RGBA } from \"./RGBA\";\r\n\r\nexport interface OperatorDescriptor {\r\n    /**\r\n     * Returns `true` if this operator requires a dynamic execution context (e.g. [\"zoom\"]).\r\n     */\r\n    isDynamicOperator?: (call: CallExpr) => boolean;\r\n\r\n    /**\r\n     * Evaluates the given expression.\r\n     */\r\n    call: (context: ExprEvaluatorContext, call: CallExpr) => Value;\r\n\r\n    /**\r\n     * Partial evaluate the `call` expression using the given `context`.\r\n     */\r\n    partialEvaluate?: (context: ExprEvaluatorContext, call: CallExpr) => Value;\r\n}\r\n\r\nexport interface OperatorDescriptorMap {\r\n    [name: string]: OperatorDescriptor;\r\n}\r\n\r\nconst operatorDescriptors = new Map<string, OperatorDescriptor>();\r\n\r\n/**\r\n * Promote string literals and values to color and pixel constants.\r\n *\r\n * @hidden\r\n * @internal\r\n */\r\nfunction promoteValue(context: ExprEvaluatorContext, expr: Expr): Value {\r\n    if (expr instanceof StringLiteralExpr) {\r\n        return expr.promotedValue ?? expr.value;\r\n    }\r\n\r\n    const value = context.evaluate(expr);\r\n\r\n    if (typeof value === \"string\") {\r\n        return RGBA.parse(value) ?? Pixels.parse(value) ?? value;\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\nfunction cubicInterpolate(\r\n    context: ExprEvaluatorContext,\r\n    interp: InterpolateExpr,\r\n    t: number\r\n): Value {\r\n    if (t < interp.stops[0][0]) {\r\n        return promoteValue(context, interp.stops[0][1]);\r\n    } else if (t >= interp.stops[interp.stops.length - 1][0]) {\r\n        return promoteValue(context, interp.stops[interp.stops.length - 1][1]);\r\n    }\r\n\r\n    // indices\r\n    const i1 = interp.stops.findIndex(stop => stop[0] > t);\r\n    const i0 = Math.max(0, i1 - 1);\r\n    const iP = i0 === 0 ? i1 : i0 - 1;\r\n    const iN = i1 < interp.stops.length - 1 ? i1 + 1 : i1 - 1;\r\n\r\n    // keys\r\n    const tP = interp.stops[iP][0];\r\n    const t0 = interp.stops[i0][0];\r\n    const t1 = interp.stops[i1][0];\r\n    const tN = interp.stops[iN][0];\r\n\r\n    const dt = (t1 - t0) * 0.5;\r\n    const wP = dt / (t0 - tP);\r\n    const wN = dt / (tN - t1);\r\n    const p = (t - t0) / (t1 - t0);\r\n    const pp = p * p;\r\n    const ppp = pp * p;\r\n\r\n    // coefficients\r\n    const cP = -wP * ppp + 2 * wP * pp - wP * p;\r\n    const c0 = (1 + wP) * ppp + (-1.5 - 2 * wP) * pp + (-0.5 + wP) * p + 1;\r\n    const c1 = (-1 - wN) * ppp + (1.5 + wN) * pp + 0.5 * p;\r\n    const cN = wN * ppp - wN * pp;\r\n\r\n    // values\r\n    const vP = promoteValue(context, interp.stops[iP][1]);\r\n    const v0 = promoteValue(context, interp.stops[i0][1]);\r\n    const v1 = promoteValue(context, interp.stops[i1][1]);\r\n    const vN = promoteValue(context, interp.stops[iN][1]);\r\n\r\n    if (\r\n        typeof vP === \"number\" &&\r\n        typeof v0 === \"number\" &&\r\n        typeof v1 === \"number\" &&\r\n        typeof vN === \"number\"\r\n    ) {\r\n        return cP * vP + c0 * v0 + c1 * v1 + cN * vN;\r\n    } else if (\r\n        vP instanceof RGBA &&\r\n        v0 instanceof RGBA &&\r\n        v1 instanceof RGBA &&\r\n        vN instanceof RGBA\r\n    ) {\r\n        return new RGBA(\r\n            THREE.MathUtils.clamp(cP * vP.r + c0 * v0.r + c1 * v1.r + cN * vN.r, 0, 1),\r\n            THREE.MathUtils.clamp(cP * vP.g + c0 * v0.g + c1 * v1.g + cN * vN.g, 0, 1),\r\n            THREE.MathUtils.clamp(cP * vP.b + c0 * v0.b + c1 * v1.b + cN * vN.b, 0, 1),\r\n            THREE.MathUtils.clamp(cP * vP.a + c0 * v0.a + c1 * v1.a + cN * vN.a, 0, 1)\r\n        );\r\n    } else if (\r\n        vP instanceof Pixels &&\r\n        v0 instanceof Pixels &&\r\n        v1 instanceof Pixels &&\r\n        vN instanceof Pixels\r\n    ) {\r\n        return new Pixels(cP * vP.value + c0 * v0.value + c1 * v1.value + cN * vN.value);\r\n    } else if (\r\n        vP instanceof THREE.Color &&\r\n        v0 instanceof THREE.Color &&\r\n        v1 instanceof THREE.Color &&\r\n        vN instanceof THREE.Color\r\n    ) {\r\n        return new THREE.Color(\r\n            cP * vP.r + c0 * v0.r + c1 * v1.r + cN * vN.r,\r\n            cP * vP.g + c0 * v0.g + c1 * v1.g + cN * vN.g,\r\n            cP * vP.b + c0 * v0.b + c1 * v1.b + cN * vN.b\r\n        );\r\n    } else if (\r\n        vP instanceof THREE.Vector2 &&\r\n        v0 instanceof THREE.Vector2 &&\r\n        v1 instanceof THREE.Vector2 &&\r\n        vN instanceof THREE.Vector2\r\n    ) {\r\n        return new THREE.Vector2(\r\n            cP * vP.x + c0 * v0.x + c1 * v1.x + cN * vN.x,\r\n            cP * vP.y + c0 * v0.y + c1 * v1.y + cN * vN.y\r\n        );\r\n    } else if (\r\n        vP instanceof THREE.Vector3 &&\r\n        v0 instanceof THREE.Vector3 &&\r\n        v1 instanceof THREE.Vector3 &&\r\n        vN instanceof THREE.Vector3\r\n    ) {\r\n        return new THREE.Vector3(\r\n            cP * vP.x + c0 * v0.x + c1 * v1.x + cN * vN.x,\r\n            cP * vP.y + c0 * v0.y + c1 * v1.y + cN * vN.y,\r\n            cP * vP.z + c0 * v0.z + c1 * v1.z + cN * vN.z\r\n        );\r\n    } else if (\r\n        vP instanceof THREE.Vector4 &&\r\n        v0 instanceof THREE.Vector4 &&\r\n        v1 instanceof THREE.Vector4 &&\r\n        vN instanceof THREE.Vector4\r\n    ) {\r\n        return new THREE.Vector4(\r\n            cP * vP.x + c0 * v0.x + c1 * v1.x + cN * vN.x,\r\n            cP * vP.y + c0 * v0.y + c1 * v1.y + cN * vN.y,\r\n            cP * vP.z + c0 * v0.z + c1 * v1.z + cN * vN.z,\r\n            cP * vP.w + c0 * v0.w + c1 * v1.w + cN * vN.w\r\n        );\r\n    } else if (Array.isArray(vP) && Array.isArray(v0) && Array.isArray(v1) && Array.isArray(vN)) {\r\n        const N = vP.length;\r\n        const r: number[] = [];\r\n        for (let i = 0; i < N; ++i) {\r\n            r[i] = cP * vP[i] + c0 * v0[i] + c1 * v1[i] + cN * vN[i];\r\n        }\r\n        return r;\r\n    }\r\n\r\n    throw new Error(`failed to interpolate values`);\r\n}\r\n\r\n/*\r\n * @hidden\r\n */\r\nexport class ExprEvaluatorContext {\r\n    constructor(\r\n        readonly evaluator: ExprEvaluator,\r\n        readonly env: Env,\r\n        readonly scope: ExprScope,\r\n        readonly cache?: Map<Expr, Value>\r\n    ) {}\r\n\r\n    /**\r\n     * Evaluate the given expression.\r\n     *\r\n     * @param expr - The {@link Expr} to evaluate.\r\n     */\r\n    evaluate(expr: Expr | undefined) {\r\n        if (expr === undefined) {\r\n            throw new Error(\"Failed to evaluate expression\");\r\n        }\r\n\r\n        const cachedResult = this.cache?.get(expr);\r\n\r\n        if (cachedResult !== undefined) {\r\n            return cachedResult;\r\n        }\r\n\r\n        const result = expr.accept(this.evaluator, this);\r\n        this.cache?.set(expr, result);\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Wraps the given value in an {@link Expr} if needed.\r\n     *\r\n     * @param value -\r\n     */\r\n    wrapValue(value: Value | Expr): Expr {\r\n        return Expr.isExpr(value) ? value : LiteralExpr.fromValue(value);\r\n    }\r\n}\r\n\r\n/**\r\n * [[ExprEvaluator]] is used to evaluate {@link Expr} in a given environment.\r\n *\r\n * @hidden\r\n */\r\nexport class ExprEvaluator implements ExprVisitor<Value, ExprEvaluatorContext> {\r\n    static defineOperator(op: string, builtin: OperatorDescriptor) {\r\n        operatorDescriptors.set(op, builtin);\r\n    }\r\n\r\n    static defineOperators(builtins: OperatorDescriptorMap) {\r\n        Object.getOwnPropertyNames(builtins).forEach(p => {\r\n            this.defineOperator(p, builtins[p]);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Returns the [[OperatorDescriptor]] for the given operator name.\r\n     * @hidden\r\n     */\r\n    static getOperator(op: string): OperatorDescriptor | undefined {\r\n        return operatorDescriptors.get(op);\r\n    }\r\n\r\n    visitVarExpr(expr: VarExpr, context: ExprEvaluatorContext): Value {\r\n        const value = context.env.lookup(expr.name);\r\n        return value !== undefined ? value : null;\r\n    }\r\n\r\n    visitNullLiteralExpr(expr: NullLiteralExpr, context: ExprEvaluatorContext): Value {\r\n        return null;\r\n    }\r\n\r\n    visitBooleanLiteralExpr(expr: BooleanLiteralExpr, context: ExprEvaluatorContext): Value {\r\n        return expr.value;\r\n    }\r\n\r\n    visitNumberLiteralExpr(expr: NumberLiteralExpr, context: ExprEvaluatorContext): Value {\r\n        return expr.value;\r\n    }\r\n\r\n    visitStringLiteralExpr(expr: StringLiteralExpr, context: ExprEvaluatorContext): Value {\r\n        return expr.value;\r\n    }\r\n\r\n    visitObjectLiteralExpr(expr: ObjectLiteralExpr, context: ExprEvaluatorContext): Value {\r\n        return expr.value;\r\n    }\r\n\r\n    visitHasAttributeExpr(expr: HasAttributeExpr, context: ExprEvaluatorContext): Value {\r\n        return context.env.lookup(expr.name) !== undefined;\r\n    }\r\n\r\n    visitMatchExpr(match: MatchExpr, context: ExprEvaluatorContext): Value {\r\n        const r = context.evaluate(match.value);\r\n        for (const [label, body] of match.branches) {\r\n            if (Array.isArray(label) && (label as any[]).includes(r)) {\r\n                return context.evaluate(body);\r\n            } else if (label === r) {\r\n                return context.evaluate(body);\r\n            }\r\n        }\r\n        return context.evaluate(match.fallback);\r\n    }\r\n\r\n    visitCaseExpr(match: CaseExpr, context: ExprEvaluatorContext): Value {\r\n        if (context.scope === ExprScope.Value) {\r\n            const firstDynamicCondition = match.branches.findIndex(([condition, _]) =>\r\n                condition.isDynamic()\r\n            );\r\n\r\n            if (firstDynamicCondition !== -1) {\r\n                let branches: Array<[Expr, Expr]> | undefined;\r\n\r\n                for (let i = 0; i < match.branches.length; ++i) {\r\n                    const [condition, body] = match.branches[i];\r\n\r\n                    const evaluatedCondition = context.evaluate(condition);\r\n                    const evaluatedBody = context.evaluate(body);\r\n\r\n                    if (i < firstDynamicCondition && Boolean(evaluatedCondition)) {\r\n                        return evaluatedBody;\r\n                    }\r\n\r\n                    if (!Expr.isExpr(evaluatedCondition) && !Boolean(evaluatedCondition)) {\r\n                        // skip this branch, it constantly evaluates to false.\r\n                        continue;\r\n                    }\r\n\r\n                    if (branches === undefined) {\r\n                        branches = [];\r\n                    }\r\n\r\n                    branches?.push([\r\n                        context.wrapValue(evaluatedCondition),\r\n                        context.wrapValue(evaluatedBody)\r\n                    ]);\r\n\r\n                    if (!Expr.isExpr(evaluatedCondition) && Boolean(evaluatedCondition)) {\r\n                        // skip unreachble expressions\r\n                        return new CaseExpr(branches, LiteralExpr.fromValue(null));\r\n                    }\r\n                }\r\n\r\n                const fallback = context.evaluate(match.fallback);\r\n\r\n                return branches === undefined\r\n                    ? fallback\r\n                    : new CaseExpr(branches, context.wrapValue(fallback));\r\n            }\r\n        }\r\n\r\n        for (const [condition, body] of match.branches) {\r\n            if (context.evaluate(condition)) {\r\n                return context.evaluate(body);\r\n            }\r\n        }\r\n\r\n        return context.evaluate(match.fallback);\r\n    }\r\n\r\n    visitCallExpr(expr: CallExpr, context: ExprEvaluatorContext): Value {\r\n        const descriptor = expr.descriptor ?? operatorDescriptors.get(expr.op);\r\n\r\n        if (descriptor) {\r\n            expr.descriptor = descriptor;\r\n\r\n            let result: Value;\r\n\r\n            if (context.scope === ExprScope.Value && expr.isDynamic()) {\r\n                if (expr.descriptor.partialEvaluate) {\r\n                    return expr.descriptor.partialEvaluate(context, expr);\r\n                }\r\n\r\n                const args = expr.args.map(arg => {\r\n                    return context.wrapValue(context.evaluate(arg));\r\n                });\r\n\r\n                if (args.every((arg, i) => arg === expr.args[i])) {\r\n                    return expr;\r\n                }\r\n\r\n                result = new CallExpr(expr.op, args);\r\n            } else {\r\n                result = descriptor.call(context, expr);\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        throw new Error(`undefined operator '${expr.op}'`);\r\n    }\r\n\r\n    visitLookupExpr(expr: LookupExpr, context: ExprEvaluatorContext): Value {\r\n        // Same behaviour as call expressions.\r\n        return this.visitCallExpr(expr, context);\r\n    }\r\n\r\n    visitStepExpr(expr: StepExpr, context: ExprEvaluatorContext): Value {\r\n        if (context.scope === ExprScope.Value) {\r\n            const input = context.evaluate(expr.input);\r\n            const defaultValue = context.evaluate(expr.defaultValue);\r\n            return new StepExpr(\r\n                context.wrapValue(input),\r\n                context.wrapValue(defaultValue),\r\n                expr.stops.map(([key, value]) => {\r\n                    const v = context.evaluate(value);\r\n                    return [key, context.wrapValue(v)];\r\n                })\r\n            );\r\n        } else {\r\n            const input = context.evaluate(expr.input);\r\n\r\n            if (typeof input !== \"number\") {\r\n                throw new Error(`input '${input}' must be a number`);\r\n            }\r\n\r\n            if (input < expr.stops[0][0]) {\r\n                return context.evaluate(expr.defaultValue);\r\n            }\r\n\r\n            let index = expr.stops.findIndex(s => s[0] > input);\r\n\r\n            if (index === -1) {\r\n                index = expr.stops.length;\r\n            }\r\n\r\n            return context.evaluate(expr.stops[index - 1][1]);\r\n        }\r\n    }\r\n\r\n    visitInterpolateExpr(expr: InterpolateExpr, context: ExprEvaluatorContext): Value {\r\n        if (context.scope === ExprScope.Value) {\r\n            const input = context.evaluate(expr.input);\r\n            return new InterpolateExpr(\r\n                expr.mode,\r\n                context.wrapValue(input),\r\n                expr.stops.map(([key, value]) => {\r\n                    const v = context.evaluate(value);\r\n                    return [key, context.wrapValue(v)];\r\n                })\r\n            );\r\n        } else {\r\n            const param = context.evaluate(expr.input);\r\n\r\n            if (typeof param !== \"number\") {\r\n                throw new Error(`input must be a number`);\r\n            }\r\n\r\n            if (expr.mode[0] === \"cubic\") {\r\n                return cubicInterpolate(context, expr, param);\r\n            }\r\n\r\n            const keyIndex = expr.stops.findIndex(stop => stop[0] > param);\r\n\r\n            if (keyIndex === -1) {\r\n                // all the keys are smaller than the parameter\r\n                return context.evaluate(expr.stops[expr.stops.length - 1][1]);\r\n            } else if (keyIndex === 0) {\r\n                return context.evaluate(expr.stops[0][1]);\r\n            }\r\n\r\n            const [key, value] = expr.stops[keyIndex];\r\n            const [prevKey, prevValue] = expr.stops[keyIndex - 1];\r\n\r\n            const v0 = promoteValue(context, prevValue);\r\n\r\n            let t = 0;\r\n\r\n            switch (expr.mode[0]) {\r\n                case \"discrete\":\r\n                    return v0;\r\n\r\n                case \"linear\":\r\n                    t = (param - prevKey) / (key - prevKey);\r\n                    break;\r\n\r\n                case \"exponential\": {\r\n                    const base = expr.mode[1];\r\n                    t =\r\n                        base === 1\r\n                            ? (param - prevKey) / (key - prevKey)\r\n                            : (Math.pow(base, param - prevKey) - 1) /\r\n                              (Math.pow(base, key - prevKey) - 1);\r\n\r\n                    break;\r\n                }\r\n\r\n                default:\r\n                    throw new Error(\r\n                        `interpolation mode ${JSON.stringify(expr.mode)} is not supported`\r\n                    );\r\n            }\r\n\r\n            const v1 = promoteValue(context, value);\r\n\r\n            if (typeof v0 === \"number\" && typeof v1 === \"number\") {\r\n                return THREE.MathUtils.lerp(v0, v1, t);\r\n            } else if (v0 instanceof RGBA && v1 instanceof RGBA) {\r\n                return v0.clone().lerp(v1, t);\r\n            } else if (v0 instanceof Pixels && v1 instanceof Pixels) {\r\n                return new Pixels(THREE.MathUtils.lerp(v0.value, v1.value, t));\r\n            } else if (v0 instanceof THREE.Color && v1 instanceof THREE.Color) {\r\n                return v0.clone().lerp(v1, t);\r\n            } else if (v0 instanceof THREE.Vector2 && v1 instanceof THREE.Vector2) {\r\n                return v0.clone().lerp(v1, t);\r\n            } else if (v0 instanceof THREE.Vector3 && v1 instanceof THREE.Vector3) {\r\n                return v0.clone().lerp(v1, t);\r\n            } else if (v0 instanceof THREE.Vector4 && v1 instanceof THREE.Vector4) {\r\n                return v0.clone().lerp(v1, t);\r\n            } else if (Array.isArray(v0) && Array.isArray(v1) && v0.length === v1.length) {\r\n                return v0.map((x, i) => THREE.MathUtils.lerp(x, (v1 as number[])[i], t));\r\n            }\r\n\r\n            throw new Error(`todo: mix(${JSON.stringify(v0)}, ${JSON.stringify(v1)}, ${t})`);\r\n        }\r\n    }\r\n}\r\n\r\nExprEvaluator.defineOperators(CastOperators);\r\nExprEvaluator.defineOperators(ComparisonOperators);\r\nExprEvaluator.defineOperators(MathOperators);\r\nExprEvaluator.defineOperators(StringOperators);\r\nExprEvaluator.defineOperators(ColorOperators);\r\nExprEvaluator.defineOperators(TypeOperators);\r\nExprEvaluator.defineOperators(MiscOperators);\r\nExprEvaluator.defineOperators(FlowOperators);\r\nExprEvaluator.defineOperators(ArrayOperators);\r\nExprEvaluator.defineOperators(ObjectOperators);\r\nExprEvaluator.defineOperators(FeatureOperators);\r\nExprEvaluator.defineOperators(MapOperators);\r\nExprEvaluator.defineOperators(VectorOperators);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Env } from \"./Env\";\r\nimport {\r\n    BooleanLiteralExpr,\r\n    CallExpr,\r\n    CaseExpr,\r\n    Expr,\r\n    ExprScope,\r\n    ExprVisitor,\r\n    HasAttributeExpr,\r\n    InterpolateExpr,\r\n    LiteralExpr,\r\n    LookupExpr,\r\n    MatchExpr,\r\n    MatchLabel,\r\n    NullLiteralExpr,\r\n    NumberLiteralExpr,\r\n    ObjectLiteralExpr,\r\n    StepExpr,\r\n    StringLiteralExpr,\r\n    VarExpr\r\n} from \"./Expr\";\r\n\r\nexport interface InstantiationContext {\r\n    /**\r\n     * The {@link Env} used to lookup for names.\r\n     */\r\n    env: Env;\r\n\r\n    /**\r\n     * The names to preserve during the instantiation.\r\n     */\r\n    preserve?: Set<string>;\r\n}\r\n\r\nconst emptyEnv = new Env();\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport class ExprInstantiator implements ExprVisitor<Expr, InstantiationContext> {\r\n    visitNullLiteralExpr(expr: NullLiteralExpr, _context: InstantiationContext): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitBooleanLiteralExpr(expr: BooleanLiteralExpr, _context: InstantiationContext): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitNumberLiteralExpr(expr: NumberLiteralExpr, _context: InstantiationContext): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitStringLiteralExpr(expr: StringLiteralExpr, _context: InstantiationContext): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitObjectLiteralExpr(expr: ObjectLiteralExpr, _context: InstantiationContext): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitVarExpr(expr: VarExpr, context: InstantiationContext): Expr {\r\n        if (context.preserve && context.preserve.has(expr.name)) {\r\n            return expr;\r\n        }\r\n        const value = context.env.lookup(expr.name);\r\n        return LiteralExpr.fromValue(value !== undefined ? value : null);\r\n    }\r\n\r\n    visitHasAttributeExpr(expr: HasAttributeExpr, context: InstantiationContext): Expr {\r\n        if (context.preserve && context.preserve.has(expr.name)) {\r\n            return expr;\r\n        }\r\n        const value = context.env.lookup(expr.name) !== undefined;\r\n        return LiteralExpr.fromValue(value);\r\n    }\r\n\r\n    private visitCallExprImpl(\r\n        expr: CallExpr,\r\n        context: InstantiationContext,\r\n        constructor: (op: string, args: Expr[]) => CallExpr\r\n    ): Expr {\r\n        const args = expr.args.map(arg => arg.accept(this, context));\r\n        if (args.some((a, i) => a !== expr.args[i])) {\r\n            return constructor(expr.op, args);\r\n        }\r\n        return expr;\r\n    }\r\n\r\n    visitCallExpr(expr: CallExpr, context: InstantiationContext): Expr {\r\n        return this.visitCallExprImpl(expr, context, (op: string, args: Expr[]) => {\r\n            return new CallExpr(op, args);\r\n        });\r\n    }\r\n\r\n    visitLookupExpr(expr: LookupExpr, context: InstantiationContext): Expr {\r\n        return this.visitCallExprImpl(expr, context, (op: string, args: Expr[]) => {\r\n            return new LookupExpr(args);\r\n        });\r\n    }\r\n\r\n    visitMatchExpr(match: MatchExpr, context: InstantiationContext): Expr {\r\n        const value = match.value.accept(this, context);\r\n\r\n        if (value instanceof LiteralExpr) {\r\n            const r = value.value;\r\n            for (const [label, body] of match.branches) {\r\n                if (Array.isArray(label) && (label as any[]).includes(r)) {\r\n                    return body.accept(this, context);\r\n                } else if (label === r) {\r\n                    return body.accept(this, context);\r\n                }\r\n            }\r\n            return match.fallback.accept(this, context);\r\n        }\r\n\r\n        let changed = match.value !== value;\r\n\r\n        const branches: Array<[MatchLabel, Expr]> = match.branches.map(([label, branch]) => {\r\n            const newBranch = branch.accept(this, context);\r\n            if (newBranch !== branch) {\r\n                changed = true;\r\n            }\r\n            return [label, newBranch];\r\n        });\r\n\r\n        const fallback = match.fallback.accept(this, context);\r\n\r\n        if (fallback !== match.fallback) {\r\n            changed = true;\r\n        }\r\n\r\n        return changed ? new MatchExpr(value, branches, fallback) : match;\r\n    }\r\n\r\n    visitCaseExpr(expr: CaseExpr, context: InstantiationContext): Expr {\r\n        const branches: Array<[Expr, Expr]> = [];\r\n\r\n        let changed = false;\r\n\r\n        for (const [condition, branch] of expr.branches) {\r\n            const newCondition = condition.accept(this, context);\r\n            const deps = newCondition.dependencies();\r\n            if (!condition.isDynamic() && deps.properties.size === 0) {\r\n                if (Boolean(newCondition.evaluate(emptyEnv, ExprScope.Condition))) {\r\n                    return branch.accept(this, context);\r\n                }\r\n            } else {\r\n                if (newCondition !== condition) {\r\n                    changed = true;\r\n                }\r\n                branches.push([newCondition, branch]);\r\n            }\r\n        }\r\n\r\n        if (branches.length === 0) {\r\n            // all the conditions of this CaseExpr evaluated\r\n            // to false, so the resulting of instantiating this CaseExpr\r\n            // is the same as instantiating its fallback expression.\r\n            return expr.fallback.accept(this, context);\r\n        }\r\n\r\n        if (branches.length !== expr.branches.length) {\r\n            // the number of branches changed, this means that\r\n            // some of the branches had constant expressions that\r\n            // evaluate to false. In this case the resulting\r\n            // `CaseExpr` has less branches.\r\n            changed = true;\r\n        }\r\n\r\n        // Instantiate the body of all the branches of this CaseExpr\r\n        // that have dynamic conditions.\r\n        branches.forEach(branch => {\r\n            const instantiatedBranch = branch[1].accept(this, context);\r\n\r\n            if (instantiatedBranch !== branch[1]) {\r\n                changed = true;\r\n            }\r\n\r\n            branch[1] = instantiatedBranch;\r\n        });\r\n\r\n        const fallback = expr.fallback.accept(this, context);\r\n\r\n        if (fallback !== expr.fallback) {\r\n            changed = true;\r\n        }\r\n\r\n        if (!changed) {\r\n            // nothing changed, return the old expression.\r\n            return expr;\r\n        }\r\n\r\n        return new CaseExpr(branches, fallback);\r\n    }\r\n\r\n    visitStepExpr(expr: StepExpr, context: InstantiationContext): Expr {\r\n        const input = expr.input.accept(this, context);\r\n        const defaultValue = expr.defaultValue.accept(this, context);\r\n        const stops: Array<[number, Expr]> = expr.stops.map(([key, value]) => [\r\n            key,\r\n            value.accept(this, context)\r\n        ]);\r\n        return new StepExpr(input, defaultValue, stops);\r\n    }\r\n\r\n    visitInterpolateExpr(expr: InterpolateExpr, context: InstantiationContext): Expr {\r\n        const input = expr.input.accept(this, context);\r\n        const stops: Array<[number, Expr]> = expr.stops.map(([key, value]) => [\r\n            key,\r\n            value.accept(this, context)\r\n        ]);\r\n        return new InterpolateExpr(expr.mode, input, stops);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport {\r\n    CallExpr,\r\n    EqualityOp,\r\n    Expr,\r\n    HasAttributeExpr,\r\n    LiteralExpr,\r\n    NumberLiteralExpr,\r\n    RelationalOp,\r\n    StringLiteralExpr,\r\n    VarExpr\r\n} from \"./Expr\";\r\n\r\n/**\r\n * Character value\r\n */\r\nenum Character {\r\n    Tab = 9,\r\n    Lf = 10,\r\n    Cr = 13,\r\n    Space = 32,\r\n    LParen = 40,\r\n    RParen = 41,\r\n    Comma = 44,\r\n    Dot = 46,\r\n    LBracket = 91,\r\n    Backslash = 92,\r\n    RBracket = 93,\r\n    _0 = 48,\r\n    _9 = 57,\r\n    _ = 95,\r\n    A = 64,\r\n    Z = 90,\r\n    a = 97,\r\n    z = 122,\r\n    DoubleQuote = 34,\r\n    SingleQuote = 39,\r\n    Exclaim = 33,\r\n    Equal = 61,\r\n    Caret = 94,\r\n    Tilde = 126,\r\n    Dollar = 36,\r\n    Less = 60,\r\n    Greater = 62,\r\n    Bar = 124,\r\n    Amp = 38\r\n}\r\n\r\n/**\r\n * Check if a codepoint is a whitespace character.\r\n */\r\nfunction isSpace(codepoint: number): boolean {\r\n    switch (codepoint) {\r\n        case Character.Tab:\r\n        case Character.Lf:\r\n        case Character.Cr:\r\n        case Character.Space:\r\n            return true;\r\n        default:\r\n            return false;\r\n    } // switch\r\n}\r\n\r\n/**\r\n * Check if codepoint is a digit character.\r\n */\r\nfunction isNumber(codepoint: number): boolean {\r\n    return codepoint >= Character._0 && codepoint <= Character._9;\r\n}\r\n\r\n/**\r\n * Check if codepoint is a letter character.\r\n */\r\nfunction isLetter(codepoint: number): boolean {\r\n    return (\r\n        (codepoint >= Character.a && codepoint <= Character.z) ||\r\n        (codepoint >= Character.A && codepoint <= Character.Z)\r\n    );\r\n}\r\n\r\n/**\r\n * Check if codepoint is either a digit or a letter character.\r\n */\r\nfunction isLetterOrNumber(codepoint: number): boolean {\r\n    return isLetter(codepoint) || isNumber(codepoint);\r\n}\r\n\r\n/**\r\n * Check if codepoint is an identification character: underscore, dollar sign, dot or bracket.\r\n */\r\nfunction isIdentChar(codepoint: number): boolean {\r\n    return (\r\n        isLetterOrNumber(codepoint) ||\r\n        codepoint === Character._ ||\r\n        codepoint === Character.Dollar ||\r\n        codepoint === Character.Dot ||\r\n        codepoint === Character.LBracket ||\r\n        codepoint === Character.RBracket\r\n    );\r\n}\r\n\r\n/**\r\n * Tokens used in theme grammar.\r\n */\r\nenum Token {\r\n    Eof = 0,\r\n    Error,\r\n    Identifier,\r\n    Number,\r\n    String,\r\n    Comma,\r\n    LParen,\r\n    RParen,\r\n    LBracket,\r\n    RBracket,\r\n    Exclaim,\r\n    TildeEqual,\r\n    CaretEqual,\r\n    DollarEqual,\r\n    EqualEqual,\r\n    ExclaimEqual,\r\n    Less,\r\n    Greater,\r\n    LessEqual,\r\n    GreaterEqual,\r\n    BarBar,\r\n    AmpAmp\r\n}\r\n\r\n/**\r\n * Maps a token to its string name.\r\n */\r\nfunction tokenSpell(token: Token): string {\r\n    switch (token) {\r\n        case Token.Eof:\r\n            return \"eof\";\r\n        case Token.Error:\r\n            return \"error\";\r\n        case Token.Identifier:\r\n            return \"identifier\";\r\n        case Token.Number:\r\n            return \"number\";\r\n        case Token.String:\r\n            return \"string\";\r\n        case Token.Comma:\r\n            return \",\";\r\n        case Token.LParen:\r\n            return \"(\";\r\n        case Token.RParen:\r\n            return \")\";\r\n        case Token.LBracket:\r\n            return \"[\";\r\n        case Token.RBracket:\r\n            return \"]\";\r\n        case Token.Exclaim:\r\n            return \"!\";\r\n        case Token.TildeEqual:\r\n            return \"~=\";\r\n        case Token.CaretEqual:\r\n            return \"^=\";\r\n        case Token.DollarEqual:\r\n            return \"$=\";\r\n        case Token.EqualEqual:\r\n            return \"==\";\r\n        case Token.ExclaimEqual:\r\n            return \"!=\";\r\n        case Token.Less:\r\n            return \"<\";\r\n        case Token.Greater:\r\n            return \">\";\r\n        case Token.LessEqual:\r\n            return \"<=\";\r\n        case Token.GreaterEqual:\r\n            return \">=\";\r\n        case Token.BarBar:\r\n            return \"||\";\r\n        case Token.AmpAmp:\r\n            return \"&&\";\r\n        default:\r\n            throw new Error(`invalid token ${token}`);\r\n    }\r\n}\r\n\r\n/**\r\n * Lexer class implementation.\r\n */\r\nclass Lexer {\r\n    private m_token: Token = Token.Error;\r\n    private m_index = 0;\r\n    private m_char: number = Character.Lf;\r\n    private m_text?: string;\r\n\r\n    constructor(readonly code: string) {}\r\n\r\n    /**\r\n     * Single lexer token.\r\n     */\r\n    token(): Token {\r\n        return this.m_token;\r\n    }\r\n\r\n    /**\r\n     * Parsed text.\r\n     */\r\n    text(): string {\r\n        return this.m_text ?? \"\";\r\n    }\r\n\r\n    /**\r\n     * Go to the next token.\r\n     */\r\n    next(): Token {\r\n        this.m_token = this.yylex();\r\n        if (this.m_token === Token.Error) {\r\n            throw new Error(`unexpected character ${this.m_char}`);\r\n        }\r\n        return this.m_token;\r\n    }\r\n\r\n    private yyinp(): void {\r\n        this.m_char = this.code.codePointAt(this.m_index++) ?? 0;\r\n    }\r\n\r\n    private yylex(): Token {\r\n        this.m_text = undefined;\r\n        while (isSpace(this.m_char)) {\r\n            this.yyinp();\r\n        }\r\n        if (this.m_char === 0) {\r\n            return Token.Eof;\r\n        }\r\n        const ch = this.m_char;\r\n        this.yyinp();\r\n        switch (ch) {\r\n            case Character.LParen:\r\n                return Token.LParen;\r\n            case Character.RParen:\r\n                return Token.RParen;\r\n            case Character.LBracket:\r\n                return Token.LBracket;\r\n            case Character.RBracket:\r\n                return Token.RBracket;\r\n            case Character.Comma:\r\n                return Token.Comma;\r\n            case Character.SingleQuote:\r\n            case Character.DoubleQuote: {\r\n                const start = this.m_index - 1;\r\n                while (this.m_char && this.m_char !== ch) {\r\n                    // ### TODO handle escape sequences\r\n                    this.yyinp();\r\n                }\r\n                if (this.m_char !== ch) {\r\n                    throw new Error(\"Unfinished string literal\");\r\n                }\r\n                this.yyinp();\r\n                this.m_text = this.code.substring(start, this.m_index - 2);\r\n                return Token.String;\r\n            }\r\n            case Character.Exclaim:\r\n                if (this.m_char === Character.Equal) {\r\n                    this.yyinp();\r\n                    return Token.ExclaimEqual;\r\n                }\r\n                return Token.Exclaim;\r\n            case Character.Caret:\r\n                if (this.m_char === Character.Equal) {\r\n                    this.yyinp();\r\n                    return Token.CaretEqual;\r\n                }\r\n                return Token.Error;\r\n            case Character.Tilde:\r\n                if (this.m_char === Character.Equal) {\r\n                    this.yyinp();\r\n                    return Token.TildeEqual;\r\n                }\r\n                return Token.Error;\r\n            case Character.Equal:\r\n                if (this.m_char === Character.Equal) {\r\n                    this.yyinp();\r\n                    return Token.EqualEqual;\r\n                }\r\n                return Token.Error;\r\n            case Character.Less:\r\n                if (this.m_char === Character.Equal) {\r\n                    this.yyinp();\r\n                    return Token.LessEqual;\r\n                }\r\n                return Token.Less;\r\n            case Character.Greater:\r\n                if (this.m_char === Character.Equal) {\r\n                    this.yyinp();\r\n                    return Token.GreaterEqual;\r\n                }\r\n                return Token.Greater;\r\n            case Character.Bar:\r\n                if (this.m_char === Character.Bar) {\r\n                    this.yyinp();\r\n                    return Token.BarBar;\r\n                }\r\n                return Token.Error;\r\n            case Character.Amp:\r\n                if (this.m_char === Character.Amp) {\r\n                    this.yyinp();\r\n                    return Token.AmpAmp;\r\n                }\r\n                return Token.Error;\r\n            default: {\r\n                const start = this.m_index - 2;\r\n                if (\r\n                    isLetter(ch) ||\r\n                    ch === Character._ ||\r\n                    (ch === Character.Dollar && isIdentChar(this.m_char))\r\n                ) {\r\n                    while (isIdentChar(this.m_char)) {\r\n                        this.yyinp();\r\n                    }\r\n                    this.m_text = this.code.substring(start, this.m_index - 1);\r\n                    return Token.Identifier;\r\n                } else if (isNumber(ch)) {\r\n                    while (isNumber(this.m_char)) {\r\n                        this.yyinp();\r\n                    }\r\n                    if (this.m_char === Character.Dot) {\r\n                        this.yyinp();\r\n                        while (isNumber(this.m_char)) {\r\n                            this.yyinp();\r\n                        }\r\n                    }\r\n                    this.m_text = this.code.substring(start, this.m_index - 1);\r\n                    return Token.Number;\r\n                } else if (ch === Character.Dollar) {\r\n                    if (this.m_char === Character.Equal) {\r\n                        this.yyinp();\r\n                        return Token.DollarEqual;\r\n                    }\r\n                    return Token.Error;\r\n                }\r\n            }\r\n        }\r\n        return Token.Error;\r\n    }\r\n}\r\n\r\nfunction getEqualityOp(token: Token): EqualityOp | undefined {\r\n    switch (token) {\r\n        case Token.TildeEqual:\r\n            return \"~=\";\r\n        case Token.CaretEqual:\r\n            return \"^=\";\r\n        case Token.DollarEqual:\r\n            return \"$=\";\r\n        case Token.EqualEqual:\r\n            return \"==\";\r\n        case Token.ExclaimEqual:\r\n            return \"!=\";\r\n        default:\r\n            return undefined;\r\n    } // switch\r\n}\r\n\r\nfunction getRelationalOp(token: Token): RelationalOp | undefined {\r\n    switch (token) {\r\n        case Token.Less:\r\n            return \"<\";\r\n        case Token.Greater:\r\n            return \">\";\r\n        case Token.LessEqual:\r\n            return \"<=\";\r\n        case Token.GreaterEqual:\r\n            return \">=\";\r\n        default:\r\n            return undefined;\r\n    } // switch\r\n}\r\n\r\nexport class ExprParser {\r\n    private readonly lex: Lexer;\r\n\r\n    constructor(code: string) {\r\n        this.lex = new Lexer(code);\r\n        this.lex.next();\r\n    }\r\n\r\n    parse(): Expr | never {\r\n        return this.parseLogicalOr();\r\n    }\r\n\r\n    private yyexpect(token: Token): void | never {\r\n        if (this.lex.token() !== token) {\r\n            throw new Error(\r\n                `Syntax error: Expected token '${tokenSpell(token)}' but ` +\r\n                    `found '${tokenSpell(this.lex.token())}'`\r\n            );\r\n        }\r\n        this.lex.next();\r\n    }\r\n\r\n    private parsePrimary(): Expr | never {\r\n        switch (this.lex.token()) {\r\n            case Token.Identifier: {\r\n                const text = this.lex.text();\r\n                switch (text) {\r\n                    case \"has\":\r\n                        this.lex.next(); // skip has keyword\r\n                        this.yyexpect(Token.LParen);\r\n                        const hasAttribute = this.lex.text();\r\n                        this.yyexpect(Token.Identifier);\r\n                        this.yyexpect(Token.RParen);\r\n                        return new HasAttributeExpr(hasAttribute);\r\n                    case \"length\":\r\n                        this.lex.next(); // skip length keyword\r\n                        this.yyexpect(Token.LParen);\r\n                        const value = this.parseLogicalOr();\r\n                        this.yyexpect(Token.RParen);\r\n                        return new CallExpr(\"length\", [value]);\r\n                    default:\r\n                        const expr = new VarExpr(text);\r\n                        this.lex.next();\r\n                        return expr;\r\n                }\r\n            }\r\n\r\n            case Token.LParen: {\r\n                this.lex.next();\r\n                const expr = this.parseLogicalOr();\r\n                this.yyexpect(Token.RParen);\r\n                return expr;\r\n            }\r\n\r\n            default:\r\n                return this.parseLiteral();\r\n        } // switch\r\n    }\r\n\r\n    private parseLiteral(): NumberLiteralExpr | StringLiteralExpr | never {\r\n        switch (this.lex.token()) {\r\n            case Token.Number: {\r\n                const expr = new NumberLiteralExpr(parseFloat(this.lex.text()));\r\n                this.lex.next();\r\n                return expr;\r\n            }\r\n            case Token.String: {\r\n                const expr = new StringLiteralExpr(this.lex.text());\r\n                this.lex.next();\r\n                return expr;\r\n            }\r\n            default:\r\n                throw new Error(\"Syntax error\");\r\n        } // switch\r\n    }\r\n\r\n    private parseUnary(): Expr | never {\r\n        if (this.lex.token() === Token.Exclaim) {\r\n            this.lex.next();\r\n            return new CallExpr(\"!\", [this.parseUnary()]);\r\n        }\r\n        return this.parsePrimary();\r\n    }\r\n\r\n    private parseRelational(): Expr | never {\r\n        let expr = this.parseUnary();\r\n        while (true) {\r\n            if (this.lex.token() === Token.Identifier && this.lex.text() === \"in\") {\r\n                this.lex.next();\r\n                this.yyexpect(Token.LBracket);\r\n                const elements = [this.parseLiteral()];\r\n                while (this.lex.token() === Token.Comma) {\r\n                    this.lex.next();\r\n                    elements.push(this.parseLiteral());\r\n                }\r\n                this.yyexpect(Token.RBracket);\r\n                expr = new CallExpr(\"in\", [\r\n                    expr,\r\n                    LiteralExpr.fromValue(elements.map(({ value }) => value))\r\n                ]);\r\n            } else {\r\n                const op = getRelationalOp(this.lex.token());\r\n                if (op === undefined) {\r\n                    break;\r\n                }\r\n                this.lex.next();\r\n                const right = this.parseUnary();\r\n                expr = new CallExpr(op, [expr, right]);\r\n            }\r\n        }\r\n        return expr;\r\n    }\r\n\r\n    private parseEquality(): Expr | never {\r\n        let expr = this.parseRelational();\r\n        while (true) {\r\n            let op: string | undefined = getEqualityOp(this.lex.token());\r\n\r\n            if (op === undefined) {\r\n                break;\r\n            }\r\n\r\n            if (op === \"~=\") {\r\n                op = \"in\";\r\n            }\r\n\r\n            this.lex.next();\r\n            const right = this.parseRelational();\r\n            expr = new CallExpr(op, [expr, right]);\r\n        }\r\n        return expr;\r\n    }\r\n\r\n    private parseLogicalAnd(): Expr | never {\r\n        const expr = this.parseEquality();\r\n\r\n        if (this.lex.token() !== Token.AmpAmp) {\r\n            return expr;\r\n        }\r\n\r\n        const expressions: Expr[] = [expr];\r\n\r\n        do {\r\n            this.lex.next();\r\n            expressions.push(this.parseEquality());\r\n        } while (this.lex.token() === Token.AmpAmp);\r\n\r\n        return new CallExpr(\"all\", expressions);\r\n    }\r\n\r\n    private parseLogicalOr(): Expr | never {\r\n        const expr = this.parseLogicalAnd();\r\n\r\n        if (this.lex.token() !== Token.BarBar) {\r\n            return expr;\r\n        }\r\n\r\n        const expressions: Expr[] = [expr];\r\n\r\n        do {\r\n            this.lex.next();\r\n            expressions.push(this.parseLogicalAnd());\r\n        } while (this.lex.token() === Token.BarBar);\r\n\r\n        return new CallExpr(\"any\", expressions);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Value } from \"./Env\";\r\nimport {\r\n    BooleanLiteralExpr,\r\n    CallExpr,\r\n    CaseExpr,\r\n    Expr,\r\n    ExprVisitor,\r\n    HasAttributeExpr,\r\n    InterpolateExpr,\r\n    LookupExpr,\r\n    MatchExpr,\r\n    NullLiteralExpr,\r\n    NumberLiteralExpr,\r\n    ObjectLiteralExpr,\r\n    StepExpr,\r\n    StringLiteralExpr,\r\n    VarExpr\r\n} from \"./Expr\";\r\n\r\n/**\r\n * [[ExprPool]] maintains a set of unique interned {@link Expr} objects.\r\n *\r\n * @hidden\r\n */\r\nexport class ExprPool implements ExprVisitor<Expr, void> {\r\n    private readonly m_booleanLiterals = new Map<boolean, BooleanLiteralExpr>();\r\n    private readonly m_numberLiterals = new Map<number, NumberLiteralExpr>();\r\n    private readonly m_stringLiterals = new Map<string, StringLiteralExpr>();\r\n    private readonly m_objectLiterals = new Map<object, ObjectLiteralExpr>();\r\n    private readonly m_arrayLiterals: ObjectLiteralExpr[] = [];\r\n    private readonly m_varExprs = new Map<string, VarExpr>();\r\n    private readonly m_hasAttributeExprs = new Map<string, HasAttributeExpr>();\r\n    private readonly m_matchExprs: MatchExpr[] = [];\r\n    private readonly m_caseExprs: CaseExpr[] = [];\r\n    private readonly m_interpolateExprs: InterpolateExpr[] = [];\r\n    private readonly m_stepExprs: StepExpr[] = [];\r\n    private readonly m_callExprs = new Map<string, CallExpr[]>();\r\n\r\n    /**\r\n     * Add `expr` to this [[ExprPool]] and return a unique {@link Expr}\r\n     * object that is structurally equivalent to `expr`.\r\n     *\r\n     * @param expr - The {@link Expr} to add to this [[ExprPool]].\r\n     * @returns A unique {@link Expr} that is structurally equivalent to `expr`.\r\n     */\r\n    add(expr: Expr): Expr {\r\n        return expr.accept(this, undefined);\r\n    }\r\n\r\n    visitNullLiteralExpr(expr: NullLiteralExpr, context: void): Expr {\r\n        return NullLiteralExpr.instance;\r\n    }\r\n\r\n    visitBooleanLiteralExpr(expr: BooleanLiteralExpr, context: void): Expr {\r\n        const e = this.m_booleanLiterals.get(expr.value);\r\n        if (e) {\r\n            return e;\r\n        }\r\n        this.m_booleanLiterals.set(expr.value, expr);\r\n        return expr;\r\n    }\r\n\r\n    visitNumberLiteralExpr(expr: NumberLiteralExpr, context: void): Expr {\r\n        const e = this.m_numberLiterals.get(expr.value);\r\n        if (e) {\r\n            return e;\r\n        }\r\n        this.m_numberLiterals.set(expr.value, expr);\r\n        return expr;\r\n    }\r\n\r\n    visitStringLiteralExpr(expr: StringLiteralExpr, context: void): Expr {\r\n        const e = this.m_stringLiterals.get(expr.value);\r\n        if (e) {\r\n            return e;\r\n        }\r\n        this.m_stringLiterals.set(expr.value, expr);\r\n        return expr;\r\n    }\r\n\r\n    visitObjectLiteralExpr(expr: ObjectLiteralExpr, context: void): Expr {\r\n        const e = this.m_objectLiterals.get(expr.value);\r\n        if (e) {\r\n            return e;\r\n        }\r\n\r\n        if (Array.isArray(expr.value)) {\r\n            const array = expr.value as Value[];\r\n\r\n            const r = this.m_arrayLiterals.find(literal => {\r\n                const elements = literal.value as Value[];\r\n                if (elements.length !== array.length) {\r\n                    return false;\r\n                }\r\n                return array.every((x, i) => x === elements[i]);\r\n            });\r\n\r\n            if (r !== undefined) {\r\n                return r;\r\n            }\r\n\r\n            this.m_arrayLiterals.push(expr);\r\n        }\r\n\r\n        this.m_objectLiterals.set(expr.value, expr);\r\n\r\n        return expr;\r\n    }\r\n\r\n    visitVarExpr(expr: VarExpr, context: void): Expr {\r\n        const e = this.m_varExprs.get(expr.name);\r\n        if (e) {\r\n            return e;\r\n        }\r\n        this.m_varExprs.set(expr.name, expr);\r\n        return expr;\r\n    }\r\n\r\n    visitHasAttributeExpr(expr: HasAttributeExpr, context: void): Expr {\r\n        const e = this.m_hasAttributeExprs.get(expr.name);\r\n        if (e) {\r\n            return e;\r\n        }\r\n        this.m_hasAttributeExprs.set(expr.name, expr);\r\n        return expr;\r\n    }\r\n\r\n    visitMatchExpr(expr: MatchExpr, context: void): Expr {\r\n        const value = expr.value.accept(this, context);\r\n        const branches: typeof expr.branches = expr.branches.map(([label, body]) => [\r\n            label,\r\n            body.accept(this, context)\r\n        ]);\r\n        const fallback = expr.fallback.accept(this, context);\r\n        for (const candidate of this.m_matchExprs) {\r\n            if (candidate.value !== value) {\r\n                continue;\r\n            }\r\n            if (candidate.fallback !== fallback) {\r\n                continue;\r\n            }\r\n            if (candidate.branches.length !== branches.length) {\r\n                continue;\r\n            }\r\n            let branchesMatching = true;\r\n            for (let i = 0; i < branches.length; i++) {\r\n                if (\r\n                    branches[i][0] !== candidate.branches[i][0] ||\r\n                    branches[i][1] !== candidate.branches[i][1]\r\n                ) {\r\n                    branchesMatching = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (branchesMatching) {\r\n                return candidate;\r\n            }\r\n        }\r\n        const r = new MatchExpr(value, branches, fallback);\r\n        this.m_matchExprs.push(r);\r\n        return r;\r\n    }\r\n\r\n    visitCaseExpr(expr: CaseExpr, context: void): Expr {\r\n        const branches: typeof expr.branches = expr.branches.map(([condition, body]) => [\r\n            condition.accept(this, context),\r\n            body.accept(this, context)\r\n        ]);\r\n        const fallback = expr.fallback.accept(this, context);\r\n\r\n        for (const candidate of this.m_caseExprs) {\r\n            if (candidate.fallback !== fallback) {\r\n                continue;\r\n            }\r\n            if (candidate.branches.length !== branches.length) {\r\n                continue;\r\n            }\r\n            let branchesMatching = true;\r\n            for (let i = 0; i < branches.length; i++) {\r\n                if (\r\n                    branches[i][0] !== candidate.branches[i][0] ||\r\n                    branches[i][1] !== candidate.branches[i][1]\r\n                ) {\r\n                    branchesMatching = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (branchesMatching) {\r\n                return candidate;\r\n            }\r\n        }\r\n\r\n        const r = new CaseExpr(branches, fallback);\r\n        this.m_caseExprs.push(r);\r\n        return r;\r\n    }\r\n\r\n    private visitCallExprImpl(\r\n        expr: CallExpr,\r\n        context: void,\r\n        constructor: (op: string, args: Expr[]) => CallExpr\r\n    ): Expr {\r\n        // rewrite the actual arguments\r\n        const expressions = expr.args.map(childExpr => childExpr.accept(this, context));\r\n        // ensure we have a valid set of interned expressions for the calls\r\n        if (!this.m_callExprs.has(expr.op)) {\r\n            this.m_callExprs.set(expr.op, []);\r\n        }\r\n        // get the calls for the given operator.\r\n        const calls = this.m_callExprs.get(expr.op)!;\r\n        for (const call of calls) {\r\n            // check the number of arguments\r\n            if (call.args.length !== expressions.length) {\r\n                continue;\r\n            }\r\n            // find the index of the first mismatch.\r\n            let index = 0;\r\n            for (; index < call.args.length; ++index) {\r\n                if (call.args[index] !== expressions[index]) {\r\n                    break;\r\n                }\r\n            }\r\n            if (index === call.args.length) {\r\n                // no mismatch found, return the 'interned' call.\r\n                return call;\r\n            }\r\n        }\r\n        const e = constructor(expr.op, expressions);\r\n        e.descriptor = expr.descriptor;\r\n        calls.push(e);\r\n        return e;\r\n    }\r\n\r\n    visitCallExpr(expr: CallExpr, context: void): Expr {\r\n        return this.visitCallExprImpl(expr, context, (op: string, args: Expr[]) => {\r\n            return new CallExpr(op, args);\r\n        });\r\n    }\r\n\r\n    visitLookupExpr(expr: LookupExpr, context: void): Expr {\r\n        return this.visitCallExprImpl(expr, context, (op: string, args: Expr[]) => {\r\n            return new LookupExpr(args);\r\n        });\r\n    }\r\n\r\n    visitStepExpr(expr: StepExpr, context: void): Expr {\r\n        if (this.m_stepExprs.includes(expr)) {\r\n            return expr;\r\n        }\r\n        const input = expr.input.accept(this, context);\r\n        const defaultValue = expr.defaultValue.accept(this, context);\r\n        const stops: Array<[number, Expr]> = expr.stops.map(stop => {\r\n            const key = stop[0];\r\n            const value = stop[1].accept(this, context);\r\n            return value === stop[1] ? stop : [key, value];\r\n        });\r\n        for (const step of this.m_stepExprs) {\r\n            if (\r\n                step.input === input &&\r\n                step.defaultValue === defaultValue &&\r\n                stops.length === step.stops.length &&\r\n                stops.every(\r\n                    ([key, value], i) => key === step.stops[i][0] && value === step.stops[i][1]\r\n                )\r\n            ) {\r\n                return step;\r\n            }\r\n        }\r\n        const e = new StepExpr(input, defaultValue, stops);\r\n        this.m_stepExprs.push(e);\r\n        return e;\r\n    }\r\n\r\n    visitInterpolateExpr(expr: InterpolateExpr, context: void): Expr {\r\n        if (this.m_interpolateExprs.includes(expr)) {\r\n            return expr;\r\n        }\r\n        const input = expr.input.accept(this, context);\r\n        const stops: Array<[number, Expr]> = expr.stops.map(stop => {\r\n            const key = stop[0];\r\n            const value = stop[1].accept(this, context);\r\n            return value === stop[1] ? stop : [key, value];\r\n        });\r\n        for (const interp of this.m_interpolateExprs) {\r\n            if (\r\n                interp.input === input &&\r\n                interp.mode[0] === expr.mode[0] &&\r\n                interp.mode[1] === expr.mode[1] &&\r\n                stops.length === interp.stops.length &&\r\n                stops.every(\r\n                    ([key, value], i) => key === interp.stops[i][0] && value === interp.stops[i][1]\r\n                )\r\n            ) {\r\n                return interp;\r\n            }\r\n        }\r\n        const e = new InterpolateExpr(expr.mode, input, stops);\r\n        this.m_interpolateExprs.push(e);\r\n        return e;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Feature details contains `feature.id`, `feature.properties.featureClass` which provides\r\n * possibility to define style in theme for particular feature.\r\n */\r\nexport interface FeatureDetails {\r\n    featureId?: string;\r\n    featureClass?: string;\r\n}\r\n\r\n/**\r\n * Represents \"Point\" GeoJSON geometry object.\r\n */\r\nexport interface Point {\r\n    type: \"Point\";\r\n    coordinates: number[];\r\n}\r\n\r\n/**\r\n * Represents \"MultiPoint\" GeoJSON geometry object.\r\n */\r\nexport interface MultiPoint {\r\n    type: \"MultiPoint\";\r\n    coordinates: number[][];\r\n}\r\n\r\n/**\r\n * Represents \"LineString\" GeoJSON geometry object.\r\n */\r\nexport interface LineString {\r\n    type: \"LineString\";\r\n    coordinates: number[][];\r\n}\r\n\r\n/**\r\n * Represents \"MultiLineString\" GeoJSON geometry object.\r\n */\r\nexport interface MultiLineString {\r\n    type: \"MultiLineString\";\r\n    coordinates: number[][][];\r\n}\r\n\r\n/**\r\n * Represents \"Polygon\" GeoJSON geometry object.\r\n */\r\nexport interface Polygon {\r\n    type: \"Polygon\";\r\n    coordinates: number[][][];\r\n}\r\n\r\n/**\r\n * Represents \"MultiPolygon\" GeoJSON geometry object.\r\n */\r\nexport interface MultiPolygon {\r\n    type: \"MultiPolygon\";\r\n    coordinates: number[][][][];\r\n}\r\n\r\n/**\r\n * Represents \"geometry\" property of \"Feature\" GeoJSON object.\r\n */\r\nexport type FeatureGeometry =\r\n    | Point\r\n    | MultiPoint\r\n    | LineString\r\n    | MultiLineString\r\n    | Polygon\r\n    | MultiPolygon;\r\n\r\nexport function isFeatureGeometry(object: any): object is FeatureGeometry {\r\n    const t = object.type;\r\n    return (\r\n        t === \"Point\" ||\r\n        t === \"MultiPoint\" ||\r\n        t === \"LineString\" ||\r\n        t === \"MultiLineString\" ||\r\n        t === \"Polygon\" ||\r\n        t === \"MultiPolygon\"\r\n    );\r\n}\r\n\r\n/**\r\n * Represents \"GeometryCollection\" GeoJSON geometry object.\r\n */\r\nexport interface GeometryCollection {\r\n    type: \"GeometryCollection\";\r\n    geometries: FeatureGeometry[];\r\n}\r\n\r\n/**\r\n * Represents \"Feature\" GeoJSON object.\r\n */\r\nexport interface Feature {\r\n    type: \"Feature\";\r\n    bbox?: number[];\r\n    id?: string;\r\n    geometry: FeatureGeometry | GeometryCollection;\r\n    properties?: any;\r\n    title?: string;\r\n}\r\n\r\n/**\r\n * Represents \"FeatureCollection\" GeoJSON object.\r\n */\r\nexport interface FeatureCollection {\r\n    type: \"FeatureCollection\";\r\n    features: Feature[];\r\n}\r\n\r\n/**\r\n * Represents a GeoJSON object.\r\n */\r\nexport type GeoJson = FeatureGeometry | GeometryCollection | Feature | FeatureCollection;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Group } from \"./DecodedTile\";\r\n\r\nexport interface IMeshBuffers {\r\n    /**\r\n     * Array that stores the vertices of the mesh.\r\n     */\r\n    readonly positions: number[];\r\n\r\n    /**\r\n     * Array of [[Group]], used to defines multiple geometries sharing the same position attribute.\r\n     */\r\n    readonly groups: Group[];\r\n\r\n    /**\r\n     * Array that stores the indices of the mesh.\r\n     */\r\n    readonly indices: number[];\r\n\r\n    /**\r\n     * Array that stores the indices of the mesh edges.\r\n     */\r\n    readonly edgeIndices: number[];\r\n\r\n    /**\r\n     * Optional list of feature start indices. The indices point into the index attribute.\r\n     */\r\n    readonly featureStarts: number[];\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { TileKey } from \"@here/harp-geoutils\";\r\n\r\nimport { GeoJson } from \"../lib/GeoJsonDataType\";\r\n\r\n/**\r\n * General type tiler which can be used to provide tile untiled payloads.\r\n */\r\nexport interface ITiler {\r\n    /**\r\n     * Connect to tiler.\r\n     *\r\n     * Should be implemented by implementations that use special resources that decode jobs like\r\n     * WebWorkers.\r\n     */\r\n    connect(): Promise<void>;\r\n\r\n    /**\r\n     * Register index in the tiler. Indexes registered in the tiler can be later used to retrieved\r\n     * tiled payloads using `getTile`.\r\n     *\r\n     * @param indexId - Index identifier.\r\n     * @param indexUrl - Url to the index payload, or direct GeoJson.\r\n     */\r\n    registerIndex(indexId: string, indexUrl: URL | GeoJson): Promise<void>;\r\n\r\n    /**\r\n     * Update index in the tiler. Indexes registered in the tiler can be later used to retrieved\r\n     * tiled payloads using `getTile`.\r\n     *\r\n     * @param indexId - Index identifier.\r\n     * @param indexUrl - Url to the index payload, or direct GeoJson.\r\n     */\r\n    updateIndex(indexId: string, indexUrl: URL | GeoJson): Promise<void>;\r\n\r\n    /**\r\n     * Retrieves a tile for a previously registered index.\r\n     *\r\n     * @param indexId - Index identifier.\r\n     * @param tileKey - The [[TileKey]] that identifies the tile.\r\n     */\r\n    getTile(indexId: string, tileKey: TileKey): Promise<{}>;\r\n\r\n    /**\r\n     * Free all resources associated with this tiler.\r\n     *\r\n     * Called by users when decoder is no longer used and all resources must be freed.\r\n     */\r\n    dispose(): void;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { JsonExpr } from \"./Expr\";\r\n\r\n/**\r\n * Interpolation mode used when computing a [[InterpolatedProperty]] value for a given zoom level.\r\n * @internal\r\n */\r\nexport enum InterpolationMode {\r\n    Discrete,\r\n    Linear,\r\n    Cubic,\r\n    Exponential\r\n}\r\n\r\n/**\r\n * Interpolated property could have its value (some initial value should be provided) changed\r\n * according to an interpolation type.\r\n *\r\n * Here is an example of an interpolated property from a map style:\r\n * \"lineWidth\": {\r\n *  \"interpolation\": \"Linear\",\r\n *  \"zoomLevels\": [13, 14, 15],\r\n *  \"values\": [ 1.5, 1.2, 0.9]\r\n * }\r\n * @internal\r\n */\r\nexport interface InterpolatedPropertyDefinition<T> {\r\n    interpolation?: \"Discrete\" | \"Linear\" | \"Cubic\" | \"Exponential\";\r\n    zoomLevels: number[];\r\n    values: T[];\r\n    exponent?: number;\r\n}\r\n\r\n/**\r\n * Checks if a property is interpolated.\r\n * @param p - property to be checked\r\n * @internal\r\n */\r\nexport function isInterpolatedPropertyDefinition<T>(\r\n    p: any\r\n): p is InterpolatedPropertyDefinition<T> {\r\n    if (\r\n        p &&\r\n        p.interpolationMode === undefined &&\r\n        Array.isArray(p.values) &&\r\n        p.values.length > 0 &&\r\n        p.values[0] !== undefined &&\r\n        Array.isArray(p.zoomLevels) &&\r\n        p.zoomLevels.length > 0 &&\r\n        p.zoomLevels[0] !== undefined &&\r\n        p.values.length === p.zoomLevels.length\r\n    ) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * Converts an [[InterpolatedPropertyDefinition]] to a [[JsonExpr]].\r\n *\r\n * @param property - A valid [[InterpolatedPropertyDefinition]]\r\n */\r\nexport function interpolatedPropertyDefinitionToJsonExpr(\r\n    property: InterpolatedPropertyDefinition<any>\r\n): JsonExpr {\r\n    if (property.interpolation === undefined || property.interpolation === \"Discrete\") {\r\n        const step: JsonExpr = [\"step\", [\"zoom\"], property.values[0]];\r\n        for (let i = 1; i < property.zoomLevels.length; ++i) {\r\n            step.push(property.zoomLevels[i], property.values[i]);\r\n        }\r\n        return step;\r\n    }\r\n    const interpolation: JsonExpr = [\"interpolate\"];\r\n    switch (property.interpolation) {\r\n        case \"Linear\":\r\n            interpolation.push([\"linear\"]);\r\n            break;\r\n        case \"Cubic\":\r\n            interpolation.push([\"cubic\"]);\r\n            break;\r\n        case \"Exponential\":\r\n            interpolation.push([\r\n                \"exponential\",\r\n                property.exponent !== undefined ? property.exponent : 2\r\n            ]);\r\n            break;\r\n        default:\r\n            throw new Error(`interpolation mode '${property.interpolation}' is not supported`);\r\n    } //switch\r\n    interpolation.push([\"zoom\"]);\r\n    for (let i = 0; i < property.zoomLevels.length; ++i) {\r\n        interpolation.push(property.zoomLevels[i], property.values[i]);\r\n    }\r\n    return interpolation;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nconst currEdgeStart = new THREE.Vector2();\r\nconst currEdgeGoal = new THREE.Vector2();\r\nconst prevEdgeStart = new THREE.Vector2();\r\nconst prevEdgeGoal = new THREE.Vector2();\r\n\r\n/**\r\n * Fills an index buffer with the indices for the edges of a polygon contour.\r\n *\r\n * @param indexBuffer - Edge index buffer to be filled.\r\n * @param vertexOffset - Starting offset of the vertices composing the contour.\r\n * @param vertexStride - Number of elements per contour vertex.\r\n * @param polygonContour - Vertices that compose the contour.\r\n * @param polygonContourEdges - Collection of booleans indicating if contour edges should be added.\r\n */\r\nexport function addPolygonEdges(\r\n    indexBuffer: number[],\r\n    vertexOffset: number,\r\n    vertexStride: number,\r\n    polygonContour: number[],\r\n    polygonContourEdges: boolean[],\r\n    isExtruded?: boolean,\r\n    addFootprintEdges?: boolean,\r\n    wallEdgeSlope?: number\r\n) {\r\n    for (let i = 0; i < polygonContourEdges.length; ++i) {\r\n        if (polygonContourEdges[i]) {\r\n            if (isExtruded === true) {\r\n                const vFootprint0 = vertexOffset + i * 2;\r\n                const vRoof0 = vFootprint0 + 1;\r\n                const vFootprint1 = vertexOffset + ((i + 1) % polygonContourEdges.length) * 2;\r\n                const vRoof1 = vFootprint1 + 1;\r\n\r\n                if (addFootprintEdges === true) {\r\n                    indexBuffer.push(vFootprint0, vFootprint1);\r\n                }\r\n                indexBuffer.push(vRoof0, vRoof1);\r\n\r\n                const prevEdgeIdx = (i === 0 ? polygonContourEdges.length : i) - 1;\r\n                if (polygonContourEdges[prevEdgeIdx]) {\r\n                    if (wallEdgeSlope !== undefined) {\r\n                        const v0x = polygonContour[i * vertexStride];\r\n                        const v0y = polygonContour[i * vertexStride + 1];\r\n                        const v1x =\r\n                            polygonContour[((i + 1) % polygonContourEdges.length) * vertexStride];\r\n                        const v1y =\r\n                            polygonContour[\r\n                                ((i + 1) % polygonContourEdges.length) * vertexStride + 1\r\n                            ];\r\n\r\n                        currEdgeStart.set(v0x, v0y);\r\n                        currEdgeGoal.set(v1x, v1y);\r\n                        prevEdgeStart.set(\r\n                            polygonContour[prevEdgeIdx * vertexStride],\r\n                            polygonContour[prevEdgeIdx * vertexStride + 1]\r\n                        );\r\n                        prevEdgeGoal.set(currEdgeStart.x, currEdgeStart.y);\r\n\r\n                        if (\r\n                            prevEdgeGoal\r\n                                .sub(prevEdgeStart)\r\n                                .normalize()\r\n                                .dot(currEdgeGoal.sub(currEdgeStart).normalize()) <= wallEdgeSlope\r\n                        ) {\r\n                            indexBuffer.push(vFootprint0, vRoof0);\r\n                        }\r\n                    } else {\r\n                        indexBuffer.push(vFootprint0, vRoof0);\r\n                    }\r\n                }\r\n            } else {\r\n                const vFoot0 = vertexOffset + i;\r\n                const vRoof0 = vertexOffset + ((i + 1) % polygonContourEdges.length);\r\n                indexBuffer.push(vFoot0, vRoof0);\r\n            }\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nconst RX = /^((?=\\.\\d|\\d)(?:\\d+)?(?:\\.?\\d*))px$/;\r\n\r\n/**\r\n * A class representing Pixels.\r\n *\r\n * @hidden\r\n * @internal\r\n */\r\nexport class Pixels {\r\n    /**\r\n     * Parses a pixel string literal.\r\n     *\r\n     * @param text - The string color literal\r\n     */\r\n    static parse(text: string): Pixels | undefined {\r\n        const match = RX.exec(text);\r\n        if (match === null) {\r\n            return undefined;\r\n        }\r\n        return new Pixels(Number(match[1]));\r\n    }\r\n\r\n    /**\r\n     * Constructs a [[Pixels]] literal\r\n     *\r\n     * @param value - The number of pixels.\r\n     */\r\n    constructor(readonly value: number) {}\r\n\r\n    toJSON() {\r\n        return `${this.value}px`;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport interface PostEffects {\r\n    bloom?: IBloomEffect;\r\n    outline?: IOutlineEffect;\r\n    vignette?: IVignetteEffect;\r\n    sepia?: ISepiaEffect;\r\n}\r\n\r\nexport interface IOutlineEffect {\r\n    enabled: boolean;\r\n    /**\r\n     * Make the extruded polygon disappear.\r\n     */\r\n    ghostExtrudedPolygons: boolean;\r\n    thickness: number;\r\n    color: string;\r\n}\r\n\r\nexport interface IBloomEffect {\r\n    strength: number;\r\n    /**\r\n     * Pixel's brightness threshold between 0 and 1, from which the bloom should apply.\r\n     */\r\n    threshold: number;\r\n    radius: number;\r\n    enabled: boolean;\r\n}\r\n\r\nexport interface IVignetteEffect {\r\n    enabled: boolean;\r\n    offset: number;\r\n    darkness: number;\r\n}\r\n\r\nexport interface ISepiaEffect {\r\n    enabled: boolean;\r\n    amount: number;\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { LoggerManager } from \"@here/harp-utils\";\r\n\r\nimport { Env } from \"./Env\";\r\nimport { Expr, ExprScope, Value } from \"./Expr\";\r\nimport { Pixels } from \"./Pixels\";\r\nimport { RGBA } from \"./RGBA\";\r\nimport { parseStringEncodedNumeral } from \"./StringEncodedNumeral\";\r\n\r\nconst logger = LoggerManager.instance.create(\"PropertyValue\");\r\n\r\n/**\r\n * Get the value of the specified property in given `env`.\r\n *\r\n * @param property - Property of a technique.\r\n * @param env - The {@link Env} used to evaluate the property\r\n * @param cache - An optional expression cache.\r\n */\r\nexport function getPropertyValue(\r\n    property: Value | undefined,\r\n    env: Env,\r\n    cache?: Map<Expr, Value>\r\n): any {\r\n    if (Expr.isExpr(property)) {\r\n        try {\r\n            let r = property.evaluate(env, ExprScope.Dynamic, cache);\r\n\r\n            if (typeof r === \"string\") {\r\n                r = RGBA.parse(r) ?? Pixels.parse(r) ?? r;\r\n            }\r\n\r\n            if (r instanceof RGBA) {\r\n                return r.getHex();\r\n            } else if (r instanceof Pixels) {\r\n                return r.value * (Number(env.lookup(\"$pixelToMeters\")) ?? 1);\r\n            }\r\n            return r;\r\n        } catch (error) {\r\n            logger.error(\r\n                \"failed to evaluate expression\",\r\n                JSON.stringify(property),\r\n                \"error\",\r\n                String(error)\r\n            );\r\n            return null;\r\n        }\r\n    }\r\n\r\n    if (property === null || typeof property === \"undefined\") {\r\n        return null;\r\n    } else if (typeof property !== \"string\") {\r\n        // Property in numeric or array, etc. format\r\n        return property;\r\n    } else {\r\n        // Non-interpolated string encoded numeral parsing\r\n        const pixelToMeters = (env.lookup(\"$pixelToMeters\") as number) || 1;\r\n        const value = parseStringEncodedNumeral(property, pixelToMeters);\r\n        return value !== undefined ? value : property;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { MathUtils } from \"three\";\r\n\r\nimport { ColorUtils } from \"./ColorUtils\";\r\nimport { parseStringEncodedColor } from \"./StringEncodedNumeral\";\r\n\r\n/**\r\n * A class representing RGBA colors.\r\n *\r\n * @hidden\r\n * @internal\r\n */\r\nexport class RGBA {\r\n    /**\r\n     * Parses a string describing a color.\r\n     *\r\n     * @param text - The string color literal\r\n     */\r\n    static parse(text: string) {\r\n        const color = parseStringEncodedColor(text);\r\n\r\n        if (color === undefined) {\r\n            return undefined;\r\n        }\r\n\r\n        return ColorUtils.getRgbaFromHex(color);\r\n    }\r\n\r\n    /**\r\n     * Constructs a [[RGBA]] color using the given components in the [0..1] range.\r\n     */\r\n    constructor(\r\n        public r: number = 1,\r\n        public g: number = 1,\r\n        public b: number = 1,\r\n        public a: number = 1\r\n    ) {}\r\n\r\n    /**\r\n     * Clones this [[RGBA]] color.\r\n     */\r\n    clone() {\r\n        return new RGBA(this.r, this.g, this.b, this.a);\r\n    }\r\n\r\n    /**\r\n     * Returns this color encoded as one single number.\r\n     */\r\n    getHex() {\r\n        return ColorUtils.getHexFromRgba(this.r, this.g, this.b, this.a);\r\n    }\r\n\r\n    /**\r\n     * Linearly interpolate the components of this color.\r\n     */\r\n    lerp(target: RGBA, t: number) {\r\n        this.r = MathUtils.lerp(this.r, target.r, t);\r\n        this.g = MathUtils.lerp(this.g, target.g, t);\r\n        this.b = MathUtils.lerp(this.b, target.b, t);\r\n        this.a = MathUtils.lerp(this.a, target.a, t);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns this color encoded as JSON literal.\r\n     */\r\n    toJSON() {\r\n        return `rgba(${(this.r * 255) << 0}, ${(this.g * 255) << 0}, ${(this.b * 255) << 0}, ${\r\n            this.a\r\n        })`;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { assert } from \"@here/harp-utils\";\r\n//@ts-ignore\r\nimport { parseCSSColor } from \"csscolorparser\";\r\n\r\nimport { ColorUtils } from \"./ColorUtils\";\r\n\r\n/**\r\n * Enumeration of supported string encoded numerals.\r\n * @internal\r\n */\r\nexport enum StringEncodedNumeralType {\r\n    Meters,\r\n    Pixels,\r\n    Hex\r\n}\r\n\r\n/**\r\n * Interface containing information about a [[StringEncodedNumeral]] format, component size and\r\n * evaluation.\r\n * @internal\r\n */\r\nexport interface StringEncodedNumeralFormat {\r\n    readonly type: StringEncodedNumeralType;\r\n    readonly size: number;\r\n    readonly regExp: RegExp;\r\n    mask?: number;\r\n    decoder: (encodedValue: string, target: number[]) => boolean;\r\n}\r\nconst StringEncodedMeters: StringEncodedNumeralFormat = {\r\n    type: StringEncodedNumeralType.Meters,\r\n    size: 1,\r\n    regExp: /^((?=\\.\\d|\\d)(?:\\d+)?(?:\\.?\\d*))m$/,\r\n    decoder: (encodedValue: string, target: number[]) => {\r\n        const match = StringEncodedMeters.regExp.exec(encodedValue);\r\n        return match ? (target[0] = Number(match[1])) !== undefined : false;\r\n    }\r\n};\r\nconst StringEncodedPixels: StringEncodedNumeralFormat = {\r\n    type: StringEncodedNumeralType.Pixels,\r\n    size: 1,\r\n    mask: 1.0,\r\n    regExp: /^((?=\\.\\d|\\d)(?:\\d+)?(?:\\.?\\d*))px$/,\r\n    decoder: (encodedValue: string, target: number[]) => {\r\n        const match = StringEncodedPixels.regExp.exec(encodedValue);\r\n        if (match === null) {\r\n            return false;\r\n        }\r\n        target[0] = Number(match[1]);\r\n        return true;\r\n    }\r\n};\r\nconst StringEncodedHex: StringEncodedNumeralFormat = {\r\n    type: StringEncodedNumeralType.Hex,\r\n    size: 4,\r\n    regExp: /^\\#((?:[0-9A-Fa-f][0-9A-Fa-f]){4}|[0-9A-Fa-f]{4})$/,\r\n    decoder: (encodedValue: string, target: number[]) => {\r\n        const match = StringEncodedHex.regExp.exec(encodedValue);\r\n        if (match === null) {\r\n            return false;\r\n        }\r\n        const hex = match[1];\r\n        const size = hex.length;\r\n        // Only few sizes are possible for given reg-exp.\r\n        assert(size === 4 || size === 8, `Matched incorrect hex color format`);\r\n        // Note that we simply ignore alpha channel value.\r\n        // TODO: To be resolved with HARP-7517\r\n        if (size === 4) {\r\n            // #RGB or #RGBA\r\n            target[0] = parseInt(hex.charAt(0) + hex.charAt(0), 16) / 255;\r\n            target[1] = parseInt(hex.charAt(1) + hex.charAt(1), 16) / 255;\r\n            target[2] = parseInt(hex.charAt(2) + hex.charAt(2), 16) / 255;\r\n            target[3] = size === 4 ? parseInt(hex.charAt(3) + hex.charAt(3), 16) / 255 : 1;\r\n        } else if (size === 8) {\r\n            // #RRGGBB or #RRGGBBAA\r\n            target[0] = parseInt(hex.charAt(0) + hex.charAt(1), 16) / 255;\r\n            target[1] = parseInt(hex.charAt(2) + hex.charAt(3), 16) / 255;\r\n            target[2] = parseInt(hex.charAt(4) + hex.charAt(5), 16) / 255;\r\n            target[3] = size === 8 ? parseInt(hex.charAt(6) + hex.charAt(7), 16) / 255 : 1;\r\n        }\r\n        return true;\r\n    }\r\n};\r\n\r\n/**\r\n * Array of all supported [[StringEncodedNumeralFormat]]s describing sizes, lengths and distances.\r\n * @internal\r\n */\r\nexport const StringEncodedMetricFormats: StringEncodedNumeralFormat[] = [\r\n    StringEncodedMeters,\r\n    StringEncodedPixels\r\n];\r\n\r\nconst StringEncodedMetricFormatMaxSize = StringEncodedMetricFormats.reduce(\r\n    (a, b) => Math.max(a, b.size),\r\n    0\r\n);\r\n\r\n/**\r\n * Array of all supported [[StringEncodedNumeralFormat]]s describing color data.\r\n * @internal\r\n */\r\nexport const StringEncodedColorFormats: StringEncodedNumeralFormat[] = [StringEncodedHex];\r\n\r\nconst StringEncodedColorFormatMaxSize = StringEncodedColorFormats.reduce(\r\n    (a, b) => Math.max(a, b.size),\r\n    0\r\n);\r\n\r\n/**\r\n * Array of supported [[StringEncodedNumeralFormat]]s (intended to be indexed with\r\n * [[StringEncodedNumeralType]] enum).\r\n * @internal\r\n */\r\nexport const StringEncodedNumeralFormats: StringEncodedNumeralFormat[] = [\r\n    ...StringEncodedMetricFormats,\r\n    ...StringEncodedColorFormats\r\n];\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const StringEncodedNumeralFormatMaxSize = Math.max(\r\n    StringEncodedColorFormatMaxSize,\r\n    StringEncodedMetricFormatMaxSize\r\n);\r\n\r\nconst tmpBuffer: number[] = new Array(StringEncodedNumeralFormatMaxSize);\r\n\r\n/**\r\n * Parse string encoded numeral values using all known [[StringEncodedNumeralFormats]].\r\n *\r\n * @param numeral - The string representing numeric value.\r\n * @param pixelToMeters - The ratio used to convert from meters to pixels (default 1.0).\r\n * @returns Number parsed or __undefined__ if non of the numeral patterns matches the expression\r\n * provided in [[numeral]].\r\n */\r\nexport function parseStringEncodedNumeral(\r\n    numeral: string,\r\n    pixelToMeters: number = 1.0\r\n): number | undefined {\r\n    return parseStringLiteral(numeral, StringEncodedNumeralFormats, pixelToMeters);\r\n}\r\n\r\n/**\r\n * Parse string encoded color value using all known [[StringEncodedColorFormats]].\r\n *\r\n * @param color - The string encoded color expression (i.e. '#FFF', 'rgb(255, 0, 0)', etc.).\r\n * @returns The color parsed or __undefined__ if non of the known representations matches\r\n * the expression provided in [[color]].\r\n */\r\nexport function parseStringEncodedColor(color: string): number | undefined {\r\n    return parseStringLiteral(color, StringEncodedColorFormats);\r\n}\r\n\r\nfunction parseStringLiteral(\r\n    text: string,\r\n    formats: StringEncodedNumeralFormat[],\r\n    pixelToMeters: number = 1.0\r\n): number | undefined {\r\n    const matchedFormat = formats.find(format => {\r\n        return format.decoder(text, tmpBuffer) ? true : false;\r\n    });\r\n\r\n    if (matchedFormat === undefined) {\r\n        const components: number[] | null = parseCSSColor(text);\r\n\r\n        return Array.isArray(components) && !components.some(c => isNaN(c))\r\n            ? ColorUtils.getHexFromRgba(\r\n                  components[0] / 255,\r\n                  components[1] / 255,\r\n                  components[2] / 255,\r\n                  components[3]\r\n              )\r\n            : undefined;\r\n    }\r\n\r\n    switch (matchedFormat?.type) {\r\n        case StringEncodedNumeralType.Pixels:\r\n            return tmpBuffer[0] * pixelToMeters;\r\n        case StringEncodedNumeralType.Hex:\r\n            return ColorUtils.getHexFromRgba(\r\n                tmpBuffer[0],\r\n                tmpBuffer[1],\r\n                tmpBuffer[2],\r\n                tmpBuffer[3]\r\n            );\r\n        default:\r\n            return tmpBuffer[0];\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2022 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { LoggerManager } from \"@here/harp-utils\";\r\n\r\nimport {\r\n    BooleanLiteralExpr,\r\n    CallExpr,\r\n    CaseExpr,\r\n    Env,\r\n    Expr,\r\n    ExprScope,\r\n    ExprVisitor,\r\n    HasAttributeExpr,\r\n    InterpolateExpr,\r\n    isJsonExpr,\r\n    JsonExpr,\r\n    LiteralExpr,\r\n    LookupExpr,\r\n    MatchExpr,\r\n    NullLiteralExpr,\r\n    NumberLiteralExpr,\r\n    ObjectLiteralExpr,\r\n    StepExpr,\r\n    StringLiteralExpr,\r\n    Value,\r\n    VarExpr\r\n} from \"./Expr\";\r\nimport { ExprPool } from \"./ExprPool\";\r\nimport {\r\n    interpolatedPropertyDefinitionToJsonExpr,\r\n    isInterpolatedPropertyDefinition\r\n} from \"./InterpolatedPropertyDefs\";\r\nimport { DecoderOptions } from \"./ITileDecoder\";\r\nimport { AttrScope, getTechniqueAttributeDescriptor } from \"./TechniqueDescriptors\";\r\nimport { IndexedTechnique, setTechniqueRenderOrderOrPriority, Technique } from \"./Techniques\";\r\nimport { Definitions, Style, Styles } from \"./Theme\";\r\n\r\nconst logger = LoggerManager.instance.create(\"StyleSetEvaluator\");\r\n\r\nconst DEFAULT_TECHNIQUE_ATTR_SCOPE = AttrScope.TechniqueGeometry;\r\n\r\n/**\r\n * Get the attribute scope of the given style property.\r\n *\r\n * @remarks\r\n * Certain Style properties change their dynamic scope behavior\r\n * based on other properties. For example, the `color` property\r\n * of `extruded-polygon` change behavior based on the usage\r\n * of `vertexColors`.\r\n *\r\n * @param style A valid Style.\r\n * @param attrName The name of the attribute of the {@link style}.\r\n */\r\nfunction getStyleAttributeScope(style: InternalStyle, attrName: string): AttrScope {\r\n    if (style.technique === \"extruded-polygon\") {\r\n        if (attrName === \"color\" && style.vertexColors !== false) {\r\n            return DEFAULT_TECHNIQUE_ATTR_SCOPE;\r\n        }\r\n    }\r\n\r\n    return (\r\n        getTechniqueAttributeDescriptor(style.technique, attrName)?.scope ??\r\n        DEFAULT_TECHNIQUE_ATTR_SCOPE\r\n    );\r\n}\r\n\r\ninterface StyleInternalParams {\r\n    /**\r\n     * Optimization: Lazy creation and storage of expression in a style object.\r\n     */\r\n    _whenExpr?: Expr;\r\n    _minZoomLevelExpr?: Expr;\r\n    _maxZoomLevelExpr?: Expr;\r\n\r\n    _staticAttributes?: Array<[string, Value]>;\r\n\r\n    /**\r\n     * These attributes are used to instantiate Technique variants.\r\n     *\r\n     * @see [[TechiqueDescriptor.techniquePropNames]]\r\n     */\r\n    _dynamicTechniqueAttributes?: Array<[string, Expr]>;\r\n\r\n    /**\r\n     * These attributes must be evaluated basing with feature env.\r\n     *\r\n     * They are not propagated to rendering scope.\r\n     *\r\n     * @see [[TechniqueAttrScope.Feature]]\r\n     */\r\n    _dynamicFeatureAttributes?: Array<[string, Expr]>;\r\n\r\n    /**\r\n     * These attributes are forwarded as serialized by decoder to main thread, so they are resolved\r\n     * directly in render loop.\r\n     *\r\n     * Will contain attributes from these lists\r\n     *  - interpolants from [[TechiqueDescriptor.techniquePropNames]]\r\n     *  - expressions [[TechniqueDescriptor.dynamicPropNames]] (Future)\r\n     */\r\n    _dynamicForwardedAttributes?: Array<[string, Expr]>;\r\n    _dynamicTechniques?: Map<string, IndexedTechnique>;\r\n\r\n    /**\r\n     * Optimization: Index into table in StyleSetEvaluator.\r\n     * @hidden\r\n     */\r\n    _staticTechnique?: IndexedTechnique;\r\n\r\n    /**\r\n     * Optimization: StyleSet index.\r\n     * @hidden\r\n     */\r\n    _styleSetIndex?: number;\r\n\r\n    /**\r\n     * Optimization: Requested $geometryType.\r\n     * @hidden\r\n     */\r\n    _geometryType?: string;\r\n\r\n    /**\r\n     * `true` if any of the properties of this technique\r\n     * requires access to the feature's state.\r\n     */\r\n    _usesFeatureState?: boolean;\r\n}\r\n\r\ntype InternalStyle = Style & StyleInternalParams;\r\n\r\n/**\r\n * `StyleConditionClassifier` searches for usages of `$layer` in `when` conditions\r\n * associated with styling rules.\r\n *\r\n * @hidden\r\n */\r\nclass StyleConditionClassifier implements ExprVisitor<Expr | undefined, Expr | undefined> {\r\n    private _style!: InternalStyle;\r\n\r\n    classify(style: InternalStyle) {\r\n        if (style._whenExpr) {\r\n            const savedStyle = this.switchStyle(style);\r\n            style._whenExpr = style._whenExpr.accept(this, undefined);\r\n            this._style = savedStyle;\r\n        }\r\n    }\r\n\r\n    visitNullLiteralExpr(expr: NullLiteralExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitBooleanLiteralExpr(expr: BooleanLiteralExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitNumberLiteralExpr(expr: NumberLiteralExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitStringLiteralExpr(expr: StringLiteralExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitObjectLiteralExpr(expr: ObjectLiteralExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitVarExpr(expr: VarExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitHasAttributeExpr(expr: HasAttributeExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitMatchExpr(expr: MatchExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitCaseExpr(expr: CaseExpr, enclosingExpr: Expr | undefined): Expr {\r\n        return expr;\r\n    }\r\n\r\n    visitCallExpr(call: CallExpr, enclosingExpr: Expr | undefined): Expr | undefined {\r\n        if (call.op === \"all\") {\r\n            // processing of an `[\"all\", e1, e2, ... eN]` expression. In this case\r\n            // search for expressions matching comparison of `$layer` and string literals\r\n            // in the sub expressions.\r\n            const children = call.args\r\n                .map(childExpr => childExpr.accept(this, call))\r\n                .filter(childExpr => childExpr !== undefined) as Expr[];\r\n\r\n            return new CallExpr(call.op, children);\r\n        } else if (enclosingExpr) {\r\n            // `call` is a direct child expression of an `\"all\"` operator.\r\n            const matched = this.matchVarStringComparison(call);\r\n\r\n            if (matched) {\r\n                if (this._style.layer === undefined && matched.name === \"$layer\") {\r\n                    // found a subexpression `[\"==\", [\"get\", \"$layer\"], \"some layer name\"]`\r\n                    // enclosed in an `[\"all\", e1...eN]` expression. Remove it from\r\n                    // its parent expression and store the value of the expected $layer in\r\n                    // [[StyleInternalParams]].\r\n\r\n                    this._style.layer = matched.value;\r\n\r\n                    // return `undefined` to remove this sub expression from its parent.\r\n                    return undefined;\r\n                } else if (\r\n                    this._style._geometryType === undefined &&\r\n                    matched.name === \"$geometryType\"\r\n                ) {\r\n                    // found a subexpression `[\"==\", [\"get\", \"$geometryType\"], \"geometry\"]`\r\n                    // enclosed in an `[\"all\", e1...eN]` expression. Remove it from\r\n                    // its parent expression and store the value of the expected $geometryType in\r\n                    // [[StyleInternalParams]].\r\n\r\n                    this._style._geometryType = matched.value;\r\n\r\n                    // return `undefined` to remove this sub expression from its parent.\r\n                    return undefined;\r\n                }\r\n            }\r\n        }\r\n\r\n        return call;\r\n    }\r\n\r\n    visitLookupExpr(lookup: LookupExpr, enclosingExpr: Expr | undefined): Expr | undefined {\r\n        return this.visitCallExpr(lookup, enclosingExpr);\r\n    }\r\n\r\n    visitStepExpr(expr: StepExpr, enclosingExpr: Expr | undefined): Expr | undefined {\r\n        return expr;\r\n    }\r\n\r\n    visitInterpolateExpr(expr: InterpolateExpr, enclosingExpr: Expr | undefined): Expr | undefined {\r\n        return expr;\r\n    }\r\n\r\n    /**\r\n     * Tests if the given `call` matches the structure [\"==\", [\"get\", name], value].\r\n     * If a match is found returns an object containing the `name` and the `value`;\r\n     *\r\n     * @param call - The expression to match.\r\n     */\r\n    private matchVarStringComparison(call: CallExpr) {\r\n        if (call.op === \"==\") {\r\n            const left = call.args[0];\r\n            const right = call.args[1];\r\n\r\n            if (left instanceof VarExpr && right instanceof StringLiteralExpr) {\r\n                return { name: left.name, value: right.value };\r\n            }\r\n\r\n            if (right instanceof VarExpr && left instanceof StringLiteralExpr) {\r\n                return { name: right.name, value: left.value };\r\n            }\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Sets the given `style` as current.\r\n     *\r\n     * @returns The previous `style`.\r\n     */\r\n    private switchStyle(style: InternalStyle) {\r\n        const saved = this._style;\r\n        this._style = style;\r\n        return saved;\r\n    }\r\n}\r\n\r\nclass OptimizedSubSetKey {\r\n    key: string;\r\n    layer: string | undefined;\r\n    geometryType: string | undefined;\r\n\r\n    cachedStyleSet?: InternalStyle[];\r\n\r\n    constructor(layer?: string | undefined, geometryType?: string | undefined) {\r\n        this.key = \"\";\r\n        this.set(layer, geometryType);\r\n    }\r\n\r\n    set(\r\n        layer: string | undefined,\r\n        geometryType: string | undefined,\r\n        env?: Env\r\n    ): OptimizedSubSetKey {\r\n        let keyUpdateNeeded: boolean = false;\r\n        if (layer === undefined) {\r\n            const envLayer = env !== undefined ? env.lookup(\"$layer\") : undefined;\r\n            layer = typeof envLayer === \"string\" ? envLayer : undefined;\r\n        }\r\n        if (this.layer !== layer) {\r\n            this.layer = layer;\r\n            keyUpdateNeeded = true;\r\n        }\r\n\r\n        if (geometryType === undefined) {\r\n            const envGeometryType = env !== undefined ? env.lookup(\"$geometryType\") : undefined;\r\n            geometryType = typeof envGeometryType === \"string\" ? envGeometryType : undefined;\r\n        }\r\n        if (this.geometryType !== geometryType) {\r\n            this.geometryType = geometryType;\r\n            keyUpdateNeeded = true;\r\n        }\r\n\r\n        if (keyUpdateNeeded) {\r\n            this.updateKey();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    private updateKey() {\r\n        if (this.layer !== undefined) {\r\n            if (this.geometryType !== undefined) {\r\n                this.key = `${this.layer}:${this.geometryType}`;\r\n            } else {\r\n                this.key = `${this.layer}:`;\r\n            }\r\n        } else {\r\n            if (this.geometryType !== undefined) {\r\n                this.key = `:${this.geometryType}`;\r\n            } else {\r\n                this.key = \"all\";\r\n            }\r\n        }\r\n        this.cachedStyleSet = undefined;\r\n    }\r\n}\r\n\r\n/**\r\n * Options to be passed to the StyleSetEvaluator\r\n *\r\n * Basically identical as the DecoderOptions but requires styleSet to be set.\r\n */\r\nexport type StyleSetOptions = Omit<DecoderOptions, \"languages\"> & { styleSet: Styles };\r\n\r\n/**\r\n * Combine data from datasource and apply the rules from a specified theme to show it on the map.\r\n */\r\nexport class StyleSetEvaluator {\r\n    readonly styleSet: InternalStyle[];\r\n\r\n    private readonly m_techniques: IndexedTechnique[] = [];\r\n    private readonly m_exprPool = new ExprPool();\r\n    private readonly m_cachedResults = new Map<Expr, Value>();\r\n    private readonly m_styleConditionClassifier = new StyleConditionClassifier();\r\n    private readonly m_subStyleSetCache = new Map<string, InternalStyle[]>();\r\n    private readonly m_definitions?: Definitions;\r\n    private readonly m_definitionExprCache = new Map<string, Expr>();\r\n    private readonly m_tmpOptimizedSubSetKey: OptimizedSubSetKey = new OptimizedSubSetKey();\r\n    private readonly m_emptyEnv = new Env();\r\n    private m_featureDependencies: string[] = [];\r\n    private m_layer: string | undefined;\r\n    private m_geometryType: string | undefined;\r\n    private m_zoomLevel: number | undefined;\r\n    private m_previousResult: IndexedTechnique[] | undefined;\r\n    private m_previousEnv: Env | undefined;\r\n    private m_nextArrayBufferId = 0;\r\n\r\n    constructor(private readonly m_options: StyleSetOptions) {\r\n        this.m_definitions = this.m_options.definitions;\r\n        this.styleSet = resolveReferences(this.m_options.styleSet, this.m_definitions);\r\n        computeDefaultRenderOrder(this.styleSet);\r\n        this.compileStyleSet();\r\n    }\r\n\r\n    /**\r\n     * Find all techniques that fit the current objects' environment.\r\n     * *The techniques in the resulting array may not be modified* since they are being reused for\r\n     * identical objects.\r\n     *\r\n     * @param env - The objects environment, i.e. the attributes that are relevant for its\r\n     * representation.\r\n     * @param layer - The optional layer name used to filter techniques.\r\n     * @param geometryType - The optional geometryType used to filter techniques.\r\n     */\r\n    getMatchingTechniques(\r\n        env: Env,\r\n        layer?: string | undefined,\r\n        geometryType?: string | undefined\r\n    ): IndexedTechnique[] {\r\n        if (\r\n            this.m_previousResult &&\r\n            this.m_previousEnv &&\r\n            this.m_featureDependencies.every(p => this.m_previousEnv?.lookup(p) === env.lookup(p))\r\n        ) {\r\n            return this.m_previousResult;\r\n        }\r\n\r\n        const result: IndexedTechnique[] = [];\r\n        this.m_cachedResults.clear();\r\n\r\n        const optimizedSubSetKey = this.m_tmpOptimizedSubSetKey;\r\n        optimizedSubSetKey.set(layer, geometryType, env);\r\n\r\n        // get the requested $layer and $geometryType, if any.\r\n        this.m_layer = optimizedSubSetKey.layer;\r\n        this.m_geometryType = optimizedSubSetKey.geometryType;\r\n        this.m_zoomLevel = env.lookup(\"$zoom\") as number | undefined;\r\n\r\n        const searchedStyleSet = this.getOptimizedStyleSet(optimizedSubSetKey);\r\n\r\n        for (const currStyle of searchedStyleSet) {\r\n            if (this.processStyle(env, currStyle, result)) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.m_previousResult = result;\r\n        this.m_previousEnv = env;\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Check if `styleSet` contains any rule related to `layer`.\r\n     *\r\n     * @param layer - name of layer\r\n     */\r\n    wantsLayer(layer: string): boolean {\r\n        return (\r\n            this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(layer, undefined)).length > 0\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Check if `styleSet` contains any rule related to particular `[layer, geometryType]` pair.\r\n     *\r\n     * @param layer - name of layer\r\n     * @param geometryType - type of layer - `point`, `line` or `polygon`\r\n     */\r\n    wantsFeature(layer: string, geometryType?: string): boolean {\r\n        return (\r\n            this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(layer, geometryType))\r\n                .length > 0\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Reset array of techniques.\r\n     *\r\n     * Cleans technique array and indices, so it doesn't accumulate accross several decoding runs.\r\n     */\r\n    resetTechniques() {\r\n        for (const techinque of this.m_techniques) {\r\n            techinque._index = undefined!;\r\n        }\r\n        this.m_techniques.length = 0;\r\n        this.m_previousResult = undefined;\r\n        this.m_previousEnv = undefined;\r\n    }\r\n\r\n    /**\r\n     * Get the (current) array of techniques that have been created during decoding.\r\n     */\r\n    get techniques(): IndexedTechnique[] {\r\n        return this.m_techniques;\r\n    }\r\n\r\n    /**\r\n     * Get the (current) array of techniques that have been created during decoding.\r\n     */\r\n    get decodedTechniques(): IndexedTechnique[] {\r\n        return this.m_techniques.map(makeDecodedTechnique);\r\n    }\r\n\r\n    private getOptimizedStyleSet(subSetKey: OptimizedSubSetKey): InternalStyle[] {\r\n        if (subSetKey.cachedStyleSet !== undefined) {\r\n            return subSetKey.cachedStyleSet;\r\n        }\r\n        let optimizedStyleSet = this.m_subStyleSetCache.get(subSetKey.key);\r\n        if (optimizedStyleSet !== undefined) {\r\n            subSetKey.cachedStyleSet = optimizedStyleSet;\r\n            return optimizedStyleSet;\r\n        }\r\n        optimizedStyleSet = this.createPreFilteredStyleSet(subSetKey);\r\n        this.m_subStyleSetCache.set(subSetKey.key, optimizedStyleSet);\r\n        subSetKey.cachedStyleSet = optimizedStyleSet;\r\n        return optimizedStyleSet;\r\n    }\r\n\r\n    private createPreFilteredStyleSet(subSetKey: OptimizedSubSetKey) {\r\n        const { layer, geometryType } = subSetKey;\r\n\r\n        return this.styleSet.filter(style => {\r\n            if (layer !== undefined && style.layer !== undefined && style.layer !== layer) {\r\n                return false;\r\n            }\r\n            if (\r\n                geometryType !== undefined &&\r\n                style._geometryType !== undefined &&\r\n                style._geometryType !== geometryType\r\n            ) {\r\n                return false;\r\n            }\r\n            return true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Compile the `when` conditions found when traversting the styling rules.\r\n     */\r\n    private compileStyleSet() {\r\n        this.m_featureDependencies = [\"$layer\", \"$geometryType\", \"$zoom\"];\r\n\r\n        this.styleSet.forEach(style => this.compileStyle(style));\r\n\r\n        // Create optimized styleSets for each `layer` & `geometryType` tuple.\r\n        this.styleSet.forEach(style => {\r\n            this.getOptimizedStyleSet(\r\n                this.m_tmpOptimizedSubSetKey.set(style.layer, style._geometryType)\r\n            );\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Compile the `when` conditions reachable from the given `style`.\r\n     *\r\n     * @param style - The current style.\r\n     */\r\n    private compileStyle(style: InternalStyle) {\r\n        this.checkStyleDynamicAttributes(style);\r\n\r\n        if (style.when !== undefined) {\r\n            try {\r\n                style._whenExpr = Array.isArray(style.when)\r\n                    ? Expr.fromJSON(style.when, this.m_definitions, this.m_definitionExprCache)\r\n                    : Expr.parse(style.when);\r\n\r\n                // search for usages of '$layer' and any other\r\n                // special symbol that can be used to speed up the evaluation\r\n                // of the `when` conditions associated to this `style`.\r\n                this.m_styleConditionClassifier.classify(style);\r\n\r\n                if (style._whenExpr !== undefined) {\r\n                    style._whenExpr = style._whenExpr.intern(this.m_exprPool);\r\n                }\r\n\r\n                const deps = style._whenExpr.dependencies();\r\n\r\n                deps?.properties.forEach(prop => {\r\n                    if (!this.m_featureDependencies.includes(prop)) {\r\n                        this.m_featureDependencies.push(prop);\r\n                    }\r\n                });\r\n\r\n                if (isJsonExpr(style.minZoomLevel)) {\r\n                    style._minZoomLevelExpr = Expr.fromJSON(\r\n                        style.minZoomLevel,\r\n                        this.m_definitions\r\n                    ).intern(this.m_exprPool);\r\n                }\r\n\r\n                if (isJsonExpr(style.maxZoomLevel)) {\r\n                    style._maxZoomLevelExpr = Expr.fromJSON(\r\n                        style.maxZoomLevel,\r\n                        this.m_definitions\r\n                    ).intern(this.m_exprPool);\r\n                }\r\n            } catch (err) {\r\n                logger.log(\r\n                    \"failed to evaluate expression\",\r\n                    JSON.stringify(style.when),\r\n                    \"error\",\r\n                    String(err)\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Process a style (and its sub-styles) hierarchically to look for the technique that fits the\r\n     * current objects' environment. The attributes of the styles are assembled to create a unique\r\n     * technique for every object.\r\n     *\r\n     * @param env - The objects environment, i.e. the attributes that are relevant for its\r\n     *            representation.\r\n     * @param style - Current style (could also be top of stack).\r\n     * @param result - The array of resulting techniques. There may be more than one technique per\r\n     *               object, resulting in multiple graphical objects for representation.\r\n     * @returns `true` if style has been found and processing is finished. `false` if not found, or\r\n     *          more than one technique should be applied.\r\n     */\r\n    private processStyle(env: Env, style: InternalStyle, result: Technique[]): boolean {\r\n        if (!this.checkZoomLevel(env, style)) {\r\n            return false;\r\n        }\r\n\r\n        if (\r\n            this.m_layer !== undefined &&\r\n            style.layer !== undefined &&\r\n            style.layer !== this.m_layer\r\n        ) {\r\n            return false;\r\n        }\r\n        if (\r\n            this.m_geometryType !== undefined &&\r\n            style._geometryType !== undefined &&\r\n            style._geometryType !== this.m_geometryType\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        if (style._whenExpr) {\r\n            try {\r\n                if (!style._whenExpr.evaluate(env, ExprScope.Condition, this.m_cachedResults)) {\r\n                    // Stop processing this styling rule. The `when` condition\r\n                    // associated with the current `style` evaluates to false so\r\n                    // no techinque defined by this style should be applied.\r\n                    return false;\r\n                }\r\n            } catch (error) {\r\n                logger.error(\r\n                    `failed to evaluate expression '${JSON.stringify(style.when)}': ${error}`\r\n                );\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (style.technique === undefined) {\r\n            return false;\r\n        }\r\n        // we found a technique!\r\n        if (style.technique !== \"none\") {\r\n            result.push(this.getTechniqueForStyleMatch(env, style));\r\n        }\r\n        // stop processing if \"final\" is set\r\n        return style.final === true;\r\n    }\r\n\r\n    private checkZoomLevel(env: Env, style: InternalStyle) {\r\n        if (style.minZoomLevel === undefined && style.maxZoomLevel === undefined) {\r\n            return true;\r\n        }\r\n\r\n        const zoomLevel = this.m_zoomLevel;\r\n        if (zoomLevel === undefined) {\r\n            return true;\r\n        }\r\n\r\n        if (style.minZoomLevel !== undefined) {\r\n            let minZoomLevel: Value = style.minZoomLevel;\r\n\r\n            if (style._minZoomLevelExpr?.isDynamic() === false) {\r\n                // Only filter by zoom level if the expression is not dynamic.\r\n                try {\r\n                    minZoomLevel = style._minZoomLevelExpr.evaluate(\r\n                        env,\r\n                        ExprScope.Condition,\r\n                        this.m_cachedResults\r\n                    );\r\n                } catch (error) {\r\n                    logger.error(\r\n                        `failed to evaluate expression '${JSON.stringify(\r\n                            style._minZoomLevelExpr\r\n                        )}': ${error}`\r\n                    );\r\n                }\r\n            }\r\n\r\n            if (typeof minZoomLevel === \"number\" && zoomLevel < minZoomLevel) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (style.maxZoomLevel !== undefined) {\r\n            let maxZoomLevel: Value = style.maxZoomLevel;\r\n\r\n            if (style._maxZoomLevelExpr?.isDynamic() === false) {\r\n                // Only filter by zoom level if the expression is not dynamic.\r\n                try {\r\n                    maxZoomLevel = style._maxZoomLevelExpr.evaluate(\r\n                        env,\r\n                        ExprScope.Condition,\r\n                        this.m_cachedResults\r\n                    );\r\n                } catch (error) {\r\n                    logger.error(\r\n                        `failed to evaluate expression '${JSON.stringify(\r\n                            style._maxZoomLevelExpr\r\n                        )}': ${error}`\r\n                    );\r\n                }\r\n            }\r\n\r\n            if (typeof maxZoomLevel === \"number\" && zoomLevel >= maxZoomLevel) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private getTechniqueForStyleMatch(env: Env, style: InternalStyle) {\r\n        let technique: IndexedTechnique | undefined;\r\n        if (style._dynamicTechniques !== undefined) {\r\n            const dynamicAttributes = this.evaluateTechniqueProperties(style, env);\r\n            const key = this.getDynamicTechniqueKey(style, dynamicAttributes);\r\n            technique = style._dynamicTechniques!.get(key);\r\n            if (technique === undefined) {\r\n                technique = this.createTechnique(style, key, dynamicAttributes);\r\n                style._dynamicTechniques!.set(key, technique);\r\n            }\r\n        } else {\r\n            technique = style._staticTechnique;\r\n            if (technique === undefined) {\r\n                style._staticTechnique = technique = this.createTechnique(\r\n                    style,\r\n                    `${style._styleSetIndex}`,\r\n                    []\r\n                ) as IndexedTechnique;\r\n            }\r\n        }\r\n\r\n        if (technique._index === undefined) {\r\n            technique._index = this.m_techniques.length;\r\n            this.m_techniques.push(technique);\r\n        }\r\n        return technique;\r\n    }\r\n\r\n    private getDynamicTechniqueKey(\r\n        style: InternalStyle,\r\n        dynamicAttributes: Array<[string, Value]>\r\n    ) {\r\n        const dynamicAttrKey = dynamicAttributes\r\n            .map(([_attrName, attrValue]) => {\r\n                if (attrValue === undefined) {\r\n                    return \"U\";\r\n                } else if (typeof attrValue === \"object\") {\r\n                    return JSON.stringify(attrValue, (_, value) => {\r\n                        if (value instanceof ArrayBuffer) {\r\n                            // ArrayBuffers cannot be directly stringified. They can be converted\r\n                            // to typed arrays and then stringified, but it's too slow. Instead,\r\n                            // assign them unique ids.\r\n                            let arrayBufferId = (value as any).id;\r\n                            if (arrayBufferId === undefined) {\r\n                                arrayBufferId = (value as any).id = this.m_nextArrayBufferId++;\r\n                            }\r\n                            return arrayBufferId;\r\n                        }\r\n                        return value;\r\n                    });\r\n                } else {\r\n                    return JSON.stringify(attrValue);\r\n                }\r\n            })\r\n            .join(\":\");\r\n        return `${style._styleSetIndex!}:${dynamicAttrKey}`;\r\n    }\r\n\r\n    private checkStyleDynamicAttributes(style: InternalStyle) {\r\n        if (style._dynamicTechniqueAttributes !== undefined || style.technique === \"none\") {\r\n            return;\r\n        }\r\n\r\n        style._dynamicTechniqueAttributes = [];\r\n        style._dynamicFeatureAttributes = [];\r\n        style._dynamicForwardedAttributes = [];\r\n        style._staticAttributes = [];\r\n\r\n        const dynamicFeatureAttributes = style._dynamicFeatureAttributes;\r\n        const dynamicTechniqueAttributes = style._dynamicTechniqueAttributes;\r\n        const dynamicForwardedAttributes = style._dynamicForwardedAttributes;\r\n        const targetStaticAttributes = style._staticAttributes;\r\n\r\n        const processAttribute = (attrName: string, attrValue: Value | JsonExpr | undefined) => {\r\n            if (attrValue === undefined) {\r\n                return;\r\n            }\r\n\r\n            if (isJsonExpr(attrValue)) {\r\n                attrValue = Expr.fromJSON(\r\n                    attrValue,\r\n                    this.m_definitions,\r\n                    this.m_definitionExprCache\r\n                ).intern(this.m_exprPool);\r\n            } else if (isInterpolatedPropertyDefinition(attrValue)) {\r\n                // found a property using an object-like interpolation definition.\r\n                attrValue = Expr.fromJSON(\r\n                    interpolatedPropertyDefinitionToJsonExpr(attrValue)\r\n                ).intern(this.m_exprPool);\r\n            }\r\n\r\n            if (Expr.isExpr(attrValue)) {\r\n                const deps = attrValue.dependencies();\r\n\r\n                if (deps.featureState) {\r\n                    if (attrName !== \"enabled\") {\r\n                        logger.log(\"feature-state is not supported in this context\");\r\n                    } else {\r\n                        style._usesFeatureState = true;\r\n                    }\r\n                }\r\n\r\n                if (deps.properties.size === 0 && !attrValue.isDynamic()) {\r\n                    // no data-dependencies detected.\r\n                    attrValue = attrValue.evaluate(this.m_emptyEnv);\r\n                }\r\n            }\r\n\r\n            if (Expr.isExpr(attrValue)) {\r\n                const attrScope = getStyleAttributeScope(style, attrName);\r\n\r\n                const deps = attrValue.dependencies();\r\n\r\n                deps.properties.forEach(prop => {\r\n                    if (!this.m_featureDependencies.includes(prop)) {\r\n                        this.m_featureDependencies.push(prop);\r\n                    }\r\n                });\r\n\r\n                switch (attrScope) {\r\n                    case AttrScope.FeatureGeometry:\r\n                        dynamicFeatureAttributes.push([attrName, attrValue]);\r\n                        break;\r\n                    case AttrScope.TechniqueGeometry:\r\n                        dynamicTechniqueAttributes.push([attrName, attrValue]);\r\n                        break;\r\n                    case AttrScope.TechniqueRendering:\r\n                        if (deps.properties.size === 0) {\r\n                            dynamicForwardedAttributes.push([attrName, attrValue]);\r\n                        } else {\r\n                            dynamicTechniqueAttributes.push([attrName, attrValue]);\r\n                        }\r\n                        break;\r\n                }\r\n            } else if (attrValue !== undefined && attrValue !== null) {\r\n                targetStaticAttributes.push([attrName, attrValue]);\r\n            }\r\n        };\r\n\r\n        const replacement = new Map<string, string>([\r\n            [\"category\", \"_category\"],\r\n            [\"secondaryCategory\", \"_secondaryCategory\"]\r\n        ]);\r\n\r\n        for (const p in style) {\r\n            if (!style.hasOwnProperty(p)) {\r\n                continue;\r\n            }\r\n            if (p.startsWith(\"_\")) {\r\n                continue;\r\n            }\r\n            if ([\"when\", \"technique\", \"layer\", \"attr\", \"description\"].includes(p)) {\r\n                continue;\r\n            }\r\n            const pp = replacement.get(p) ?? p;\r\n            processAttribute(pp, (style as any)[p]);\r\n        }\r\n\r\n        if (style.attr !== undefined) {\r\n            for (const attrName in style.attr) {\r\n                if (!style.attr.hasOwnProperty(attrName)) {\r\n                    continue;\r\n                }\r\n                processAttribute(attrName, (style.attr as any)[attrName]);\r\n            }\r\n        }\r\n\r\n        if (dynamicTechniqueAttributes.length > 0) {\r\n            style._dynamicTechniques = new Map();\r\n        }\r\n    }\r\n\r\n    private evaluateTechniqueProperties(style: InternalStyle, env: Env): Array<[string, Value]> {\r\n        if (style._dynamicTechniqueAttributes === undefined) {\r\n            return [];\r\n        }\r\n\r\n        return style._dynamicTechniqueAttributes.map(([attrName, attrExpr]) => {\r\n            try {\r\n                const evaluatedValue = attrExpr.evaluate(\r\n                    env,\r\n                    ExprScope.Value,\r\n                    this.m_cachedResults\r\n                );\r\n                return [attrName, evaluatedValue];\r\n            } catch (error) {\r\n                logger.error(`failed to evaluate expression '${attrExpr.toJSON()}': ${error}`);\r\n                return [attrName, null];\r\n            }\r\n        });\r\n    }\r\n\r\n    private createTechnique(\r\n        style: InternalStyle,\r\n        key: string,\r\n        dynamicAttrs: Array<[string, Value]>\r\n    ) {\r\n        const technique: any = {};\r\n        technique.name = style.technique;\r\n        if (style._staticAttributes !== undefined) {\r\n            for (const [attrName, attrValue] of style._staticAttributes) {\r\n                if (attrValue !== null) {\r\n                    technique[attrName] = attrValue;\r\n                }\r\n            }\r\n        }\r\n        for (const [attrName, attrValue] of dynamicAttrs) {\r\n            if (attrValue !== null) {\r\n                technique[attrName] = attrValue;\r\n            }\r\n        }\r\n\r\n        if (style._dynamicFeatureAttributes !== undefined) {\r\n            for (const [attrName, attrValue] of style._dynamicFeatureAttributes) {\r\n                technique[attrName] = attrValue;\r\n            }\r\n        }\r\n\r\n        if (style._dynamicForwardedAttributes !== undefined) {\r\n            for (const [attrName, attrValue] of style._dynamicForwardedAttributes) {\r\n                technique[attrName] = attrValue;\r\n            }\r\n        }\r\n\r\n        technique._index = this.m_techniques.length;\r\n        technique._styleSetIndex = style._styleSetIndex!;\r\n        if (style.styleSet !== undefined) {\r\n            technique._styleSet = style.styleSet;\r\n        }\r\n        if (style._usesFeatureState !== undefined) {\r\n            technique._usesFeatureState = style._usesFeatureState;\r\n        }\r\n        setTechniqueRenderOrderOrPriority(\r\n            technique,\r\n            this.m_options.priorities ?? [],\r\n            this.m_options.labelPriorities ?? []\r\n        );\r\n        this.m_techniques.push(technique as IndexedTechnique);\r\n        return technique as IndexedTechnique;\r\n    }\r\n}\r\n\r\nfunction computeDefaultRenderOrder(styleSet: InternalStyle[]) {\r\n    let techniqueRenderOrder = 0;\r\n    let styleSetIndex = 0;\r\n    for (const style of styleSet) {\r\n        style._styleSetIndex = styleSetIndex++;\r\n        if (style.technique !== undefined && style.renderOrder === undefined) {\r\n            style.renderOrder = techniqueRenderOrder++;\r\n        }\r\n    }\r\n}\r\n\r\nfunction resolveReferences(styleSet: Style[], definitions: Definitions | undefined) {\r\n    return styleSet.map(style => resolveStyleReferences(style, definitions));\r\n}\r\n\r\nfunction resolveStyleReferences(style: Style, definitions: Definitions | undefined): InternalStyle {\r\n    return { ...style };\r\n}\r\n\r\n/**\r\n * Create transferable representation of dynamic technique.\r\n *\r\n * Converts  non-transferable {@link Expr}instances back to JSON form.\r\n */\r\nexport function makeDecodedTechnique(technique: IndexedTechnique): IndexedTechnique {\r\n    const result: Partial<IndexedTechnique> = {};\r\n    for (const attrName in technique) {\r\n        if (!technique.hasOwnProperty(attrName)) {\r\n            continue;\r\n        }\r\n\r\n        let attrValue: any = (technique as any)[attrName];\r\n\r\n        if (\r\n            typeof attrValue === \"object\" &&\r\n            (attrValue.isVector2 || attrValue.isVector3 || attrValue.isVector4)\r\n        ) {\r\n            attrValue = LiteralExpr.fromValue(attrValue);\r\n        }\r\n\r\n        if (Expr.isExpr(attrValue)) {\r\n            attrValue = attrValue.toJSON();\r\n        }\r\n\r\n        (result as any)[attrName] = attrValue;\r\n    }\r\n    return (result as any) as IndexedTechnique;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Env, Expr, MapEnv, Value } from \"./Expr\";\r\nimport { getPropertyValue } from \"./PropertyValue\";\r\n\r\nexport interface AttrEvaluationContext {\r\n    /**\r\n     * Expression evaluation environment containing variable bindings.\r\n     */\r\n    env: MapEnv;\r\n\r\n    /**\r\n     * Optional, cache of expression results.\r\n     *\r\n     * @see [[Expr.evaluate]]\r\n     */\r\n    cachedExprResults?: Map<Expr, Value>;\r\n}\r\n\r\n/**\r\n * Evaluate feature attr _without_ default value.\r\n *\r\n * @returns actual value or `undefined`\r\n */\r\nexport function evaluateTechniqueAttr<T = Value>(\r\n    context: Env | AttrEvaluationContext,\r\n    attrValue: T | Expr | undefined\r\n): T | undefined;\r\n\r\n/**\r\n * Evaluate feature attr _with_ default value.\r\n *\r\n * @returns actual value or `defaultValue`\r\n */\r\nexport function evaluateTechniqueAttr<T extends Value>(\r\n    context: Env | AttrEvaluationContext,\r\n    attrValue: T | Expr | undefined,\r\n    defaultValue: T\r\n): T;\r\n\r\nexport function evaluateTechniqueAttr<T = Value>(\r\n    context: Env | AttrEvaluationContext,\r\n    attrValue: Value | undefined,\r\n    defaultValue?: T\r\n): T | undefined {\r\n    if (attrValue === undefined) {\r\n        return defaultValue;\r\n    }\r\n\r\n    const result = Env.isEnv(context)\r\n        ? getPropertyValue(attrValue, context)\r\n        : getPropertyValue(attrValue, context.env, context.cachedExprResults);\r\n\r\n    return result ?? defaultValue;\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport {\r\n    BaseTechniqueParams,\r\n    PointTechniqueParams,\r\n    PolygonalTechniqueParams\r\n} from \"./TechniqueParams\";\r\nimport {\r\n    CirclesTechnique,\r\n    ExtrudedPolygonTechnique,\r\n    FillTechnique,\r\n    IndexedTechnique,\r\n    LineMarkerTechnique,\r\n    LineTechnique,\r\n    ShaderTechnique,\r\n    SolidLineTechnique,\r\n    SquaresTechnique,\r\n    StandardTechnique,\r\n    Technique,\r\n    TextTechnique\r\n} from \"./Techniques\";\r\n\r\nexport enum AttrScope {\r\n    /**\r\n     * Attributes that affect generation of feature geometry and thus must be resolved at decoding\r\n     * time.\r\n     *\r\n     * @remarks\r\n     * They may have huge variancy as they are implemented as vertex attributes or embedded in\r\n     * generated meshes.\r\n     *\r\n     * These attributes are available only in decoding scope.\r\n     */\r\n    FeatureGeometry,\r\n\r\n    /**\r\n     * Attributes that are common to whole group of features drawn with this technique.\r\n     * These attributes affect generated geometry and  thus must be resolved at decoding time.\r\n     *\r\n     * @remarks\r\n     * They shouldn't have big variancy and evaluate to at least dozens of values as each\r\n     * combination of these attributes consitute new technique and material.\r\n     *\r\n     * These attributes are available in decoding and rendering scope.\r\n     */\r\n    TechniqueGeometry,\r\n\r\n    /**\r\n     * Attributes that are common to whole group of features drawn with this technique.\r\n     *\r\n     * @remarks\r\n     * Attributes that can be changed in resulting object/material from frame to frame. They are\r\n     * usually implemented as uniforms.\r\n     *\r\n     * These attributes may be available only at rendering scope.\r\n     */\r\n    TechniqueRendering\r\n}\r\n\r\n/**\r\n * Extract  property names from `Technique`-like interface (excluding `name`) as union of string\r\n * literals.\r\n *\r\n * TechniquePropName<Base\r\n *\r\n */\r\ntype TechniquePropNames<T> = T extends { name: any } ? keyof Omit<T, \"name\"> : keyof T;\r\n\r\ninterface AttrDescriptor {\r\n    /**\r\n     * The evaluation scope of this attribute.\r\n     */\r\n    scope?: AttrScope;\r\n\r\n    /**\r\n     * Mark this attribute as automatic.\r\n     *\r\n     * @remarks\r\n     * When set to `true`, the underlying material property\r\n     * associated with this attribute is automatically kept in sync\r\n     * with the value of the technique attribute.\r\n     */\r\n    automatic?: boolean;\r\n}\r\n\r\ntype TechniqueAttrDescriptors<T> = {\r\n    [P in TechniquePropNames<T>]?: AttrScope | AttrDescriptor;\r\n};\r\n\r\nexport interface TechniqueDescriptor<T = Technique> {\r\n    attrTransparencyColor?: string;\r\n    attrDescriptors: TechniqueAttrDescriptors<T>;\r\n}\r\n\r\ntype OneThatMatches<T, P> = T extends P ? T : never;\r\ntype TechniqueByName<K extends Technique[\"name\"]> = OneThatMatches<Technique, { name: K }>;\r\n\r\ntype TechniqueDescriptorRegistry = {\r\n    [P in Technique[\"name\"]]?: TechniqueDescriptor<TechniqueByName<P>>;\r\n};\r\n\r\n/**\r\n * @internal\r\n */\r\nfunction mergeTechniqueDescriptor<T>(\r\n    ...descriptors: Array<Partial<TechniqueDescriptor<T>>>\r\n): TechniqueDescriptor<T> {\r\n    const result: TechniqueDescriptor<T> = {\r\n        attrDescriptors: {}\r\n    };\r\n    for (const descriptor of descriptors) {\r\n        if (descriptor.attrTransparencyColor !== undefined) {\r\n            result.attrTransparencyColor = descriptor.attrTransparencyColor;\r\n        }\r\n        if (descriptor.attrDescriptors !== undefined) {\r\n            result.attrDescriptors = { ...result.attrDescriptors, ...descriptor.attrDescriptors };\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nconst baseTechniqueParamsDescriptor: TechniqueDescriptor<BaseTechniqueParams> = {\r\n    // TODO: Choose which techniques should support color with transparency.\r\n    // For now we chosen all, but it maybe not suitable for text or line marker techniques.\r\n    attrTransparencyColor: \"color\",\r\n    attrDescriptors: {\r\n        constantHeight: AttrScope.FeatureGeometry,\r\n        enabled: AttrScope.FeatureGeometry,\r\n        fadeFar: AttrScope.TechniqueRendering,\r\n        fadeNear: AttrScope.TechniqueRendering,\r\n        transparent: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        side: { scope: AttrScope.TechniqueRendering, automatic: true }\r\n    }\r\n};\r\n\r\nconst pointTechniquePropTypes = mergeTechniqueDescriptor<PointTechniqueParams>(\r\n    baseTechniqueParamsDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            color: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            size: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            opacity: { scope: AttrScope.TechniqueRendering, automatic: true }\r\n        }\r\n    }\r\n);\r\n\r\nconst squaresTechniquePropTypes = mergeTechniqueDescriptor<SquaresTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    pointTechniquePropTypes\r\n);\r\n\r\nconst circlesTechniquePropTypes = mergeTechniqueDescriptor<CirclesTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    pointTechniquePropTypes\r\n);\r\n\r\nconst lineMarkerTechniquePropTypes = mergeTechniqueDescriptor<LineMarkerTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            text: AttrScope.FeatureGeometry,\r\n            label: AttrScope.FeatureGeometry,\r\n            useAbbreviation: AttrScope.FeatureGeometry,\r\n            useIsoCode: AttrScope.FeatureGeometry,\r\n            poiName: AttrScope.FeatureGeometry,\r\n            imageTexture: AttrScope.FeatureGeometry,\r\n            iconColor: AttrScope.TechniqueRendering,\r\n            iconBrightness: AttrScope.TechniqueRendering,\r\n            backgroundColor: AttrScope.TechniqueRendering,\r\n            backgroundSize: AttrScope.TechniqueRendering,\r\n            backgroundOpacity: AttrScope.TechniqueRendering,\r\n            color: AttrScope.TechniqueRendering,\r\n            opacity: AttrScope.TechniqueRendering,\r\n            size: AttrScope.TechniqueRendering\r\n        }\r\n    }\r\n);\r\n\r\nconst polygonalTechniqueDescriptor: TechniqueDescriptor<PolygonalTechniqueParams> = {\r\n    attrDescriptors: {\r\n        polygonOffset: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        polygonOffsetFactor: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        polygonOffsetUnits: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        depthTest: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        transparent: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        opacity: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        color: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n        lineColor: AttrScope.TechniqueRendering,\r\n        lineFadeFar: AttrScope.TechniqueRendering,\r\n        lineFadeNear: AttrScope.TechniqueRendering\r\n    }\r\n};\r\n\r\nconst solidLineTechniqueDescriptor = mergeTechniqueDescriptor<SolidLineTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    polygonalTechniqueDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            lineWidth: AttrScope.TechniqueRendering,\r\n            secondaryWidth: AttrScope.TechniqueRendering,\r\n            secondaryColor: AttrScope.TechniqueRendering,\r\n            dashSize: AttrScope.TechniqueRendering,\r\n            gapSize: AttrScope.TechniqueRendering,\r\n            outlineColor: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            caps: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            drawRangeStart: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            drawRangeEnd: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            dashes: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            dashColor: { scope: AttrScope.TechniqueRendering, automatic: true }\r\n        }\r\n    }\r\n);\r\n\r\nconst lineTechniqueDescriptor = mergeTechniqueDescriptor<LineTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            // TODO, check, which are really dynamic !\r\n            color: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            opacity: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            lineWidth: AttrScope.FeatureGeometry\r\n        }\r\n    }\r\n);\r\n\r\nconst fillTechniqueDescriptor = mergeTechniqueDescriptor<FillTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    polygonalTechniqueDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            wireframe: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            color: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            opacity: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            transparent: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            lineWidth: AttrScope.TechniqueRendering,\r\n            map: { scope: AttrScope.TechniqueRendering, automatic: true }\r\n        }\r\n    }\r\n);\r\n\r\nconst standardTechniqueDescriptor = mergeTechniqueDescriptor<StandardTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            color: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            vertexColors: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            wireframe: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            roughness: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            metalness: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            alphaTest: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            depthTest: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            transparent: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            opacity: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            emissive: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            emissiveIntensity: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            refractionRatio: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            normalMapType: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            map: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            normalMap: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            displacementMap: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            roughnessMap: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            emissiveMap: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            bumpMap: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            metalnessMap: { scope: AttrScope.TechniqueRendering, automatic: true },\r\n            alphaMap: { scope: AttrScope.TechniqueRendering, automatic: true }\r\n        }\r\n    }\r\n);\r\n\r\nconst extrudedPolygonTechniqueDescriptor = mergeTechniqueDescriptor<ExtrudedPolygonTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    standardTechniqueDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            height: AttrScope.FeatureGeometry,\r\n            floorHeight: AttrScope.FeatureGeometry,\r\n            color: AttrScope.FeatureGeometry,\r\n            defaultColor: AttrScope.FeatureGeometry,\r\n            defaultHeight: AttrScope.FeatureGeometry,\r\n            boundaryWalls: AttrScope.FeatureGeometry,\r\n            footprint: AttrScope.FeatureGeometry,\r\n            maxSlope: AttrScope.FeatureGeometry,\r\n            animateExtrusion: AttrScope.TechniqueRendering,\r\n            lineWidth: AttrScope.TechniqueRendering,\r\n            lineFadeNear: AttrScope.TechniqueRendering,\r\n            lineFadeFar: AttrScope.TechniqueRendering,\r\n            lineColor: AttrScope.TechniqueRendering\r\n        }\r\n    }\r\n);\r\n\r\nconst textTechniqueDescriptor = mergeTechniqueDescriptor<TextTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            text: AttrScope.FeatureGeometry,\r\n            label: AttrScope.FeatureGeometry,\r\n            useAbbreviation: AttrScope.FeatureGeometry,\r\n            useIsoCode: AttrScope.FeatureGeometry,\r\n            backgroundColor: AttrScope.TechniqueRendering,\r\n            backgroundSize: AttrScope.TechniqueRendering,\r\n            backgroundOpacity: AttrScope.TechniqueRendering,\r\n            color: AttrScope.TechniqueRendering,\r\n            opacity: AttrScope.TechniqueRendering,\r\n            priority: AttrScope.TechniqueRendering,\r\n            size: AttrScope.TechniqueRendering\r\n        }\r\n    }\r\n);\r\n\r\nconst shaderTechniqueDescriptor = mergeTechniqueDescriptor<ShaderTechnique>(\r\n    baseTechniqueParamsDescriptor,\r\n    {\r\n        attrDescriptors: {\r\n            params: AttrScope.TechniqueRendering\r\n        }\r\n    }\r\n);\r\n\r\nconst techniqueDescriptors: TechniqueDescriptorRegistry = {\r\n    \"extruded-polygon\": extrudedPolygonTechniqueDescriptor,\r\n    \"line-marker\": lineMarkerTechniquePropTypes,\r\n    \"labeled-icon\": lineMarkerTechniquePropTypes,\r\n    \"solid-line\": solidLineTechniqueDescriptor,\r\n    \"dashed-line\": solidLineTechniqueDescriptor,\r\n    terrain: standardTechniqueDescriptor,\r\n    standard: standardTechniqueDescriptor,\r\n    squares: squaresTechniquePropTypes,\r\n    circles: circlesTechniquePropTypes,\r\n    line: lineTechniqueDescriptor,\r\n    segments: lineTechniqueDescriptor,\r\n    fill: fillTechniqueDescriptor,\r\n    text: textTechniqueDescriptor,\r\n    shader: shaderTechniqueDescriptor\r\n};\r\n\r\nexport function getTechniqueDescriptor(\r\n    technique: string | IndexedTechnique | Technique\r\n): TechniqueDescriptor | undefined {\r\n    if (typeof technique !== \"string\") {\r\n        technique = technique.name;\r\n    }\r\n    return (techniqueDescriptors as any)[technique];\r\n}\r\n\r\nexport function getTechniqueAttributeDescriptor(\r\n    technique: string | IndexedTechnique | Technique,\r\n    attrName: string\r\n): AttrDescriptor | undefined {\r\n    const techniqueDescriptor = getTechniqueDescriptor(technique);\r\n    const attrDescriptors = techniqueDescriptor?.attrDescriptors;\r\n    const descriptor = attrDescriptors?.[attrName];\r\n    if (typeof descriptor === undefined) {\r\n        return undefined;\r\n    } else if (typeof descriptor === \"object\") {\r\n        return descriptor;\r\n    }\r\n    return { scope: descriptor };\r\n}\r\n\r\nconst automaticAttributeCache: Map<string, string[]> = new Map();\r\n\r\nexport function getTechniqueAutomaticAttrs(\r\n    technique: string | IndexedTechnique | Technique\r\n): string[] {\r\n    if (typeof technique !== \"string\") {\r\n        technique = technique.name;\r\n    }\r\n\r\n    if (automaticAttributeCache.has(technique)) {\r\n        return automaticAttributeCache.get(technique)!;\r\n    }\r\n\r\n    const descriptors: string[] = [];\r\n\r\n    const attrDescriptors = getTechniqueDescriptor(technique)?.attrDescriptors;\r\n\r\n    if (attrDescriptors === undefined) {\r\n        return descriptors;\r\n    }\r\n\r\n    for (const attrName in attrDescriptors) {\r\n        if (!attrDescriptors.hasOwnProperty(attrName)) {\r\n            continue;\r\n        }\r\n\r\n        const descr = attrDescriptors[attrName];\r\n\r\n        if (descr === undefined || typeof descr === \"number\") {\r\n            continue;\r\n        }\r\n\r\n        if (descr.automatic === true) {\r\n            descriptors.push(attrName);\r\n        }\r\n    }\r\n\r\n    automaticAttributeCache.set(technique, descriptors);\r\n\r\n    return descriptors;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { JsonExpr } from \"./Expr\";\r\nimport { InterpolatedPropertyDefinition } from \"./InterpolatedPropertyDefs\";\r\n\r\n/**\r\n * The style type of the line caps.\r\n */\r\nexport type LineCaps = \"Square\" | \"Round\" | \"None\" | \"TriangleOut\" | \"TriangleIn\";\r\n\r\n/**\r\n * The style type of the line dashes.\r\n */\r\nexport type LineDashes = \"Square\" | \"Round\" | \"Diamond\";\r\n\r\n/**\r\n * Defines how to interpret the units.\r\n */\r\nexport type MetricUnit = \"Meter\" | \"Pixel\";\r\n\r\n/**\r\n * Standard kinds of geometry.\r\n * @deprecated See {@link BaseTechniqueParams.kind}.\r\n */\r\nexport enum StandardGeometryKind {\r\n    /**\r\n     * Used in the enabledKinds/disabledKinds filter to match any kind.\r\n     */\r\n    All = \"_all_\",\r\n\r\n    /**\r\n     * Background geometry.\r\n     */\r\n    Background = \"background\",\r\n\r\n    /**\r\n     * Terrain geometry.\r\n     */\r\n    Terrain = \"terrain\",\r\n\r\n    /**\r\n     * Default value for the FillTechnique.\r\n     */\r\n    Area = \"area\",\r\n\r\n    /**\r\n     * Default value for all line techniques.\r\n     */\r\n    Line = \"line\",\r\n\r\n    /**\r\n     * Default value for the FillTechnique.\r\n     */\r\n    Water = \"water\",\r\n\r\n    /**\r\n     * Political borders.\r\n     */\r\n    Border = \"border\",\r\n\r\n    /**\r\n     * Basis for all roads.\r\n     */\r\n    Road = \"road\",\r\n\r\n    /**\r\n     * Default value for the ExtrudedPolygonTechnique.\r\n     */\r\n    Building = \"building\",\r\n\r\n    /**\r\n     * Default value for the TextTechnique, LineMarkerTechnique and the PoiTechnique.\r\n     */\r\n    Label = \"label\",\r\n\r\n    /**\r\n     * Anything that may show up last.\r\n     */\r\n    Detail = \"detail\"\r\n}\r\n\r\n/**\r\n * The kind of geometry is used to group objects together,\r\n * allowing the group to be hidden or displayed.\r\n *\r\n * @remarks\r\n * Any string can be used to specify the kind of the technique in a style in the theme file. Is is\r\n * suggested to specify multiple kinds for specific types of data. For a highway, the following list\r\n * of kinds is suggested:\r\n *```json\r\n *    [\"line\", \"road\", \"road:highway\"]\r\n *```\r\n * If it is a tunnel for a highway:\r\n *```json\r\n *    [\"line\", \"road\", \"road:highway\", \"tunnel\", \"road:tunnel\", \"road:highway:tunnel\"]\r\n *```\r\n * If specified in this way, specific types of data (here: highway roads) can be enabled and/or\r\n * disabled.\r\n * @deprecated See {@link BaseTechniqueParams.kind}.\r\n */\r\nexport type GeometryKind = string | StandardGeometryKind;\r\n\r\n// See https://github.com/typescript-eslint/typescript-eslint/blob/master/packages/eslint-plugin/docs/rules/no-redeclare.md#ignoredeclarationmerge\r\n// eslint-disable-next-line @typescript-eslint/no-redeclare\r\nexport const GeometryKind = StandardGeometryKind;\r\n\r\n/**\r\n * Decorate property type with possible dynamic variants.\r\n */\r\nexport type DynamicProperty<T> = T | JsonExpr | InterpolatedPropertyDefinition<T>;\r\n\r\n/**\r\n * Length literals.\r\n *\r\n * @remarks\r\n * Description of length units inside a style. Supports literal values (interpreted as `m`), `m` and\r\n * `px`(i.e. `80`, `14px`, `0.6m`, etc.).\r\n */\r\nexport type StyleLength = string | number;\r\n\r\n/**\r\n * Color literals.\r\n *\r\n * @remarks\r\n * Description of colors inside a style. Supports hex values as well as CSS hex, rgb and hsl values\r\n * (i.e. `0xffffff`, `#f00fab`, `#aaa`, `rgb(255, 0 120)`, `hsl(360, 100%, 100%)`, etc.).\r\n */\r\nexport type StyleColor = string | number;\r\n\r\n/**\r\n * A set of {@link GeometryKind}s.\r\n */\r\nexport class GeometryKindSet extends Set {\r\n    /**\r\n     * Return `true` if the Set is a superset of the set 'subset'.\r\n     */\r\n    isSuperset(subset: Set<any>): boolean {\r\n        for (const elem of subset) {\r\n            if (!this.has(elem)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Return `true` if the Set intersects Set 'set'.\r\n     */\r\n    hasIntersection(set: any) {\r\n        for (const elem of set) {\r\n            if (this.has(elem)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Return `true` if the Set either intersects Set 'set' (if set is a Set), of has element 'set'\r\n     * if set is not a Set.\r\n     */\r\n    hasOrIntersects(set: any) {\r\n        if (set instanceof Set) {\r\n            return this.hasIntersection(set);\r\n        }\r\n        return this.has(set);\r\n    }\r\n\r\n    /**\r\n     * Return `true` if this set and the array of elements share at least a single element.\r\n     */\r\n    hasOrIntersectsArray(subset: any[]) {\r\n        for (const elem of subset) {\r\n            if (this.has(elem)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Common attributes or all [[Technique]]s.\r\n */\r\nexport interface BaseTechniqueParams {\r\n    /**\r\n     * The name used to identify materials created from this technique.\r\n     */\r\n    id?: string;\r\n\r\n    /**\r\n     * The render order of the objects created using this technique.\r\n     *\r\n     * @remarks\r\n     * If not specified in style file monotonically increasing\r\n     * values according to style position in file.\r\n     */\r\n    renderOrder?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * The category of this technique.\r\n     *\r\n     * @remarks\r\n     * The category is used in conjunction with {@link Theme.priorities}\r\n     * to assign render orders to the objects created by this {@link Style}.\r\n     */\r\n    category?: DynamicProperty<string>;\r\n\r\n    /**\r\n     * Optional. If `true` or `Pickability.transient`, no IDs will be saved for the geometry\r\n     * this style creates. Default is `Pickability.onlyVisible`, which allows all pickable and\r\n     * visible objects to be picked, Pickability.all, will also allow invisible objects to be\r\n     * picked.\r\n     * @defaultValue `Pickability.onlyVisible`\r\n     * The boolean option is for backwardscompatibilty, please use the Pickability.\r\n     *\r\n     *\r\n     * TODO: deprecate and rename to something that makes more sense\r\n     */\r\n    transient?: boolean | Pickability;\r\n\r\n    /**\r\n     * Distance to the camera `(0.0 = camera position, 1.0 = farPlane) at which the object start\r\n     * fading out (opacity decreases).\r\n     */\r\n    fadeNear?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Distance to the camera (0.0 = camera position, 1.0 = farPlane) at which the object has zero\r\n     * opacity and stops fading out. An undefined value disables fading.\r\n     */\r\n    fadeFar?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Specified kind of geometry.\r\n     *\r\n     * @remarks\r\n     * One kind is set as default in the technique, and can be overridden in the style.\r\n     *\r\n     * @deprecated Use {@link enabled} with expressions based on `['dynamic-properties']` operator.\r\n     * See \"object picking\" example.\r\n     */\r\n    kind?: GeometryKind | GeometryKindSet;\r\n\r\n    /**\r\n     * Runtime filtering of techniques.\r\n     *\r\n     * Use with `['dynamic-properties']` operator for dynamic feature highlight, highlighig etc.\r\n     *\r\n     * @see Picking example\r\n     */\r\n    enabled?: DynamicProperty<boolean>;\r\n\r\n    /**\r\n     * Set to 'true' if line should appear transparent.\r\n     *\r\n     * @remarks\r\n     * Rendering transparent lines may come with a\r\n     * slight performance impact.\r\n     * See https://threejs.org/docs/#api/en/materials/Material.transparent.\r\n     */\r\n    transparent?: DynamicProperty<boolean>;\r\n\r\n    /**\r\n     * Defines which side of faces will be rendered - front, back or both.\r\n     * See https://threejs.org/docs/#api/en/materials/Material.side.\r\n     */\r\n    side?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Minimal zoom level. If the current zoom level is smaller, the technique will not be used.\r\n     */\r\n    minZoomLevel?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Maximum zoom level. If the current zoom level is equal to or greater, the technique will not be used.\r\n     */\r\n    maxZoomLevel?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * If `true`, geometry height won't be scaled on projection. Enable it for projections with\r\n     * variable scale factor (e.g. mercator) to avoid distortions in geometry with great heights and\r\n     * latitude spans. E.g. a large object with even height would look oblique to the ground plane\r\n     * on mercator unless this property is set to `true`.\r\n     *\r\n     * @defaultValue `true` for geometries stored at level less than `12`.\r\n     */\r\n    constantHeight?: DynamicProperty<boolean>;\r\n}\r\n\r\nexport enum TextureCoordinateType {\r\n    /**\r\n     * Texture coordinates are in tile space.\r\n     *\r\n     * @remarks\r\n     * SW of the tile will have (0,0) and NE will have (1,1).\r\n     */\r\n    TileSpace = \"tile-space\",\r\n\r\n    /**\r\n     * Texture coordinates are in equirectangular space.\r\n     *\r\n     * @remarks\r\n     * (u, v) = ( (longitude+180) / 360, (latitude+90) / 180).\r\n     */\r\n    EquirectangularSpace = \"equirectangular-space\",\r\n\r\n    /**\r\n     * Texture coordinates in feature space.\r\n     *\r\n     * @remarks\r\n     * To compute texture coordinates in feature space,\r\n     * the feature must have a property named `bbox` with value\r\n     * the tuple `[west, south, east, north]`.\r\n     */\r\n    FeatureSpace = \"feature-space\"\r\n}\r\n\r\n/**\r\n * Standard technique parameters.\r\n */\r\nexport interface StandardTechniqueParams extends BaseTechniqueParams {\r\n    /**\r\n     * Color of the feature in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`,\r\n     * `\"#fff\"`, `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * See https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.color.\r\n     * @format color-hex\r\n     */\r\n    color?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * A value of `true` creates a wireframe geometry. (May not be supported with all techniques).\r\n     * See https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.wireframe.\r\n     */\r\n    wireframe?: boolean;\r\n    /**\r\n     * If `vertexColors` is `true`, every vertex has color information, which is interpolated\r\n     * between vertices.\r\n     * See https://threejs.org/docs/#api/en/materials/Material.vertexColors.\r\n     */\r\n    vertexColors?: boolean;\r\n    /**\r\n     * How rough the material appears. `0.0` means a smooth mirror reflection. `1.0` means fully\r\n     * diffuse. Default is `1.0`.\r\n     * See https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.roughness.\r\n     */\r\n    roughness?: DynamicProperty<number>;\r\n    /**\r\n     * How much the material is like a metal. Nonmetallic materials such as wood or stone use `0.0`,\r\n     * metallic ones use `1.0`, with nothing (usually) in between. Default is `0.0`. A value between\r\n     * `0.0` and `1.0` can be used for a rusty metal look. If `metalnessMap` is also provided, both\r\n     * values are multiplied.\r\n     * See https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.metalness.\r\n     */\r\n    metalness?: DynamicProperty<number>;\r\n    /**\r\n     * The material will not be rendered if the opacity is lower than this value.\r\n     * See https://threejs.org/docs/#api/en/materials/Material.alphaTest.\r\n     */\r\n    alphaTest?: DynamicProperty<number>;\r\n    /**\r\n     * Skip rendering clobbered pixels.\r\n     * See https://threejs.org/docs/#api/en/materials/Material.depthTest.\r\n     */\r\n    depthTest?: DynamicProperty<boolean>;\r\n    /**\r\n     * For transparent lines, set a value between 0.0 for totally transparent, to 1.0 for totally\r\n     * opaque.\r\n     * See https://threejs.org/docs/#api/en/materials/Material.opacity.\r\n     */\r\n    opacity?: DynamicProperty<number>;\r\n    /**\r\n     * Emissive (light) color of the material, essentially a solid color unaffected by other\r\n     * lighting. Default is black.\r\n     * See https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.emissive.\r\n     * @format color-hex\r\n     */\r\n    emissive?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * Intensity of the emissive light. Modulates the emissive color. Default is `1`.\r\n     * See https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.emissiveIntensity.\r\n     */\r\n    emissiveIntensity?: DynamicProperty<number>;\r\n    /**\r\n     * The index of refraction (IOR) of air (approximately 1) divided by the index of refraction of\r\n     * the material. It is used with environment mapping modes `THREE.CubeRefractionMapping` and\r\n     * `THREE.EquirectangularRefractionMapping`. The refraction ratio should not exceed `1`. Default\r\n     *  is `0.98`.\r\n     * See https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.refractionRatio.\r\n     */\r\n    refractionRatio?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Whether and how texture coordinates should be generated. No texture coordinates are\r\n     * generated if `undefined`.\r\n     * Should be set if any texture assigned (e.g. `map`, `normalMap`, ...).\r\n     */\r\n    textureCoordinateType?: TextureCoordinateType;\r\n\r\n    /*\r\n     * URL or texture buffer that should be used as color map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.map\r\n     */\r\n    map?: DynamicProperty<string | TextureBuffer>;\r\n    mapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * URL or texture buffer that should be used as normal map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.normalMap\r\n     */\r\n    normalMap?: DynamicProperty<string | TextureBuffer>;\r\n    normalMapType?: DynamicProperty<number>;\r\n    normalMapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * URL or texture buffer that should be used as displacement map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.displacementMap\r\n     */\r\n    displacementMap?: DynamicProperty<string | TextureBuffer>;\r\n    displacementMapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * URL or texture buffer that should be used as roughness map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.roughnessMap\r\n     */\r\n    roughnessMap?: DynamicProperty<string | TextureBuffer>;\r\n    roughnessMapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * URL or texture buffer that should be used as emissive map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.emissiveMap\r\n     */\r\n    emissiveMap?: DynamicProperty<string | TextureBuffer>;\r\n    emissiveMapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * URL or texture buffer that should be used as bump map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.bumpMap\r\n     */\r\n    bumpMap?: DynamicProperty<string | TextureBuffer>;\r\n    bumpMapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * URL or texture buffer that should be used as metalness map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.metalnessMap\r\n     */\r\n    metalnessMap?: DynamicProperty<string | TextureBuffer>;\r\n    metalnessMapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * URL or texture buffer that should be used as alpha map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshStandardMaterial.alphaMap\r\n     */\r\n    alphaMap?: DynamicProperty<string | TextureBuffer>;\r\n    alphaMapProperties?: DynamicProperty<TextureProperties>;\r\n}\r\n\r\n/**\r\n * Possible parameters of [[PointTechnique]].\r\n */\r\nexport interface PointTechniqueParams extends BaseTechniqueParams {\r\n    /**\r\n     * Color of a point in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`, `\"#fff\"`,\r\n     * `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    color?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * URL of a texture image to be loaded.\r\n     */\r\n    texture?: string;\r\n    /**\r\n     * For transparent lines, set a value between 0.0 for totally transparent, to 1.0 for totally\r\n     * opaque.\r\n     */\r\n    opacity?: DynamicProperty<number>;\r\n    /**\r\n     * Size of point in pixels.\r\n     */\r\n    size?: DynamicProperty<number>;\r\n    /**\r\n     * Whether to enable picking on these points.\r\n     */\r\n    enablePicking?: boolean;\r\n}\r\n\r\n/**\r\n * Define the stacking option. Enum values for theme file are in \"kebab-case\".\r\n */\r\nexport enum PoiStackMode {\r\n    /**\r\n     * Show in a stack.\r\n     */\r\n    Show = \"show-in-stack\",\r\n    /**\r\n     * Do not show in a stack.\r\n     */\r\n    Hide = \"hide-in-stack\",\r\n    /**\r\n     * Show category parent in the stack.\r\n     */\r\n    ShowParent = \"show-parent\"\r\n}\r\n\r\n/**\r\n * Define the pickability of an object.\r\n */\r\nexport enum Pickability {\r\n    /**\r\n     * Pickable if visible.\r\n     */\r\n    onlyVisible = \"only-visible\",\r\n    /**\r\n     * Not Pickable at all.\r\n     */\r\n    transient = \"transient\",\r\n    /**\r\n     * All objects of this type pickable.\r\n     */\r\n    all = \"all\"\r\n}\r\n\r\n/**\r\n * Converts backwards compatible transient property to pure {@type Pickabilty} object\r\n *\r\n * @param transient The transient property from the style\r\n */\r\nexport function transientToPickability(transient?: boolean | Pickability): Pickability {\r\n    let pickability: Pickability = Pickability.onlyVisible;\r\n    if (transient !== undefined && transient !== null) {\r\n        pickability =\r\n            typeof transient === \"string\"\r\n                ? transient\r\n                : transient === true\r\n                ? Pickability.transient\r\n                : Pickability.onlyVisible;\r\n    }\r\n    return pickability;\r\n}\r\n\r\n/**\r\n * Defines options (tokens) supported for text placements defined via [[placements]] attribute.\r\n *\r\n * @remarks\r\n * Possible values are defined as vertical placement letter and horizontal letter, where\r\n * one of the axis may be ignored and then assumed centered. Moving clock-wise, we have:\r\n * `TL` (top-left), `T` (top-center), `TR` (top-right), `R` (center-right), `BR` (bottom-right),\r\n * `B` (bottom-center), `BL` (bottom-left), `L` (left), `C` (center-center).\r\n * Alternatively instead of `T`, `B`, `L`, `R` geographic directions may be used accordingly:\r\n * `NW` (north-west), `N` (north), `NE` (north-east), `E` (east), `SE` (south-east), `S` (south),\r\n * `SW` (south-west), `W` (west).\r\n */\r\nexport enum PlacementToken {\r\n    TopLeft = \"TL\",\r\n    Top = \"T\",\r\n    TopRight = \"TR\",\r\n    Right = \"R\",\r\n    BottomRight = \"BR\",\r\n    Bottom = \"B\",\r\n    BottomLeft = \"BL\",\r\n    Left = \"L\",\r\n    Center = \"C\",\r\n    NorthWest = \"NW\",\r\n    North = \"N\",\r\n    NorthEast = \"NE\",\r\n    East = \"E\",\r\n    SouthEast = \"SE\",\r\n    South = \"S\",\r\n    SouthWest = \"SW\",\r\n    West = \"W\"\r\n}\r\n\r\n/**\r\n * Technique that describes icons with labels. Used in [[PoiTechnique]] and [[LineMarkerTechnique]]\r\n * (for road shields).\r\n */\r\nexport interface MarkerTechniqueParams extends BaseTechniqueParams {\r\n    /**\r\n     * Text to be displayed for feature.\r\n     *\r\n     * @remarks\r\n     * Defaults to first defined:\r\n     *  - feature property `label` if present in technique (deprecated)\r\n     *  - `[\"get\", \"name:short\"]` is `useAbbreviation` is true\r\n     *  - `[\"get\", \"iso_code\"]` is `useIsoCode` is true\r\n     *  - `[\"get\", \"name:$LANGUAGE\"]` for each specified language\r\n     *  - `[\"get\", \"name\"]`\r\n     *\r\n     * See [[ExtendedTileInfo.getFeatureText]]\r\n     */\r\n    text?: DynamicProperty<string>;\r\n\r\n    /**\r\n     * Field name of object containing the text to be rendered.\r\n     *\r\n     * @deprecated Use `[\"get\", \"FIELD\"]`.\r\n     */\r\n    label?: string;\r\n    /**\r\n     * If `true`, the abbreviation (field `name:short`) of the elements is used as text.\r\n     *\r\n     * @deprecated Use proper expression with [`get`, `name:short`] for this purpose.\r\n     */\r\n    useAbbreviation?: boolean;\r\n    /**\r\n     * If `true`, the iso code (field 'iso_code') of the elements is used as text.\r\n     * The `iso_code` field contains the ISO 3166-1 2-letter country code.\r\n     *\r\n     * @deprecated Use proper expression with [`get`, `iso_code`] for this purpose.\r\n     */\r\n    useIsoCode?: boolean;\r\n    /**\r\n     * Priority of marker, defaults to `0`. Markers with highest priority get placed first.\r\n     */\r\n    priority?: DynamicProperty<number>;\r\n    /**\r\n     * Minimum zoomLevel at which to display the label text. No default.\r\n     */\r\n    textMinZoomLevel?: DynamicProperty<number>;\r\n    /**\r\n     * Maximum zoomLevel at which to display the label text. No default.\r\n     */\r\n    textMaxZoomLevel?: DynamicProperty<number>;\r\n    /**\r\n     * Minimum zoomLevel at which to display the label icon. No default.\r\n     */\r\n    iconMinZoomLevel?: DynamicProperty<number>;\r\n    /**\r\n     * Maximum zoomLevel at which to display the label icon. No default.\r\n     */\r\n    iconMaxZoomLevel?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Icon color.\r\n     *\r\n     * @remarks\r\n     * If specified, combined using multiplication with color value read from icon texture.\r\n     * Works best for grayscale or monochromatic textures.\r\n     */\r\n    iconColor?: StyleColor;\r\n\r\n    /**\r\n     * Icon brightness.\r\n     *\r\n     * @remarks\r\n     * Factor that multiplies a color on top of the icon texture (and `iconColor`) with `0` being\r\n     * fully black as final output, `1` being the original rgb colors of the texture.\r\n     *\r\n     * @defaultValue `1`\r\n     */\r\n    iconBrightness?: number;\r\n\r\n    /**\r\n     * Scaling factor of icon. Defaults to 0.5, reducing the size ot 50% in the distance.\r\n     */\r\n    distanceScale?: number;\r\n    /**\r\n     * If `false`, text may overlap markers.\r\n     * @defaultValue `false`\r\n     */\r\n    textMayOverlap?: boolean;\r\n    /**\r\n     * If `false`, the icon may overlap text and other icons of lower priority.\r\n     *\r\n     * @remarks\r\n     * If not defined, the\r\n     * property value from `textMayOverlap` will be used.\r\n     * @defaultValue `false`\r\n     */\r\n    iconMayOverlap?: boolean;\r\n    /**\r\n     * If `false`, text will not reserve screen space, other markers will be able to overlap.\r\n     * @defaultValue `true`\r\n     */\r\n    textReserveSpace?: boolean;\r\n    /**\r\n     * If `false`, icon will not reserve screen space, other markers will be able to overlap.\r\n     *\r\n     * @remarks\r\n     * If not defined, the property value from `iconReserveSpace` will be used.\r\n     * @defaultValue `true`\r\n     */\r\n    iconReserveSpace?: boolean;\r\n    /**\r\n     * If `false`, text will not be rendered during animations. Defaults to `true`.\r\n     */\r\n    renderTextDuringMovements?: boolean;\r\n    /**\r\n     * If `true`, the label will always be rendered on top.\r\n     *\r\n     * @remarks\r\n     * If overlapping with other labels with\r\n     * this flag set, the render order is undefined.\r\n     * @defaultValue `false`\r\n     */\r\n    alwaysOnTop?: boolean;\r\n    /**\r\n     * If `true`, icon will appear even if the text part is blocked by other labels.\r\n     *\r\n     * @remarks\r\n     * @defaultValue `false`\r\n     */\r\n    textIsOptional?: boolean;\r\n    /**\r\n     * Should be displayed on map or not. Defaults to `true`.\r\n     */\r\n    showOnMap?: boolean;\r\n    /**\r\n     * Specify stack mode. Defaults to `ShowInStack`.\r\n     */\r\n    stackMode?: PoiStackMode;\r\n    /**\r\n     * Minimal distance between markers in screen pixels.\r\n     */\r\n    minDistance?: number;\r\n    /**\r\n     * If `true`, text will appear even if the icon is blocked by other labels.\r\n     *\r\n     * @defaultValue `false`\r\n     */\r\n    iconIsOptional?: boolean;\r\n    /**\r\n     * Fading time for labels in seconds.\r\n     */\r\n    textFadeTime?: number;\r\n    /**\r\n     * Fading time for icons in seconds.\r\n     */\r\n    iconFadeTime?: number;\r\n    /**\r\n     * Horizontal offset (to the right) in screen pixels.\r\n     */\r\n    xOffset?: DynamicProperty<number>;\r\n    /**\r\n     * Vertical offset (up) in screen pixels.\r\n     */\r\n    yOffset?: DynamicProperty<number>;\r\n    /**\r\n     * Horizontal offset (to the right) in screen pixels.\r\n     */\r\n    iconXOffset?: DynamicProperty<number>;\r\n    /**\r\n     * Vertical offset (up) in screen pixels.\r\n     */\r\n    iconYOffset?: DynamicProperty<number>;\r\n    /**\r\n     * Scaling factor of icon.\r\n     */\r\n    iconScale?: number;\r\n    /**\r\n     * Vertical height in pixels, controls vertical scaling. Overrides `iconScale`.\r\n     */\r\n    screenHeight?: DynamicProperty<number>;\r\n    /**\r\n     * Horizontal height in pixels, controls horizontal scaling. Overrides `iconScale`.\r\n     */\r\n    screenWidth?: DynamicProperty<number>;\r\n    /**\r\n     * Name of the POI table which should be used for this POI.\r\n     */\r\n    poiTable?: string;\r\n    /**\r\n     * Fixed name to identify POI options in the POI table.\r\n     *\r\n     * @remarks\r\n     * If `poiName` has a value, this value\r\n     * supersedes any value read from the field referenced in `poiNameField`.\r\n     */\r\n    poiName?: string;\r\n    /**\r\n     * Name of the field to evaluate to get the name of the POI options in the POI table.\r\n     */\r\n    poiNameField?: string;\r\n    /**\r\n     * The name of either the {@link ImageTexture} in {@link Theme.imageTextures} or the user image\r\n     * cached in {@link @here/harp-mapview#userImageCache} to be rendered as marker.\r\n     */\r\n    imageTexture?: DynamicProperty<string>;\r\n    /**\r\n     * Field name to extract imageTexture content from, if imageTexture refers to an\r\n     * [[ImageTexture]] definition.\r\n     */\r\n    imageTextureField?: string;\r\n    /**\r\n     * Prefix for `imageTexture` if `imageTextureField` is used.\r\n     */\r\n    imageTexturePrefix?: string;\r\n    /**\r\n     * Postfix for `imageTexture` if `imageTextureField` is used.\r\n     */\r\n    imageTexturePostfix?: string;\r\n    /**\r\n     * Name of the text style.\r\n     */\r\n    style?: string;\r\n    /**\r\n     * Name of the preferred [[Font]] to be used when rendering.\r\n     */\r\n    fontName?: string;\r\n    /**\r\n     * Size of the text (pixels).\r\n     */\r\n    size?: DynamicProperty<number>;\r\n    /**\r\n     * Size of the text background (pixels).\r\n     */\r\n    backgroundSize?: DynamicProperty<number>;\r\n    /**\r\n     * Glyph style to apply for the currently active [[Font]].\r\n     */\r\n    fontStyle?: \"Regular\" | \"Bold\" | \"Italic\" | \"BoldItalic\";\r\n    /**\r\n     * Glyph variant to apply for the currently active [[Font]].\r\n     */\r\n    fontVariant?: \"Regular\" | \"AllCaps\" | \"SmallCaps\";\r\n    /**\r\n     * Glyph local rotation (radians).\r\n     */\r\n    rotation?: number;\r\n    /**\r\n     * Text color in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`, `\"#fff\"`,\r\n     * `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    color?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * Text background color in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`,\r\n     * `\"#fff\"`, `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    backgroundColor?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * For transparent text, set a value between 0.0 for totally transparent, to 1.0 for totally\r\n     * opaque.\r\n     */\r\n    opacity?: DynamicProperty<number>;\r\n    /**\r\n     * Background text opacity value.\r\n     */\r\n    backgroundOpacity?: DynamicProperty<number>;\r\n    /**\r\n     * Inter-glyph spacing (pixels). Scaled by `size`.\r\n     */\r\n    tracking?: DynamicProperty<number>;\r\n    /**\r\n     * Inter-line spacing (pixels). Scaled by `size`.\r\n     */\r\n    leading?: DynamicProperty<number>;\r\n    /**\r\n     * Maximum number of lines for this label.\r\n     */\r\n    maxLines?: DynamicProperty<number>;\r\n    /**\r\n     * Maximum line width (pixels).\r\n     */\r\n    lineWidth?: DynamicProperty<number>;\r\n    /**\r\n     * [[TextCanvas]] rotation (radians).\r\n     */\r\n    canvasRotation?: DynamicProperty<number>;\r\n    /**\r\n     * Line typesetting rotation (radians).\r\n     */\r\n    lineRotation?: DynamicProperty<number>;\r\n    /**\r\n     * Wrapping (line-breaking) mode.\r\n     */\r\n    wrappingMode?: DynamicProperty<\"None\" | \"Character\" | \"Word\">;\r\n    /**\r\n     * Text position regarding the baseline.\r\n     *\r\n     * @note The [[placements]] attribute may override the alignment settings.\r\n     */\r\n    hAlignment?: DynamicProperty<\"Left\" | \"Center\" | \"Right\">;\r\n    /**\r\n     * Text position inside a line.\r\n     *\r\n     * @note The [[placements]] attribute may supersede it.\r\n     */\r\n    vAlignment?: DynamicProperty<\"Above\" | \"Center\" | \"Below\">;\r\n    /**\r\n     * Text label positions relative to the label central position (anchor point).\r\n     *\r\n     * @remarks\r\n     * This attribute defines a comma separated tokens of possible text placements\r\n     * relative to label central position (anchor), for example: \"TL, TR, C\".\r\n     * Keep in mind that horizontal placement defines text position in opposite way to\r\n     * the alignment, so the text `R` placed (located on the **right side** of label position)\r\n     * will be the same as `Left` aligned by deduction. On other side vertical placement is quite\r\n     * similar to vertical alignment so `T` placement corresponds with `Above` alignment.\r\n     *\r\n     * @note This attribute may override [[hAlignment]] and [[vAlignment]] if defined.\r\n     */\r\n    placements?: string;\r\n\r\n    /**\r\n     * World space offset in meters applied to the icon along the ground plane, i.e. tangent\r\n     * to the local space up vector.\r\n     *\r\n     * @remarks\r\n     * Valid only for icons which have the\r\n     * \"offset_direction\" property as an attribute of the data, which specifies an angle in degrees\r\n     * in which direction the offset should take place, i.e. 0 degrees is north, 90 is east etc.\r\n     */\r\n    worldOffset?: DynamicProperty<number>;\r\n}\r\n\r\nexport interface LineTechniqueParams extends BaseTechniqueParams {\r\n    /**\r\n     * Color of a line in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`, `\"#fff\"`,\r\n     * `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    color: DynamicProperty<StyleColor>;\r\n    /**\r\n     * For transparent lines, set a value between 0.0 for totally transparent, to 1.0 for totally\r\n     * opaque.\r\n     */\r\n    opacity?: DynamicProperty<number>;\r\n    /**\r\n     * Width of line in pixels. WebGL implementations will normally render all lines with 1 pixel\r\n     * width, and ignore this value.\r\n     */\r\n    lineWidth: DynamicProperty<number>;\r\n}\r\n\r\n/**\r\n * Declares a geometry as a segment.\r\n */\r\nexport interface SegmentsTechniqueParams extends BaseTechniqueParams {\r\n    /**\r\n     * Color of segments in a hexadecimal notation, for example: `\"#e4e9ec\"` or `\"#fff\"`.\r\n     * @format color-hex\r\n     */\r\n    color: DynamicProperty<StyleColor>;\r\n    /**\r\n     * For transparent lines, set a value between `0.0` for fully transparent, to `1.0` for fully\r\n     * opaque.\r\n     */\r\n    opacity?: DynamicProperty<number>;\r\n    /**\r\n     * Width of a line in meters.\r\n     */\r\n    lineWidth: DynamicProperty<number>;\r\n}\r\n\r\n/**\r\n * Declares a a geometry as a polygon.\r\n */\r\nexport interface PolygonalTechniqueParams {\r\n    /**\r\n     * Whether to use polygon offset. Default is false.\r\n     *\r\n     * @remarks\r\n     * This corresponds to the\r\n     * GL_POLYGON_OFFSET_FILL WebGL feature.\r\n     *\r\n     * PolygonOffset is used to raise the geometry towards the geometry (for depth calculation\r\n     * only). Default is false.\r\n     *\r\n     * See here: https://sites.google.com/site/threejstuts/home/polygon_offset\r\n     *\r\n     * To activate polygonOffset these values have to be set to pull the line \"forwards\":\r\n     *\r\n     * transparent: true\r\n     *\r\n     * polygonOffset: true\r\n     *\r\n     * polygonOffsetFactor : -1.0, (as an example, see link above)\r\n     *\r\n     * polygonOffsetUnits: -1 (as an example, see link above)\r\n     */\r\n    polygonOffset?: boolean;\r\n\r\n    /**\r\n     * Sets the polygon offset factor. Default is 0.\r\n     */\r\n    polygonOffsetFactor?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Sets the polygon offset units. Default is 0.\r\n     */\r\n    polygonOffsetUnits?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Skip rendering clobbered pixels.\r\n     * See https://threejs.org/docs/#api/en/materials/Material.depthTest.\r\n     * @defaultValue `false`\r\n     */\r\n    depthTest?: DynamicProperty<boolean>;\r\n\r\n    /**\r\n     * Sets the polygon outline color.\r\n     * @format color-hex\r\n     */\r\n    lineColor?: DynamicProperty<StyleColor>;\r\n\r\n    /**\r\n     * Distance to the camera (0.0 = nearPlane, 1.0 = farPlane) at which the object edges start\r\n     * fading out.\r\n     */\r\n    lineFadeNear?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Distance to the camera (0.0 = nearPlane, 1.0 = farPlane) at which the object edges become\r\n     * transparent. A value of <= 0.0 disables fading.\r\n     */\r\n    lineFadeFar?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Set to `true` if line should appear transparent. Rendering transparent lines may come with a\r\n     * slight performance impact.\r\n     */\r\n    transparent?: DynamicProperty<boolean>;\r\n\r\n    /**\r\n     * For transparent lines, set a value between `0.0` for fully transparent, to `1.0` for fully\r\n     * opaque.\r\n     */\r\n    opacity?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Fill color in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`, `\"#fff\"`,\r\n     * `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    color?: DynamicProperty<StyleColor>;\r\n}\r\n\r\n/**\r\n * Declares a a geometry as a basic extruded line.\r\n */\r\nexport interface BasicExtrudedLineTechniqueParams\r\n    extends BaseTechniqueParams,\r\n        PolygonalTechniqueParams {\r\n    /**\r\n     * A value determining the shading technique.\r\n     *\r\n     * @remarks\r\n     * Valid values are \"Basic\" and \"Standard\". Default is \"basic\".\r\n     *\r\n     * `\"basic\"`   : Simple shading, faster to render. Only simple color and opacity are effective.\r\n     * `\"standard\"`: Elaborate shading, with metalness, and roughness.\r\n     */\r\n    shading?: \"basic\";\r\n    /**\r\n     * Width of line in meters for different zoom levels.\r\n     */\r\n    lineWidth: DynamicProperty<number>;\r\n    /**\r\n     * A value of `true` creates a wireframe geometry. (May not be supported with all techniques).\r\n     */\r\n    wireframe?: boolean;\r\n    /**\r\n     * Style of both end caps. Possible values: `\"None\"`, `\"Circle\"`. A value of undefined maps to\r\n     * `\"Circle\"`.\r\n     */\r\n    caps?: DynamicProperty<\"None\" | \"Circle\">;\r\n}\r\n\r\n/**\r\n * Declares a a geometry as a standard extruded line.\r\n */\r\nexport interface StandardExtrudedLineTechniqueParams\r\n    extends StandardTechniqueParams,\r\n        PolygonalTechniqueParams {\r\n    /**\r\n     * A value determining the shading technique. Valid values are `\"basic\"` and `\"standard\"`.\r\n     * Default is `\"basic\"`.\r\n     *\r\n     * @remarks\r\n     * `\"basic\"` : Simple shading, faster to render. Only simple color and opacity are effective.\r\n     * `\"standard\"` : Elaborate shading, with metalness, and roughness.\r\n     */\r\n    shading: \"standard\";\r\n    /**\r\n     * Width of a line in meters for different zoom levels.\r\n     */\r\n    lineWidth: DynamicProperty<number>;\r\n    /**\r\n     * Style of both end caps. Possible values: `\"None\"`, `\"Circle\"`.\r\n     *\r\n     * @remarks\r\n     * A value of undefined maps to\r\n     * `\"Circle\"`.\r\n     */\r\n    caps?: DynamicProperty<\"None\" | \"Circle\">;\r\n}\r\n\r\n/**\r\n * Declares a a geometry as a solid line.\r\n */\r\nexport interface SolidLineTechniqueParams extends BaseTechniqueParams, PolygonalTechniqueParams {\r\n    /**\r\n     * Color of a line in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`, `\"#fff\"`,\r\n     * `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    color: DynamicProperty<StyleColor>;\r\n    /**\r\n     * Color of a line outline in hexadecimal or CSS-style notation,\r\n     * for example: `\"#e4e9ec\"`, `\"#fff\"`, `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    outlineColor?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * @deprecated Specify metrics units as part of the value instead.\r\n     * Units in which different size properties are specified. Either `Meter` (default) or `Pixel`.\r\n     */\r\n    metricUnit?: MetricUnit;\r\n    /**\r\n     * Width of a line in `metricUnit` for different zoom levels.\r\n     */\r\n    lineWidth: DynamicProperty<StyleLength>;\r\n    /**\r\n     * Outline width of a line in `metricUnit`s for different zoom levels.\r\n     */\r\n    outlineWidth?: DynamicProperty<StyleLength>;\r\n    /**\r\n     * Clip the line outside the tile if `true`.\r\n     * @defaultValue false\r\n     */\r\n    clipping?: DynamicProperty<boolean>;\r\n    /**\r\n     * Describes the style of the line caps.\r\n     * @defaultValue `\"Round\"`.\r\n     */\r\n    caps?: DynamicProperty<LineCaps>;\r\n    /**\r\n     * Color of secondary line geometry in hexadecimal or CSS-style notation, for example:\r\n     * `\"#e4e9ec\"`, `\"#fff\"`, `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    secondaryColor?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * Width of secondary line geometry in `metricUnit`s for different zoom levels.\r\n     */\r\n    secondaryWidth?: DynamicProperty<StyleLength>;\r\n    /**\r\n     * The render order of the secondary line geometry object created using this technique.\r\n     */\r\n    secondaryRenderOrder?: DynamicProperty<number>;\r\n    /**\r\n     * Describes the style of the secondary line caps\r\n     * @defaultValue `\"Round\"`.\r\n     */\r\n    secondaryCaps?: DynamicProperty<LineCaps>;\r\n    /**\r\n     * Describes the category of the secondary geometry object created using this technique.\r\n     */\r\n    secondaryCategory?: DynamicProperty<string>;\r\n    /**\r\n     * Describes the starting drawing position for the line (in the range [0...1]).\r\n     * Default is `0.0`.\r\n     */\r\n    drawRangeStart?: number;\r\n    /**\r\n     * Describes the ending drawing position for the line (in the range [0...1]).\r\n     * Default is `1.0`.\r\n     */\r\n    drawRangeEnd?: number;\r\n    /**\r\n     * Describes the style of the line dashes.\r\n     * @defaultValue `\"Square\"`.\r\n     */\r\n    dashes?: DynamicProperty<LineDashes>;\r\n    /**\r\n     * Color of a line dashes in hexadecimal or CSS-style notation,\r\n     * for example: `\"#e4e9ec\"`, `\"#fff\"`, `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    dashColor?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * Length of a line in meters for different zoom levels.\r\n     */\r\n    dashSize?: DynamicProperty<StyleLength>;\r\n    /**\r\n     * Size of a gap between lines in meters for different zoom levels.\r\n     */\r\n    gapSize?: DynamicProperty<StyleLength>;\r\n    /**\r\n     * Size in world units how far to offset the line perpendicular to its direction.\r\n     */\r\n    offset?: DynamicProperty<number>;\r\n}\r\n\r\n/**\r\n * Technique used to draw filled polygons.\r\n */\r\nexport interface FillTechniqueParams extends BaseTechniqueParams, PolygonalTechniqueParams {\r\n    /**\r\n     * A value of `true` creates a wireframe geometry. (May not be supported with all techniques).\r\n     */\r\n    wireframe?: boolean;\r\n    /**\r\n     * Width of the lines. Currently limited to the [0, 1] range.\r\n     */\r\n    lineWidth?: DynamicProperty<number>;\r\n\r\n    /*\r\n     * URL or texture buffer that should be used as color map. See:\r\n     * https://threejs.org/docs/#api/en/materials/MeshBasicMaterial.map\r\n     */\r\n    map?: DynamicProperty<string | TextureBuffer>;\r\n    mapProperties?: DynamicProperty<TextureProperties>;\r\n\r\n    /**\r\n     * Whether and how texture coordinates should be generated. No texture coordinates are\r\n     * generated if `undefined`.\r\n     * Should be set if a `map` is assigned.\r\n     */\r\n    textureCoordinateType?: TextureCoordinateType;\r\n}\r\n\r\n/**\r\n * Technique used to draw a geometry as an extruded polygon, for example extruded buildings.\r\n */\r\nexport interface ExtrudedPolygonTechniqueParams extends StandardTechniqueParams {\r\n    /**\r\n     * Renders the footprint lines if set to 'true'.\r\n     */\r\n    footprint?: boolean;\r\n    /**\r\n     * Set to a negative value to remove all the vertical lines, and to a value between 0.0 and 1.0\r\n     * to modulate the amount of vertical lines rendered.\r\n     */\r\n    maxSlope?: number;\r\n    /**\r\n     * Width of the lines. Currently limited to the [0, 1] range.\r\n     */\r\n    lineWidth: DynamicProperty<number>;\r\n    /**\r\n     * Fill color in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`, `\"#fff\"`,\r\n     * `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    lineColor?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * Mix value between the lineColor(0.0) and the geometry's vertex colors(1.0).\r\n     */\r\n    lineColorMix?: number;\r\n\r\n    /**\r\n     * Distance to the camera (0.0 = nearPlane, 1.0 = farPlane) at which the object edges start\r\n     * fading out.\r\n     */\r\n    lineFadeNear?: DynamicProperty<number>;\r\n    /**\r\n     * Distance to the camera (0.0 = nearPlane, 1.0 = farPlane) at which the object edges become\r\n     * transparent. A value of <= 0.0 disables fading.\r\n     */\r\n    lineFadeFar?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Height above ground in world units of extruded polygon.\r\n     *\r\n     * Usually, unique per feature, so defaults to `[\"get\", \"height\"]`.\r\n     */\r\n    height?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * Height of \"floor\" of extruded polygon in world units of extruded polygon.\r\n     *\r\n     * Usually, unique per feature, so defaults to `[\"number\", [\"get\", \"min_height\"], 0]`.\r\n     */\r\n    floorHeight?: DynamicProperty<number>;\r\n\r\n    /**\r\n     * In some data sources, for example Tilezen, building extrusion information might be missing.\r\n     * This attribute allows to define a default height of an extruded polygon in the theme.\r\n     *\r\n     * @deprecated use [[height]]\r\n     */\r\n    defaultHeight?: number;\r\n\r\n    /**\r\n     * Default color used if feature doesn't provide color attribute\r\n     * and [[MapEnv]] did not return it too.\r\n     * @format color-hex\r\n     */\r\n    defaultColor?: DynamicProperty<StyleColor>;\r\n\r\n    /**\r\n     * If `true`, wall geometry will is added along the tile boundaries.\r\n     *\r\n     * @remarks\r\n     * this causes artifacts when used with shadows,\r\n     * so it should be known in advance that shadows won't be enabled.\r\n     * @defaultValue `false`\r\n     */\r\n    boundaryWalls?: boolean;\r\n\r\n    /**\r\n     * Animate the extrusion of the buildings if set to `true`.\r\n     */\r\n    animateExtrusion?: DynamicProperty<boolean>;\r\n\r\n    /**\r\n     * Duration of the building's extrusion in milliseconds\r\n     */\r\n    animateExtrusionDuration?: number;\r\n\r\n    /**\r\n     * Control rendering of depth prepass before the actual geometry.\r\n     *\r\n     * @remarks\r\n     * Depth prepass is a method to render translucent meshes, hence only the visible front faces of\r\n     * a mesh are actually rendered, removing artifacts caused by blending with internal faces of\r\n     * the mesh. This method is used for drawing translucent buildings over map background.\r\n     *\r\n     * By default, each [[DataSource]] determines how/if enable the depth pre-pass. A value of\r\n     * `false` forcefully disables depth prepass.\r\n     */\r\n    enableDepthPrePass?: boolean;\r\n}\r\n\r\nexport interface ShaderTechniqueMaterialParameters {\r\n    [name: string]: any;\r\n}\r\n\r\n/**\r\n * Special technique for user-defined shaders. See\r\n * https://threejs.org/docs/#api/harp-materials/ShaderMaterial for details.\r\n */\r\nexport interface ShaderTechniqueParams extends BaseTechniqueParams {\r\n    /**\r\n     * Parameters for shader. See `THREE.ShaderMaterialParameters`.\r\n     */\r\n    params: ShaderTechniqueMaterialParameters;\r\n\r\n    /**\r\n     * Type of primitive for the shader technique.\r\n     */\r\n    primitive: \"point\" | \"line\" | \"segments\" | \"mesh\";\r\n\r\n    [name: string]: any;\r\n}\r\n\r\n/**\r\n * Technique used to render a terrain geometry with a texture.\r\n *\r\n * @remarks\r\n * When using this technique, the datasource will produce texture coordinates in\r\n * local tile space (i.e. [0,0] at south-west and [1,1] at north-east tile corner).\r\n */\r\nexport interface TerrainTechniqueParams extends StandardTechniqueParams {\r\n    /**\r\n     * Colors to be applied at different heights (as a results of a `displacementMap`).\r\n     */\r\n    heightBasedColors?: HeightBasedColors;\r\n\r\n    /**\r\n     * If `heightBasedColors` is defined, this value defines the interpolation method used to\r\n     * generate the height-based gradient texture (defaults to `Discrete`).\r\n     * @defaultValue `\"Discrete\"`\r\n     */\r\n    heightGradientInterpolation?: \"Discrete\" | \"Linear\" | \"Cubic\";\r\n\r\n    /**\r\n     * If `heightBasedColors` is defined, this value defines the width (in pixels) of the generated\r\n     * gradient texture.\r\n     *\r\n     * @defaultValue `128`\r\n     */\r\n    heightGradientWidth?: number;\r\n}\r\n\r\n/**\r\n * Render geometry as a text.\r\n */\r\nexport interface TextTechniqueParams extends BaseTechniqueParams {\r\n    /**\r\n     * Text to be displayed for feature.\r\n     *\r\n     * @remarks\r\n     * Defaults to first defined:\r\n     *  - feature property `label` if present in technique (depreacted);\r\n     *  - `[\"get\", \"name:short\"]` is `useAbbreviation` is true;\r\n     *  - `[\"get\", \"iso_code\"]` is `useIsoCode` is true;\r\n     *  - `[\"get\", \"name:$LANGUAGE\"]` for each specified language;\r\n     *  - `[\"get\", \"name\"]`.\r\n     */\r\n    text?: DynamicProperty<string>;\r\n\r\n    /**\r\n     * Field name of object containing the text to be rendered.\r\n     *\r\n     * @deprecated Use `[\"get\", \"FIELD\"]`.\r\n     */\r\n    label?: string;\r\n    /**\r\n     * If `true`, the abbreviation (field `name:short`) of the elements is used as text.\r\n     *\r\n     * @deprecated Use proper expression with [`get`, `name:short`] for this purpose.\r\n     */\r\n    useAbbreviation?: boolean;\r\n    /**\r\n     * If `true`, the iso code (field 'iso_code') of the elements is used as text.\r\n     * @remarks\r\n     * The `iso_code` field contains the ISO 3166-1 2-letter country code.\r\n     *\r\n     * @deprecated Use proper expression with [`get`, `iso_code`] for this purpose.\r\n     */\r\n    useIsoCode?: boolean;\r\n    /**\r\n     * Priority of text, defaults to `0`. Elements with highest priority get placed first.\r\n     */\r\n    priority?: DynamicProperty<number>;\r\n    /**\r\n     * Scaling factor of the text. Defaults to 0.5, reducing the size ot 50% in the distance.\r\n     */\r\n    distanceScale?: number;\r\n    /**\r\n     * If `true`, icon is allowed to overlap other labels or icons of lower priority.\r\n     * @defaultValue `false`\r\n     */\r\n    mayOverlap?: boolean;\r\n    /**\r\n     * If `true`, element will reserve screen space, other markers of lower priority will not be\r\n     * able to overlap.\r\n     * @defaultValue `true`\r\n     */\r\n    reserveSpace?: boolean;\r\n    /**\r\n     * Fading time for labels in seconds.\r\n     */\r\n    textFadeTime?: number;\r\n    /**\r\n     * Horizontal offset (to the right) in screen pixels.\r\n     */\r\n    xOffset?: number;\r\n    /**\r\n     * Vertical offset (up) in screen pixels.\r\n     */\r\n    yOffset?: number;\r\n    /**\r\n     * Name of the text style.\r\n     */\r\n    style?: string;\r\n    /**\r\n     * Name of the preferred [[Font]] to be used when rendering.\r\n     */\r\n    fontName?: string;\r\n    /**\r\n     * Size of the text (pixels).\r\n     */\r\n    size?: DynamicProperty<number>;\r\n    /**\r\n     * Size of the text background (pixels).\r\n     */\r\n    backgroundSize?: DynamicProperty<number>;\r\n    /**\r\n     * Glyph style to apply for the currently active [[Font]].\r\n     */\r\n    fontStyle?: \"Regular\" | \"Bold\" | \"Italic\" | \"BoldItalic\";\r\n    /**\r\n     * Glyph variant to apply for the currently active [[Font]].\r\n     */\r\n    fontVariant?: \"Regular\" | \"AllCaps\" | \"SmallCaps\";\r\n    /**\r\n     * Glyph local rotation (radians).\r\n     */\r\n    rotation?: number;\r\n    /**\r\n     * Text color in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`, `\"#fff\"`,\r\n     * `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    color?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * Text background color in hexadecimal or CSS-style notation, for example: `\"#e4e9ec\"`,\r\n     * `\"#fff\"`, `\"rgb(255, 0, 0)\"`, or `\"hsl(35, 11%, 88%)\"`.\r\n     * @format color-hex\r\n     */\r\n    backgroundColor?: DynamicProperty<StyleColor>;\r\n    /**\r\n     * For transparent text, set a value between 0.0 for totally transparent, to 1.0 for totally\r\n     * opaque.\r\n     */\r\n    opacity?: DynamicProperty<number>;\r\n    /**\r\n     * Background text opacity value.\r\n     */\r\n    backgroundOpacity?: DynamicProperty<number>;\r\n    /**\r\n     * Inter-glyph spacing (pixels). Scaled by `size`.\r\n     */\r\n    tracking?: DynamicProperty<number>;\r\n    /**\r\n     * Inter-line spacing (pixels). Scaled by `size`.\r\n     */\r\n    leading?: DynamicProperty<number>;\r\n    /**\r\n     * Maximum number of lines for this label.\r\n     */\r\n    maxLines?: DynamicProperty<number>;\r\n    /**\r\n     * Maximum line width (pixels).\r\n     */\r\n    lineWidth?: DynamicProperty<number>;\r\n    /**\r\n     * [[TextCanvas]] rotation (radians).\r\n     */\r\n    canvasRotation?: DynamicProperty<number>;\r\n    /**\r\n     * Line typesetting rotation (radians).\r\n     */\r\n    lineRotation?: DynamicProperty<number>;\r\n    /**\r\n     * Wrapping (line-breaking) mode.\r\n     */\r\n    wrappingMode?: DynamicProperty<\"None\" | \"Character\" | \"Word\">;\r\n    /**\r\n     * Text position regarding the baseline.\r\n     */\r\n    hAlignment?: DynamicProperty<\"Left\" | \"Center\" | \"Right\">;\r\n    /**\r\n     * Text position inside a line.\r\n     */\r\n    vAlignment?: DynamicProperty<\"Above\" | \"Center\" | \"Below\">;\r\n}\r\n\r\n/**\r\n * Buffer holding a texture.\r\n */\r\nexport interface TextureBuffer {\r\n    /**\r\n     * Buffer containing the (compressed) image or the raw texture data.\r\n     */\r\n    buffer: ArrayBuffer;\r\n\r\n    /**\r\n     * Mime type of the image or 'image/raw' in case of raw texture data.\r\n     */\r\n    type: string;\r\n\r\n    /**\r\n     * Properties for creating a three.js DataTexture\r\n     * (https://threejs.org/docs/#api/en/textures/DataTexture).\r\n     */\r\n    dataTextureProperties?: DataTextureProperties;\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `TextureBuffer`.\r\n */\r\nexport function isTextureBuffer(object: any): object is TextureBuffer {\r\n    return object && object.buffer && typeof object.type === \"string\";\r\n}\r\n\r\n/**\r\n * Properties of a DataTexture (https://threejs.org/docs/#api/en/textures/DataTexture).\r\n */\r\nexport interface DataTextureProperties {\r\n    width: number;\r\n    height: number;\r\n\r\n    format?: PixelFormat;\r\n    type?: TextureDataType;\r\n}\r\n\r\n/**\r\n * Properties of a Texture (https://threejs.org/docs/#api/en/textures/Texture).\r\n */\r\nexport interface TextureProperties {\r\n    /**\r\n     * Texture horizontal wrapping mode.\r\n     * See: https://threejs.org/docs/#api/en/textures/Texture.wrapS.\r\n     */\r\n    wrapS?: WrappingMode;\r\n\r\n    /**\r\n     * Texture vertical wrapping mode.\r\n     * See: https://threejs.org/docs/#api/en/textures/Texture.wrapT.\r\n     */\r\n    wrapT?: WrappingMode;\r\n\r\n    /**\r\n     * Texture magnification filter.\r\n     */\r\n    magFilter?: MagFilter;\r\n\r\n    /**\r\n     * Texture minification filter.\r\n     */\r\n    minFilter?: MinFilter;\r\n\r\n    /**\r\n     * Flip texture vertically.\r\n     * See: https://threejs.org/docs/#api/en/textures/Texture.flipY.\r\n     */\r\n    flipY?: boolean;\r\n\r\n    /**\r\n     * Texture horizontal repetition rate.\r\n     * See: https://threejs.org/docs/#api/en/textures/Texture.repeat.\r\n     */\r\n    repeatU?: number;\r\n\r\n    /**\r\n     * Texture vertical repetition rate.\r\n     * See: https://threejs.org/docs/#api/en/textures/Texture.repeat.\r\n     */\r\n    repeatV?: number;\r\n}\r\n\r\n/**\r\n * Interface containing the definition of different colors to be used at different heights with the\r\n * [[TerrainTechnique]].\r\n */\r\nexport interface HeightBasedColors {\r\n    heightArray: number[];\r\n    colorArray: string[];\r\n}\r\n\r\nexport type PixelFormat =\r\n    | \"Alpha\"\r\n    | \"RGB\"\r\n    | \"RGBA\"\r\n    | \"Luminance\"\r\n    | \"LuminanceAlpha\"\r\n    | \"RGBE\"\r\n    | \"Depth\"\r\n    | \"DepthStencil\"\r\n    | \"Red\";\r\n\r\nexport type TextureDataType =\r\n    | \"UnsignedByte\"\r\n    | \"Byte\"\r\n    | \"Short\"\r\n    | \"UnsignedShort\"\r\n    | \"Int\"\r\n    | \"UnsignedInt\"\r\n    | \"Float\"\r\n    | \"HalfFloat\";\r\n\r\n/**\r\n * Available texture wrapping modes.\r\n */\r\nexport type WrappingMode = \"clamp\" | \"repeat\" | \"mirror\";\r\n\r\n/**\r\n * Available texture magnification filters.\r\n */\r\nexport type MagFilter = \"nearest\" | \"linear\";\r\n\r\n/**\r\n * Available texture minification filters.\r\n */\r\nexport type MinFilter =\r\n    | \"nearest\"\r\n    | \"nearestMipMapNearest\"\r\n    | \"nearestMipMapLinear\"\r\n    | \"linear\"\r\n    | \"linearMipMapNearest\"\r\n    | \"linearMipMapLinear\";\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Expr, JsonExpr } from \"./Expr\";\r\nimport { InterpolatedPropertyDefinition } from \"./InterpolatedPropertyDefs\";\r\nimport {\r\n    BaseTechniqueParams,\r\n    BasicExtrudedLineTechniqueParams,\r\n    ExtrudedPolygonTechniqueParams,\r\n    FillTechniqueParams,\r\n    isTextureBuffer,\r\n    LineTechniqueParams,\r\n    MarkerTechniqueParams,\r\n    PointTechniqueParams,\r\n    SegmentsTechniqueParams,\r\n    ShaderTechniqueParams,\r\n    SolidLineTechniqueParams,\r\n    StandardExtrudedLineTechniqueParams,\r\n    StandardTechniqueParams,\r\n    TerrainTechniqueParams,\r\n    TextTechniqueParams,\r\n    TextureCoordinateType\r\n} from \"./TechniqueParams\";\r\nimport { StylePriority } from \"./Theme\";\r\n\r\n/**\r\n * Names of the supported texture properties.\r\n * @internal\r\n */\r\nexport const TEXTURE_PROPERTY_KEYS = [\r\n    \"map\",\r\n    \"normalMap\",\r\n    \"displacementMap\",\r\n    \"roughnessMap\",\r\n    \"emissiveMap\",\r\n    \"alphaMap\",\r\n    \"metalnessMap\",\r\n    \"bumpMap\"\r\n];\r\n\r\n// TODO: Can be removed, when all when interpolators are implemented as {@link Expr}s\r\ntype RemoveInterpolatedPropDef<T> = T | InterpolatedPropertyDefinition<any> extends T\r\n    ? Exclude<T, InterpolatedPropertyDefinition<any>>\r\n    : T;\r\ntype RemoveJsonExpr<T> = T | JsonExpr extends T ? Exclude<T, JsonExpr> : T;\r\n\r\n/**\r\n * Make runtime representation of technique attributes from JSON-compatible typings.\r\n *\r\n * Translates\r\n *  - InterpolatedPropertyDefinition -> InterpolatedProperty\r\n *  - JsonExpr -> Expr\r\n */\r\nexport type MakeTechniqueAttrs<T> = {\r\n    [P in keyof T]: T[P] | JsonExpr extends T[P]\r\n        ? RemoveInterpolatedPropDef<RemoveJsonExpr<T[P]>> | Expr\r\n        : T[P];\r\n};\r\n\r\n/**\r\n * Possible techniques that can be used to draw a geometry on the map.\r\n */\r\nexport type Technique =\r\n    | SquaresTechnique\r\n    | CirclesTechnique\r\n    | PoiTechnique\r\n    | LineMarkerTechnique\r\n    | LineTechnique\r\n    | SegmentsTechnique\r\n    | SolidLineTechnique\r\n    | FillTechnique\r\n    | StandardTechnique\r\n    | TerrainTechnique\r\n    | BasicExtrudedLineTechnique\r\n    | StandardExtrudedLineTechnique\r\n    | ExtrudedPolygonTechnique\r\n    | ShaderTechnique\r\n    | TextTechnique\r\n    | LabelRejectionLineTechnique;\r\n\r\n/**\r\n * Runtime representation of `SquaresStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `PointTechniqueParams`.\r\n */\r\nexport interface SquaresTechnique extends MakeTechniqueAttrs<PointTechniqueParams> {\r\n    name: \"squares\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `CirclesStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `PointTechniqueParams`.\r\n */\r\nexport interface CirclesTechnique extends MakeTechniqueAttrs<PointTechniqueParams> {\r\n    name: \"circles\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `PoiStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `MarkerTechniqueParams`.\r\n */\r\nexport interface PoiTechnique extends MakeTechniqueAttrs<MarkerTechniqueParams> {\r\n    name: \"labeled-icon\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `LineMarkerStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `MarkerTechniqueParams`.\r\n */\r\nexport interface LineMarkerTechnique extends MakeTechniqueAttrs<MarkerTechniqueParams> {\r\n    name: \"line-marker\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `SegmentsStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `SegmentsTechniqueParams`.\r\n */\r\nexport interface SegmentsTechnique extends MakeTechniqueAttrs<SegmentsTechniqueParams> {\r\n    name: \"segments\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `BasicExtrudedLineStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `BasicExtrudedLineTechniqueParams`.\r\n */\r\nexport interface BasicExtrudedLineTechnique\r\n    extends MakeTechniqueAttrs<BasicExtrudedLineTechniqueParams> {\r\n    name: \"extruded-line\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `StandardExtrudedLineStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `StandardExtrudedLineTechniqueParams`.\r\n */\r\nexport interface StandardExtrudedLineTechnique\r\n    extends MakeTechniqueAttrs<StandardExtrudedLineTechniqueParams> {\r\n    name: \"extruded-line\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `SolidLineStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `SolidLineTechniqueParams`.\r\n */\r\nexport interface SolidLineTechnique extends MakeTechniqueAttrs<SolidLineTechniqueParams> {\r\n    name: \"solid-line\" | \"dashed-line\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `LineStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `LineTechniqueParams`.\r\n */\r\nexport interface LineTechnique extends MakeTechniqueAttrs<LineTechniqueParams> {\r\n    name: \"line\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `FillStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `FillTechniqueParams`.\r\n */\r\nexport interface FillTechnique extends MakeTechniqueAttrs<FillTechniqueParams> {\r\n    name: \"fill\";\r\n}\r\n\r\n/**\r\n * Technique used to render a mesh geometry.\r\n * For technique parameters see `StandardTechniqueParams`.\r\n */\r\nexport interface StandardTechnique extends MakeTechniqueAttrs<StandardTechniqueParams> {\r\n    name: \"standard\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `ExtrudedPolygonStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `ExtrudedPolygonTechniqueParams`.\r\n */\r\nexport interface ExtrudedPolygonTechnique\r\n    extends MakeTechniqueAttrs<ExtrudedPolygonTechniqueParams> {\r\n    name: \"extruded-polygon\";\r\n}\r\n\r\n/**\r\n * Runtime representation of `TextStyle` as parsed by `StyleSetEvaluator`.\r\n * For technique parameters see `TextTechniqueParams`.\r\n */\r\nexport interface TextTechnique extends MakeTechniqueAttrs<TextTechniqueParams> {\r\n    name: \"text\";\r\n}\r\n\r\n/**\r\n * Special technique for user-defined shaders.\r\n * For technique parameters see `ShaderTechniqueParams`.\r\n */\r\nexport interface ShaderTechnique extends MakeTechniqueAttrs<ShaderTechniqueParams> {\r\n    name: \"shader\";\r\n}\r\n\r\n/**\r\n * Technique used to render a terrain geometry with textures.\r\n * For technique parameters see `TerrainTechniqueParams`.\r\n */\r\nexport interface TerrainTechnique extends MakeTechniqueAttrs<TerrainTechniqueParams> {\r\n    name: \"terrain\";\r\n}\r\n\r\n/**\r\n * Technique to avoid label rendering on top of certain line geometries.\r\n * For technique parameters see `BaseTechniqueParams`.\r\n */\r\nexport interface LabelRejectionLineTechnique extends MakeTechniqueAttrs<BaseTechniqueParams> {\r\n    name: \"label-rejection-line\";\r\n}\r\n\r\n/**\r\n * Names of the properties controlling transparency.\r\n * @internal\r\n */\r\nexport const TRANSPARENCY_PROPERTY_KEYS = [\"opacity\", \"transparent\"];\r\n\r\n/**\r\n * Additional params used for optimized usage of `Techniques`.\r\n */\r\nexport interface IndexedTechniqueParams {\r\n    /**\r\n     * Optimization: Index into table in `StyleSetEvaluator` or in `DecodedTile`.\r\n     * @hidden\r\n     */\r\n    _index: number;\r\n\r\n    /**\r\n     * Optimization: Unique `Technique` index of `Style` from which technique was derived.\r\n     * @hidden\r\n     */\r\n    _styleSetIndex: number;\r\n\r\n    /**\r\n     * The styleSet associated to this `Technique`.\r\n     * @hidden\r\n     */\r\n    _styleSet?: string;\r\n\r\n    /**\r\n     * The category used to assign render orders to objects created using this `Technique`.\r\n     * @hidden\r\n     */\r\n    _category?: string;\r\n\r\n    /**\r\n     * The category used to assign render orders to secondary objects\r\n     * created using this `Technique`.\r\n     * @hidden\r\n     */\r\n    _secondaryCategory?: string;\r\n\r\n    /**\r\n     * `true` if any of the properties of this technique needs to access\r\n     * the feature's state.\r\n     *\r\n     * @hidden\r\n     */\r\n    _usesFeatureState?: boolean;\r\n\r\n    /**\r\n     * Last computed state derived from [[Technique.kind]].\r\n     */\r\n    _kindState?: boolean;\r\n}\r\n\r\n/**\r\n * For efficiency, `StyleSetEvaluator` returns `Techniques` additional params as defined in\r\n * `IndexedTechniqueParams`.\r\n */\r\nexport type IndexedTechnique = Technique & IndexedTechniqueParams;\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `CirclesTechnique`.\r\n */\r\nexport function isCirclesTechnique(technique: Technique): technique is CirclesTechnique {\r\n    return technique.name === \"circles\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `SquaresTechnique`.\r\n */\r\nexport function isSquaresTechnique(technique: Technique): technique is SquaresTechnique {\r\n    return technique.name === \"squares\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `PoiTechnique`.\r\n */\r\nexport function isPoiTechnique(technique: Technique): technique is PoiTechnique {\r\n    return technique.name === \"labeled-icon\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `LineMarkerTechnique`.\r\n */\r\nexport function isLineMarkerTechnique(technique: Technique): technique is LineMarkerTechnique {\r\n    return technique.name === \"line-marker\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `LineTechnique`.\r\n */\r\nexport function isLineTechnique(technique: Technique): technique is LineTechnique {\r\n    return technique.name === \"line\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `SolidLineTechnique`.\r\n */\r\nexport function isSolidLineTechnique(technique: Technique): technique is SolidLineTechnique {\r\n    return technique.name === \"solid-line\" || technique.name === \"dashed-line\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `SolidLineTechnique` and is a kind that\r\n * has special dashes.\r\n * @note Lines with special dashes need line caps to render properly.\r\n */\r\nexport function isSpecialDashesLineTechnique(\r\n    technique: Technique\r\n): technique is SolidLineTechnique {\r\n    return (\r\n        (technique.name === \"solid-line\" || technique.name === \"dashed-line\") &&\r\n        technique.dashes !== undefined &&\r\n        technique.dashes !== \"Square\"\r\n    );\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `SegmentsTechnique`.\r\n */\r\nexport function isSegmentsTechnique(technique: Technique): technique is SegmentsTechnique {\r\n    return technique.name === \"segments\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `BasicExtrudedLineTechnique`\r\n * or `StandardExtrudedLineTechnique`.\r\n */\r\nexport function isExtrudedLineTechnique(\r\n    technique: Technique\r\n): technique is BasicExtrudedLineTechnique | StandardExtrudedLineTechnique {\r\n    return technique.name === \"extruded-line\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `BasicExtrudedLineTechnique`.\r\n */\r\nexport function isBasicExtrudedLineTechnique(\r\n    technique: Technique\r\n): technique is BasicExtrudedLineTechnique {\r\n    return isExtrudedLineTechnique(technique) && technique.shading === \"basic\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `StandardExtrudedLineTechnique`.\r\n */\r\nexport function isStandardExtrudedLineTechnique(\r\n    technique: Technique\r\n): technique is StandardExtrudedLineTechnique {\r\n    return isExtrudedLineTechnique(technique) && technique.shading === \"standard\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `FillTechnique`.\r\n */\r\nexport function isFillTechnique(technique: Technique): technique is FillTechnique {\r\n    return technique.name === \"fill\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `ExtrudedPolygonTechnique`.\r\n */\r\nexport function isExtrudedPolygonTechnique(\r\n    technique: Technique\r\n): technique is ExtrudedPolygonTechnique {\r\n    return technique.name === \"extruded-polygon\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `StandardTechnique`.\r\n */\r\nexport function isStandardTechnique(technique: Technique): technique is StandardTechnique {\r\n    return technique.name === \"standard\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `TerrainTechnique`.\r\n */\r\nexport function isTerrainTechnique(technique: Technique): technique is TerrainTechnique {\r\n    return technique.name === \"terrain\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `TextTechnique`.\r\n */\r\nexport function isTextTechnique(technique: Technique): technique is TextTechnique {\r\n    return technique.name === \"text\";\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of `ShaderTechnique`.\r\n */\r\nexport function isShaderTechnique(technique: Technique): technique is ShaderTechnique {\r\n    return technique.name === \"shader\";\r\n}\r\n\r\nexport function isLabelRejectionLineTechnique(\r\n    technique: Technique\r\n): technique is LabelRejectionLineTechnique {\r\n    return technique.name === \"label-rejection-line\";\r\n}\r\n\r\n/**\r\n * Check if vertex normals should be generated for this technique (if no normals are in the data).\r\n * @param technique - Technique to check.\r\n */\r\nexport function needsVertexNormals(technique: Technique): boolean {\r\n    return (\r\n        isExtrudedPolygonTechnique(technique) ||\r\n        isFillTechnique(technique) ||\r\n        isStandardTechnique(technique) ||\r\n        isTerrainTechnique(technique) ||\r\n        isStandardExtrudedLineTechnique(technique)\r\n    );\r\n}\r\n\r\n/**\r\n * Type guard to check if an object is an instance of a technique with textures.\r\n */\r\nexport function supportsTextures(\r\n    technique: Technique\r\n): technique is FillTechnique | StandardTechnique | ExtrudedPolygonTechnique | TerrainTechnique {\r\n    return (\r\n        isFillTechnique(technique) ||\r\n        isStandardTechnique(technique) ||\r\n        isExtrudedPolygonTechnique(technique) ||\r\n        isTerrainTechnique(technique)\r\n    );\r\n}\r\n\r\n/**\r\n * Get the texture coordinate type if the technique supports it.\r\n */\r\nexport function textureCoordinateType(technique: Technique): TextureCoordinateType | undefined {\r\n    return supportsTextures(technique) || isShaderTechnique(technique)\r\n        ? technique.textureCoordinateType\r\n        : undefined;\r\n}\r\n\r\n/**\r\n * Add all the buffers of the technique to the transfer list.\r\n */\r\nexport function addBuffersToTransferList(technique: Technique, transferList: ArrayBuffer[]) {\r\n    if (\r\n        isStandardTechnique(technique) ||\r\n        isExtrudedPolygonTechnique(technique) ||\r\n        isTerrainTechnique(technique)\r\n    ) {\r\n        for (const texturePropertyKey of TEXTURE_PROPERTY_KEYS) {\r\n            const textureProperty = (technique as any)[texturePropertyKey];\r\n            if (isTextureBuffer(textureProperty)) {\r\n                if (textureProperty.buffer instanceof ArrayBuffer) {\r\n                    transferList.push(textureProperty.buffer);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Compose full texture name for given image name with technique specified.\r\n * Some techniques allows to add prefix/postfix to icons names specified, this\r\n * function uses technique information to create fully qualified texture name.\r\n * @param imageName - base name of the marker icon.\r\n * @param technique - the technique describing POI or line marker.\r\n * @returns fully qualified texture name for loading from atlas (without extension).\r\n */\r\nexport function composeTechniqueTextureName(\r\n    imageName: string,\r\n    technique: PoiTechnique | LineMarkerTechnique\r\n): string {\r\n    let textureName = imageName;\r\n    if (typeof technique.imageTexturePrefix === \"string\") {\r\n        textureName = technique.imageTexturePrefix + textureName;\r\n    }\r\n    if (typeof technique.imageTexturePostfix === \"string\") {\r\n        textureName = textureName + technique.imageTexturePostfix;\r\n    }\r\n    return textureName;\r\n}\r\n\r\n/**\r\n * Sets a technique's render order (or priority for screen-space techniques) depending on its\r\n * category and the priorities specified in a given theme.\r\n * @param technique- The technique whose render order or priority will be set.\r\n * @param theme - The theme from which the category priorities will be taken.\r\n */\r\nexport function setTechniqueRenderOrderOrPriority(\r\n    technique: IndexedTechnique,\r\n    priorities: StylePriority[],\r\n    labelPriorities: string[]\r\n) {\r\n    if (\r\n        isTextTechnique(technique) ||\r\n        isPoiTechnique(technique) ||\r\n        isLineMarkerTechnique(technique)\r\n    ) {\r\n        // for screen-space techniques the `category` is used to assign\r\n        // priorities.\r\n        if (labelPriorities && typeof technique._category === \"string\") {\r\n            // override the `priority` when the technique uses `category`.\r\n            const priority = labelPriorities.indexOf(technique._category);\r\n            if (priority !== -1) {\r\n                technique.priority = labelPriorities.length - priority;\r\n            }\r\n        }\r\n    } else if (priorities && technique._styleSet !== undefined) {\r\n        // Compute the render order based on the style category and styleSet.\r\n        const computeRenderOrder = (category: string): number | undefined => {\r\n            const priority = priorities?.findIndex(\r\n                entry => entry.group === technique._styleSet && entry.category === category\r\n            );\r\n\r\n            return priority !== undefined && priority !== -1 ? (priority + 1) * 10 : undefined;\r\n        };\r\n\r\n        if (typeof technique._category === \"string\") {\r\n            // override the renderOrder when the technique is using categories.\r\n            const renderOrder = computeRenderOrder(technique._category);\r\n\r\n            if (renderOrder !== undefined) {\r\n                technique.renderOrder = renderOrder;\r\n            }\r\n        }\r\n\r\n        if (typeof technique._secondaryCategory === \"string\") {\r\n            // override the secondaryRenderOrder when the technique is using categories.\r\n            const secondaryRenderOrder = computeRenderOrder(technique._secondaryCategory);\r\n\r\n            if (secondaryRenderOrder !== undefined) {\r\n                (technique as any).secondaryRenderOrder = secondaryRenderOrder;\r\n            }\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { Vector3Like } from \"@here/harp-geoutils/lib/math/Vector3Like\";\r\n\r\nimport { JsonExpr, JsonValue } from \"./Expr\";\r\nimport { InterpolatedPropertyDefinition } from \"./InterpolatedPropertyDefs\";\r\nimport {\r\n    BaseTechniqueParams,\r\n    BasicExtrudedLineTechniqueParams,\r\n    ExtrudedPolygonTechniqueParams,\r\n    FillTechniqueParams,\r\n    LineTechniqueParams,\r\n    MarkerTechniqueParams,\r\n    Pickability,\r\n    PointTechniqueParams,\r\n    SegmentsTechniqueParams,\r\n    ShaderTechniqueParams,\r\n    SolidLineTechniqueParams,\r\n    StandardExtrudedLineTechniqueParams,\r\n    StandardTechniqueParams,\r\n    TerrainTechniqueParams,\r\n    TextTechniqueParams\r\n} from \"./TechniqueParams\";\r\n\r\n/**\r\n * Map theme is used to define what features are shown and how the map is styled, for example\r\n * which lightning is used or whether fog should be displayed.\r\n */\r\nexport interface Theme {\r\n    /**\r\n     * The URI of the JSON schema describing themes.\r\n     */\r\n    $schema?: string;\r\n\r\n    /**\r\n     * The base `Theme`s or `theme` URLs to extend.\r\n     *\r\n     * @remarks\r\n     * If used, base themes are loaded first, and then all the properties from inherited theme\r\n     * overwrite these defined in base theme.\r\n     */\r\n\r\n    extends?: string | Theme | Array<string | Theme>;\r\n\r\n    /**\r\n     * Actual URL the theme has been loaded from.\r\n     */\r\n    url?: string;\r\n\r\n    /**\r\n     * Color to be used as a clear background - no map objects.\r\n     * @format color-hex\r\n     */\r\n    clearColor?: string;\r\n\r\n    /**\r\n     * Alpha to be used as a clear background - no map objects.\r\n     * @format 0-1\r\n     */\r\n    clearAlpha?: number;\r\n\r\n    /**\r\n     * Define the default text style for styling labels and texts.\r\n     */\r\n    defaultTextStyle?: TextStyleDefinition;\r\n\r\n    /**\r\n     * Define the lightning available on the three.js scene.\r\n     */\r\n    lights?: Light[];\r\n\r\n    /**\r\n     * Define the style of the sky presented in the map scene.\r\n     */\r\n    sky?: Sky;\r\n\r\n    /**\r\n     * Define the fog used in the map scene.\r\n     */\r\n    fog?: Fog;\r\n\r\n    /**\r\n     * The definitions exported by these theme.\r\n     */\r\n    definitions?: Definitions;\r\n\r\n    /**\r\n     * Map styles available for datasources used to render the map.\r\n     */\r\n    styles?: StylesDictionary | Styles;\r\n\r\n    /**\r\n     * Define the style to render different types of text used on the map.\r\n     */\r\n    textStyles?: TextStyleDefinition[];\r\n\r\n    /**\r\n     * List available fonts to be used while rendering text.\r\n     */\r\n    fontCatalogs?: FontCatalogConfig[];\r\n\r\n    /**\r\n     * Optional images to be rendered on the map view.\r\n     */\r\n    images?: ImageDefinitions;\r\n\r\n    /**\r\n     * Image textures to be used while rendering geometries on the map view.\r\n     */\r\n    imageTextures?: ImageTexture[];\r\n\r\n    /**\r\n     * Optional list of [[ThemePoiTableDef]]s.\r\n     */\r\n    poiTables?: PoiTableRef[];\r\n\r\n    /**\r\n     * Optional list of symbolic priorities for the object\r\n     * created using this {@link Theme}.\r\n     *\r\n     * @remarks\r\n     * The attribute `styleSet` and `category` of the [[Technique]]\r\n     * are used together with [[Theme.priorities]] to sort\r\n     * the objects created using this {@link Theme}, for example:\r\n     *\r\n     *\r\n     * ```json\r\n     * {\r\n     *      \"priorities\": [\r\n     *          { \"group\": \"tilezen\", \"category\": \"outline-1\" }\r\n     *      ],\r\n     *      \"styles\": [\r\n     *          {\r\n     *              \"technique\": \"solid-line\",\r\n     *              \"styleSet\": \"tilezen\",\r\n     *              \"category\": \"outline-1\"\r\n     *          }\r\n     *      ]\r\n     * }\r\n     * ```\r\n     */\r\n    priorities?: StylePriority[];\r\n\r\n    /**\r\n     * Optional list of priorities for the screen-space\r\n     * objects created using this style.\r\n     *\r\n     * @remarks\r\n     * The name of the `category` attribute of the screen-space\r\n     * technique (e.g. `\"text\"`) must match on the strings\r\n     * defined by this [[Theme.labelPriorities]], for example:\r\n     *\r\n     * ```json\r\n     * {\r\n     *      \"labelPriorities\": [\r\n     *          \"continent-labels\",\r\n     *          \"country-labels\",\r\n     *          \"state-labels\"\r\n     *      ],\r\n     *      \"styles\": [\r\n     *          {\r\n     *              \"technique\": \"text\",\r\n     *              \"category\": \"state-labels\"\r\n     *          }\r\n     *      ]\r\n     * }\r\n     * ```\r\n     */\r\n    labelPriorities?: string[];\r\n}\r\n\r\n/**\r\n * A type representing symbolic render orders.\r\n */\r\nexport interface StylePriority {\r\n    /**\r\n     * The group of this `StylePriority`.\r\n     */\r\n    group: string;\r\n\r\n    /**\r\n     * The category of this `StylePriority`.\r\n     */\r\n    category?: string;\r\n}\r\n\r\n/**\r\n * Value definition commons.\r\n */\r\nexport type Definition = JsonValue | InterpolatedPropertyDefinition<JsonValue>;\r\n\r\n/**\r\n * This is the old, more verbose, format of the definitions, to be deprecated\r\n * @deprecated\r\n */\r\nexport interface VerboseDefinition {\r\n    /**\r\n     * The type of the definition.\r\n     */\r\n    type?: \"selector\" | \"boolean\" | \"number\" | \"string\" | \"color\";\r\n\r\n    /**\r\n     * The value of the definition.\r\n     */\r\n    value: Definition;\r\n\r\n    /**\r\n     * The description of the definition.\r\n     */\r\n    description?: string;\r\n}\r\n\r\n/**\r\n * This is to distinguish between definition types at runtime, to be deprecated with\r\n * {@link VerboseDefinition}\r\n * @deprecated\r\n *\r\n * @param definition\r\n * @returns `true` if the Definition is of the deprecated {@link VerboseDefinition} type\r\n */\r\nexport function isVerboseDefinition(definition: VerboseDefinition | Definition) {\r\n    return (definition as VerboseDefinition)?.value !== undefined;\r\n}\r\n\r\n/**\r\n * This is a utility function to retrive a definitions value until {@link VerboseDefinition} is fully\r\n * deprecated\r\n * @deprecated\r\n *\r\n * @param definition\r\n * @returns value of the given definition.\r\n */\r\nexport function getDefinitionValue(definition: VerboseDefinition | Definition): Definition {\r\n    return isVerboseDefinition(definition)\r\n        ? (definition as VerboseDefinition).value\r\n        : (definition as Definition);\r\n}\r\n\r\n/*\r\n * An set of {@link Definition}s.\r\n */\r\nexport interface Definitions {\r\n    [name: string]: Definition | VerboseDefinition;\r\n}\r\n\r\nexport type JsonExprReference = [\"ref\", string];\r\n\r\n/**\r\n * Checks if the given value is a reference to a definition.\r\n *\r\n * @param value - The value of a technique property.\r\n */\r\nexport function isJsonExprReference(value: any): value is JsonExprReference {\r\n    return (\r\n        Array.isArray(value) &&\r\n        value.length === 2 &&\r\n        value[0] === \"ref\" &&\r\n        typeof value[1] === \"string\"\r\n    );\r\n}\r\n\r\n/**\r\n * An array of {@link Style}s that are used together to define how a\r\n * {@link @here/harp-mapview#DataSource} should be rendered.\r\n *\r\n * @remarks\r\n * `StyleSet`s are applied to sources providing vector tiles via their method\r\n * `setStyleSet`. This is also handle internally when a whole theme is passed to a\r\n * {@link @here/harp-mapview#MapView} via {@link @here/harp-mapview#MapViewtheme}.\r\n */\r\nexport type Styles = Style[];\r\n\r\n/**\r\n * The object that defines what way an item of a {@link @here/harp-mapview#DataSource}\r\n * should be decoded to assemble a tile.\r\n *\r\n * @remarks\r\n * {@link Style} is describing which features are shown on a map and in what way they are being\r\n * shown.\r\n */\r\nexport type BaseStyle<Technique, Params> = StyleAttributes<Technique, Params> & Partial<Params>;\r\n\r\n/**\r\n * The common attributes of a {@link Style}.\r\n */\r\nexport interface StyleAttributes<Technique, Params> {\r\n    /**\r\n     * Unique identifier associated with this `Style`.\r\n     */\r\n    id?: string;\r\n\r\n    /**\r\n     * Reference to the identifier of an existing `Style` to extend.\r\n     */\r\n    extends?: string;\r\n\r\n    /**\r\n     * Condition when this style rule applies.\r\n     *\r\n     * @remarks\r\n     * Condition that is applied to feature properties to check if given {@link Style} this feature\r\n     * should emit geometry of this style.\r\n     */\r\n    when?: string | JsonExpr;\r\n\r\n    /**\r\n     * The layer containing the carto features processed by this style rule.\r\n     */\r\n    layer?: string;\r\n\r\n    /**\r\n     * Optional. If `true`, no more matching styles will be evaluated.\r\n     */\r\n    final?: boolean;\r\n\r\n    /**\r\n     * Human readable description.\r\n     */\r\n    description?: string;\r\n\r\n    /**\r\n     * The style set referenced by this styling rule.\r\n     */\r\n    styleSet?: string;\r\n\r\n    /**\r\n     * The category of this style.\r\n     */\r\n    category?: string | JsonExpr;\r\n\r\n    /**\r\n     * The name of the technique to use.\r\n     *\r\n     * @remarks\r\n     * Technique name. See the classes extending from this class to determine what possible\r\n     * techniques are possible, includes `\"line\"`, `\"fill\"`, `\"solid-line\"`, `\"extruded-line\"`,\r\n     * `\"extruded-polygon\"`, `\"text\"`, `\"none\"`.\r\n     */\r\n    technique: Technique;\r\n\r\n    /**\r\n     * Specify `renderOrder` of value.\r\n     *\r\n     * @remarks\r\n     * @default If not specified in style file, `renderOrder` will be assigned with monotonically\r\n     * increasing values according to style position in file.\r\n     */\r\n    renderOrder?: number | JsonExpr;\r\n\r\n    /**\r\n     * Minimal zoom level. If the current zoom level is smaller, the technique will not be used.\r\n     */\r\n    minZoomLevel?: number | JsonExpr;\r\n\r\n    /**\r\n     * Maximum zoom level. If the current zoom level is larger, the technique will not be used.\r\n     */\r\n    maxZoomLevel?: number | JsonExpr;\r\n\r\n    /**\r\n     * Optional. If `true` or `Pickability.transient`, no IDs will be saved for the geometry\r\n     * this style creates. Default is `Pickability.onlyVisible`, which allows all pickable and visible\r\n     * objects to be picked, Pickability.all, will also allow invisible objects to be\r\n     * picked.\r\n     * @defaultValue `Pickability.onlyVisible`\r\n     * The boolean option is for backwardscompatibilty, please use the Pickability.\r\n     *\r\n     *\r\n     * TODO: deprecate and rename to something that makes more sense\r\n     */\r\n    transient?: boolean | Pickability;\r\n\r\n    /**\r\n     * Optional: If `true`, the objects with matching `when` statement will be printed to the\r\n     * console.\r\n     */\r\n    debug?: boolean;\r\n\r\n    /**\r\n     * @deprecated Technique parameters are now properties at the Style interface level.\r\n     */\r\n    attr?: Partial<Params>;\r\n}\r\n\r\nexport type Style =\r\n    | SquaresStyle\r\n    | CirclesStyle\r\n    | PoiStyle\r\n    | LineMarkerStyle\r\n    | LineStyle\r\n    | SegmentsStyle\r\n    | SolidLineStyle\r\n    | LabelRejectionLineStyle\r\n    | FillStyle\r\n    | StandardStyle\r\n    | BasicExtrudedLineStyle\r\n    | StandardExtrudedLineStyle\r\n    | ExtrudedPolygonStyle\r\n    | ShaderStyle\r\n    | TerrainStyle\r\n    | TextTechniqueStyle\r\n    | NoneStyle;\r\n\r\n/**\r\n * A dictionary of {@link Styles}s.\r\n * @deprecated\r\n *\r\n * Use {@link Styles} instead, which is just a flat list of {@link Style}\r\n */\r\nexport interface StylesDictionary {\r\n    [styleSetName: string]: Styles;\r\n}\r\n\r\n/**\r\n * Utility function to convert old style format to new one, to be deprecated with\r\n * {@link StylesDictionary}\r\n *\r\n * @param stylesDict\r\n * @returns\r\n *\r\n */\r\nfunction convertDictionaryToStyles(stylesDict: StylesDictionary): Styles {\r\n    const styles: Styles = [];\r\n    for (const styleSetName in stylesDict) {\r\n        stylesDict[styleSetName].forEach(style => {\r\n            if (style.styleSet === undefined) {\r\n                style.styleSet = styleSetName;\r\n            }\r\n            styles.push(style);\r\n        });\r\n    }\r\n    return styles;\r\n}\r\n\r\n/**\r\n * Utility function to distinguish Styles until {@link StylesDictionary} is deprecated\r\n *\r\n * @deprecated\r\n * @param styles\r\n * @returns\r\n */\r\nexport function isStylesDictionary(styles: StylesDictionary | Styles | undefined): boolean {\r\n    return styles !== undefined && !Array.isArray(styles);\r\n}\r\n\r\n/**\r\n * Utility function to retrieve Styles until {@link StylesDictionary} is deprecated\r\n *\r\n * @deprecated\r\n * @param styles\r\n * @returns\r\n */\r\nexport function getStyles(styles: StylesDictionary | Styles | undefined): Styles {\r\n    if (styles === undefined) {\r\n        return [] as Styles;\r\n    } else if (isStylesDictionary(styles)) {\r\n        return convertDictionaryToStyles(styles as StylesDictionary);\r\n    } else {\r\n        return styles as Styles;\r\n    }\r\n}\r\n\r\n/**\r\n * A reference to a style definition.\r\n *\r\n * @remarks\r\n * Use as value `attrs` to reference value from `definitions`.\r\n *\r\n * Example of usage:\r\n * ```json\r\n * {\r\n *   \"definitions\": {\r\n *     \"roadColor\": \"#f00\"\r\n *   },\r\n *   \"styles\": { \"tilezen\": [\r\n *      {\r\n *       \"when\": \"kind == 'road\",\r\n *       \"technique\": \"solid-line\",\r\n *       \"attr\": {\r\n *         \"lineColor\": { \"$ref\": \"roadColor\" }\r\n *       }\r\n *     }\r\n *   ] }\r\n * }\r\n * ```\r\n */\r\n\r\n/**\r\n * The attributes of a technique.\r\n */\r\nexport type Attr<T> = { [P in keyof T]?: T[P] | JsonExpr };\r\n\r\n/**\r\n * Render feature as set of squares rendered in screen space.\r\n *\r\n * @see {@link PointTechniqueParams}.\r\n */\r\nexport type SquaresStyle = BaseStyle<\"squares\", PointTechniqueParams>;\r\n\r\n/**\r\n * Render feature as set of circles rendered in screen space.\r\n *\r\n * @see {@link PointTechniqueParams}.\r\n */\r\nexport type CirclesStyle = BaseStyle<\"circles\", PointTechniqueParams>;\r\n\r\n/**\r\n * Render feature as POIs (icons and text) rendered in screen space.\r\n *\r\n * @see [[MarkerTechniqueParams]].\r\n */\r\nexport type PoiStyle = BaseStyle<\"labeled-icon\", MarkerTechniqueParams>;\r\n\r\n/**\r\n * Render feature as line markers, which is a recurring marker along a line (usually road).\r\n *\r\n * @see [[MarkerTechniqueParams]].\r\n */\r\nexport type LineMarkerStyle = BaseStyle<\"line-marker\", MarkerTechniqueParams>;\r\n\r\n/**\r\n * Render feature as line.\r\n */\r\nexport type LineStyle = BaseStyle<\"line\", LineTechniqueParams>;\r\n\r\n/**\r\n * Render feature as segments.\r\n */\r\nexport type SegmentsStyle = BaseStyle<\"segments\", SegmentsTechniqueParams>;\r\n\r\nexport type SolidLineStyle = BaseStyle<\"solid-line\" | \"dashed-line\", SolidLineTechniqueParams>;\r\n\r\nexport type LabelRejectionLineStyle = BaseStyle<\"label-rejection-line\", BaseTechniqueParams>;\r\n\r\nexport type FillStyle = BaseStyle<\"fill\", FillTechniqueParams>;\r\n\r\nexport type StandardStyle = BaseStyle<\"standard\", StandardTechniqueParams>;\r\n\r\nexport type TerrainStyle = BaseStyle<\"terrain\", TerrainTechniqueParams>;\r\n\r\nexport type BasicExtrudedLineStyle = BaseStyle<\"extruded-line\", BasicExtrudedLineTechniqueParams>;\r\n\r\nexport type StandardExtrudedLineStyle = BaseStyle<\r\n    \"extruded-line\",\r\n    StandardExtrudedLineTechniqueParams\r\n>;\r\n\r\n/**\r\n * Style used to draw a geometry as an extruded polygon, for example extruded buildings.\r\n */\r\nexport type ExtrudedPolygonStyle = BaseStyle<\"extruded-polygon\", ExtrudedPolygonTechniqueParams>;\r\n\r\nexport type ShaderStyle = BaseStyle<\"shader\", ShaderTechniqueParams>;\r\n\r\nexport type TextTechniqueStyle = BaseStyle<\"text\", TextTechniqueParams>;\r\n\r\nexport interface NoneStyle\r\n    extends BaseStyle<\r\n        \"none\",\r\n        {\r\n            [name: string]: any;\r\n        }\r\n    > {\r\n    [name: string]: any;\r\n}\r\n\r\n/**\r\n * Possible lights used for light the map.\r\n */\r\nexport type Light = AmbientLight | DirectionalLight;\r\n\r\nexport interface BaseLight {\r\n    type: string;\r\n    name: string;\r\n}\r\n\r\n/**\r\n * Ambient light\r\n */\r\nexport interface AmbientLight extends BaseLight {\r\n    /**\r\n     * The type of the light.\r\n     */\r\n    type: \"ambient\";\r\n\r\n    /**\r\n     * The color of this ambient light.\r\n     */\r\n    color: string;\r\n\r\n    /**\r\n     * The intensity of this ambient light.\r\n     */\r\n    intensity?: number;\r\n}\r\n\r\n/**\r\n * Directional light.\r\n */\r\nexport interface DirectionalLight extends BaseLight {\r\n    /**\r\n     * The type of the light.\r\n     */\r\n    type: \"directional\";\r\n\r\n    /**\r\n     * The color of this directional light.\r\n     */\r\n    color: string;\r\n\r\n    /**\r\n     * The intensity of this directional light.\r\n     */\r\n    intensity: number;\r\n\r\n    /**\r\n     * The direction of this directional light.\r\n     */\r\n    direction: Vector3Like;\r\n\r\n    /**\r\n     * Determine if this light casts dynamic shadows.\r\n     *\r\n     * @defaultValue false\r\n     */\r\n    castShadow?: boolean;\r\n}\r\n\r\n/**\r\n * Various text styles used with labels and texts.\r\n */\r\nexport interface TextStyleDefinition {\r\n    name?: string;\r\n    fontCatalogName?: string;\r\n\r\n    fontName?: string;\r\n    size?: number;\r\n    backgroundSize?: number;\r\n    fontStyle?: \"Regular\" | \"Bold\" | \"Italic\" | \"BoldItalic\";\r\n    fontVariant?: \"Regular\" | \"AllCaps\" | \"SmallCaps\";\r\n    rotation?: number;\r\n    /**\r\n     * @format color-hex\r\n     */\r\n    color?: string;\r\n    /**\r\n     * @format color-hex\r\n     */\r\n    backgroundColor?: string;\r\n    opacity?: number;\r\n    backgroundOpacity?: number;\r\n\r\n    tracking?: number;\r\n    leading?: number;\r\n    maxLines?: number;\r\n    lineWidth?: number;\r\n    canvasRotation?: number;\r\n    lineRotation?: number;\r\n    wrappingMode?: \"None\" | \"Character\" | \"Word\";\r\n    hAlignment?: \"Left\" | \"Center\" | \"Right\";\r\n    vAlignment?: \"Above\" | \"Center\" | \"Below\";\r\n    /**\r\n     * @format comma separated list of placement tokens, i.e. \"TR, TL, C\"\r\n     * @see [[PlacementToken]]\r\n     */\r\n    placements?: string;\r\n}\r\n\r\n/**\r\n * Interface that defines a procedural gradient sky.\r\n */\r\nexport interface GradientSky {\r\n    /** Sky type. */\r\n    type: \"gradient\";\r\n    /**\r\n     * Color of the upper part of the gradient.\r\n     * @format color-hex\r\n     */\r\n    topColor: string;\r\n    /**\r\n     * Color of bottom part of the gradient.\r\n     * @format color-hex\r\n     */\r\n    bottomColor: string;\r\n    /**\r\n     * Color of the ground plane.\r\n     * @format color-hex\r\n     */\r\n    groundColor: string;\r\n    /** Texture's gradient power. */\r\n    monomialPower?: number;\r\n}\r\n\r\n/**\r\n * Interface that defines a cubemap sky.\r\n */\r\nexport interface CubemapSky {\r\n    /** Sky type. */\r\n    type: \"cubemap\";\r\n    /** Positive X cube map face. */\r\n    positiveX: string;\r\n    /** Negative X cube map face. */\r\n    negativeX: string;\r\n    /** Positive Y cube map face. */\r\n    positiveY: string;\r\n    /** Negative Y cube map face. */\r\n    negativeY: string;\r\n    /** Positive Z cube map face. */\r\n    positiveZ: string;\r\n    /** Negative Z cube map face. */\r\n    negativeZ: string;\r\n}\r\n\r\n/**\r\n * Interface that defines the options to configure the sky.\r\n */\r\nexport type Sky = GradientSky | CubemapSky;\r\n\r\n/**\r\n * Interface that defines the options to configure fog.\r\n */\r\nexport interface Fog {\r\n    /** Fog's color. */\r\n    color: string;\r\n    /** Distance ratio to far plane at which the linear fog begins. */\r\n    startRatio: number;\r\n}\r\n\r\n/**\r\n * Define an image (e.g. icon).\r\n */\r\nexport interface ImageDefinition {\r\n    /** Url to load content from. */\r\n    url: string;\r\n    /** `true` to start loading at init tile, `false` to lazily wait until required. */\r\n    preload: boolean;\r\n    /** Url of JSON file containing the texture atlas */\r\n    atlas?: string;\r\n}\r\n\r\nexport interface ImageDefinitions {\r\n    /** Name of Image. */\r\n    [name: string]: ImageDefinition;\r\n}\r\n\r\n/**\r\n * Can be used to create a texture atlas.\r\n */\r\nexport interface ImageTexture {\r\n    /** Name of ImageTexture. Used to reference texture in the styles. */\r\n    name: string;\r\n    /** Name of ImageDefinition to use. */\r\n    image: string;\r\n    /** Origin of image, defaults to \"topleft\" */\r\n    origin?: string;\r\n    /** Specify sub-region: Defaults to 0. */\r\n    xOffset?: number;\r\n    /** Specify sub-region: Defaults to 0. */\r\n    yOffset?: number;\r\n    /** Specify sub-region:  Defaults to 0, meaning width is taken from loaded image. */\r\n    width?: number;\r\n    /** Specify sub-region:  Defaults to 0, meaning height is taken from loaded image. */\r\n    height?: number;\r\n    /** Defaults to false. */\r\n    flipH?: boolean;\r\n    /** Defaults to false. */\r\n    flipV?: boolean;\r\n    /** Defaults to 1. */\r\n    opacity?: number;\r\n}\r\n\r\n/**\r\n * Definition for a [[PoiTable]] reference as part of the {@link Theme} object.\r\n */\r\nexport interface PoiTableRef {\r\n    /** Required name of the [[PoiTable]] for later reference. */\r\n    name: string;\r\n    /**\r\n     * Required URL from where to load [[PoiTable]].\r\n     *\r\n     * Should refer to JSON that is matched [[PoiTableDef]] interface.\r\n     */\r\n    url: string;\r\n    /**\r\n     * If set to `true`, the list of values in the field \"altNames\" will be used as names for this\r\n     * POI.\r\n     */\r\n    useAltNamesForKey: boolean;\r\n}\r\n\r\n/**\r\n * Interface for the JSON description of the [[PoiTable]]. It is being implemented in [[PoiTable]].\r\n */\r\nexport interface PoiTableDef {\r\n    /** Name of the `PoiTable`. Must be unique. */\r\n    name?: string;\r\n    /**\r\n     * Stores the list of {@link PoiTableEntryDef}s.\r\n     */\r\n    poiList?: PoiTableEntryDef[];\r\n}\r\n\r\n/**\r\n * Interface descrining POI entries.\r\n */\r\nexport interface PoiTableEntryDef {\r\n    /** Default name of the POI as the key for looking it up. */\r\n    name?: string;\r\n    /** Alternative names of the POI. */\r\n    altNames?: string[];\r\n    /** Visibility of the POI. If `false`, the POI will not be rendered. */\r\n    visible?: boolean;\r\n    /** Name of the icon, defined in the the texture atlases. */\r\n    iconName?: string;\r\n    /** Stacking mode of the POI. For future use. */\r\n    stackMode?: string;\r\n    /**\r\n     * Priority of the POI to select the visible set in case there are more POIs than can be\r\n     * handled.\r\n     */\r\n    priority?: number;\r\n    /** Minimum zoom level to render the icon on. */\r\n    iconMinLevel?: number;\r\n    /** Maximum zoom level to render the icon on. */\r\n    iconMaxLevel?: number;\r\n    /** Minimum zoom level to render the text label on. */\r\n    textMinLevel?: number;\r\n    /** Maximum zoom level to render the text label on. */\r\n    textMaxLevel?: number;\r\n}\r\n\r\n/**\r\n * Fonts used for all text related rendering.\r\n */\r\nexport interface FontCatalogConfig {\r\n    url: string;\r\n    name: string;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { isJsonExpr } from \"./Expr\";\r\nimport { getStyles, Style, Theme } from \"./Theme\";\r\n\r\n/**\r\n * The ThemeVisitor visits every style in the theme in a depth-first fashion.\r\n */\r\nexport class ThemeVisitor {\r\n    constructor(readonly theme: Theme) {}\r\n    /**\r\n     * Applies a function to every style in the theme.\r\n     *\r\n     * @param visitFunc - Function to be called with `style` as an argument. Function should return\r\n     *                  `true` to cancel visitation.\r\n     * @returns `true` if function has finished prematurely.\r\n     */\r\n    visitStyles(visitFunc: (style: Style) => boolean): boolean {\r\n        const visit = (style: Style): boolean => {\r\n            if (isJsonExpr(style)) {\r\n                return false;\r\n            }\r\n            if (visitFunc(style)) {\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n        if (this.theme.styles !== undefined) {\r\n            for (const style of getStyles(this.theme.styles)) {\r\n                if (visit(style)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport {\r\n    BufferAttribute as ThreeBufferAttribute,\r\n    BufferGeometry as ThreeBufferGeometry,\r\n    InterleavedBufferAttribute as ThreeInterleavedBufferAttribute\r\n} from \"three\";\r\n\r\nimport {\r\n    BufferAttribute,\r\n    BufferElementType,\r\n    Geometry,\r\n    GeometryType,\r\n    InterleavedBufferAttribute\r\n} from \"./DecodedTile\";\r\n\r\n/**\r\n * Collection of helper methods to convert\r\n * {@link https://threejs.org/docs/index.html#api/en/core/BufferGeometry|three.js BufferGeometry}\r\n * to [[Geometry]] that allows creation and transfering of THREE BufferGeometry in webworkers.\r\n * See also [[CustomDatasourceExample]].\r\n */\r\nexport namespace ThreeBufferUtils {\r\n    export function getBufferElementType(buffer: ArrayBufferView): BufferElementType {\r\n        if (buffer instanceof Int8Array) {\r\n            return \"int8\";\r\n        } else if (buffer instanceof Uint8Array) {\r\n            return \"uint8\";\r\n        } else if (buffer instanceof Int16Array) {\r\n            return \"int16\";\r\n        } else if (buffer instanceof Uint16Array) {\r\n            return \"uint16\";\r\n        } else if (buffer instanceof Int32Array) {\r\n            return \"int32\";\r\n        } else if (buffer instanceof Uint32Array) {\r\n            return \"uint32\";\r\n        } else if (buffer instanceof Float32Array) {\r\n            return \"float\";\r\n        }\r\n\r\n        throw new Error(`Unsupported buffer type ${name}`);\r\n    }\r\n\r\n    export function fromThreeBufferAttribute(\r\n        bufferAttribute: ThreeBufferAttribute\r\n    ): BufferAttribute {\r\n        const buffer = (bufferAttribute.array as any) as ArrayBufferView;\r\n        return {\r\n            name: bufferAttribute.name,\r\n            buffer: buffer.buffer,\r\n            type: getBufferElementType(buffer),\r\n            itemCount: bufferAttribute.itemSize,\r\n            normalized: bufferAttribute.normalized\r\n        };\r\n    }\r\n\r\n    export function fromThreeInterleavedBufferAttribute(\r\n        bufferAttribute: ThreeInterleavedBufferAttribute\r\n    ): InterleavedBufferAttribute {\r\n        throw new Error(\"Not implemented yet\");\r\n    }\r\n\r\n    export function fromThreeBufferGeometry(\r\n        bufferGeometry: ThreeBufferGeometry,\r\n        techniqueIndex: number\r\n    ): Geometry {\r\n        const vertexAttributes: BufferAttribute[] = [];\r\n        const attributeNames = Object.getOwnPropertyNames(bufferGeometry.attributes);\r\n        for (const name of attributeNames) {\r\n            const attribute = bufferGeometry.attributes[name];\r\n            // FIXME: Also support InterleavedBufferAttribute\r\n            const vertexAttribute = fromThreeBufferAttribute(attribute as ThreeBufferAttribute);\r\n            vertexAttribute.name = name;\r\n            vertexAttributes.push(vertexAttribute);\r\n        }\r\n        const index =\r\n            bufferGeometry.index !== null\r\n                ? fromThreeBufferAttribute(bufferGeometry.index)\r\n                : undefined;\r\n\r\n        let count = 0;\r\n        if (index !== undefined) {\r\n            count = bufferGeometry.index === null ? 0 : bufferGeometry.index.count;\r\n        } else {\r\n            // If there is no index buffer, try to deduce the count from the position attribute.\r\n            const posAttr = bufferGeometry.attributes.position as ThreeBufferAttribute;\r\n            if (posAttr === undefined) {\r\n                throw new Error(\"Missing position attibute to deduce item count\");\r\n            }\r\n            count = posAttr.count;\r\n        }\r\n\r\n        return {\r\n            type: GeometryType.Unspecified,\r\n            vertexAttributes,\r\n            index,\r\n            groups: [{ start: 0, count, technique: techniqueIndex }]\r\n        };\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Definitions, StylePriority, Styles } from \"./Theme\";\r\nimport { WorkerServiceProtocol } from \"./WorkerServiceProtocol\";\r\n\r\n/**\r\n * Interface for `OptionsMap` which describes a general structure of key-value pairs.\r\n */\r\nexport interface OptionsMap {\r\n    [name: string]: any;\r\n}\r\n\r\n/**\r\n * Allows to cancel and prioritize requests inside the requestQueue.\r\n *\r\n * @remarks\r\n * Useful to optimize the order of decoding tiles during animations and camera movements.\r\n *\r\n * `RequestController` is not extending [[AbortController]], because this is not supported in ES5.\r\n */\r\nexport class RequestController implements AbortController {\r\n    /**\r\n     * Creates an instance of `RequestController`.\r\n     *\r\n     * @param {number} priority\r\n     * @param {AbortController} abortController Optional [[AbortController]] used internally, since\r\n     *      [[AbortController]]s should not be subclassed.\r\n     */\r\n    constructor(\r\n        public priority: number = 0,\r\n        public abortController: AbortController = new AbortController()\r\n    ) {}\r\n\r\n    get signal(): AbortSignal {\r\n        return this.abortController.signal;\r\n    }\r\n\r\n    /**\r\n     * Invoking this method will set this object's AbortSignal's aborted flag and\r\n     * signal to any observers that the associated activity is to be aborted.\r\n     */\r\n    abort(): void {\r\n        this.abortController.abort();\r\n    }\r\n}\r\n\r\n/**\r\n * Communication protocol with [[ITileDecoder]].\r\n */\r\nexport namespace WorkerDecoderProtocol {\r\n    /**\r\n     * Define possible names of messages exchanged with decoder services within `WebWorker`.\r\n     */\r\n    export enum DecoderMessageName {\r\n        Configuration = \"configuration\"\r\n    }\r\n\r\n    /**\r\n     * Interface for `DecodedTileMessage` which describes metadata for a decoded tile.\r\n     */\r\n    export interface DecoderMessage {\r\n        service: string;\r\n        type: DecoderMessageName;\r\n    }\r\n\r\n    /**\r\n     * Interface for a ConfigurationMessage that is sent from the datasource to the decoder. The\r\n     * message used to configure the [[ITileDecoder]].\r\n     */\r\n    export interface ConfigurationMessage extends DecoderMessage {\r\n        type: DecoderMessageName.Configuration;\r\n        styleSet?: Styles;\r\n        definitions?: Definitions;\r\n        priorities?: StylePriority[];\r\n        labelPriorities?: string[];\r\n        options?: OptionsMap;\r\n        languages?: string[];\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is an instance of `ConfigurationMessage`.\r\n     */\r\n    export function isConfigurationMessage(message: any): message is ConfigurationMessage {\r\n        return (\r\n            message &&\r\n            typeof message.service === \"string\" &&\r\n            typeof message.type === \"string\" &&\r\n            message.type === DecoderMessageName.Configuration\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Define possible names of requests called on decoder services within `WebWorker`.\r\n     */\r\n    export enum Requests {\r\n        DecodeTileRequest = \"decode-tile-request\",\r\n        TileInfoRequest = \"tile-info-request\"\r\n    }\r\n\r\n    /**\r\n     * This object is sent to the decoder asking to decode a specific tile. The expected response\r\n     * type is a [[DecodedTile]].\r\n     */\r\n    export interface DecodeTileRequest extends WorkerServiceProtocol.ServiceRequest {\r\n        type: Requests.DecodeTileRequest;\r\n        tileKey: number;\r\n        data: ArrayBufferLike;\r\n        projection: string;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is a decoded tile object sent to a worker.\r\n     */\r\n    export function isDecodeTileRequest(message: any): message is DecodeTileRequest {\r\n        return (\r\n            message &&\r\n            typeof message.type === \"string\" &&\r\n            message.type === Requests.DecodeTileRequest\r\n        );\r\n    }\r\n\r\n    /**\r\n     * This object is sent to the decoder asking for a tile info of a specific tile. The expected\r\n     * response type is a [[DecodedTile]].\r\n     */\r\n    export interface TileInfoRequest extends WorkerServiceProtocol.ServiceRequest {\r\n        type: Requests.TileInfoRequest;\r\n        tileKey: number;\r\n        data: ArrayBufferLike;\r\n        projection: string;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is an info tile object sent to a worker.\r\n     */\r\n    export function isTileInfoRequest(message: any): message is TileInfoRequest {\r\n        return (\r\n            message && typeof message.type === \"string\" && message.type === Requests.TileInfoRequest\r\n        );\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Common communication protocol for [[WorkerService]].\r\n */\r\nexport namespace WorkerServiceProtocol {\r\n    /**\r\n     * Service id of worker manager ([[WorkerServiceManager]]) used to create/destroy service\r\n     * instances in workers.\r\n     */\r\n    export const WORKER_SERVICE_MANAGER_SERVICE_ID = \"worker-service-manager\";\r\n\r\n    /**\r\n     * Define possible names of messages exchanged with services within `WebWorker`.\r\n     */\r\n    export enum ServiceMessageName {\r\n        Initialized = \"initialized\",\r\n        Request = \"request\",\r\n        Response = \"response\"\r\n    }\r\n\r\n    /**\r\n     * Interface for `ServiceMessage` which describes metadata for a service messages.\r\n     */\r\n    export interface ServiceMessage {\r\n        service: string;\r\n        type: ServiceMessageName;\r\n    }\r\n\r\n    /**\r\n     * This message is sent by the worker to the main thread. No data is sent. Receiving this\r\n     * message confirms that the worker has started successfully.\r\n     */\r\n    export interface InitializedMessage extends ServiceMessage {\r\n        type: ServiceMessageName.Initialized;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is a signal message from worker.\r\n     */\r\n    export function isInitializedMessage(message: any): message is InitializedMessage {\r\n        return (\r\n            message &&\r\n            typeof message.service === \"string\" &&\r\n            typeof message.type === \"string\" &&\r\n            message.type === ServiceMessageName.Initialized\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Define possible names of requests called on services within `WebWorker`.\r\n     */\r\n    export enum Requests {\r\n        CreateService = \"create-service\",\r\n        DestroyService = \"destroy-service\"\r\n    }\r\n\r\n    /**\r\n     * This is an internal general interface used in communication with workers.\r\n     * Check [[ConcurrentWorkerSet]]'s invokeRequest function for exemplary usage.\r\n     */\r\n    export interface ServiceRequest {\r\n        type: string;\r\n    }\r\n\r\n    /**\r\n     * This message is sent by the main thread to [[WorkerServiceManager]] to dynamically create a\r\n     * new service.\r\n     *\r\n     * May throw `UnknownServiceError` if service of given type is not registered in\r\n     * [[WorkerServiceManager]], see [[isUnknownServiceError]].\r\n     */\r\n    export interface CreateServiceRequest extends ServiceRequest {\r\n        type: Requests.CreateService;\r\n\r\n        /**\r\n         * Type of service to be created.\r\n         *\r\n         * @see [[WorkerServiceManager.register]]\r\n         */\r\n        targetServiceType: string;\r\n\r\n        /**\r\n         * The newly created service instance will be available under this id.\r\n         */\r\n        targetServiceId: string;\r\n    }\r\n\r\n    /**\r\n     * Test if `error` thrown by [[CreateServiceRequest]] was caused by unknown type of service.\r\n     */\r\n    export function isUnknownServiceError(error: Error): boolean {\r\n        return error.message.includes(\"unknown targetServiceType requested: \");\r\n    }\r\n\r\n    /**\r\n     * This message is sent by the main thread to [[WorkerServiceManager]] to dynamically destroy a\r\n     * service.\r\n     */\r\n    export interface DestroyServiceRequest extends ServiceRequest {\r\n        type: Requests.DestroyService;\r\n\r\n        /**\r\n         * Id of service to be destroyed.\r\n         */\r\n        targetServiceId: string;\r\n    }\r\n\r\n    /**\r\n     * Possible service management messages (`CreateService` or `DestroyService`) sent to WebWorker.\r\n     */\r\n    export type WorkerServiceManagerRequest = CreateServiceRequest | DestroyServiceRequest;\r\n\r\n    /**\r\n     * This message is a part of the Request-Response scheme implemented to be used in communication\r\n     * between workers and the decoder.\r\n     */\r\n    export interface RequestMessage extends ServiceMessage {\r\n        type: ServiceMessageName.Request;\r\n        messageId: number;\r\n        request: any;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is a request message sent to a worker.\r\n     */\r\n    export function isRequestMessage(message: any): message is RequestMessage {\r\n        return (\r\n            message &&\r\n            typeof message.service === \"string\" &&\r\n            typeof message.type === \"string\" &&\r\n            message.type === ServiceMessageName.Request\r\n        );\r\n    }\r\n\r\n    /**\r\n     * This message is a part of the Request-Response scheme implemented to be used in communication\r\n     * between workers and the decoder.\r\n     */\r\n    export interface ResponseMessage extends ServiceMessage {\r\n        type: ServiceMessageName.Response;\r\n        messageId: number;\r\n        errorMessage?: string;\r\n        errorStack?: string;\r\n        response?: object;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is a request message sent to a worker.\r\n     */\r\n    export function isResponseMessage(message: any): message is ResponseMessage {\r\n        return (\r\n            message &&\r\n            typeof message.service === \"string\" &&\r\n            typeof message.type === \"string\" &&\r\n            message.type === ServiceMessageName.Response\r\n        );\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { GeoJson } from \"../lib/GeoJsonDataType\";\r\nimport { WorkerServiceProtocol } from \"./WorkerServiceProtocol\";\r\n\r\n/**\r\n * Communication protocol with {@link ITiler}.\r\n */\r\nexport namespace WorkerTilerProtocol {\r\n    /**\r\n     * Define possible names of requests called on tiler services within `WebWorker`.\r\n     */\r\n    export enum Requests {\r\n        RegisterIndex = \"register-index\",\r\n        UpdateIndex = \"update-index\",\r\n        TileRequest = \"tile-request\"\r\n    }\r\n\r\n    /**\r\n     * This object is sent to the tiler to register a new tile index in the worker.\r\n     */\r\n    export interface RegisterIndexRequest extends WorkerServiceProtocol.ServiceRequest {\r\n        type: Requests.RegisterIndex;\r\n        id: string;\r\n        input: string | GeoJson;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is an index registration request sent to a worker.\r\n     */\r\n    export function isRegisterIndexRequest(message: any): message is RegisterIndexRequest {\r\n        return (\r\n            message && typeof message.type === \"string\" && message.type === Requests.RegisterIndex\r\n        );\r\n    }\r\n\r\n    /**\r\n     * This object is sent to the tiler to register a new tile index in the worker.\r\n     */\r\n    export interface UpdateIndexRequest extends WorkerServiceProtocol.ServiceRequest {\r\n        type: Requests.UpdateIndex;\r\n        id: string;\r\n        input: string | GeoJson;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is an update request for the index registration.\r\n     */\r\n    export function isUpdateIndexRequest(message: any): message is UpdateIndexRequest {\r\n        return message && typeof message.type === \"string\" && message.type === Requests.UpdateIndex;\r\n    }\r\n\r\n    /**\r\n     * This object is sent to the tiler asking to retrieve a specific tile. The expected response\r\n     * type is an object containing a tiled payload.\r\n     */\r\n    export interface TileRequest extends WorkerServiceProtocol.ServiceRequest {\r\n        type: Requests.TileRequest;\r\n        index: string;\r\n        tileKey: number;\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if an object is a tile request sent to a worker.\r\n     */\r\n    export function isTileRequest(message: any): message is TileRequest {\r\n        return message && typeof message.type === \"string\" && message.type === Requests.TileRequest;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { CallExpr, Expr, JsonArray, NumberLiteralExpr, StringLiteralExpr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst VALID_ELEMENT_TYPES = [\"boolean\", \"number\", \"string\"];\r\n\r\nfunction checkElementTypes(arg: Expr, array: JsonArray) {\r\n    if (!(arg instanceof StringLiteralExpr) || !VALID_ELEMENT_TYPES.includes(arg.value)) {\r\n        throw new Error(\r\n            `expected \"boolean\", \"number\" or \"string\" instead of '${JSON.stringify(arg)}'`\r\n        );\r\n    }\r\n\r\n    const ty = arg.value;\r\n\r\n    array.forEach((element, index) => {\r\n        if (typeof element !== ty) {\r\n            throw new Error(`expected array element at index ${index} to have type '${ty}'`);\r\n        }\r\n    });\r\n}\r\n\r\nfunction checkArrayLength(arg: Expr, array: JsonArray) {\r\n    if (!(arg instanceof NumberLiteralExpr)) {\r\n        throw new Error(`missing expected number of elements`);\r\n    }\r\n\r\n    const length = arg.value;\r\n\r\n    if (array.length !== length) {\r\n        throw new Error(`the array must have ${length} element(s)`);\r\n    }\r\n}\r\n\r\nfunction checkArray(context: ExprEvaluatorContext, arg: Expr) {\r\n    const value = context.evaluate(arg);\r\n    if (!Array.isArray(value)) {\r\n        throw new Error(`'${value}' is not an array`);\r\n    }\r\n    return value;\r\n}\r\n\r\nconst operators = {\r\n    array: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            switch (call.args.length) {\r\n                case 0:\r\n                    throw new Error(\"not enough arguments\");\r\n                case 1:\r\n                    return checkArray(context, call.args[0]);\r\n                case 2: {\r\n                    const array = checkArray(context, call.args[1]);\r\n                    checkElementTypes(call.args[0], array);\r\n                    return array;\r\n                }\r\n                case 3: {\r\n                    const array = checkArray(context, call.args[2]);\r\n                    checkArrayLength(call.args[1], array);\r\n                    checkElementTypes(call.args[0], array);\r\n                    return array;\r\n                }\r\n                default:\r\n                    throw new Error(\"too many arguments\");\r\n            }\r\n        }\r\n    },\r\n    \"make-array\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            if (call.args.length === 0) {\r\n                throw new Error(\"not enough arguments\");\r\n            }\r\n            return [...call.args.map(arg => context.evaluate(arg))];\r\n        }\r\n    },\r\n    at: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const args = call.args;\r\n            const index = context.evaluate(args[0]);\r\n            if (typeof index !== \"number\") {\r\n                throw new Error(`expected the index of the element to retrieve`);\r\n            }\r\n            const value = context.evaluate(args[1]);\r\n            if (!Array.isArray(value)) {\r\n                throw new Error(`expected an array`);\r\n            }\r\n            return index >= 0 && index < value.length ? value[index] : null;\r\n        }\r\n    },\r\n\r\n    slice: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            if (call.args.length < 2) {\r\n                throw new Error(\"not enough arguments\");\r\n            }\r\n            const input = context.evaluate(call.args[0]);\r\n            if (!(typeof input === \"string\" || Array.isArray(input))) {\r\n                throw new Error(\"input must be a string or an array\");\r\n            }\r\n            const start = context.evaluate(call.args[1]);\r\n            if (typeof start !== \"number\") {\r\n                throw new Error(\"expected an index\");\r\n            }\r\n            let end: number | undefined;\r\n            if (call.args.length > 2) {\r\n                end = context.evaluate(call.args[2]) as any;\r\n                if (typeof end !== \"number\") {\r\n                    throw new Error(\"expected an index\");\r\n                }\r\n            }\r\n            return input.slice(start, end);\r\n        }\r\n    }\r\n};\r\n\r\nexport const ArrayOperators: OperatorDescriptorMap = operators;\r\nexport type ArrayOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { CallExpr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst operators = {\r\n    \"to-boolean\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return Boolean(context.evaluate(call.args[0]));\r\n        }\r\n    },\r\n\r\n    \"to-string\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return String(context.evaluate(call.args[0]));\r\n        }\r\n    },\r\n\r\n    \"to-number\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            for (const arg of call.args) {\r\n                const value = Number(context.evaluate(arg));\r\n                if (!isNaN(value)) {\r\n                    return value;\r\n                }\r\n            }\r\n            throw new Error(\"cannot convert the value to a number\");\r\n        }\r\n    }\r\n};\r\n\r\nexport const CastOperators: OperatorDescriptorMap = operators;\r\nexport type CastOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { ColorUtils } from \"../ColorUtils\";\r\nimport { CallExpr, Value } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\nimport { parseStringEncodedColor } from \"../StringEncodedNumeral\";\r\n\r\nconst operators = {\r\n    alpha: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            let color: Value | undefined = context.evaluate(call.args[0]);\r\n            if (typeof color === \"string\") {\r\n                color = parseStringEncodedColor(color);\r\n            }\r\n            const alpha = typeof color === \"number\" ? ColorUtils.getAlphaFromHex(color) : 1;\r\n            return alpha;\r\n        }\r\n    },\r\n    rgba: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const r = context.evaluate(call.args[0]);\r\n            const g = context.evaluate(call.args[1]);\r\n            const b = context.evaluate(call.args[2]);\r\n            const a = context.evaluate(call.args[3]);\r\n            if (\r\n                typeof r === \"number\" &&\r\n                typeof g === \"number\" &&\r\n                typeof b === \"number\" &&\r\n                typeof a === \"number\" &&\r\n                r >= 0 &&\r\n                g >= 0 &&\r\n                b >= 0 &&\r\n                a >= 0 &&\r\n                a <= 1\r\n            ) {\r\n                return rgbaToHex(r, g, b, a);\r\n            }\r\n            throw new Error(`unknown color 'rgba(${r},${g},${b},${a})'`);\r\n        }\r\n    },\r\n    rgb: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const r = context.evaluate(call.args[0]);\r\n            const g = context.evaluate(call.args[1]);\r\n            const b = context.evaluate(call.args[2]);\r\n            if (\r\n                typeof r === \"number\" &&\r\n                typeof g === \"number\" &&\r\n                typeof b === \"number\" &&\r\n                r >= 0 &&\r\n                g >= 0 &&\r\n                b >= 0\r\n            ) {\r\n                return rgbToHex(r, g, b);\r\n            }\r\n            throw new Error(`unknown color 'rgb(${r},${g},${b})'`);\r\n        }\r\n    },\r\n    // Hsl operator contains angle modulated to <0, 360> range, percent of\r\n    // saturation and lightness in <0, 100> range, i.e. hsl(360, 100, 100)\r\n    hsl: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const h = context.evaluate(call.args[0]);\r\n            const s = context.evaluate(call.args[1]);\r\n            const l = context.evaluate(call.args[2]);\r\n            if (\r\n                typeof h === \"number\" &&\r\n                typeof s === \"number\" &&\r\n                typeof l === \"number\" &&\r\n                h >= 0 &&\r\n                s >= 0 &&\r\n                l >= 0\r\n            ) {\r\n                return hslToHex(h, s, l);\r\n            }\r\n            throw new Error(`unknown color 'hsl(${h},${s}%,${l}%)'`);\r\n        }\r\n    }\r\n};\r\n\r\nfunction rgbaToHex(r: number, g: number, b: number, a: number): number {\r\n    // We decode rgba color channels using custom hex format with transparency.\r\n    return ColorUtils.getHexFromRgba(\r\n        THREE.MathUtils.clamp(r, 0, 255) / 255,\r\n        THREE.MathUtils.clamp(g, 0, 255) / 255,\r\n        THREE.MathUtils.clamp(b, 0, 255) / 255,\r\n        THREE.MathUtils.clamp(a, 0, 1)\r\n    );\r\n}\r\n\r\nfunction rgbToHex(r: number, g: number, b: number): number {\r\n    return ColorUtils.getHexFromRgb(\r\n        THREE.MathUtils.clamp(r, 0, 255) / 255,\r\n        THREE.MathUtils.clamp(g, 0, 255) / 255,\r\n        THREE.MathUtils.clamp(b, 0, 255) / 255\r\n    );\r\n}\r\n\r\nfunction hslToHex(h: number, s: number, l: number): number {\r\n    return ColorUtils.getHexFromHsl(\r\n        THREE.MathUtils.euclideanModulo(h, 360) / 360,\r\n        THREE.MathUtils.clamp(s, 0, 100) / 100,\r\n        THREE.MathUtils.clamp(l, 0, 100) / 100\r\n    );\r\n}\r\n\r\nexport const ColorOperators: OperatorDescriptorMap = operators;\r\nexport type ColorOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { CallExpr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nfunction compare(context: ExprEvaluatorContext, call: CallExpr, strict: boolean = false) {\r\n    const left = context.evaluate(call.args[0]) as any;\r\n    const right = context.evaluate(call.args[1]) as any;\r\n\r\n    if (\r\n        !(\r\n            (typeof left === \"number\" && typeof right === \"number\") ||\r\n            (typeof left === \"string\" && typeof right === \"string\")\r\n        )\r\n    ) {\r\n        if (strict) {\r\n            throw new Error(`invalid operands '${left}' and '${right}' for operator '${call.op}'`);\r\n        }\r\n    }\r\n\r\n    switch (call.op) {\r\n        case \"<\":\r\n            return left < right;\r\n        case \">\":\r\n            return left > right;\r\n        case \"<=\":\r\n            return left <= right;\r\n        case \">=\":\r\n            return left >= right;\r\n        default:\r\n            throw new Error(`invalid comparison operator '${call.op}'`);\r\n    }\r\n}\r\n\r\nconst operators = {\r\n    \"!\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return !context.evaluate(call.args[0]);\r\n        }\r\n    },\r\n\r\n    \"==\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const left = context.evaluate(call.args[0]);\r\n            const right = context.evaluate(call.args[1]);\r\n            return left === right;\r\n        }\r\n    },\r\n\r\n    \"!=\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const left = context.evaluate(call.args[0]);\r\n            const right = context.evaluate(call.args[1]);\r\n            return left !== right;\r\n        }\r\n    },\r\n\r\n    \"<\": { call: (context: ExprEvaluatorContext, call: CallExpr) => compare(context, call) },\r\n    \">\": { call: (context: ExprEvaluatorContext, call: CallExpr) => compare(context, call) },\r\n    \"<=\": { call: (context: ExprEvaluatorContext, call: CallExpr) => compare(context, call) },\r\n    \">=\": { call: (context: ExprEvaluatorContext, call: CallExpr) => compare(context, call) }\r\n};\r\n\r\nexport const ComparisonOperators: OperatorDescriptorMap = operators;\r\nexport type ComparisonOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Env } from \"../Env\";\r\nimport { CallExpr, ExprScope } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst operators = {\r\n    \"geometry-type\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const geometryType = context.env.lookup(\"$geometryType\");\r\n            switch (geometryType) {\r\n                case \"point\":\r\n                    return \"Point\";\r\n                case \"line\":\r\n                    return \"LineString\";\r\n                case \"polygon\":\r\n                    return \"Polygon\";\r\n                default:\r\n                    return null;\r\n            }\r\n        }\r\n    },\r\n    \"feature-state\": {\r\n        isDynamicOperator: () => true,\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            if (context.scope !== ExprScope.Dynamic) {\r\n                throw new Error(\"feature-state cannot be used in this context\");\r\n            }\r\n            const property = context.evaluate(call.args[0]);\r\n            if (typeof property !== \"string\") {\r\n                throw new Error(`expected the name of the property of the feature state`);\r\n            }\r\n            const state = context.env.lookup(\"$state\");\r\n            if (Env.isEnv(state)) {\r\n                return state.lookup(property) ?? null;\r\n            } else if (state instanceof Map) {\r\n                return state.get(property) ?? null;\r\n            }\r\n            return null;\r\n        }\r\n    },\r\n    id: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return context.env.lookup(\"$id\") ?? null;\r\n        }\r\n    }\r\n};\r\n\r\nexport const FeatureOperators: OperatorDescriptorMap = operators;\r\nexport type FeatureOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { CallExpr, Expr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nfunction conditionalCast(context: ExprEvaluatorContext, type: string, args: Expr[]) {\r\n    switch (type) {\r\n        case \"boolean\":\r\n        case \"number\":\r\n        case \"string\":\r\n            for (const childExpr of args) {\r\n                const value = context.evaluate(childExpr);\r\n                if (typeof value === type) {\r\n                    return value;\r\n                }\r\n            }\r\n            throw new Error(`expected a '${type}'`);\r\n        default:\r\n            throw new Error(`invalid type '${type}'`);\r\n    } // switch\r\n}\r\n\r\nconst operators = {\r\n    all: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            for (const childExpr of call.args) {\r\n                if (!context.evaluate(childExpr)) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n    },\r\n\r\n    any: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            for (const childExpr of call.args) {\r\n                if (context.evaluate(childExpr)) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n    },\r\n\r\n    none: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            for (const childExpr of call.args) {\r\n                if (context.evaluate(childExpr)) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n    },\r\n\r\n    boolean: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return conditionalCast(context, \"boolean\", call.args);\r\n        }\r\n    },\r\n\r\n    number: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return conditionalCast(context, \"number\", call.args);\r\n        }\r\n    },\r\n\r\n    string: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return conditionalCast(context, \"string\", call.args);\r\n        }\r\n    }\r\n};\r\n\r\nexport const FlowOperators: OperatorDescriptorMap = operators;\r\nexport type FlowOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { CallExpr, ExprScope, Value } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst operators = {\r\n    \"ppi-scale\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]) as number;\r\n            const scaleFactor = call.args[1] ? (context.evaluate(call.args[1]) as number) : 1;\r\n            return value * scaleFactor;\r\n        }\r\n    },\r\n    \"world-ppi-scale\": {\r\n        isDynamicOperator: (): boolean => {\r\n            return true;\r\n        },\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const pixels = context.evaluate(call.args[0]) as number;\r\n            const scaleFactor = call.args[1] ? (context.evaluate(call.args[1]) as number) : 1;\r\n            const zoom = context.env.lookup(\"$zoom\") as number;\r\n            const zoomWidth = Math.pow(2, 17) / Math.pow(2, zoom);\r\n            const v = pixels * zoomWidth * scaleFactor;\r\n            return v;\r\n        }\r\n    },\r\n    \"world-discrete-ppi-scale\": {\r\n        isDynamicOperator: (): boolean => {\r\n            return true;\r\n        },\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const pixels = context.evaluate(call.args[0]) as number;\r\n            const scaleFactor = call.args[1] ? (context.evaluate(call.args[1]) as number) : 1;\r\n            const zoom = context.env.lookup(\"$zoom\") as number;\r\n            const zoomWidthDiscrete = Math.pow(2, 17) / Math.pow(2, Math.floor(zoom));\r\n            const v = pixels * zoomWidthDiscrete * scaleFactor;\r\n            return v;\r\n        }\r\n    },\r\n    ppi: {\r\n        call: (context: ExprEvaluatorContext) => {\r\n            const ppi = context.env.lookup(\"$ppi\");\r\n            if (typeof ppi === \"number\") {\r\n                return ppi;\r\n            }\r\n            return 72;\r\n        }\r\n    },\r\n    zoom: {\r\n        isDynamicOperator: (): boolean => {\r\n            return true;\r\n        },\r\n        call: (context: ExprEvaluatorContext, call: CallExpr): Value => {\r\n            if (context.scope === ExprScope.Value) {\r\n                return call;\r\n            }\r\n            return context.env.lookup(\"$zoom\") ?? null;\r\n        }\r\n    }\r\n};\r\n\r\nexport const MapOperators: OperatorDescriptorMap = operators;\r\nexport type MapOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { CallExpr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst operators = {\r\n    \"^\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const a = context.evaluate(call.args[0]);\r\n            const b = context.evaluate(call.args[1]);\r\n            if (typeof a !== \"number\" || typeof b !== \"number\") {\r\n                throw new Error(\r\n                    `invalid operands '${typeof a}' and '${typeof b}' for operator '^'`\r\n                );\r\n            }\r\n            return Math.pow(a, b);\r\n        }\r\n    },\r\n\r\n    \"-\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            if (call.args.length === 1) {\r\n                const value = context.evaluate(call.args[0]);\r\n                if (typeof value !== \"number\") {\r\n                    throw new Error(`ìnvalid operand '${typeof value} for operator '-'`);\r\n                }\r\n\r\n                return -value;\r\n            }\r\n\r\n            const a = context.evaluate(call.args[0]);\r\n            const b = context.evaluate(call.args[1]);\r\n            if (typeof a !== \"number\" || typeof b !== \"number\") {\r\n                throw new Error(\r\n                    `invalid operands '${typeof a}' and '${typeof b}' for operator '-'`\r\n                );\r\n            }\r\n            return a - b;\r\n        }\r\n    },\r\n\r\n    \"/\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const a = context.evaluate(call.args[0]);\r\n            const b = context.evaluate(call.args[1]);\r\n            if (typeof a !== \"number\" || typeof b !== \"number\") {\r\n                throw new Error(\r\n                    `invalid operands '${typeof a}' and '${typeof b}' for operator '/'`\r\n                );\r\n            }\r\n            return a / b;\r\n        }\r\n    },\r\n\r\n    \"%\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const a = context.evaluate(call.args[0]);\r\n            const b = context.evaluate(call.args[1]);\r\n            if (typeof a !== \"number\" || typeof b !== \"number\") {\r\n                throw new Error(\r\n                    `invalid operands '${typeof a}' and '${typeof b}' for operator '%'`\r\n                );\r\n            }\r\n            return a % b;\r\n        }\r\n    },\r\n\r\n    \"+\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return call.args.reduce((a, b) => Number(a) + Number(context.evaluate(b)), 0);\r\n        }\r\n    },\r\n\r\n    \"*\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return call.args.reduce((a, b) => Number(a) * Number(context.evaluate(b)), 1);\r\n        }\r\n    },\r\n\r\n    abs: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'abs'`);\r\n            }\r\n            return Math.abs(value);\r\n        }\r\n    },\r\n\r\n    acos: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'acos'`);\r\n            }\r\n            return Math.acos(value);\r\n        }\r\n    },\r\n\r\n    asin: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'asin'`);\r\n            }\r\n            return Math.asin(value);\r\n        }\r\n    },\r\n\r\n    atan: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'atan'`);\r\n            }\r\n            return Math.atan(value);\r\n        }\r\n    },\r\n\r\n    ceil: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'ceil'`);\r\n            }\r\n            return Math.ceil(value);\r\n        }\r\n    },\r\n\r\n    cos: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'cos'`);\r\n            }\r\n            return Math.cos(value);\r\n        }\r\n    },\r\n\r\n    e: {\r\n        call: () => {\r\n            return Math.E;\r\n        }\r\n    },\r\n\r\n    floor: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'floor'`);\r\n            }\r\n            return Math.floor(value);\r\n        }\r\n    },\r\n\r\n    ln: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'ln'`);\r\n            }\r\n            return Math.log(value);\r\n        }\r\n    },\r\n\r\n    ln2: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'ln2'`);\r\n            }\r\n            return Math.log2(value);\r\n        }\r\n    },\r\n\r\n    log10: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'log10'`);\r\n            }\r\n            return Math.log10(value);\r\n        }\r\n    },\r\n\r\n    max: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return Math.max(...call.args.map(v => Number(context.evaluate(v))));\r\n        }\r\n    },\r\n\r\n    min: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return Math.min(...call.args.map(v => Number(context.evaluate(v))));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Clamp numeric value to given range, inclusive.\r\n     *\r\n     * Synopsis:\r\n     * ```\r\n     * [\"clamp\", v: number, min: number, max: number]`\r\n     * ```\r\n     */\r\n    clamp: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const v = context.evaluate(call.args[0]);\r\n            const min = context.evaluate(call.args[1]);\r\n            const max = context.evaluate(call.args[2]);\r\n\r\n            if (typeof v !== \"number\" || typeof min !== \"number\" || typeof max !== \"number\") {\r\n                throw new Error(`invalid operands '${v}', ${min}, ${max} for operator 'clamp'`);\r\n            }\r\n            return THREE.MathUtils.clamp(v, min, max);\r\n        }\r\n    },\r\n\r\n    pi: {\r\n        call: () => {\r\n            return Math.PI;\r\n        }\r\n    },\r\n\r\n    round: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'round'`);\r\n            }\r\n            return Math.round(value);\r\n        }\r\n    },\r\n\r\n    sin: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'sin'`);\r\n            }\r\n            return Math.sin(value);\r\n        }\r\n    },\r\n\r\n    sqrt: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'sqrt'`);\r\n            }\r\n            return Math.sqrt(value);\r\n        }\r\n    },\r\n\r\n    tan: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (typeof value !== \"number\") {\r\n                throw new Error(`invalid operand '${value}' for operator 'tan'`);\r\n            }\r\n            return Math.tan(value);\r\n        }\r\n    }\r\n};\r\n\r\nexport const MathOperators: OperatorDescriptorMap = operators;\r\nexport type MathOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { assert } from \"@here/harp-utils\";\r\n\r\nimport { CallExpr, LookupExpr, ObjectLiteralExpr, Value } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\ninterface KeyValObj {\r\n    [key: string]: Value;\r\n}\r\ninterface LookupEntry {\r\n    keys: KeyValObj;\r\n    attributes: KeyValObj;\r\n}\r\n\r\ntype LookupArray = LookupEntry[];\r\ntype LookupMap = Map<string, KeyValObj>;\r\n\r\nfunction joinKeyValues(keys: string[]): string {\r\n    return keys.join(\"&\");\r\n}\r\n\r\nfunction stringifyKeyValue(key: string, value: Value): string {\r\n    return key + \"=\" + JSON.stringify(value);\r\n}\r\n\r\n/**\r\n * Joins the strings of each given array.\r\n * @param combinations Array of string arrays that must be joined.\r\n * @returns The joined strings sorted from longest to shortest (in number of substrings).\r\n */\r\nfunction joinCombinations(combinations: string[][]): string[] {\r\n    // sort from longest (more specific) to shortest (more generic).\r\n    combinations.sort((lhs, rhs) => rhs.length - lhs.length);\r\n    const result = combinations.map((keys: string[]) => joinKeyValues(keys));\r\n    // Add the empty combination which will match a default table entry (an entry without keys) if\r\n    // it exists.\r\n    result.push(\"\");\r\n    return result;\r\n}\r\n/**\r\n * Gets all combinations of all lengths of a list of strings.\r\n * @param input An array containing all strings.\r\n * @param index Start index of the strings in `input` that will be considered.\r\n * @returns An array of all combinations. The strings within each combination are in the inverse\r\n * order of the input array.\r\n */\r\nfunction getAllCombinations(input: string[], index: number = 0): string[][] {\r\n    if (index >= input.length) {\r\n        return [];\r\n    }\r\n\r\n    const combinations = getAllCombinations(input, index + 1);\r\n\r\n    const initLength = combinations.length;\r\n    for (let i = 0; i < initLength; i += 1) {\r\n        combinations.push([...combinations[i], input[index]]);\r\n    }\r\n    combinations.push([input[index]]);\r\n    return combinations;\r\n}\r\n\r\n/**\r\n * Make all combinations of all lengths with the search keys of the given lookup expression.\r\n * @param lookupExpr The lookup expression.\r\n * @param context The context to evaluate expressions.\r\n * @returns All combinations, sorted from longest(more specific) to shortest (more generic).\r\n */\r\nfunction getKeyCombinations(lookupExpr: LookupExpr, context: ExprEvaluatorContext): string[] {\r\n    const keys = lookupExpr.args.slice(1);\r\n    const result = [];\r\n    for (let i = 0; i < keys.length; i += 2) {\r\n        const value = context.evaluate(keys[i + 1]);\r\n        // ignore keys whose values evaluate to null.\r\n        if (value === null) {\r\n            continue;\r\n        }\r\n        const key = context.evaluate(keys[i]) as string;\r\n        result.push(stringifyKeyValue(key, value));\r\n    }\r\n    // Reverse sort, getAllCombinations reverses the order.\r\n    result.sort().reverse();\r\n\r\n    return joinCombinations(getAllCombinations(result));\r\n}\r\n\r\n/**\r\n * Creates a map from the lookup entries in a given array.\r\n * @param lookupArray The array to transform.\r\n * @returns The resulting map.\r\n */\r\nfunction createLookupMap(lookupArray: LookupArray): LookupMap {\r\n    const map = new Map();\r\n    for (const entry of lookupArray) {\r\n        if (typeof entry !== \"object\") {\r\n            throw new Error(`Invalid lookup table entry type (${typeof entry})`);\r\n        }\r\n        if (!entry.keys) {\r\n            throw new Error(`Lookup table entry has no 'keys' property.`);\r\n        }\r\n        if (!entry.attributes) {\r\n            throw new Error(`Lookup table entry has no 'attributes' property.`);\r\n        }\r\n        const key = joinKeyValues(\r\n            Object.getOwnPropertyNames(entry.keys)\r\n                .sort()\r\n                .map(key => stringifyKeyValue(key, entry.keys[key]))\r\n        );\r\n        map.set(key, entry.attributes);\r\n    }\r\n    return map;\r\n}\r\n\r\n/**\r\n * Searches matches of the given keys in a map.\r\n * @param keys Keys to search in the map.\r\n * @param map The lookup map.\r\n * @returns The first match (in the order in which keys are given) or null if no match found.\r\n */\r\nfunction searchLookupMap(keys: string[], map: LookupMap): KeyValObj | null {\r\n    for (const key of keys) {\r\n        const matchAttributes = map.get(key);\r\n        if (matchAttributes) {\r\n            return matchAttributes;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nconst operators = {\r\n    length: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            if (Array.isArray(value) || typeof value === \"string\") {\r\n                return value.length;\r\n            }\r\n            throw new Error(`invalid operand '${value}' for operator 'length'`);\r\n        }\r\n    },\r\n    coalesce: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            for (const childExpr of call.args) {\r\n                const value = context.evaluate(childExpr);\r\n                if (value !== null) {\r\n                    return value;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    },\r\n    lookup: {\r\n        call: (context: ExprEvaluatorContext, lookup: LookupExpr) => {\r\n            // Argument types are checked on parsing, see LookupExpr.parseArray().\r\n            assert(lookup.args.length > 0, \"missing lookup table\");\r\n\r\n            const keyCombinations = getKeyCombinations(lookup, context);\r\n            let table = context.evaluate(lookup.args[0]) as LookupArray | LookupMap;\r\n            assert(Array.isArray(table) || table instanceof Map, \"wrong lookup table type\");\r\n\r\n            if (Array.isArray(table)) {\r\n                // Transform the lookup table into a map to speedup lookup, since the same table\r\n                // might be used by multiple lookup expressions.\r\n                table = createLookupMap(table);\r\n                const lookupMapExpr = new ObjectLiteralExpr(table);\r\n                // Replace the lookup table argument with the map. Next calls to the same expression\r\n                // (e.g. re-evaluations due to data dependencies) will use the map.\r\n                lookup.args[0] = lookupMapExpr;\r\n            }\r\n\r\n            return searchLookupMap(keyCombinations, table);\r\n        }\r\n    }\r\n};\r\n\r\nexport const MiscOperators: OperatorDescriptorMap = operators;\r\nexport type MiscOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Env } from \"../Env\";\r\nimport { CallExpr, Expr, ExprScope } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\nenum LookupMode {\r\n    get,\r\n    has\r\n}\r\n\r\nfunction lookupMember(context: ExprEvaluatorContext, args: Expr[], lookupMode: LookupMode) {\r\n    const memberName = context.evaluate(args[0]);\r\n\r\n    if (typeof memberName !== \"string\") {\r\n        throw new Error(`expected the name of an attribute`);\r\n    }\r\n\r\n    const object = context.evaluate(args[1]) as any;\r\n\r\n    if (object && typeof object === \"object\") {\r\n        if (Env.isEnv(object)) {\r\n            const value = object.lookup(memberName) ?? null;\r\n            return lookupMode === LookupMode.get ? value : value !== null;\r\n        }\r\n        if (hasOwnProperty.call(object, memberName)) {\r\n            return lookupMode === LookupMode.get ? object[memberName] : true;\r\n        }\r\n    }\r\n\r\n    return lookupMode === LookupMode.get ? null : false;\r\n}\r\n\r\nconst operators = {\r\n    in: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const value = context.evaluate(call.args[0]);\r\n            const object = context.evaluate(call.args[1]);\r\n            if (typeof value === \"string\" && typeof object === \"string\") {\r\n                return object.includes(value);\r\n            } else if (Array.isArray(object)) {\r\n                return object.includes(value);\r\n            }\r\n            return false;\r\n        }\r\n    },\r\n\r\n    get: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) =>\r\n            lookupMember(context, call.args, LookupMode.get)\r\n    },\r\n\r\n    has: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) =>\r\n            lookupMember(context, call.args, LookupMode.has)\r\n    },\r\n\r\n    \"dynamic-properties\": {\r\n        isDynamicOperator: () => true,\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            if (context.scope === ExprScope.Dynamic) {\r\n                return context.env;\r\n            }\r\n            return call;\r\n        }\r\n    }\r\n};\r\n\r\nexport const ObjectOperators: OperatorDescriptorMap = operators;\r\nexport type ObjectOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { CallExpr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst operators = {\r\n    concat: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return \"\".concat(...call.args.map(a => String(context.evaluate(a))));\r\n        }\r\n    },\r\n\r\n    downcase: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return String(context.evaluate(call.args[0])).toLocaleLowerCase();\r\n        }\r\n    },\r\n\r\n    upcase: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return String(context.evaluate(call.args[0])).toLocaleUpperCase();\r\n        }\r\n    },\r\n\r\n    \"~=\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const left = context.evaluate(call.args[0]);\r\n            const right = context.evaluate(call.args[1]);\r\n            if (typeof left === \"string\" && typeof right === \"string\") {\r\n                return left.includes(right);\r\n            }\r\n            return false;\r\n        }\r\n    },\r\n\r\n    \"^=\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const left = context.evaluate(call.args[0]);\r\n            const right = context.evaluate(call.args[1]);\r\n            if (typeof left === \"string\" && typeof right === \"string\") {\r\n                return left.startsWith(right);\r\n            }\r\n            return false;\r\n        }\r\n    },\r\n\r\n    \"$=\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            const left = context.evaluate(call.args[0]);\r\n            const right = context.evaluate(call.args[1]);\r\n            if (typeof left === \"string\" && typeof right === \"string\") {\r\n                return left.endsWith(right);\r\n            }\r\n            return false;\r\n        }\r\n    }\r\n};\r\n\r\nexport const StringOperators: OperatorDescriptorMap = operators;\r\nexport type StringOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { CallExpr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\nconst operators = {\r\n    typeof: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => {\r\n            return typeof context.evaluate(call.args[0]);\r\n        }\r\n    }\r\n};\r\n\r\nexport const TypeOperators: OperatorDescriptorMap = operators;\r\nexport type TypeOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { Value } from \"../Env\";\r\nimport { CallExpr, NumberLiteralExpr } from \"../Expr\";\r\nimport { ExprEvaluatorContext, OperatorDescriptorMap } from \"../ExprEvaluator\";\r\n\r\ntype MakeVectorCallExpr = CallExpr & {\r\n    _value?: THREE.Vector2 | THREE.Vector3 | THREE.Vector4;\r\n};\r\n\r\nfunction isVector(\r\n    context: ExprEvaluatorContext,\r\n    call: CallExpr,\r\n    type: \"vector2\" | \"vector3\" | \"vector4\"\r\n): Value {\r\n    let ctor: new () => object;\r\n    switch (type) {\r\n        case \"vector2\":\r\n            ctor = THREE.Vector2;\r\n            break;\r\n        case \"vector3\":\r\n            ctor = THREE.Vector3;\r\n            break;\r\n        case \"vector4\":\r\n            ctor = THREE.Vector4;\r\n            break;\r\n    }\r\n    for (const childExpr of call.args) {\r\n        const value = context.evaluate(childExpr);\r\n        if (value instanceof ctor) {\r\n            return value;\r\n        }\r\n    }\r\n    throw new Error(`expected a \"${type}\"`);\r\n}\r\n\r\nfunction toVector(\r\n    context: ExprEvaluatorContext,\r\n    call: CallExpr,\r\n    type: \"vector2\" | \"vector3\" | \"vector4\"\r\n): Value {\r\n    let VectorCtor: any;\r\n    let components: number;\r\n\r\n    switch (type) {\r\n        case \"vector2\":\r\n            VectorCtor = THREE.Vector2;\r\n            components = 2;\r\n            break;\r\n        case \"vector3\":\r\n            VectorCtor = THREE.Vector3;\r\n            components = 3;\r\n            break;\r\n        case \"vector4\":\r\n            VectorCtor = THREE.Vector4;\r\n            components = 4;\r\n            break;\r\n    }\r\n\r\n    for (const childExpr of call.args) {\r\n        const value = context.evaluate(childExpr);\r\n        if (value instanceof VectorCtor) {\r\n            return value;\r\n        } else if (\r\n            Array.isArray(value) &&\r\n            value.length === components &&\r\n            value.every(v => typeof v === \"number\")\r\n        ) {\r\n            return new VectorCtor().fromArray(value);\r\n        }\r\n    }\r\n    throw new Error(`expected a \"${type}\"`);\r\n}\r\n\r\nconst operators = {\r\n    \"make-vector\": {\r\n        call: (context: ExprEvaluatorContext, call: MakeVectorCallExpr) => {\r\n            if (call._value !== undefined) {\r\n                return call._value;\r\n            }\r\n\r\n            if (call.args.length < 2) {\r\n                throw new Error(\"not enough arguments\");\r\n            } else if (call.args.length > 4) {\r\n                throw new Error(\"too many arguments\");\r\n            }\r\n\r\n            const components = call.args.map(arg => context.evaluate(arg)) as number[];\r\n\r\n            components.forEach((element, index) => {\r\n                if (typeof element !== \"number\") {\r\n                    throw new Error(\r\n                        `expected vector component at index ${index} to have type \"number\"`\r\n                    );\r\n                }\r\n            });\r\n\r\n            let result: THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | undefined;\r\n\r\n            switch (components.length) {\r\n                case 2:\r\n                    result = new THREE.Vector2().fromArray(components);\r\n                    break;\r\n                case 3:\r\n                    result = new THREE.Vector3().fromArray(components);\r\n                    break;\r\n                case 4:\r\n                    result = new THREE.Vector4().fromArray(components);\r\n                    break;\r\n                default:\r\n                    throw new Error(\"too many arguments\");\r\n            }\r\n\r\n            if (call.args.every(arg => arg instanceof NumberLiteralExpr)) {\r\n                call._value = result;\r\n            }\r\n\r\n            return result;\r\n        }\r\n    },\r\n    vector2: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => isVector(context, call, \"vector2\")\r\n    },\r\n    vector3: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => isVector(context, call, \"vector3\")\r\n    },\r\n    vector4: {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => isVector(context, call, \"vector4\")\r\n    },\r\n    \"to-vector2\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => toVector(context, call, \"vector2\")\r\n    },\r\n    \"to-vector3\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => toVector(context, call, \"vector3\")\r\n    },\r\n    \"to-vector4\": {\r\n        call: (context: ExprEvaluatorContext, call: CallExpr) => toVector(context, call, \"vector4\")\r\n    }\r\n};\r\n\r\nexport const VectorOperators: OperatorDescriptorMap = operators;\r\nexport type VectorOperatorNames = keyof typeof operators;\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { EarthConstants, GeoCoordinates, webMercatorProjection } from \"@here/harp-geoutils\";\r\nimport { Math2D } from \"@here/harp-utils\";\r\nimport { Vector2, Vector3 } from \"three\";\r\n\r\n/**\r\n * A clipping edge.\r\n *\r\n * @remarks\r\n * Clip lines using the Sutherland-Hodgman algorithm.\r\n *\r\n * @internal\r\n */\r\nclass ClipEdge {\r\n    readonly p0: Vector2;\r\n    readonly p1: Vector2;\r\n\r\n    /**\r\n     * Creates a clipping edge.\r\n     *\r\n     * @param x1 - The x coordinate of the first point of this ClipEdge.\r\n     * @param y1 - The y coordinate of the first point of this ClipEdge.\r\n     * @param x2 - The x coordinate of the second point of this ClipEdge.\r\n     * @param y2 - The y coordinate of the second point of this ClipEdge.\r\n     * @param isInside - The function used to test points against this ClipEdge.\r\n     */\r\n    constructor(\r\n        x1: number,\r\n        y1: number,\r\n        x2: number,\r\n        y2: number,\r\n        private readonly isInside: (p: Vector2) => boolean\r\n    ) {\r\n        this.p0 = new Vector2(x1, y1);\r\n        this.p1 = new Vector2(x2, y2);\r\n    }\r\n\r\n    /**\r\n     * Tests if the given point is inside this clipping edge.\r\n     */\r\n    inside(point: Vector2): boolean {\r\n        return this.isInside(point);\r\n    }\r\n\r\n    /**\r\n     * Computes the intersection of a line and this clipping edge.\r\n     *\r\n     * @remarks\r\n     * {@link https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection\r\n     *    | line-line intersection}.\r\n     */\r\n    computeIntersection(a: Vector2, b: Vector2): Vector2 {\r\n        const result = new Vector2();\r\n        Math2D.intersectLines(\r\n            a.x,\r\n            a.y,\r\n            b.x,\r\n            b.y,\r\n            this.p0.x,\r\n            this.p0.y,\r\n            this.p1.x,\r\n            this.p1.y,\r\n            result\r\n        );\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Clip the input line against this edge.\r\n     */\r\n    clipLine(lineString: Vector2[]): Vector2[][] {\r\n        const inputList = lineString;\r\n\r\n        const result: Vector2[][] = [];\r\n\r\n        lineString = [];\r\n        result.push(lineString);\r\n\r\n        const pushPoint = (point: Vector2) => {\r\n            if (lineString.length === 0 || !lineString[lineString.length - 1].equals(point)) {\r\n                lineString.push(point);\r\n            }\r\n        };\r\n\r\n        for (let i = 0; i < inputList.length; ++i) {\r\n            const currentPoint = inputList[i];\r\n            const prevPoint = i > 0 ? inputList[i - 1] : undefined;\r\n\r\n            if (this.inside(currentPoint)) {\r\n                if (prevPoint !== undefined && !this.inside(prevPoint)) {\r\n                    if (lineString.length > 0) {\r\n                        lineString = [];\r\n                        result.push(lineString);\r\n                    }\r\n                    pushPoint(this.computeIntersection(prevPoint, currentPoint));\r\n                }\r\n                pushPoint(currentPoint);\r\n            } else if (prevPoint !== undefined && this.inside(prevPoint)) {\r\n                pushPoint(this.computeIntersection(prevPoint, currentPoint));\r\n            }\r\n        }\r\n\r\n        if (result[result.length - 1].length === 0) {\r\n            result.length = result.length - 1;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Clip the input lines against this edge.\r\n     */\r\n    clipLines(lineStrings: Vector2[][]) {\r\n        const reuslt: Vector2[][] = [];\r\n        lineStrings.forEach(lineString => {\r\n            this.clipLine(lineString).forEach(clippedLine => {\r\n                reuslt.push(clippedLine);\r\n            });\r\n        });\r\n        return reuslt;\r\n    }\r\n}\r\n\r\n/**\r\n * Clip the input line against the given bounds.\r\n *\r\n * @param lineString - The line to clip.\r\n * @param minX - The minimum x coordinate.\r\n * @param minY - The minimum y coordinate.\r\n * @param maxX - The maxumum x coordinate.\r\n * @param maxY - The maxumum y coordinate.\r\n */\r\nexport function clipLineString(\r\n    lineString: Vector2[],\r\n    minX: number,\r\n    minY: number,\r\n    maxX: number,\r\n    maxY: number\r\n): Vector2[][] {\r\n    const clipEdge0 = new ClipEdge(minX, minY, minX, maxY, p => p.x > minX); // left\r\n    const clipEdge1 = new ClipEdge(minX, maxY, maxX, maxY, p => p.y < maxY); // bottom\r\n    const clipEdge2 = new ClipEdge(maxX, maxY, maxX, minY, p => p.x < maxX); // right\r\n    const clipEdge3 = new ClipEdge(maxX, minY, minX, minY, p => p.y > minY); // top\r\n\r\n    let lines = clipEdge0.clipLine(lineString);\r\n    lines = clipEdge1.clipLines(lines);\r\n    lines = clipEdge2.clipLines(lines);\r\n    lines = clipEdge3.clipLines(lines);\r\n\r\n    return lines;\r\n}\r\n\r\n/**\r\n * The result of wrapping a line string.\r\n */\r\ninterface WrappedLineString {\r\n    left: GeoCoordinates[][];\r\n    middle: GeoCoordinates[][];\r\n    right: GeoCoordinates[][];\r\n}\r\n\r\n/**\r\n * Helper function to wrap a line string projected in web mercator.\r\n *\r\n * @param multiLineString The input to wrap\r\n * @param edges The clipping edges used to wrap the input.\r\n * @param offset The x-offset used to displace the result\r\n *\r\n * @internal\r\n */\r\nfunction wrapMultiLineStringHelper(\r\n    multiLineString: Vector2[][],\r\n    edges: ClipEdge[],\r\n    offset: number\r\n): GeoCoordinates[][] | undefined {\r\n    for (const clip of edges) {\r\n        multiLineString = clip.clipLines(multiLineString);\r\n    }\r\n\r\n    const worldP = new Vector3();\r\n\r\n    const coordinates: GeoCoordinates[][] = [];\r\n\r\n    multiLineString.forEach(lineString => {\r\n        if (lineString.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const coords = lineString.map(({ x, y }) => {\r\n            worldP.set(x, y, 0);\r\n            const geoPoint = webMercatorProjection.unprojectPoint(worldP);\r\n            geoPoint.longitude += offset;\r\n            return geoPoint;\r\n        });\r\n\r\n        coordinates.push(coords);\r\n    });\r\n\r\n    return coordinates.length > 0 ? coordinates : undefined;\r\n}\r\n\r\n/**\r\n * Wrap the given line string.\r\n *\r\n * @remarks\r\n * This function splits this input line string in three parts.\r\n *\r\n * The `left` member of the result contains the part of the line string with longitude less than `-180`.\r\n *\r\n * The `middle` member contains the part of the line string with longitude in the range `[-180, 180]`.\r\n *\r\n * The `right` member contains the part of the line string with longitude greater than `180`.\r\n *\r\n * @param coordinates The coordinates of the line string to wrap.\r\n */\r\nexport function wrapLineString(coordinates: GeoCoordinates[]): Partial<WrappedLineString> {\r\n    const worldP = new Vector3();\r\n\r\n    const lineString = coordinates.map(g => {\r\n        const { x, y } = webMercatorProjection.projectPoint(g, worldP);\r\n        return new Vector2(x, y);\r\n    });\r\n\r\n    const multiLineString = [lineString];\r\n\r\n    return {\r\n        left: wrapMultiLineStringHelper(multiLineString, WRAP_LEFT_CLIP_EDGES, 360),\r\n        middle: wrapMultiLineStringHelper(multiLineString, WRAP_MIDDLE_CLIP_EDGES, 0),\r\n        right: wrapMultiLineStringHelper(multiLineString, WRAP_RIGHT_CLIP_EDGES, -360)\r\n    };\r\n}\r\n\r\nconst ec = EarthConstants.EQUATORIAL_CIRCUMFERENCE;\r\nconst border = 0;\r\n\r\nconst WRAP_MIDDLE_CLIP_EDGES = [\r\n    new ClipEdge(0 - border, ec, 0 - border, 0, p => p.x > 0 - border),\r\n    new ClipEdge(ec + border, 0, ec + border, ec, p => p.x < ec + border)\r\n];\r\n\r\nconst WRAP_LEFT_CLIP_EDGES = [\r\n    new ClipEdge(-ec - border, ec, -ec - border, 0, p => p.x > -ec - border),\r\n    new ClipEdge(0 + border, 0, 0 + border, ec, p => p.x < 0 + border)\r\n];\r\n\r\nconst WRAP_RIGHT_CLIP_EDGES = [\r\n    new ClipEdge(ec - border, ec, ec - border, 0, p => p.x > ec - border),\r\n    new ClipEdge(ec * 2 + border, 0, ec * 2 + border, ec, p => p.x < ec * 2 + border)\r\n];\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Vector2 } from \"three\";\r\n\r\ninterface ClipInfo {\r\n    /**\r\n     * `true` if this vertex was clipped.\r\n     */\r\n    isClipped?: boolean;\r\n}\r\n\r\nexport type ClippedVertex = Vector2 & ClipInfo;\r\n\r\n/**\r\n * Abstract helper class used to implement the Sutherland-Hodgman clipping algorithm.\r\n *\r\n * @remarks\r\n * Concrete implementation of this class are used to clip a polygon\r\n * against one edge of a bounding box.\r\n *\r\n * @internal\r\n */\r\nexport abstract class ClippingEdge {\r\n    /**\r\n     * Tests if the given point is inside this clipping edge.\r\n     *\r\n     * @param point A point of the polygon.\r\n     * @param extent The extent of the bounding box.\r\n     */\r\n    abstract inside(point: Vector2, extent: number): boolean;\r\n\r\n    /**\r\n     * Computes the intersection of a line and this clipping edge.\r\n     *\r\n     * @remarks\r\n     * Specialization of {@link https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection\r\n     *    | line-line intersection}.\r\n     *\r\n     * @param a A point of the segment to clip.\r\n     * @param b A point of the segment to clip.\r\n     * @param extent The extent of the bounding box.\r\n     */\r\n    abstract computeIntersection(a: Vector2, b: Vector2, extent: number): ClippedVertex;\r\n\r\n    /**\r\n     * Clip the polygon against this clipping edge.\r\n     *\r\n     * @param polygon Clip the polygon against this edge.\r\n     * @param extent The extent of the bounding box.\r\n     *\r\n     * @return The clipped polygon.\r\n     */\r\n    clipPolygon(polygon: Vector2[], extent: number): Vector2[] {\r\n        const inputList = polygon;\r\n\r\n        polygon = [];\r\n\r\n        const pushPoint = (point: ClippedVertex) => {\r\n            const lastAddedPoint: ClippedVertex = polygon[polygon.length - 1];\r\n\r\n            if (\r\n                !lastAddedPoint?.equals(point) ||\r\n                (point.isClipped === true && !lastAddedPoint?.isClipped) ||\r\n                (!point.isClipped && lastAddedPoint?.isClipped === true)\r\n            ) {\r\n                polygon.push(point);\r\n            }\r\n        };\r\n\r\n        for (let i = 0; i < inputList.length; ++i) {\r\n            const currentPoint = inputList[i];\r\n            const prevPoint = inputList[(i + inputList.length - 1) % inputList.length];\r\n            if (this.inside(currentPoint, extent)) {\r\n                if (!this.inside(prevPoint, extent)) {\r\n                    const p = this.computeIntersection(prevPoint, currentPoint, extent);\r\n                    p.isClipped = true;\r\n                    pushPoint(p);\r\n                }\r\n                pushPoint(currentPoint);\r\n            } else if (this.inside(prevPoint, extent)) {\r\n                const p = this.computeIntersection(prevPoint, currentPoint, extent);\r\n                p.isClipped = true;\r\n                pushPoint(p);\r\n            }\r\n        }\r\n\r\n        return polygon;\r\n    }\r\n}\r\n\r\nclass TopClippingEdge extends ClippingEdge {\r\n    /** @override */\r\n    inside(point: Vector2): boolean {\r\n        return point.y >= 0;\r\n    }\r\n\r\n    /**\r\n     * Computes the intersection of a line and this clipping edge.\r\n     *\r\n     * @remarks\r\n     * Find the intersection point between the line defined by the points `a` and `b`\r\n     * and the edge defined by the points `(0, 0)` and `(0, extent)`.\r\n     *\r\n     * @override\r\n     *\r\n     */\r\n    computeIntersection(a: Vector2, b: Vector2): Vector2 {\r\n        const { x: x1, y: y1 } = a;\r\n        const { x: x2, y: y2 } = b;\r\n        const v: Vector2 = new Vector2((x1 * y2 - y1 * x2) / -(y1 - y2), 0).round();\r\n        return v;\r\n    }\r\n}\r\n\r\nclass RightClippingEdge extends ClippingEdge {\r\n    /**\r\n     * @override\r\n     *\r\n     * See: HARP-14633, this should potentially be changed to < as it was previously.\r\n     * However further investigation is needed to confirm this.\r\n     */\r\n    inside(point: Vector2, extent: number): boolean {\r\n        return point.x <= extent;\r\n    }\r\n\r\n    /**\r\n     * Computes the intersection of a line and this clipping edge.\r\n     *\r\n     * @remarks\r\n     * Find the intersection point between the line defined by the points `a` and `b`\r\n     * and the edge defined by the points `(extent, 0)` and `(extent, extent)`.\r\n     *\r\n     * @override\r\n     *\r\n     */\r\n    computeIntersection(a: Vector2, b: Vector2, extent: number): Vector2 {\r\n        const { x: x1, y: y1 } = a;\r\n        const { x: x2, y: y2 } = b;\r\n        const v: Vector2 = new Vector2(\r\n            extent,\r\n            (x1 * y2 - y1 * x2 - (y1 - y2) * -extent) / (x1 - x2)\r\n        ).round();\r\n        return v;\r\n    }\r\n}\r\n\r\nclass BottomClipEdge extends ClippingEdge {\r\n    /** @override */\r\n    inside(point: Vector2, extent: number): boolean {\r\n        return point.y <= extent;\r\n    }\r\n\r\n    /**\r\n     * Computes the intersection of a line and this clipping edge.\r\n     *\r\n     * @remarks\r\n     * Find the intersection point between the line defined by the points `a` and `b`\r\n     * and the edge defined by the points `(extent, extent)` and `(0, extent)`.\r\n     *\r\n     * @override\r\n     *\r\n     */\r\n    computeIntersection(a: Vector2, b: Vector2, extent: number): Vector2 {\r\n        const { x: x1, y: y1 } = a;\r\n        const { x: x2, y: y2 } = b;\r\n        const v: Vector2 = new Vector2(\r\n            (x1 * y2 - y1 * x2 - (x1 - x2) * extent) / -(y1 - y2),\r\n            extent\r\n        ).round();\r\n        return v;\r\n    }\r\n}\r\n\r\nclass LeftClippingEdge extends ClippingEdge {\r\n    /** @override */\r\n    inside(point: Vector2) {\r\n        return point.x >= 0;\r\n    }\r\n\r\n    /**\r\n     * Computes the intersection of a line and this clipping edge.\r\n     *\r\n     * @remarks\r\n     * Find the intersection point between the line defined by the points `a` and `b`\r\n     * and the edge defined by the points `(0, extent)` and `(0, 0)`.\r\n     *\r\n     * @override\r\n     *\r\n     */\r\n    computeIntersection(a: Vector2, b: Vector2): Vector2 {\r\n        const { x: x1, y: y1 } = a;\r\n        const { x: x2, y: y2 } = b;\r\n        const v: Vector2 = new Vector2(0, (x1 * y2 - y1 * x2) / (x1 - x2)).round();\r\n        return v;\r\n    }\r\n}\r\n\r\nconst clipEdges = [\r\n    new TopClippingEdge(),\r\n    new RightClippingEdge(),\r\n    new BottomClipEdge(),\r\n    new LeftClippingEdge()\r\n];\r\n\r\n/**\r\n * Clip the given polygon against a rectangle using the Sutherland-Hodgman algorithm.\r\n *\r\n * @remarks\r\n * The coordinates of the polygon must be integer numbers.\r\n *\r\n * @param polygon The vertices of the polygon to clip.\r\n * @param extent The extents of the rectangle to clip against.\r\n */\r\nexport function clipPolygon(polygon: Vector2[], extent: number): Vector2[] {\r\n    if (polygon.length === 0) {\r\n        return polygon;\r\n    }\r\n\r\n    if (!polygon[0].equals(polygon[polygon.length - 1])) {\r\n        // close the polygon if needed.\r\n        polygon = [...polygon, polygon[0]];\r\n    }\r\n\r\n    for (const clip of clipEdges) {\r\n        polygon = clip.clipPolygon(polygon, extent);\r\n    }\r\n\r\n    if (polygon.length < 3) {\r\n        return [];\r\n    }\r\n\r\n    return polygon;\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Box3Like, GeoBox, Projection, ProjectionType } from \"@here/harp-geoutils\";\r\nimport { assert } from \"@here/harp-utils\";\r\nimport { Vector3 } from \"three\";\r\n\r\nimport { SubdivisionModifier } from \"./SubdivisionModifier\";\r\n\r\nconst VERTEX_POSITION_CACHE = [new Vector3(), new Vector3()];\r\n\r\nexport enum SubdivisionMode {\r\n    /**\r\n     * Subdivide all edges\r\n     */\r\n    All,\r\n    /**\r\n     * Only subdivide horizontal and vertical edges\r\n     */\r\n    NoDiagonals\r\n}\r\n\r\n/**\r\n * The [[EdgeLengthGeometrySubdivisionModifier]] subdivides triangle mesh depending on\r\n * length of edges.\r\n */\r\nexport class EdgeLengthGeometrySubdivisionModifier extends SubdivisionModifier {\r\n    private readonly m_projectedBox: Box3Like;\r\n    private readonly m_maxLength: number;\r\n    private readonly m_maxLengthX: number;\r\n    private readonly m_maxLengthY: number;\r\n\r\n    /**\r\n     * Constructs a new [[EdgeLengthGeometrySubdivisionModifier]].\r\n     *\r\n     * @param subdivision - The subdivision factor\r\n     * @param geoBox - The geo bounding box of a tile\r\n     * @param subdivisionMode - Configures what edges to divide\r\n     * @param projection - The projection that defines the world space of this geometry.\r\n     */\r\n    constructor(\r\n        readonly subdivision: number,\r\n        readonly geoBox: GeoBox,\r\n        readonly subdivisionMode: SubdivisionMode = SubdivisionMode.All,\r\n        readonly projection: Projection\r\n    ) {\r\n        super();\r\n\r\n        assert(\r\n            projection.type === ProjectionType.Planar,\r\n            \"EdgeLengthGeometrySubdivisionModifier only supports planar projections\"\r\n        );\r\n\r\n        const northEast = projection.projectPoint(geoBox.northEast, VERTEX_POSITION_CACHE[0]);\r\n        const southWest = projection.projectPoint(geoBox.southWest, VERTEX_POSITION_CACHE[1]);\r\n        this.m_projectedBox = {\r\n            min: {\r\n                x: Math.min(northEast.x, southWest.x),\r\n                y: Math.min(northEast.y, southWest.y),\r\n                z: Math.min(northEast.z, southWest.z)\r\n            },\r\n            max: {\r\n                x: Math.max(northEast.x, southWest.x),\r\n                y: Math.max(northEast.y, southWest.y),\r\n                z: Math.max(northEast.z, southWest.z)\r\n            }\r\n        };\r\n        this.m_maxLengthX = (this.m_projectedBox.max.x - this.m_projectedBox.min.x) / subdivision;\r\n        this.m_maxLengthY = (this.m_projectedBox.max.y - this.m_projectedBox.min.y) / subdivision;\r\n\r\n        // Increase max length slightly to account for precision errors\r\n        if (this.subdivisionMode === SubdivisionMode.All) {\r\n            this.m_maxLengthX *= 1.1;\r\n            this.m_maxLengthY *= 1.1;\r\n        }\r\n        this.m_maxLength = Math.sqrt(\r\n            this.m_maxLengthX * this.m_maxLengthX + this.m_maxLengthY * this.m_maxLengthY\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Return upper bound for length of diagonal edges\r\n     */\r\n    get maxLength() {\r\n        return this.m_maxLength;\r\n    }\r\n\r\n    /**\r\n     * Return upper bound for edge length in x direction\r\n     */\r\n    get maxLengthX() {\r\n        return this.m_maxLengthX;\r\n    }\r\n\r\n    /**\r\n     * Return upper bound for edge length in y direction\r\n     */\r\n    get maxLengthY() {\r\n        return this.m_maxLengthY;\r\n    }\r\n\r\n    /** @override */\r\n    protected shouldSplitTriangle(a: Vector3, b: Vector3, c: Vector3): number | undefined {\r\n        const shouldSplitAB = this.shouldSplitEdge(a, b);\r\n        const shouldSplitBC = this.shouldSplitEdge(b, c);\r\n        const shouldSplitCA = this.shouldSplitEdge(c, a);\r\n        const shouldSplit = shouldSplitAB || shouldSplitBC || shouldSplitCA;\r\n\r\n        if (!shouldSplit) {\r\n            return;\r\n        }\r\n\r\n        const ab = a.distanceTo(b);\r\n        const bc = b.distanceTo(c);\r\n        const ca = c.distanceTo(a);\r\n        const maxDistance = Math.max(\r\n            shouldSplitAB ? ab : 0,\r\n            shouldSplitBC ? bc : 0,\r\n            shouldSplitCA ? ca : 0\r\n        );\r\n        if (ab === maxDistance) {\r\n            return 0;\r\n        } else if (bc === maxDistance) {\r\n            return 1;\r\n        } else if (ca === maxDistance) {\r\n            return 2;\r\n        }\r\n\r\n        throw new Error(\"Could not split triangle.\");\r\n    }\r\n\r\n    private shouldSplitEdge(a: Vector3, b: Vector3): boolean {\r\n        switch (this.subdivisionMode) {\r\n            case SubdivisionMode.All:\r\n                return (\r\n                    (a.y === b.y && Math.abs(a.x - b.x) > this.m_maxLengthX) ||\r\n                    (a.x === b.x && Math.abs(a.y - b.y) > this.m_maxLengthY) ||\r\n                    a.distanceTo(b) > this.m_maxLength\r\n                );\r\n            case SubdivisionMode.NoDiagonals:\r\n                return (\r\n                    (a.y === b.y && Math.abs(a.x - b.x) > this.m_maxLengthX) ||\r\n                    (a.x === b.x && Math.abs(a.y - b.y) > this.m_maxLengthY)\r\n                );\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Projection, sphereProjection } from \"@here/harp-geoutils\";\r\nimport { Vector3 } from \"three\";\r\n\r\nimport { SubdivisionModifier } from \"./SubdivisionModifier\";\r\n\r\nconst VERTEX_POSITION_CACHE = [new Vector3(), new Vector3(), new Vector3()];\r\n\r\n/**\r\n * The [[SphericalGeometrySubdivisionModifier]] subdivides triangle mesh geometries positioned\r\n * on the surface of a sphere centered at `(0, 0, 0)`.\r\n */\r\nexport class SphericalGeometrySubdivisionModifier extends SubdivisionModifier {\r\n    /**\r\n     * Constructs a new [[SphericalGeometrySubdivisionModifier]].\r\n     *\r\n     * @param angle - The maximum angle in radians between two vertices and the origin.\r\n     * @param projection - The projection that defines the world space of this geometry.\r\n     */\r\n    constructor(readonly angle: number, readonly projection: Projection = sphereProjection) {\r\n        super();\r\n    }\r\n\r\n    /** @override */\r\n    protected shouldSplitTriangle(a: Vector3, b: Vector3, c: Vector3): number | undefined {\r\n        const aa = sphereProjection.reprojectPoint(this.projection, a, VERTEX_POSITION_CACHE[0]);\r\n        const bb = sphereProjection.reprojectPoint(this.projection, b, VERTEX_POSITION_CACHE[1]);\r\n        const cc = sphereProjection.reprojectPoint(this.projection, c, VERTEX_POSITION_CACHE[2]);\r\n\r\n        const alpha = aa.angleTo(bb);\r\n        const beta = bb.angleTo(cc);\r\n        const gamma = cc.angleTo(aa);\r\n\r\n        // find the maximum angle\r\n        const m = Math.max(alpha, Math.max(beta, gamma));\r\n\r\n        // split the triangle if needed.\r\n        if (m < this.angle) {\r\n            return undefined;\r\n        }\r\n\r\n        if (m === alpha) {\r\n            return 0;\r\n        } else if (m === beta) {\r\n            return 1;\r\n        } else if (m === gamma) {\r\n            return 2;\r\n        }\r\n\r\n        throw new Error(\"failed to split triangle\");\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { BufferAttribute, BufferGeometry, Vector3 } from \"three\";\r\n\r\nconst tmpVectorA = new Vector3();\r\nconst tmpVectorB = new Vector3();\r\nconst tmpVectorC = new Vector3();\r\n\r\n/**\r\n * The [[SubdivisionModifier]] subdivides triangle mesh geometries.\r\n */\r\nexport abstract class SubdivisionModifier {\r\n    /**\r\n     * Constructs a new [[SubdivisionModifier]].\r\n     */\r\n    constructor() {\r\n        // nothing to do\r\n    }\r\n\r\n    /**\r\n     * Subdivides the faces of the given [[THREE.BufferGeometry]].\r\n     *\r\n     * This method modifies (in-place) the vertices and the faces of the geometry.\r\n     * Please note that only the vertex position and their UV coordinates are subdivided.\r\n     * Normals, vertex colors and other attributes are left unmodified.\r\n     *\r\n     * @param geometry - The [[THREE.BufferGeometry]] to subdivide.\r\n     */\r\n    modify(geometry: BufferGeometry): BufferGeometry {\r\n        const positionAttr = geometry.getAttribute(\"position\") as BufferAttribute;\r\n        const position = Array.from(positionAttr.array);\r\n\r\n        const uvAttr = geometry.getAttribute(\"uv\") as BufferAttribute;\r\n        const uv = uvAttr !== undefined ? Array.from(uvAttr.array) : undefined;\r\n\r\n        const edgeAttr = geometry.getAttribute(\"edge\") as BufferAttribute;\r\n        const edge = edgeAttr !== undefined ? Array.from(edgeAttr.array) : undefined;\r\n\r\n        const wallAttr = geometry.getAttribute(\"wall\") as BufferAttribute;\r\n        const wall = wallAttr !== undefined ? Array.from(wallAttr.array) : undefined;\r\n\r\n        const indexAttr = geometry.getIndex() as BufferAttribute;\r\n        const indices = Array.from(indexAttr.array);\r\n\r\n        // A cache containing the indices of the vertices added\r\n        // when subdiving the faces of the geometry.\r\n        const cache = new Map<string, number>();\r\n\r\n        /**\r\n         * Returns the index of the vertex positioned in the middle of the given vertices.\r\n         */\r\n        function middleVertex(i: number, j: number): number {\r\n            // Build a unique `key` for the pair of indices `(i, j)`.\r\n            const key = `${Math.min(i, j)}_${Math.max(i, j)}`;\r\n\r\n            const h = cache.get(key);\r\n\r\n            if (h !== undefined) {\r\n                // Nothing to do, a vertex in the middle of (i, j) was already created.\r\n                return h;\r\n            }\r\n\r\n            // The position of the new vertex.\r\n            tmpVectorA.set(position[i * 3], position[i * 3 + 1], position[i * 3 + 2]);\r\n            tmpVectorB.set(position[j * 3], position[j * 3 + 1], position[j * 3 + 2]);\r\n            tmpVectorC.lerpVectors(tmpVectorA, tmpVectorB, 0.5);\r\n\r\n            // The index of the new vertex.\r\n            const index = position.length / 3;\r\n            position.push(...tmpVectorC.toArray());\r\n            // Cache the position of the new vertex.\r\n            cache.set(key, index);\r\n\r\n            // The uvs of the new vertex.\r\n            if (uv !== undefined) {\r\n                tmpVectorA.set(uv[i * 2], uv[i * 2 + 1], 0);\r\n                tmpVectorB.set(uv[j * 2], uv[j * 2 + 1], 0);\r\n                tmpVectorC.lerpVectors(tmpVectorA, tmpVectorB, 0.5);\r\n                uv.push(tmpVectorC.x, tmpVectorC.y);\r\n            }\r\n\r\n            // The edge and wall attributes of the new vertex.\r\n            // If a new vertex has been introduced between i and j, connect the elements\r\n            // accordingly.\r\n            if (edge !== undefined) {\r\n                if (edge[i] === j) {\r\n                    edge.push(j);\r\n                    edge[i] = index;\r\n                } else if (edge[j] === i) {\r\n                    edge.push(i);\r\n                    edge[j] = index;\r\n                } else {\r\n                    edge.push(-1);\r\n                }\r\n            }\r\n            if (wall !== undefined) {\r\n                if (wall[i] === j) {\r\n                    wall.push(j);\r\n                    wall[i] = index;\r\n                } else if (wall[j] === i) {\r\n                    wall.push(i);\r\n                    wall[j] = index;\r\n                } else {\r\n                    wall.push(-1);\r\n                }\r\n            }\r\n\r\n            return index;\r\n        }\r\n\r\n        const newIndices = [];\r\n        while (indices.length >= 3) {\r\n            const v0 = indices.shift()!;\r\n            const v1 = indices.shift()!;\r\n            const v2 = indices.shift()!;\r\n\r\n            tmpVectorA.set(position[v0 * 3], position[v0 * 3 + 1], position[v0 * 3 + 2]);\r\n            tmpVectorB.set(position[v1 * 3], position[v1 * 3 + 1], position[v1 * 3 + 2]);\r\n            tmpVectorC.set(position[v2 * 3], position[v2 * 3 + 1], position[v2 * 3 + 2]);\r\n\r\n            const edgeToSplit = this.shouldSplitTriangle(tmpVectorA, tmpVectorB, tmpVectorC);\r\n\r\n            switch (edgeToSplit) {\r\n                case 0: {\r\n                    const v3 = middleVertex(v0, v1);\r\n                    indices.push(v0, v3, v2, v3, v1, v2);\r\n                    break;\r\n                }\r\n\r\n                case 1: {\r\n                    const v3 = middleVertex(v1, v2);\r\n                    indices.push(v0, v1, v3, v0, v3, v2);\r\n                    break;\r\n                }\r\n\r\n                case 2: {\r\n                    const v3 = middleVertex(v2, v0);\r\n                    indices.push(v0, v1, v3, v3, v1, v2);\r\n                    break;\r\n                }\r\n\r\n                case undefined: {\r\n                    newIndices.push(v0, v1, v2);\r\n                    break;\r\n                }\r\n\r\n                default:\r\n                    throw new Error(\"failed to subdivide the given geometry\");\r\n            }\r\n        }\r\n\r\n        positionAttr.array =\r\n            positionAttr.array instanceof Float32Array\r\n                ? new Float32Array(position)\r\n                : new Float64Array(position);\r\n        positionAttr.count = position.length / positionAttr.itemSize;\r\n        positionAttr.needsUpdate = true;\r\n\r\n        geometry.setIndex(newIndices);\r\n\r\n        if (uv !== undefined) {\r\n            uvAttr.array = new Float32Array(uv);\r\n            uvAttr.count = uv.length / uvAttr.itemSize;\r\n            uvAttr.needsUpdate = true;\r\n        }\r\n\r\n        if (edge !== undefined) {\r\n            edgeAttr.array = new Float32Array(edge);\r\n            edgeAttr.count = edge.length / edgeAttr.itemSize;\r\n            edgeAttr.needsUpdate = true;\r\n        }\r\n\r\n        return geometry;\r\n    }\r\n\r\n    /**\r\n     * Returns if the given triangle should be subdivide.\r\n     *\r\n     * Implementations of this function should return the index of\r\n     * the edge of the triangle to split (0, 1, or 2) or undefined if\r\n     * the triangle doesn't need to be subdivided.\r\n     *\r\n     * @param a - The position of the first vertex of the triangle.\r\n     * @param b - The position of the second vertex of the triangle.\r\n     * @param c - The position of the third vertex of the triangle.\r\n     */\r\n    protected abstract shouldSplitTriangle(a: Vector3, b: Vector3, c: Vector3): number | undefined;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Utility classes for working with geospatial data.\r\n *\r\n * @remarks\r\n *\r\n * @packageDocumentation\r\n */\r\n\r\nexport * from \"./lib/coordinates/GeoBox\";\r\nexport * from \"./lib/coordinates/GeoBoxExtentLike\";\r\nexport * from \"./lib/coordinates/GeoCoordinatesLike\";\r\nexport * from \"./lib/coordinates/GeoCoordinates\";\r\nexport * from \"./lib/coordinates/GeoPointLike\";\r\nexport * from \"./lib/coordinates/GeoPolygonLike\";\r\nexport * from \"./lib/coordinates/GeoPolygon\";\r\nexport * from \"./lib/coordinates/LatLngLike\";\r\nexport * from \"./lib/projection/EarthConstants\";\r\nexport * from \"./lib/projection/EquirectangularProjection\";\r\nexport * from \"./lib/projection/IdentityProjection\";\r\nexport * from \"./lib/projection/Projection\";\r\nexport * from \"./lib/projection/MercatorProjection\";\r\nexport * from \"./lib/projection/TransverseMercatorProjection\";\r\nexport * from \"./lib/projection/SphereProjection\";\r\nexport * from \"./lib/tiling/FlatTileBoundingBoxGenerator\";\r\nexport * from \"./lib/tiling/HalfQuadTreeSubdivisionScheme\";\r\nexport * from \"./lib/tiling/QuadTreeSubdivisionScheme\";\r\nexport * from \"./lib/tiling/QuadTree\";\r\nexport * from \"./lib/tiling/SubTiles\";\r\nexport * from \"./lib/tiling/SubdivisionScheme\";\r\nexport * from \"./lib/tiling/TileKey\";\r\nexport * from \"./lib/tiling/TileKeyUtils\";\r\nexport * from \"./lib/tiling/TileTreeTraverse\";\r\nexport * from \"./lib/tiling/TilingScheme\";\r\nexport * from \"./lib/tiling/HereTilingScheme\";\r\nexport * from \"./lib/tiling/WebMercatorTilingScheme\";\r\nexport * from \"./lib/tiling/MercatorTilingScheme\";\r\nexport * from \"./lib/tiling/PolarTilingScheme\";\r\nexport * from \"./lib/math/Vector2Like\";\r\nexport * from \"./lib/math/Vector3Like\";\r\nexport * from \"./lib/math/Box3Like\";\r\nexport * from \"./lib/math/OrientedBox3Like\";\r\nexport * from \"./lib/math/MathUtils\";\r\nexport * from \"./lib/math/TransformLike\";\r\nexport * from \"./lib/math/OrientedBox3\";\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoBoxExtentLike } from \"./GeoBoxExtentLike\";\r\nimport { GeoCoordinates, MAX_LONGITUDE } from \"./GeoCoordinates\";\r\nimport { GeoCoordinatesLike } from \"./GeoCoordinatesLike\";\r\n\r\n/**\r\n * `GeoBox` is used to represent a bounding box in geo coordinates.\r\n */\r\nexport class GeoBox implements GeoBoxExtentLike {\r\n    /**\r\n     * Returns a `GeoBox` with the given geo coordinates.\r\n     *\r\n     * @param southWest - The south west position in geo coordinates.\r\n     * @param northEast - The north east position in geo coordinates.\r\n     */\r\n    static fromCoordinates(southWest: GeoCoordinates, northEast: GeoCoordinates): GeoBox {\r\n        return new GeoBox(southWest, northEast);\r\n    }\r\n\r\n    /**\r\n     * Returns a `GeoBox` with the given center and dimensions.\r\n     *\r\n     * @param center - The center position of geo box.\r\n     * @param extent - Box latitude and logitude span\r\n     */\r\n    static fromCenterAndExtents(center: GeoCoordinates, extent: GeoBoxExtentLike): GeoBox {\r\n        return new GeoBox(\r\n            new GeoCoordinates(\r\n                center.latitude - extent.latitudeSpan / 2,\r\n                center.longitude - extent.longitudeSpan / 2\r\n            ),\r\n            new GeoCoordinates(\r\n                center.latitude + extent.latitudeSpan / 2,\r\n                center.longitude + extent.longitudeSpan / 2\r\n            )\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Constructs a new `GeoBox` with the given geo coordinates.\r\n     *\r\n     * @param southWest - The south west position in geo coordinates.\r\n     * @param northEast - The north east position in geo coordinates.\r\n     */\r\n    constructor(readonly southWest: GeoCoordinates, readonly northEast: GeoCoordinates) {\r\n        if (this.west > this.east) {\r\n            this.northEast.longitude += 360;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the minimum altitude or `undefined`.\r\n     */\r\n    get minAltitude(): number | undefined {\r\n        if (this.southWest.altitude === undefined || this.northEast.altitude === undefined) {\r\n            return undefined;\r\n        }\r\n        return Math.min(this.southWest.altitude, this.northEast.altitude);\r\n    }\r\n\r\n    /**\r\n     * Returns the maximum altitude or `undefined`.\r\n     */\r\n    get maxAltitude(): number | undefined {\r\n        if (this.southWest.altitude === undefined || this.northEast.altitude === undefined) {\r\n            return undefined;\r\n        }\r\n        return Math.max(this.southWest.altitude, this.northEast.altitude);\r\n    }\r\n\r\n    /**\r\n     * Returns the south latitude in degrees of this `GeoBox`.\r\n     */\r\n    get south(): number {\r\n        return this.southWest.latitude;\r\n    }\r\n\r\n    /**\r\n     * Returns the north altitude in degrees of this `GeoBox`.\r\n     */\r\n    get north(): number {\r\n        return this.northEast.latitude;\r\n    }\r\n\r\n    /**\r\n     * Returns the west longitude in degrees of this `GeoBox`.\r\n     */\r\n    get west(): number {\r\n        return this.southWest.longitude;\r\n    }\r\n\r\n    /**\r\n     * Returns the east longitude in degrees of this `GeoBox`.\r\n     */\r\n    get east(): number {\r\n        return this.northEast.longitude;\r\n    }\r\n\r\n    /**\r\n     * Returns the center of this `GeoBox`.\r\n     */\r\n    get center(): GeoCoordinates {\r\n        const latitude = (this.south + this.north) * 0.5;\r\n        const { west, east } = this;\r\n        const { minAltitude, altitudeSpan } = this;\r\n\r\n        let altitude: number | undefined;\r\n\r\n        if (minAltitude !== undefined && altitudeSpan !== undefined) {\r\n            altitude = minAltitude + altitudeSpan * 0.5;\r\n        }\r\n\r\n        if (west <= east) {\r\n            return new GeoCoordinates(latitude, (west + east) * 0.5, altitude);\r\n        }\r\n\r\n        let longitude = (360 + east + west) * 0.5;\r\n\r\n        if (longitude > 360) {\r\n            longitude -= 360;\r\n        }\r\n\r\n        return new GeoCoordinates(latitude, longitude, altitude);\r\n    }\r\n\r\n    /**\r\n     * Returns the latitude span in radians.\r\n     */\r\n    get latitudeSpanInRadians(): number {\r\n        return THREE.MathUtils.degToRad(this.latitudeSpan);\r\n    }\r\n\r\n    /**\r\n     * Returns the longitude span in radians.\r\n     */\r\n    get longitudeSpanInRadians(): number {\r\n        return THREE.MathUtils.degToRad(this.longitudeSpan);\r\n    }\r\n\r\n    /**\r\n     * Returns the latitude span in degrees.\r\n     */\r\n    get latitudeSpan(): number {\r\n        return this.north - this.south;\r\n    }\r\n\r\n    get altitudeSpan(): number | undefined {\r\n        if (this.maxAltitude === undefined || this.minAltitude === undefined) {\r\n            return undefined;\r\n        }\r\n        return this.maxAltitude - this.minAltitude;\r\n    }\r\n\r\n    /**\r\n     * Returns the longitude span in degrees.\r\n     */\r\n    get longitudeSpan(): number {\r\n        let width = this.northEast.longitude - this.southWest.longitude;\r\n\r\n        if (width < 0) {\r\n            width += 360;\r\n        }\r\n\r\n        return width;\r\n    }\r\n\r\n    /**\r\n     * Returns the latitude span in degrees.\r\n     * @deprecated Use [[latitudeSpan]] instead.\r\n     */\r\n    get latitudeSpanInDegrees(): number {\r\n        return this.latitudeSpan;\r\n    }\r\n\r\n    /**\r\n     * Returns the longitude span in degrees.\r\n     * @deprecated Use [[longitudeSpan]] instead.\r\n     */\r\n    get longitudeSpanInDegrees(): number {\r\n        return this.longitudeSpan;\r\n    }\r\n\r\n    /**\r\n     * Returns `true` if the given geo coordinates are contained in this `GeoBox`.\r\n     *\r\n     * @param point - The geo coordinates.\r\n     */\r\n    contains(point: GeoCoordinates): boolean {\r\n        if (\r\n            point.altitude === undefined ||\r\n            this.minAltitude === undefined ||\r\n            this.maxAltitude === undefined\r\n        ) {\r\n            return this.containsHelper(point);\r\n        }\r\n\r\n        const isFlat = this.minAltitude === this.maxAltitude;\r\n        const isSameAltitude = this.minAltitude === point.altitude;\r\n        const isWithinAltitudeRange =\r\n            this.minAltitude <= point.altitude && this.maxAltitude > point.altitude;\r\n\r\n        // If box is flat, we should check the altitude and containment,\r\n        // otherwise we should check also altitude difference where we consider\r\n        // point to be inside if alt is from [m_minAltitude, m_maxAltitude) range!\r\n        if (isFlat ? isSameAltitude : isWithinAltitudeRange) {\r\n            return this.containsHelper(point);\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Clones this `GeoBox` instance.\r\n     */\r\n    clone(): GeoBox {\r\n        return new GeoBox(this.southWest.clone(), this.northEast.clone());\r\n    }\r\n\r\n    /**\r\n     * Update the bounding box by considering a given point.\r\n     *\r\n     * @param point - The point that may expand the bounding box.\r\n     */\r\n    growToContain(point: GeoCoordinatesLike) {\r\n        this.southWest.latitude = Math.min(this.southWest.latitude, point.latitude);\r\n        this.southWest.longitude = Math.min(this.southWest.longitude, point.longitude);\r\n        this.southWest.altitude =\r\n            this.southWest.altitude !== undefined && point.altitude !== undefined\r\n                ? Math.min(this.southWest.altitude, point.altitude)\r\n                : this.southWest.altitude !== undefined\r\n                ? this.southWest.altitude\r\n                : point.altitude !== undefined\r\n                ? point.altitude\r\n                : undefined;\r\n\r\n        this.northEast.latitude = Math.max(this.northEast.latitude, point.latitude);\r\n        this.northEast.longitude = Math.max(this.northEast.longitude, point.longitude);\r\n        this.northEast.altitude =\r\n            this.northEast.altitude !== undefined && point.altitude !== undefined\r\n                ? Math.max(this.northEast.altitude, point.altitude)\r\n                : this.northEast.altitude !== undefined\r\n                ? this.northEast.altitude\r\n                : point.altitude !== undefined\r\n                ? point.altitude\r\n                : undefined;\r\n    }\r\n\r\n    private containsHelper(point: GeoCoordinates): boolean {\r\n        if (point.latitude < this.southWest.latitude || point.latitude >= this.northEast.latitude) {\r\n            return false;\r\n        }\r\n\r\n        const { west, east } = this;\r\n\r\n        let longitude = point.longitude;\r\n        if (east > MAX_LONGITUDE) {\r\n            while (longitude < west) {\r\n                longitude = longitude + 360;\r\n            }\r\n        }\r\n\r\n        if (longitude > east) {\r\n            while (longitude > west + 360) {\r\n                longitude = longitude - 360;\r\n            }\r\n        }\r\n\r\n        return longitude >= west && longitude < east;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Represents an object that carry {@link GeoBox} extents like interface.\r\n */\r\nexport interface GeoBoxExtentLike {\r\n    /**\r\n     * Latitude span in degrees.\r\n     */\r\n    readonly latitudeSpan: number;\r\n\r\n    /**\r\n     * Longitude span in degrees\r\n     */\r\n    readonly longitudeSpan: number;\r\n}\r\n\r\n/**\r\n * Type guard to assert that `object` conforms to {@link GeoBoxExtentLike} interface.\r\n */\r\nexport function isGeoBoxExtentLike(obj: any): obj is GeoBoxExtentLike {\r\n    return (\r\n        obj &&\r\n        typeof obj === \"object\" &&\r\n        typeof obj.latitudeSpan === \"number\" &&\r\n        typeof obj.longitudeSpan === \"number\"\r\n    );\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { GeoCoordinatesLike, isGeoCoordinatesLike } from \"./GeoCoordinatesLike\";\r\nimport { GeoPointLike, isGeoPointLike } from \"./GeoPointLike\";\r\nimport { isLatLngLike, LatLngLike } from \"./LatLngLike\";\r\n\r\n/**\r\n * Represents an object in different geo coordinate formats\r\n */\r\nexport type GeoCoordLike = GeoPointLike | GeoCoordinatesLike | LatLngLike;\r\n\r\nexport function geoCoordLikeToGeoCoordinatesLike(coord: GeoCoordLike): GeoCoordinatesLike {\r\n    return isGeoCoordinatesLike(coord)\r\n        ? coord\r\n        : isLatLngLike(coord)\r\n        ? { latitude: coord.lat, longitude: coord.lng }\r\n        : { latitude: coord[1], longitude: coord[0] };\r\n}\r\n\r\nexport function geoCoordLikeToGeoPointLike(coord: GeoCoordLike): GeoPointLike {\r\n    return isGeoPointLike(coord)\r\n        ? coord\r\n        : isLatLngLike(coord)\r\n        ? [coord.lng, coord.lat]\r\n        : [coord.longitude, coord.latitude];\r\n}\r\n\r\nexport function isGeoCoordLike(object: any): boolean {\r\n    return isGeoCoordinatesLike(object) || isLatLngLike(object) || !isGeoPointLike(object);\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoCoordinatesLike, isGeoCoordinatesLike } from \"./GeoCoordinatesLike\";\r\nimport { GeoCoordLike } from \"./GeoCoordLike\";\r\nimport { GeoPointLike, isGeoPointLike } from \"./GeoPointLike\";\r\nimport { isLatLngLike, LatLngLike } from \"./LatLngLike\";\r\n\r\nexport const MAX_LATITUDE = 90;\r\nexport const MIN_LATITUDE = -90;\r\nexport const MAX_LONGITUDE = 180;\r\nexport const MIN_LONGITUDE = -180;\r\n\r\nconst tmpV0 = new THREE.Vector3();\r\nconst tmpV1 = new THREE.Vector3();\r\n\r\n/**\r\n * Compute the modulo.\r\n *\r\n * @internal\r\n */\r\nfunction mod(dividend: number, divisor: number): number {\r\n    const modulo = dividend % divisor;\r\n    const modulo_sign = modulo < 0;\r\n    const divisor_sign = divisor < 0;\r\n    return modulo_sign === divisor_sign ? modulo : modulo + divisor;\r\n}\r\n\r\n/**\r\n * `GeoCoordinates` is used to represent geo positions.\r\n */\r\nexport class GeoCoordinates implements GeoCoordinatesLike {\r\n    /**\r\n     * Returns a `GeoCoordinates` from the given latitude, longitude, and optional altitude.\r\n     *\r\n     * @param latitude - Latitude in degrees.\r\n     * @param longitude - Longitude in degrees.\r\n     * @param altitude - Altitude in meters.\r\n     */\r\n    static fromDegrees(latitude: number, longitude: number, altitude?: number): GeoCoordinates {\r\n        return new GeoCoordinates(latitude, longitude, altitude);\r\n    }\r\n\r\n    /**\r\n     * Returns a `GeoCoordinates` from the given latitude, longitude, and optional altitude.\r\n     *\r\n     * @param latitude - Latitude in radians.\r\n     * @param longitude - Longitude in radians.\r\n     * @param altitude - Altitude in meters.\r\n     */\r\n    static fromRadians(latitude: number, longitude: number, altitude?: number): GeoCoordinates {\r\n        return new GeoCoordinates(\r\n            THREE.MathUtils.radToDeg(latitude),\r\n            THREE.MathUtils.radToDeg(longitude),\r\n            altitude\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Creates a {@link GeoCoordinates} from a {@link LatLngLike} literal.\r\n     * ```typescript\r\n     * const center = { lat: 53.3, lng: 13.4 };\r\n     * mapView.geoCenter = GeoCoordinates.fromLatLng(center);\r\n     * ```\r\n     * @param latLng - A {@link LatLngLike} object literal.\r\n     */\r\n    static fromLatLng(latLng: LatLngLike) {\r\n        return new GeoCoordinates(latLng.lat, latLng.lng);\r\n    }\r\n\r\n    /**\r\n     * Creates a {@link GeoCoordinates} from a [[GeoPointLike]] tuple.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * mapView.geoCenter = GeoCoordinates.fromGeoPoint([longitude, latitude]);\r\n     *\r\n     * let geoCoords: number[] = ...;\r\n     *\r\n     * if (isGeoPointLike(geoCoords)) {\r\n     *     const p = GeoCoordinates.fromGeoPoint(geoCoords);\r\n     * }\r\n     * ```\r\n     * @param geoPoint - An [[Array]] of at least two elements following the order\r\n     * longitude, latitude, altitude.\r\n     */\r\n    static fromGeoPoint(geoPoint: GeoPointLike): GeoCoordinates {\r\n        return new GeoCoordinates(geoPoint[1], geoPoint[0], geoPoint[2]);\r\n    }\r\n\r\n    /**\r\n     * Creates a {@link GeoCoordinates} from different types of geo coordinate objects.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const fromGeoPointLike = GeoCoordinates.fromObject([longitude, latitude]);\r\n     * const fromGeoCoordinateLike = GeoCoordinates.fromObject({ longitude, latitude });\r\n     * const fromGeoCoordinate = GeoCoordinates.fromObject(new GeoCoordinates(latitude, longitude));\r\n     * const fromLatLngLike = GeoCoordinates.fromObject({ lat: latitude , lng: longitude });\r\n     * ```\r\n     *\r\n     * @param geoPoint - Either [[GeoPointLike]], {@link GeoCoordinatesLike}\r\n     * or {@link LatLngLike} object literal.\r\n     */\r\n    static fromObject(geoPoint: GeoCoordLike): GeoCoordinates {\r\n        if (isGeoPointLike(geoPoint)) {\r\n            return GeoCoordinates.fromGeoPoint(geoPoint);\r\n        } else if (isGeoCoordinatesLike(geoPoint)) {\r\n            return GeoCoordinates.fromDegrees(\r\n                geoPoint.latitude,\r\n                geoPoint.longitude,\r\n                geoPoint.altitude\r\n            );\r\n        } else if (isLatLngLike(geoPoint)) {\r\n            return GeoCoordinates.fromDegrees(geoPoint.lat, geoPoint.lng);\r\n        }\r\n\r\n        throw new Error(\"Invalid input coordinate format.\");\r\n    }\r\n\r\n    /**\r\n     * Returns a `GeoCoordinates` resulting from the linear interpolation of other two.\r\n     * @param geoCoords0 - One of the `GeoCoordinates` used for interpolation.\r\n     * @param geoCoords1 - The other `GeoCoordinates` used for interpolation.\r\n     * @param factor - Interpolation factor. If `0` result will be equal to `geoCoords0`, if `1`\r\n     * it'll be equal to `geoCoords1`.\r\n     * @param wrap - If `true`, interpolation will be done across the antimeridian, otherwise it's\r\n     * done across the Greenwich meridian. Supported only if longitude span is less than 360 deg.\r\n     * @default false\r\n     * @param normalize - If `true`, interpolation result will be normalized. @default false\r\n     */\r\n    static lerp(\r\n        geoCoords0: GeoCoordinates,\r\n        geoCoords1: GeoCoordinates,\r\n        factor: number,\r\n        wrap: boolean = false,\r\n        normalize: boolean = false\r\n    ): GeoCoordinates {\r\n        if (wrap) {\r\n            if (geoCoords0.lng < geoCoords1.lng) {\r\n                const geoCoordsEnd = geoCoords0.clone();\r\n                geoCoordsEnd.longitude += 360;\r\n                return this.lerp(geoCoords1, geoCoordsEnd, 1 - factor);\r\n            } else {\r\n                const geoCoordsEnd = geoCoords1.clone();\r\n                geoCoordsEnd.longitude += 360;\r\n                return this.lerp(geoCoords0, geoCoordsEnd, factor);\r\n            }\r\n        }\r\n\r\n        const v0 = tmpV0.set(geoCoords0.lat, geoCoords0.lng, geoCoords0.altitude ?? 0);\r\n        const v1 = tmpV1.set(geoCoords1.lat, geoCoords1.lng, geoCoords1.altitude ?? 0);\r\n        v0.lerp(v1, factor);\r\n        const result = new GeoCoordinates(v0.x, v0.y, v0.z);\r\n\r\n        return normalize ? result.normalized() : result;\r\n    }\r\n\r\n    /**\r\n     * Creates a `GeoCoordinates` from the given latitude, longitude, and optional altitude.\r\n     *\r\n     * @param latitude - Latitude in degrees.\r\n     * @param longitude - Longitude in degrees.\r\n     * @param altitude - Altitude in meters.\r\n     */\r\n    constructor(public latitude: number, public longitude: number, public altitude?: number) {}\r\n\r\n    /**\r\n     * Returns the latitude in radians.\r\n     */\r\n    get latitudeInRadians(): number {\r\n        return THREE.MathUtils.degToRad(this.latitude);\r\n    }\r\n\r\n    /**\r\n     * Returns the longitude in radians.\r\n     */\r\n    get longitudeInRadians(): number {\r\n        return THREE.MathUtils.degToRad(this.longitude);\r\n    }\r\n\r\n    /**\r\n     * Returns the latitude in degrees.\r\n     * @deprecated Use the [[latitude]] property instead.\r\n     */\r\n    get latitudeInDegrees(): number {\r\n        return this.latitude;\r\n    } // compat api\r\n\r\n    /**\r\n     * Returns the longitude in degrees.\r\n     * @deprecated Use the [[longitude]] property instead.\r\n     */\r\n    get longitudeInDegrees(): number {\r\n        return this.longitude;\r\n    } // compat api\r\n\r\n    /**\r\n     * The latitude in the degrees.\r\n     */\r\n    get lat() {\r\n        return this.latitude;\r\n    }\r\n\r\n    /**\r\n     * The longitude in the degrees.\r\n     */\r\n    get lng() {\r\n        return this.longitude;\r\n    }\r\n\r\n    /**\r\n     * Returns `true` if this `GeoCoordinates` is valid; returns `false` otherwise.\r\n     */\r\n    isValid(): boolean {\r\n        return !isNaN(this.latitude) && !isNaN(this.longitude);\r\n    }\r\n\r\n    /**\r\n     * Returns the normalized `GeoCoordinates`.\r\n     */\r\n    normalized(): GeoCoordinates {\r\n        let { latitude, longitude } = this;\r\n        if (isNaN(latitude) || isNaN(longitude)) {\r\n            return this;\r\n        }\r\n        if (longitude < -180 || longitude > 180) {\r\n            longitude = mod(longitude + 180, 360) - 180;\r\n        }\r\n        latitude = THREE.MathUtils.clamp(latitude, -90, 90);\r\n        return new GeoCoordinates(latitude, longitude, this.altitude);\r\n    }\r\n\r\n    /**\r\n     * Returns `true` if this `GeoCoordinates` is equal to the other.\r\n     *\r\n     * @param other - GeoCoordinatesLike to compare to.\r\n     */\r\n    equals(other: GeoCoordinatesLike): boolean {\r\n        return (\r\n            this.latitude === other.latitude &&\r\n            this.longitude === other.longitude &&\r\n            this.altitude === other.altitude\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Copy values from the other.\r\n     *\r\n     * @param other - GeoCoordinatesLike to copy all values from.\r\n     */\r\n    copy(other: GeoCoordinatesLike): GeoCoordinates {\r\n        this.latitude = other.latitude;\r\n        this.longitude = other.longitude;\r\n        this.altitude = other.altitude;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clones this `GeoCoordinates`.\r\n     */\r\n    clone(): GeoCoordinates {\r\n        return new GeoCoordinates(this.latitude, this.longitude, this.altitude);\r\n    }\r\n\r\n    /**\r\n     * Returns this {@link GeoCoordinates} as {@link LatLngLike} literal.\r\n     */\r\n    toLatLng(): LatLngLike {\r\n        return { lat: this.latitude, lng: this.longitude };\r\n    }\r\n\r\n    /**\r\n     * Converts this {@link GeoCoordinates} to a [[GeoPointLike]].\r\n     */\r\n    toGeoPoint(): GeoPointLike {\r\n        return this.altitude !== undefined\r\n            ? [this.longitude, this.latitude, this.altitude]\r\n            : [this.longitude, this.latitude];\r\n    }\r\n\r\n    /**\r\n     * Returns the minimum longitude span from this `GeoCoordinates` to another.\r\n     *\r\n     * @param other - The other GeoCoordinatesLike defining the longitude span.\r\n     */\r\n    minLongitudeSpanTo(other: GeoCoordinatesLike): number {\r\n        const minLongitude = Math.min(this.longitude, other.longitude);\r\n        const maxLongitude = Math.max(this.longitude, other.longitude);\r\n\r\n        return Math.min(maxLongitude - minLongitude, 360 + minLongitude - maxLongitude);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Represents an object with `GeoCoordinates` like interface.\r\n */\r\nexport interface GeoCoordinatesLike {\r\n    /** The latitude in degrees. */\r\n    latitude: number;\r\n\r\n    /** The longitude in degrees. */\r\n    longitude: number;\r\n\r\n    /** The optional altitude in meters. */\r\n    altitude?: number;\r\n}\r\n\r\n/**\r\n * Type guard to assert that `object` conforms to {@link GeoCoordinatesLike} data interface.\r\n */\r\nexport function isGeoCoordinatesLike(object: any): object is GeoCoordinatesLike {\r\n    return (\r\n        object &&\r\n        typeof object.latitude === \"number\" &&\r\n        typeof object.longitude === \"number\" &&\r\n        (typeof object.altitude === \"number\" || typeof object.altitude === \"undefined\")\r\n    );\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * An [[Array]] following the order longitude, latitude, altitude.\r\n */\r\nexport type GeoPointLike = [number, number, number?];\r\n\r\n/**\r\n * Type guard to assert that `object` conforms to [[GeoPointLike]] interface.\r\n */\r\nexport function isGeoPointLike(geoPoint: any): geoPoint is GeoPointLike {\r\n    if (Array.isArray(geoPoint)) {\r\n        const [longitude, latitude, altitude] = geoPoint;\r\n        return (\r\n            typeof longitude === \"number\" &&\r\n            typeof latitude === \"number\" &&\r\n            (altitude === undefined || typeof altitude === \"number\")\r\n        );\r\n    }\r\n    return false;\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { Vector2 } from \"three\";\r\n\r\nimport { GeoBox } from \"./GeoBox\";\r\nimport { GeoCoordinates, MAX_LATITUDE, MIN_LATITUDE } from \"./GeoCoordinates\";\r\nimport { GeoCoordinatesLike } from \"./GeoCoordinatesLike\";\r\nimport { GeoCoordLike, geoCoordLikeToGeoCoordinatesLike } from \"./GeoCoordLike\";\r\nimport { GeoPolygonLike } from \"./GeoPolygonLike\";\r\n\r\nfunction computeLonSpanAcrossGreewich(lonA: number, lonB: number) {\r\n    return Math.max(lonA, lonB) - Math.min(lonA, lonB);\r\n}\r\n\r\nfunction isLeftToRightAntimeridianCrossing(lonStart: number, lonEnd: number) {\r\n    return lonStart > 0 && lonEnd < 0 && computeLonSpanAcrossGreewich(lonStart, lonEnd) > 180;\r\n}\r\n\r\nfunction isRightToLeftAntimeridianCrossing(lonStart: number, lonEnd: number) {\r\n    return isLeftToRightAntimeridianCrossing(lonEnd, lonStart);\r\n}\r\n\r\nexport function isAntimeridianCrossing(lonStart: number, lonEnd: number) {\r\n    return (\r\n        Math.sign(lonStart) === -Math.sign(lonEnd) &&\r\n        computeLonSpanAcrossGreewich(lonStart, lonEnd) > 180\r\n    );\r\n}\r\n\r\ntype MinThreeItemsArray<T> = [T, T, T, ...T[]];\r\n\r\nexport type GeoPolygonCoordinates = MinThreeItemsArray<\r\n    GeoCoordinatesLike | GeoCoordinates | GeoCoordLike\r\n>;\r\n\r\n/**\r\n * A GeoPolygon in 2D Space (altitudes will be ignored).\r\n * Coordinates are expected in counter-clockwise order, for convex polygons a sorting is\r\n * available.\r\n * Clockwise ordered or selfintersecting Polygons might lead to no or unexpected results.\r\n *\r\n * @beta @internal\r\n */\r\nexport class GeoPolygon implements GeoPolygonLike {\r\n    private readonly m_coordinates: MinThreeItemsArray<GeoCoordinatesLike>;\r\n\r\n    /**\r\n     * Creates a GeoPolygon instance\r\n     *\r\n     * @param coordinates An array of GeoCoordinates acting as the Vertices of the Polygon.\r\n     * @param needsSort  If `true` it will sort the coordinates in ccw order, this will only\r\n     *  result correctly for convex polygons @default false\r\n     * @param needsWrapping  If `true` it will wrap around coordinates crossing the antemeridian.\r\n     * Only supported for polygons with sides that don't span more than 180 degrees longitude.\r\n     * @default false\r\n     */\r\n    constructor(\r\n        coordinates: GeoPolygonCoordinates,\r\n        needsSort: boolean = false,\r\n        needsWrapping: boolean = false\r\n    ) {\r\n        this.m_coordinates = coordinates.map(coord => {\r\n            return geoCoordLikeToGeoCoordinatesLike(coord);\r\n        }) as MinThreeItemsArray<GeoCoordinatesLike>;\r\n        if (needsSort) {\r\n            this.sortCCW();\r\n        }\r\n        if (needsWrapping) {\r\n            this.wrapCoordinatesAround();\r\n        }\r\n    }\r\n\r\n    get coordinates(): MinThreeItemsArray<GeoCoordinatesLike> {\r\n        return this.m_coordinates;\r\n    }\r\n\r\n    /**\r\n     * Gets a BoundingBox for the Polygon\r\n     *\r\n     * Might have unexpected results for twisted or concave Polygons\r\n     */\r\n    getGeoBoundingBox(): GeoBox {\r\n        const centroid = this.getCentroid();\r\n        if (centroid === undefined) {\r\n            //return a BBox without extend if the centroid could not be generated\r\n            return GeoBox.fromCoordinates(\r\n                this.coordinates[0] as GeoCoordinates,\r\n                this.coordinates[0] as GeoCoordinates\r\n            );\r\n        }\r\n        const { east, west } = this.getEastAndWest(centroid);\r\n        const { north, south } = this.getNorthAndSouth();\r\n        return GeoBox.fromCoordinates(\r\n            new GeoCoordinates(south, west),\r\n            new GeoCoordinates(north, east)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Gets the Centroid for the Polygon\r\n     *\r\n     * Might be undefined or with unexpected results for twisted or concave Polygons.\r\n     */\r\n    getCentroid(): GeoCoordinates | undefined {\r\n        const area = this.getArea();\r\n        if (area === 0) {\r\n            return undefined;\r\n        }\r\n        let latitude = 0;\r\n        let longitude = 0;\r\n        let f;\r\n\r\n        let previousIndex = this.m_coordinates.length - 1;\r\n\r\n        this.m_coordinates.forEach((coordinate, index) => {\r\n            const previousCoordinate = this.m_coordinates[previousIndex];\r\n            f =\r\n                coordinate.latitude * previousCoordinate.longitude -\r\n                previousCoordinate.latitude * coordinate.longitude;\r\n            latitude += (coordinate.latitude + previousCoordinate.latitude) * f;\r\n            longitude += (coordinate.longitude + previousCoordinate.longitude) * f;\r\n            previousIndex = index;\r\n        });\r\n\r\n        f = area * 6;\r\n\r\n        return new GeoCoordinates(\r\n            latitude / f,\r\n            area < 0 /* antimeridian crossing */ ? -180 + longitude / f : longitude / f\r\n        );\r\n    }\r\n\r\n    private sortCCW() {\r\n        const polyCenter = this.getPolyAverageCenter();\r\n        if (!polyCenter) {\r\n            return;\r\n        }\r\n\r\n        //sorts by angle from x-axis\r\n        this.m_coordinates.sort((a: GeoCoordinatesLike, b: GeoCoordinatesLike) => {\r\n            const veca = new Vector2(\r\n                a.latitude - polyCenter.latitude,\r\n                a.longitude - polyCenter.longitude\r\n            ).normalize();\r\n            const vecb = new Vector2(\r\n                b.latitude - polyCenter.latitude,\r\n                b.longitude - polyCenter.longitude\r\n            ).normalize();\r\n\r\n            return vecb.angle() - veca.angle();\r\n        });\r\n    }\r\n\r\n    private wrapCoordinatesAround() {\r\n        const firstAntimerCrossIndex = this.m_coordinates.findIndex(\r\n            (val: GeoCoordinatesLike, index: number) => {\r\n                const prevLonIndex = index === 0 ? this.m_coordinates.length - 1 : index - 1;\r\n                const prevLon = this.m_coordinates[prevLonIndex].longitude;\r\n                const lon = val.longitude;\r\n\r\n                return isLeftToRightAntimeridianCrossing(prevLon, lon);\r\n            }\r\n        );\r\n        if (firstAntimerCrossIndex < 0) {\r\n            return;\r\n        }\r\n\r\n        let wrapAround = true;\r\n        for (let i = 0; i < this.m_coordinates.length; i++) {\r\n            const index = (firstAntimerCrossIndex + i) % this.m_coordinates.length;\r\n            const currentLon = this.m_coordinates[index].longitude;\r\n            const nextLon = this.m_coordinates[(index + 1) % this.m_coordinates.length].longitude;\r\n\r\n            if (wrapAround) {\r\n                this.m_coordinates[index].longitude += 360;\r\n            }\r\n\r\n            if (isRightToLeftAntimeridianCrossing(currentLon, nextLon)) {\r\n                wrapAround = false;\r\n            } else if (isLeftToRightAntimeridianCrossing(currentLon, nextLon)) {\r\n                wrapAround = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    private getPolyAverageCenter(): GeoCoordinates | undefined {\r\n        const polySum = this.m_coordinates.reduce((prev, curr) => {\r\n            return new GeoCoordinates(\r\n                prev.latitude + curr.latitude,\r\n                prev.longitude + curr.longitude\r\n            );\r\n        });\r\n        //create an average center point\r\n        return new GeoCoordinates(\r\n            polySum.latitude / this.m_coordinates.length,\r\n            polySum.longitude / this.m_coordinates.length\r\n        );\r\n    }\r\n\r\n    private getArea(): number {\r\n        let area = 0;\r\n        let previousIndex = this.m_coordinates.length - 1;\r\n\r\n        this.m_coordinates.forEach((coordinate, index) => {\r\n            const previousCoordinate = this.m_coordinates[previousIndex];\r\n            area += coordinate.latitude * previousCoordinate.longitude;\r\n            area -= coordinate.longitude * previousCoordinate.latitude;\r\n            previousIndex = index;\r\n        });\r\n\r\n        return (area /= 2);\r\n    }\r\n\r\n    private getEastAndWest(center: GeoCoordinates): { east: number; west: number } {\r\n        let west = center.longitude;\r\n        let east = center.longitude;\r\n        let previousIndex = this.m_coordinates.length - 1;\r\n        this.m_coordinates.forEach((coordinate, index) => {\r\n            const previousCoordinate = this.m_coordinates[previousIndex];\r\n            previousIndex = index;\r\n            const veca = new Vector2(\r\n                coordinate.latitude - center.latitude,\r\n                coordinate.longitude - center.longitude\r\n            ).normalize();\r\n\r\n            const vecb = new Vector2(\r\n                previousCoordinate.latitude - center.latitude,\r\n                previousCoordinate.longitude - center.longitude\r\n            ).normalize();\r\n\r\n            let ccw = Math.sign(vecb.angle() - veca.angle()) === 1;\r\n            // overwrite in case of angle over axis\r\n            if (vecb.y >= 0 && veca.y < 0) {\r\n                ccw = true;\r\n            }\r\n\r\n            const long = coordinate.longitude;\r\n            if (long < center.longitude) {\r\n                if (ccw) {\r\n                    west = Math.min(west, long);\r\n                } else {\r\n                    east = Math.min(east, long);\r\n                }\r\n            } else {\r\n                if (ccw) {\r\n                    east = Math.max(east, long);\r\n                } else {\r\n                    west = Math.max(west, long);\r\n                }\r\n            }\r\n        });\r\n        return { east, west };\r\n    }\r\n\r\n    private getNorthAndSouth(): { north: number; south: number } {\r\n        let north = MIN_LATITUDE;\r\n        let south = MAX_LATITUDE;\r\n        this.m_coordinates.forEach((coordinate, index) => {\r\n            north = Math.max(north, coordinate.latitude);\r\n            south = Math.min(south, coordinate.latitude);\r\n        });\r\n        return { north, south };\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { GeoCoordLike, isGeoCoordLike } from \"./GeoCoordLike\";\r\n\r\n/**\r\n * Represents an object with `GeoPolygon` like interface.\r\n *\r\n * This is defined as an Array of GeoCoordinates sorted in ccw order.\r\n *\r\n * @beta, @internal\r\n */\r\nexport interface GeoPolygonLike {\r\n    /**\r\n     * Array of ccw sorted GeoCoordLike\r\n     */\r\n    coordinates: GeoCoordLike[];\r\n}\r\n\r\n/**\r\n * Type guard to assert that `object` conforms to {@link GeoPolygonLike} data interface.\r\n *\r\n * @beta, @internal\r\n */\r\nexport function isGeoPolygonLike(object: any): object is GeoPolygonLike {\r\n    if (!object || (!Array.isArray(object.coordinates) && object.coordinates.length > 2)) {\r\n        return false;\r\n    }\r\n    let isValid: boolean = true;\r\n    //TODO: this might take a while, not sure this should be that extensive\r\n    object.coordinates.forEach((coord: any) => {\r\n        if (!isGeoCoordLike(object)) {\r\n            isValid = false;\r\n        }\r\n    });\r\n    return isValid;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Represents an object with `LatLng` like interface.\r\n */\r\nexport interface LatLngLike {\r\n    /** The latitude in degrees. */\r\n    lat: number;\r\n\r\n    /** The longitude in degrees. */\r\n    lng: number;\r\n}\r\n\r\n/**\r\n * Type guard to assert that `object` conforms to {@link LatLngLike} interface.\r\n */\r\nexport function isLatLngLike(object: any): object is LatLngLike {\r\n    return object && typeof object.lat === \"number\" && typeof object.lng === \"number\";\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Vector3Like } from \"./Vector3Like\";\r\n\r\n/**\r\n * An interface representing bounding box in world coordinates.\r\n */\r\nexport interface Box3Like {\r\n    /**\r\n     * The minimum position in world coordinates of this bounding box.\r\n     */\r\n    readonly min: Vector3Like;\r\n\r\n    /**\r\n     * The maximum position in world coordinates of this bounding box.\r\n     */\r\n    readonly max: Vector3Like;\r\n}\r\n\r\n/**\r\n * Returns true if the given object implements the {@link Box3Like} interface.\r\n *\r\n * @param object - A valid object.\r\n */\r\nexport function isBox3Like(object: {}): object is Box3Like {\r\n    const box3 = object as Partial<Box3Like>;\r\n    return box3.min !== undefined && box3.max !== undefined;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { Box3Like } from \"./Box3Like\";\r\nimport { Vector3Like } from \"./Vector3Like\";\r\n\r\nexport namespace MathUtils {\r\n    /**\r\n     * Creates a new empty bounding box.\r\n     *\r\n     * @deprecated Use {@link https://threejs.org/docs/#api/en/math/Box3 | THREE.Box3} instead.\r\n     */\r\n    export function newEmptyBox3(): Box3Like {\r\n        return {\r\n            min: { x: Infinity, y: Infinity, z: Infinity },\r\n            max: { x: -Infinity, y: -Infinity, z: -Infinity }\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Creates a new [Vector3Like] instance.\r\n     *\r\n     * @param x - The x component.\r\n     * @param y - The y component.\r\n     * @param z - The z component.\r\n     */\r\n    export function newVector3(x: number, y: number, z: number): Vector3Like;\r\n\r\n    /**\r\n     * Creates a new [Vector3Like] instance.\r\n     *\r\n     * @param x - The x component.\r\n     * @param y - The y component.\r\n     * @param z - The z component.\r\n     * @param v - The resulting [Vector3Like] instance.\r\n     */\r\n    export function newVector3<Vector extends Vector3Like>(\r\n        x: number,\r\n        y: number,\r\n        z: number,\r\n        v: Vector\r\n    ): Vector;\r\n\r\n    /**\r\n     * Set the components of the given [Vector3Like] instance.\r\n     *\r\n     * @param x - The x component.\r\n     * @param y - The y component.\r\n     * @param z - The z component.\r\n     * @param v - The [Vector3Like]\r\n     */\r\n    export function newVector3(x: number, y: number, z: number, v?: Vector3Like): Vector3Like {\r\n        if (v === undefined) {\r\n            return { x, y, z };\r\n        }\r\n        v.x = x;\r\n        v.y = y;\r\n        v.z = z;\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * Copies the vector across.\r\n     *\r\n     * @param from - The vector to copy from.\r\n     * @param to - The resulting [Vector3Like] instance, with the contents copied from from\r\n     */\r\n    export function copyVector3<Vector extends Vector3Like>(from: Vector3Like, to: Vector): Vector {\r\n        to.x = from.x;\r\n        to.y = from.y;\r\n        to.z = from.z;\r\n        return to;\r\n    }\r\n\r\n    /**\r\n     * Converts an angle measured in degrees to an equivalent value in radians.\r\n     *\r\n     * @param degrees - Value in degrees.\r\n     * @returns Value in radians.\r\n     * @deprecated use THREE.MathUtils.degToRad instead\r\n     */\r\n    export const degToRad = THREE.MathUtils.degToRad;\r\n\r\n    /**\r\n     * Converts an angle measured in radians to an equivalent value in degrees.\r\n     *\r\n     * @param degrees - Value in radians.\r\n     * @returns Value in degrees.\r\n     * @deprecated Use {@link https://threejs.org/docs/#api/en/math/MathUtils.radToDeg\r\n     *                | THREE.MathUtils.radToDeg}.\r\n     */\r\n    export const radToDeg = THREE.MathUtils.radToDeg;\r\n\r\n    /**\r\n     * Ensures that input value fits in a given range.\r\n     *\r\n     * @param value - The value to be clamped.\r\n     * @param min - Minimum value.\r\n     * @param max - Maximum value.\r\n     * @returns Clamped value.\r\n     * @deprecated Use {@link https://threejs.org/docs/#api/en/math/MathUtils.clamp\r\n     *                | THREE.MathUtils.clamp}.\r\n     */\r\n    export const clamp = THREE.MathUtils.clamp;\r\n\r\n    /**\r\n     * Normalize angle in degrees to range `[0, 360)`.\r\n     *\r\n     * @param a - Angle in degrees.\r\n     * @returns Angle in degrees in range `[0, 360)`.\r\n     */\r\n    export function normalizeAngleDeg(a: number): number {\r\n        a = a % 360;\r\n        if (a < 0) {\r\n            a = a + 360;\r\n        }\r\n        return a;\r\n    }\r\n\r\n    /**\r\n     * Normalize latitude angle in degrees to range `[-180, 180]`.\r\n     *\r\n     * @param a - Latitude angle in degrees.\r\n     * @returns Latitude angle in degrees in range `[-180, 180]`.\r\n     */\r\n    export function normalizeLongitudeDeg(a: number): number {\r\n        a = normalizeAngleDeg(a);\r\n        if (a > 180) {\r\n            a = a - 360;\r\n        }\r\n        return a;\r\n    }\r\n\r\n    /**\r\n     * Return the minimal delta between angles `a` and `b` given in degrees.\r\n     *\r\n     * Equivalent to `a - b` in coordinate space with exception vector direction can be reversed\r\n     * that if `abs(a-b) > 180` because trip is shorter in 'other' direction.\r\n     *\r\n     * Useful when interpolating between `b` and `a` in angle space.\r\n     *\r\n     * @param a - Start angle in degrees.\r\n     * @param b - End angle in degrees.\r\n     * @returns Angle that that satisfies condition `a - b - d = 0` in angle space.\r\n     */\r\n    export function angleDistanceDeg(a: number, b: number): number {\r\n        a = normalizeAngleDeg(a);\r\n        b = normalizeAngleDeg(b);\r\n\r\n        const d = a - b;\r\n        if (d > 180) {\r\n            return d - 360;\r\n        } else if (d <= -180) {\r\n            return d + 360;\r\n        } else {\r\n            return d;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Interpolate linearly between two angles given in degrees.\r\n     *\r\n     * @param p0 - Angle from in degrees\r\n     * @param p1 - Angle to in degrees\r\n     * @param t - Interpolation factor (alpha), in range `0-1`.\r\n     */\r\n    export function interpolateAnglesDeg(p0: number, p1: number, t: number): number {\r\n        // hand crafted version,\r\n        // see stack for maybe better versions:\r\n        //    https://stackoverflow.com/questions/2708476/rotation-interpolation\r\n\r\n        const d = angleDistanceDeg(p1, p0);\r\n        const r = (p0 + d * t) % 360;\r\n        return r;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Frustum, Matrix4, Plane, Ray, Vector3 } from \"three\";\r\n\r\nimport { OrientedBox3Like } from \"./OrientedBox3Like\";\r\n\r\nfunction intersectsSlab(\r\n    rayDir: Vector3,\r\n    p: Vector3,\r\n    axis: Vector3,\r\n    extent: number,\r\n    t: { min: number; max: number }\r\n): boolean {\r\n    const epsilon = 1e-20;\r\n    const e = axis.dot(p);\r\n    const f = axis.dot(rayDir);\r\n    if (Math.abs(f) < epsilon) {\r\n        // ray parallel to near/far slab lines.\r\n        return Math.abs(e) <= extent;\r\n    }\r\n\r\n    // ray intersects near/far slab lines.\r\n    const finv = 1 / f;\r\n    const t1 = (e + extent) * finv;\r\n    const t2 = (e - extent) * finv;\r\n    if (t1 > t2) {\r\n        // t1 is far intersect, t2 is near.\r\n        if (t2 > t.min) {\r\n            t.min = t2;\r\n        }\r\n        if (t1 < t.max) {\r\n            t.max = t1;\r\n        }\r\n    } else {\r\n        // t1 is near intersect, t2 is far.\r\n        if (t1 > t.min) {\r\n            t.min = t1;\r\n        }\r\n        if (t2 < t.max) {\r\n            t.max = t2;\r\n        }\r\n    }\r\n    return t.min <= t.max && t.max >= 0;\r\n}\r\n\r\nconst tmpVec = new Vector3();\r\nconst tmpT = { min: -Infinity, max: Infinity };\r\n\r\nexport class OrientedBox3 implements OrientedBox3Like {\r\n    /**\r\n     * The position of the center of this `OrientedBox3`.\r\n     */\r\n    readonly position = new Vector3();\r\n\r\n    /**\r\n     * The x-axis of this `OrientedBox3`.\r\n     */\r\n    readonly xAxis = new Vector3(1, 0, 0);\r\n\r\n    /**\r\n     * The y-axis of this `OrientedBox3`.\r\n     */\r\n    readonly yAxis = new Vector3(0, 1, 0);\r\n\r\n    /**\r\n     * The z-axis of this `OrientedBox3`.\r\n     */\r\n    readonly zAxis = new Vector3(0, 0, 1);\r\n\r\n    /**\r\n     * The extents of this `OrientedBox3`.\r\n     */\r\n    readonly extents = new Vector3();\r\n\r\n    /**\r\n     * Creates a new `OrientedBox3`.\r\n     */\r\n    constructor();\r\n\r\n    /**\r\n     * Creates a new `OrientedBox3` with the given position, orientation and extents.\r\n     *\r\n     * @param position - The position of the center of the `OrientedBox3`.\r\n     * @param rotationMatrix - The rotation of the `OrientedBox3`.\r\n     * @param extents - The extents of the `OrientedBox3`.\r\n     */\r\n    constructor(position: Vector3, rotationMatrix: Matrix4, extents: Vector3);\r\n\r\n    /**\r\n     * Creates a new `OrientedBox3`.\r\n     *\r\n     * @hideconstructor\r\n     */\r\n    constructor(position?: Vector3, rotationMatrix?: Matrix4, extents?: Vector3) {\r\n        if (position !== undefined) {\r\n            this.position.copy(position);\r\n        }\r\n\r\n        if (rotationMatrix !== undefined) {\r\n            rotationMatrix.extractBasis(this.xAxis, this.yAxis, this.zAxis);\r\n        }\r\n\r\n        if (extents !== undefined) {\r\n            this.extents.copy(extents);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create a copy of this [[OrientedBoundingBox]].\r\n     */\r\n    clone(): OrientedBox3 {\r\n        const newBox = new OrientedBox3();\r\n        newBox.copy(this);\r\n        return newBox;\r\n    }\r\n\r\n    /**\r\n     * Copies the values of `other` to this {@link OrientedBox3}.\r\n     * @param other - The other {@link OrientedBox3} to copy.\r\n     */\r\n    copy(other: OrientedBox3) {\r\n        this.position.copy(other.position);\r\n        this.xAxis.copy(other.xAxis);\r\n        this.yAxis.copy(other.yAxis);\r\n        this.zAxis.copy(other.zAxis);\r\n        this.extents.copy(other.extents);\r\n    }\r\n\r\n    /**\r\n     * Gets the center position of this {@link OrientedBox3}.\r\n     *\r\n     * @param center - The returned center position.\r\n     */\r\n    getCenter(center = new Vector3()): Vector3 {\r\n        return center.copy(this.position);\r\n    }\r\n\r\n    /**\r\n     * Gets the size of this {@link OrientedBox3}.\r\n     *\r\n     * @param size - The returned size.\r\n     */\r\n    getSize(size = new Vector3()): Vector3 {\r\n        return size.copy(this.extents).multiplyScalar(2);\r\n    }\r\n\r\n    /**\r\n     * Gets the orientation matrix of this `OrientedBox3`.\r\n     * @param matrix - The output orientation matrix.\r\n     */\r\n    getRotationMatrix(matrix: Matrix4 = new Matrix4()): Matrix4 {\r\n        return matrix.makeBasis(this.xAxis, this.yAxis, this.zAxis);\r\n    }\r\n\r\n    /**\r\n     * Checks intersection with the given `THREE.Frustum` or array of `THREE.Plane`s.\r\n     *\r\n     * @param frustumOrPlanes - Frustum or array of planes.\r\n     */\r\n    intersects(frustumOrPlanes: Plane[] | Frustum): boolean {\r\n        const planes: Plane[] = Array.isArray(frustumOrPlanes)\r\n            ? frustumOrPlanes\r\n            : frustumOrPlanes.planes;\r\n\r\n        for (const plane of planes) {\r\n            const r =\r\n                Math.abs(plane.normal.dot(this.xAxis) * this.extents.x) +\r\n                Math.abs(plane.normal.dot(this.yAxis) * this.extents.y) +\r\n                Math.abs(plane.normal.dot(this.zAxis) * this.extents.z);\r\n\r\n            const d = plane.distanceToPoint(this.position);\r\n\r\n            if (d + r < 0) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Checks intersection with the given ray.\r\n     *\r\n     * @param ray - The ray to test.\r\n     * @returns distance from ray origin to intersection point if it exist, undefined otherwise.\r\n     */\r\n    intersectsRay(ray: Ray): number | undefined {\r\n        // Slabs intersection algorithm.\r\n        tmpT.min = -Infinity;\r\n        tmpT.max = Infinity;\r\n        tmpVec.copy(this.position).sub(ray.origin);\r\n        if (!intersectsSlab(ray.direction, tmpVec, this.xAxis, this.extents.x, tmpT)) {\r\n            return undefined;\r\n        }\r\n        if (!intersectsSlab(ray.direction, tmpVec, this.yAxis, this.extents.y, tmpT)) {\r\n            return undefined;\r\n        }\r\n        if (!intersectsSlab(ray.direction, tmpVec, this.zAxis, this.extents.z, tmpT)) {\r\n            return undefined;\r\n        }\r\n\r\n        return tmpT.min > 0 ? tmpT.min : tmpT.max;\r\n    }\r\n\r\n    /**\r\n     * Returns true if this {@link OrientedBox3} contains the given point.\r\n     *\r\n     * @param point - A valid point.\r\n     */\r\n    contains(point: Vector3): boolean {\r\n        const dx = point.x - this.position.x;\r\n        const dy = point.y - this.position.y;\r\n        const dz = point.z - this.position.z;\r\n        const x = Math.abs(dx * this.xAxis.x + dy * this.xAxis.y + dz * this.xAxis.z);\r\n        const y = Math.abs(dx * this.yAxis.x + dy * this.yAxis.y + dz * this.yAxis.z);\r\n        const z = Math.abs(dx * this.zAxis.x + dy * this.zAxis.y + dz * this.zAxis.z);\r\n        if (x > this.extents.x || y > this.extents.y || z > this.extents.z) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Returns the distance from this {@link OrientedBox3} and the given `point`.\r\n     *\r\n     * @param point - A point.\r\n     */\r\n    distanceToPoint(point: Vector3): number {\r\n        return Math.sqrt(this.distanceToPointSquared(point));\r\n    }\r\n\r\n    /**\r\n     * Returns the squared distance from this {@link OrientedBox3} and the given `point`.\r\n     *\r\n     * @param point - A point.\r\n     */\r\n    distanceToPointSquared(point: Vector3): number {\r\n        const d = new Vector3();\r\n        d.subVectors(point, this.position);\r\n\r\n        const lengths = [d.dot(this.xAxis), d.dot(this.yAxis), d.dot(this.zAxis)];\r\n\r\n        let result = 0;\r\n\r\n        for (let i = 0; i < 3; ++i) {\r\n            const length = lengths[i];\r\n            const extent = this.extents.getComponent(i);\r\n            if (length < -extent) {\r\n                const dd = extent + length;\r\n                result += dd * dd;\r\n            } else if (length > extent) {\r\n                const dd = length - extent;\r\n                result += dd * dd;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { TransformLike } from \"./TransformLike\";\r\nimport { Vector3Like } from \"./Vector3Like\";\r\n\r\n/**\r\n * The interface {@link OrientedBox3Like} is used to represent oriented bounding box.\r\n */\r\nexport interface OrientedBox3Like extends TransformLike {\r\n    /**\r\n     * The extents of this bounding box.\r\n     */\r\n    readonly extents: Vector3Like;\r\n}\r\n\r\n/**\r\n * Returns true if the given object implements the interface {@link OrientedBox3Like}.\r\n *\r\n * @param object - The object.\r\n */\r\nexport function isOrientedBox3Like(object: {}): object is OrientedBox3Like {\r\n    const obb = object as Partial<OrientedBox3Like>;\r\n    return (\r\n        obb.position !== undefined &&\r\n        obb.xAxis !== undefined &&\r\n        obb.yAxis !== undefined &&\r\n        obb.zAxis !== undefined &&\r\n        obb.extents !== undefined\r\n    );\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Vector3Like } from \"./Vector3Like\";\r\n\r\n/**\r\n * The interface {@link TransformLike} is used to represent transforms with\r\n * only translation and rotation.\r\n */\r\nexport interface TransformLike {\r\n    /**\r\n     * The position of this transform.\r\n     */\r\n    readonly position: Vector3Like;\r\n\r\n    /**\r\n     * The x-axis of this transform.\r\n     */\r\n    readonly xAxis: Vector3Like;\r\n\r\n    /**\r\n     * The y-axis of this transform.\r\n     */\r\n    readonly yAxis: Vector3Like;\r\n\r\n    /**\r\n     * The z-axis of this transform.\r\n     */\r\n    readonly zAxis: Vector3Like;\r\n}\r\n\r\n/**\r\n * Returns true if the given object implements the interface {@link TransformLike}.\r\n *\r\n * @param object - The object.\r\n */\r\nexport function isTransformLike(object: {}): object is TransformLike {\r\n    const transform = object as Partial<TransformLike>;\r\n    return (\r\n        transform.position !== undefined &&\r\n        transform.xAxis !== undefined &&\r\n        transform.yAxis !== undefined &&\r\n        transform.zAxis !== undefined\r\n    );\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Interface representing a Vector2.\r\n */\r\nexport interface Vector2Like {\r\n    /**\r\n     * The X position.\r\n     */\r\n    x: number;\r\n\r\n    /**\r\n     * The Y position.\r\n     */\r\n    y: number;\r\n}\r\n\r\nexport function isVector2Like(v: any): v is Vector2Like {\r\n    return v && typeof v.x === \"number\" && typeof v.y === \"number\";\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Interface representing a Vector3.\r\n */\r\nexport interface Vector3Like {\r\n    /**\r\n     * The X position.\r\n     */\r\n    x: number;\r\n\r\n    /**\r\n     * The Y position.\r\n     */\r\n    y: number;\r\n\r\n    /**\r\n     * The Z position.\r\n     */\r\n    z: number;\r\n}\r\n\r\nexport function isVector3Like(v: any): v is Vector3Like {\r\n    return v && typeof v.x === \"number\" && typeof v.y === \"number\" && typeof v.z === \"number\";\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport class EarthConstants {\r\n    /** The equatorial circumference in meters. */\r\n    static EQUATORIAL_CIRCUMFERENCE: number = 40075016.6855784861531768177614;\r\n\r\n    /** The equatorial radius in meters. */\r\n    static EQUATORIAL_RADIUS: number = 6378137.0;\r\n\r\n    /** The lowest point on earth (Dead Sea) in meters. */\r\n    static MIN_ELEVATION: number = -433.0;\r\n\r\n    /** The highest point on earth (Mt. Everest) in meters. */\r\n    static MAX_ELEVATION: number = 8848.0;\r\n\r\n    /** The highest artificial structure (building) on earth, Burj Khalifa tower in Dubai */\r\n    static MAX_BUILDING_HEIGHT: number = 828;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinates } from \"../coordinates/GeoCoordinates\";\r\nimport { GeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Box3Like, isBox3Like } from \"../math/Box3Like\";\r\nimport { MathUtils } from \"../math/MathUtils\";\r\nimport { isOrientedBox3Like, OrientedBox3Like } from \"../math/OrientedBox3Like\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\nimport { EarthConstants } from \"./EarthConstants\";\r\nimport { Projection, ProjectionType } from \"./Projection\";\r\n\r\nclass EquirectangularProjection extends Projection {\r\n    static geoToWorldScale: number = 1.0 / (2.0 * Math.PI);\r\n    static worldToGeoScale: number = (2.0 * Math.PI) / 1.0;\r\n\r\n    /** @override */\r\n    readonly type: ProjectionType = ProjectionType.Planar;\r\n\r\n    /** @override */\r\n    getScaleFactor(_worldPoint: Vector3Like): number {\r\n        return 1;\r\n    }\r\n\r\n    /** @override */\r\n    worldExtent<WorldBoundingBox extends Box3Like>(\r\n        minAltitude: number,\r\n        maxAltitude: number,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        result.min.x = 0.0;\r\n        result.min.y = 0.0;\r\n        result.min.z = minAltitude;\r\n        result.max.x = this.unitScale;\r\n        result.max.y = this.unitScale / 2;\r\n        result.max.z = maxAltitude;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    projectPoint<WorldCoordinates extends Vector3Like>(\r\n        geoPoint: GeoCoordinatesLike,\r\n        result?: WorldCoordinates\r\n    ): WorldCoordinates {\r\n        if (result === undefined) {\r\n            result = { x: 0, y: 0, z: 0 } as WorldCoordinates;\r\n        }\r\n        result.x =\r\n            (THREE.MathUtils.degToRad(geoPoint.longitude) + Math.PI) *\r\n            EquirectangularProjection.geoToWorldScale *\r\n            this.unitScale;\r\n        result.y =\r\n            (THREE.MathUtils.degToRad(geoPoint.latitude) + Math.PI * 0.5) *\r\n            EquirectangularProjection.geoToWorldScale *\r\n            this.unitScale;\r\n        result.z = geoPoint.altitude ?? 0;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectPoint(worldPoint: Vector3Like): GeoCoordinates {\r\n        const geoPoint = GeoCoordinates.fromRadians(\r\n            (worldPoint.y * EquirectangularProjection.worldToGeoScale) / this.unitScale -\r\n                Math.PI * 0.5,\r\n            (worldPoint.x * EquirectangularProjection.worldToGeoScale) / this.unitScale - Math.PI,\r\n            worldPoint.z\r\n        );\r\n        return geoPoint;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectAltitude(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    projectBox<WorldBoundingBox extends Box3Like | OrientedBox3Like>(\r\n        geoBox: GeoBox,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        const worldCenter = this.projectPoint(\r\n            new GeoCoordinates(geoBox.center.latitude, geoBox.center.longitude, 0)\r\n        );\r\n        const { latitudeSpanInRadians, longitudeSpanInRadians, altitudeSpan } = geoBox;\r\n        const sizeX = longitudeSpanInRadians * EquirectangularProjection.geoToWorldScale;\r\n        const sizeY = latitudeSpanInRadians * EquirectangularProjection.geoToWorldScale;\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        if (isBox3Like(result)) {\r\n            result.min.x = worldCenter.x - sizeX * 0.5 * this.unitScale;\r\n            result.min.y = worldCenter.y - sizeY * 0.5 * this.unitScale;\r\n            result.max.x = worldCenter.x + sizeX * 0.5 * this.unitScale;\r\n            result.max.y = worldCenter.y + sizeY * 0.5 * this.unitScale;\r\n            if (altitudeSpan !== undefined) {\r\n                result.min.z = worldCenter.z - altitudeSpan * 0.5;\r\n                result.max.z = worldCenter.z + altitudeSpan * 0.5;\r\n            } else {\r\n                result.min.z = 0;\r\n                result.max.z = 0;\r\n            }\r\n        } else if (isOrientedBox3Like(result)) {\r\n            MathUtils.newVector3(1, 0, 0, result.xAxis);\r\n            MathUtils.newVector3(0, 1, 0, result.yAxis);\r\n            MathUtils.newVector3(0, 0, 1, result.zAxis);\r\n            result.position.x = worldCenter.x;\r\n            result.position.y = worldCenter.y;\r\n            result.position.z = worldCenter.z;\r\n            result.extents.x = sizeX * 0.5 * this.unitScale;\r\n            result.extents.y = sizeY * 0.5 * this.unitScale;\r\n            result.extents.z = Math.max(Number.EPSILON, (altitudeSpan ?? 0) * 0.5);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectBox(worldBox: Box3Like): GeoBox {\r\n        const minGeo = this.unprojectPoint(worldBox.min);\r\n        const maxGeo = this.unprojectPoint(worldBox.max);\r\n        return GeoBox.fromCoordinates(minGeo, maxGeo);\r\n    }\r\n\r\n    /** @override */\r\n    groundDistance(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    scalePointToSurface(worldPoint: Vector3Like): Vector3Like {\r\n        worldPoint.z = 0;\r\n        return worldPoint;\r\n    }\r\n\r\n    /** @override */\r\n    surfaceNormal(_worldPoint: Vector3Like, normal?: Vector3Like) {\r\n        if (normal === undefined) {\r\n            normal = { x: 0, y: 0, z: 1 };\r\n        } else {\r\n            normal.x = 0;\r\n            normal.y = 0;\r\n            normal.z = 1;\r\n        }\r\n        return normal;\r\n    }\r\n}\r\n\r\n/**\r\n * Equirectangular {@link Projection} used to convert geo coordinates to unit coordinates and vice\r\n * versa.\r\n */\r\nexport const normalizedEquirectangularProjection: Projection = new EquirectangularProjection(1);\r\n\r\n/**\r\n * Equirectangular {@link Projection} used to convert geo coordinates to world coordinates and vice\r\n * versa.\r\n */\r\nexport const equirectangularProjection: Projection = new EquirectangularProjection(\r\n    EarthConstants.EQUATORIAL_CIRCUMFERENCE\r\n);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinates } from \"../coordinates/GeoCoordinates\";\r\nimport { GeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Box3Like, isBox3Like } from \"../math/Box3Like\";\r\nimport { MathUtils } from \"../math/MathUtils\";\r\nimport { isOrientedBox3Like, OrientedBox3Like } from \"../math/OrientedBox3Like\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\nimport { Projection, ProjectionType } from \"./Projection\";\r\n\r\nclass IdentityProjection extends Projection {\r\n    /** @override */\r\n    readonly type: ProjectionType = ProjectionType.Planar;\r\n\r\n    /** @override */\r\n    getScaleFactor(_worldPoint: Vector3Like): number {\r\n        return 1;\r\n    }\r\n\r\n    /** @override */\r\n    worldExtent<WorldBoundingBox extends Box3Like>(\r\n        minAltitude: number,\r\n        maxAltitude: number,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        result.min.x = -Math.PI;\r\n        result.min.y = -Math.PI * 0.5;\r\n        result.min.z = minAltitude;\r\n        result.max.x = Math.PI;\r\n        result.max.y = Math.PI * 0.5;\r\n        result.max.z = maxAltitude;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    projectPoint<WorldCoordinates extends Vector3Like>(\r\n        geoPoint: GeoCoordinatesLike,\r\n        result?: WorldCoordinates\r\n    ): WorldCoordinates {\r\n        if (!result) {\r\n            result = { x: 0, y: 0, z: 0 } as WorldCoordinates;\r\n        }\r\n        result.x = THREE.MathUtils.degToRad(geoPoint.longitude);\r\n        result.y = THREE.MathUtils.degToRad(geoPoint.latitude);\r\n        result.z = geoPoint.altitude ?? 0;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectPoint(worldPoint: Vector3Like): GeoCoordinates {\r\n        const geoPoint = GeoCoordinates.fromRadians(worldPoint.y, worldPoint.x, worldPoint.z);\r\n        return geoPoint;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectAltitude(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    projectBox<WorldBoundingBox extends Box3Like | OrientedBox3Like>(\r\n        geoBox: GeoBox,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        const min = this.projectPoint(\r\n            new GeoCoordinates(geoBox.south, geoBox.west, geoBox.minAltitude)\r\n        );\r\n        const max = this.projectPoint(\r\n            new GeoCoordinates(geoBox.north, geoBox.east, geoBox.maxAltitude)\r\n        );\r\n        if (isBox3Like(result)) {\r\n            result.min.x = min.x;\r\n            result.min.y = min.y;\r\n            result.min.z = min.z;\r\n            result.max.x = max.x;\r\n            result.max.y = max.y;\r\n            result.max.z = max.z;\r\n        } else if (isOrientedBox3Like(result)) {\r\n            MathUtils.newVector3(1, 0, 0, result.xAxis);\r\n            MathUtils.newVector3(0, 1, 0, result.yAxis);\r\n            MathUtils.newVector3(0, 0, 1, result.zAxis);\r\n            result.position.x = (min.x + max.x) * 0.5;\r\n            result.position.y = (min.y + max.y) * 0.5;\r\n            result.position.z = (min.z + max.z) * 0.5;\r\n            result.extents.x = (max.x - min.x) * 0.5;\r\n            result.extents.y = (max.y - min.y) * 0.5;\r\n            result.extents.z = Math.max(Number.EPSILON, (max.z - min.z) * 0.5);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectBox(worldBox: Box3Like): GeoBox {\r\n        const minGeo = this.unprojectPoint(worldBox.min);\r\n        const maxGeo = this.unprojectPoint(worldBox.max);\r\n        return GeoBox.fromCoordinates(minGeo, maxGeo);\r\n    }\r\n\r\n    /** @override */\r\n    groundDistance(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    scalePointToSurface(worldPoint: Vector3Like): Vector3Like {\r\n        worldPoint.z = 0;\r\n        return worldPoint;\r\n    }\r\n\r\n    /** @override */\r\n    surfaceNormal(_worldPoint: Vector3Like, normal?: Vector3Like) {\r\n        if (normal === undefined) {\r\n            normal = { x: 0, y: 0, z: 1 };\r\n        } else {\r\n            normal.x = 0;\r\n            normal.y = 0;\r\n            normal.z = 1;\r\n        }\r\n        return normal;\r\n    }\r\n}\r\n\r\n/**\r\n * Identity {@link Projection} used to convert geo coordinates to unit coordinates and vice versa.\r\n */\r\nexport const identityProjection: Projection = new IdentityProjection(1);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinates } from \"../coordinates/GeoCoordinates\";\r\nimport { GeoCoordinatesLike, isGeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Box3Like, isBox3Like } from \"../math/Box3Like\";\r\nimport { MathUtils } from \"../math/MathUtils\";\r\nimport { isOrientedBox3Like, OrientedBox3Like } from \"../math/OrientedBox3Like\";\r\nimport { TransformLike } from \"../math/TransformLike\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\nimport { EarthConstants } from \"./EarthConstants\";\r\nimport { Projection, ProjectionType } from \"./Projection\";\r\n\r\nclass MercatorProjection extends Projection {\r\n    protected static clamp(val: number, min: number, max: number): number {\r\n        return Math.min(Math.max(min, val), max);\r\n    }\r\n\r\n    protected static latitudeClamp(latitude: number): number {\r\n        return MercatorProjection.clamp(\r\n            latitude,\r\n            -MercatorConstants.MAXIMUM_LATITUDE,\r\n            MercatorConstants.MAXIMUM_LATITUDE\r\n        );\r\n    }\r\n\r\n    private static latitudeProject(latitude: number): number {\r\n        return Math.log(Math.tan(Math.PI * 0.25 + latitude * 0.5)) / Math.PI;\r\n    }\r\n\r\n    private static latitudeClampProject(latitude: number): number {\r\n        return MercatorProjection.latitudeProject(MercatorProjection.latitudeClamp(latitude));\r\n    }\r\n\r\n    private static unprojectLatitude(y: number): number {\r\n        return 2.0 * Math.atan(Math.exp(Math.PI * y)) - Math.PI * 0.5;\r\n    }\r\n\r\n    /** @override */\r\n    readonly type: ProjectionType = ProjectionType.Planar;\r\n\r\n    /** @override */\r\n    getScaleFactor(worldPoint: Vector3Like): number {\r\n        return Math.cosh(2 * Math.PI * (worldPoint.y / this.unitScale - 0.5));\r\n    }\r\n\r\n    /** @override */\r\n    worldExtent<WorldBoundingBox extends Box3Like>(\r\n        minAltitude: number,\r\n        maxAltitude: number,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        result.min.x = 0;\r\n        result.min.y = 0;\r\n        result.min.z = minAltitude;\r\n        result.max.x = this.unitScale;\r\n        result.max.y = this.unitScale;\r\n        result.max.z = maxAltitude;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    projectPoint<WorldCoordinates extends Vector3Like>(\r\n        geoPointLike: GeoCoordinatesLike,\r\n        result?: WorldCoordinates\r\n    ): WorldCoordinates {\r\n        let geoPoint: GeoCoordinates;\r\n\r\n        if (geoPointLike instanceof GeoCoordinates) {\r\n            geoPoint = geoPointLike;\r\n        } else {\r\n            geoPoint = new GeoCoordinates(\r\n                geoPointLike.latitude,\r\n                geoPointLike.longitude,\r\n                geoPointLike.altitude\r\n            );\r\n        }\r\n\r\n        if (!result) {\r\n            result = { x: 0, y: 0, z: 0 } as WorldCoordinates;\r\n        }\r\n        result.x = ((geoPoint.longitude + 180) / 360) * this.unitScale;\r\n        result.y =\r\n            (MercatorProjection.latitudeClampProject(geoPoint.latitudeInRadians) * 0.5 + 0.5) *\r\n            this.unitScale;\r\n        result.z = geoPoint.altitude ?? 0;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectPoint(worldPoint: Vector3Like): GeoCoordinates {\r\n        const geoPoint = GeoCoordinates.fromRadians(\r\n            MercatorProjection.unprojectLatitude((worldPoint.y / this.unitScale - 0.5) * 2.0),\r\n            (worldPoint.x / this.unitScale) * 2 * Math.PI - Math.PI,\r\n            worldPoint.z\r\n        );\r\n        return geoPoint;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectAltitude(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    projectBox<WorldBoundingBox extends Box3Like | OrientedBox3Like>(\r\n        geoBox: GeoBox,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        const worldCenter = this.projectPoint(geoBox.center);\r\n        const worldNorth =\r\n            (MercatorProjection.latitudeClampProject(geoBox.northEast.latitudeInRadians) * 0.5 +\r\n                0.5) *\r\n            this.unitScale;\r\n        const worldSouth =\r\n            (MercatorProjection.latitudeClampProject(geoBox.southWest.latitudeInRadians) * 0.5 +\r\n                0.5) *\r\n            this.unitScale;\r\n        const worldYCenter = (worldNorth + worldSouth) * 0.5;\r\n\r\n        worldCenter.y = worldYCenter;\r\n\r\n        const latitudeSpan = worldNorth - worldSouth;\r\n        const longitudeSpan = (geoBox.longitudeSpan / 360) * this.unitScale;\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        if (isBox3Like(result)) {\r\n            result.min.x = worldCenter.x - longitudeSpan * 0.5;\r\n            result.min.y = worldCenter.y - latitudeSpan * 0.5;\r\n            result.max.x = worldCenter.x + longitudeSpan * 0.5;\r\n            result.max.y = worldCenter.y + latitudeSpan * 0.5;\r\n            const altitudeSpan = geoBox.altitudeSpan;\r\n            if (altitudeSpan !== undefined) {\r\n                result.min.z = worldCenter.z - altitudeSpan * 0.5;\r\n                result.max.z = worldCenter.z + altitudeSpan * 0.5;\r\n            } else {\r\n                result.min.z = 0;\r\n                result.max.z = 0;\r\n            }\r\n        } else if (isOrientedBox3Like(result)) {\r\n            MathUtils.newVector3(1, 0, 0, result.xAxis);\r\n            MathUtils.newVector3(0, 1, 0, result.yAxis);\r\n            MathUtils.newVector3(0, 0, 1, result.zAxis);\r\n            result.position.x = worldCenter.x;\r\n            result.position.y = worldCenter.y;\r\n            result.position.z = worldCenter.z;\r\n            result.extents.x = longitudeSpan * 0.5;\r\n            result.extents.y = latitudeSpan * 0.5;\r\n            result.extents.z = Math.max(Number.EPSILON, (geoBox.altitudeSpan ?? 0) * 0.5);\r\n        } else {\r\n            throw new Error(\"invalid bounding box\");\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectBox(worldBox: Box3Like): GeoBox {\r\n        const minGeo = this.unprojectPoint(worldBox.min);\r\n        const maxGeo = this.unprojectPoint(worldBox.max);\r\n        const geoBox = GeoBox.fromCoordinates(minGeo, maxGeo);\r\n        return geoBox;\r\n    }\r\n\r\n    /** @override */\r\n    groundDistance(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    scalePointToSurface(worldPoint: Vector3Like): Vector3Like {\r\n        worldPoint.z = 0;\r\n        return worldPoint;\r\n    }\r\n\r\n    /** @override */\r\n    surfaceNormal(_worldPoint: Vector3Like, normal?: Vector3Like) {\r\n        if (normal === undefined) {\r\n            normal = { x: 0, y: 0, z: 1 };\r\n        } else {\r\n            normal.x = 0;\r\n            normal.y = 0;\r\n            normal.z = 1;\r\n        }\r\n        return normal;\r\n    }\r\n\r\n    /** @override */\r\n    reprojectPoint(\r\n        sourceProjection: Projection,\r\n        worldPos: Vector3Like,\r\n        result?: Vector3Like\r\n    ): Vector3Like {\r\n        // this implementation of [[reprojectPoint]] supports both\r\n        // [[WebMercatorProjection]] and [[MercatorProjection]]. The only\r\n        // difference betweeen these two variants of WEB Mercator\r\n        // is in the orientation of the Y axis, so we just flip Y coordinates\r\n        // when reprojecting between them.\r\n        if (\r\n            sourceProjection !== this &&\r\n            (sourceProjection === webMercatorProjection || sourceProjection === mercatorProjection)\r\n        ) {\r\n            if (result === undefined) {\r\n                result = {} as Vector3Like;\r\n            }\r\n\r\n            result.x = worldPos.x;\r\n            result.y = this.unitScale - worldPos.y;\r\n            result.z = worldPos.z;\r\n\r\n            return result;\r\n        }\r\n\r\n        return super.reprojectPoint(sourceProjection, worldPos, result!);\r\n    }\r\n}\r\n\r\nclass WebMercatorProjection extends MercatorProjection {\r\n    /** @override */\r\n    projectPoint<WorldCoordinates extends Vector3Like>(\r\n        geoPointLike: GeoCoordinatesLike,\r\n        result?: WorldCoordinates\r\n    ): WorldCoordinates {\r\n        let geoPoint: GeoCoordinates;\r\n\r\n        if (geoPointLike instanceof GeoCoordinates) {\r\n            geoPoint = geoPointLike;\r\n        } else {\r\n            geoPoint = new GeoCoordinates(\r\n                geoPointLike.latitude,\r\n                geoPointLike.longitude,\r\n                geoPointLike.altitude\r\n            );\r\n        }\r\n\r\n        /*\r\n         * The following tslint:disable is due to the fact that the [[WorldCoordinates]]\r\n         * might be a concrete class which is not available at runtime.\r\n         * Consider the following example:\r\n         *\r\n         *  const x: THREE.Vector3 = new THREE.Vector3(0,0,0);\r\n         *  const result = EquirectangularProjection.projectPoint<THREE.Vector3>(x);\r\n         *\r\n         * Note: type of `result` is Vector3Like and not as expected: THREE.Vector3!\r\n         */\r\n        if (!result) {\r\n            result = { x: 0, y: 0, z: 0 } as WorldCoordinates;\r\n        }\r\n\r\n        result.x = ((geoPoint.longitude + 180) / 360) * this.unitScale;\r\n        const sy = Math.sin(MercatorProjection.latitudeClamp(geoPoint.latitudeInRadians));\r\n        result.y = (0.5 - Math.log((1 + sy) / (1 - sy)) / (4 * Math.PI)) * this.unitScale;\r\n        result.z = geoPoint.altitude ?? 0;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectPoint(worldPoint: Vector3Like): GeoCoordinates {\r\n        const x = worldPoint.x / this.unitScale - 0.5;\r\n        const y = 0.5 - worldPoint.y / this.unitScale;\r\n\r\n        const longitude = 360 * x;\r\n        const latitude = 90 - (360 * Math.atan(Math.exp(-y * 2 * Math.PI))) / Math.PI;\r\n\r\n        return new GeoCoordinates(latitude, longitude, worldPoint.z);\r\n    }\r\n\r\n    /** @override */\r\n    projectBox<WorldBoundingBox extends Box3Like | OrientedBox3Like>(\r\n        geoBox: GeoBox,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        const r = super.projectBox(geoBox, result);\r\n        if (isBox3Like(r)) {\r\n            // Invert the y axis for web mercator, this means that max => min & min => max\r\n            const maxY = r.max.y;\r\n            r.max.y = this.unitScale - r.min.y;\r\n            r.min.y = this.unitScale - maxY;\r\n        } else if (isOrientedBox3Like(r)) {\r\n            MathUtils.newVector3(1, 0, 0, r.xAxis);\r\n            MathUtils.newVector3(0, -1, 0, r.yAxis);\r\n            MathUtils.newVector3(0, 0, -1, r.zAxis);\r\n            r.position.y = this.unitScale - r.position.y;\r\n        }\r\n        return r;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectBox(worldBox: Box3Like): GeoBox {\r\n        const minGeo = this.unprojectPoint(worldBox.min);\r\n        const maxGeo = this.unprojectPoint(worldBox.max);\r\n        const geoBox = new GeoBox(\r\n            new GeoCoordinates(maxGeo.latitude, minGeo.longitude, minGeo.altitude),\r\n            new GeoCoordinates(minGeo.latitude, maxGeo.longitude, maxGeo.altitude)\r\n        );\r\n        return geoBox;\r\n    }\r\n\r\n    /** @override */\r\n    surfaceNormal(_worldPoint: Vector3Like, normal?: Vector3Like) {\r\n        if (normal === undefined) {\r\n            normal = { x: 0, y: 0, z: -1 };\r\n        } else {\r\n            normal.x = 0;\r\n            normal.y = 0;\r\n            normal.z = -1;\r\n        }\r\n        return normal;\r\n    }\r\n\r\n    /** @override */\r\n    localTangentSpace(\r\n        point: GeoCoordinatesLike | Vector3Like,\r\n        result: TransformLike\r\n    ): TransformLike {\r\n        if (isGeoCoordinatesLike(point)) {\r\n            this.projectPoint(point, result.position);\r\n        } else {\r\n            MathUtils.copyVector3(point, result.position);\r\n        }\r\n        MathUtils.newVector3(1, 0, 0, result.xAxis);\r\n        MathUtils.newVector3(0, -1, 0, result.yAxis);\r\n        MathUtils.newVector3(0, 0, -1, result.zAxis);\r\n        return result;\r\n    }\r\n}\r\n\r\nexport class MercatorConstants {\r\n    // Math.atan(Math.sinh(Math.PI))\r\n    static readonly MAXIMUM_LATITUDE: number = 1.4844222297453323;\r\n}\r\n\r\n/**\r\n * Mercator {@link Projection} used to convert geo coordinates to world coordinates and vice versa.\r\n */\r\nexport const mercatorProjection: Projection = new MercatorProjection(\r\n    EarthConstants.EQUATORIAL_CIRCUMFERENCE\r\n);\r\n\r\n/**\r\n * Web Mercator {@link Projection} used to convert geo coordinates to world coordinates\r\n * and vice versa.\r\n */\r\nexport const webMercatorProjection: Projection = new WebMercatorProjection(\r\n    EarthConstants.EQUATORIAL_CIRCUMFERENCE\r\n);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinates } from \"../coordinates/GeoCoordinates\";\r\nimport { GeoCoordinatesLike, isGeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Box3Like } from \"../math/Box3Like\";\r\nimport { MathUtils } from \"../math/MathUtils\";\r\nimport { OrientedBox3Like } from \"../math/OrientedBox3Like\";\r\nimport { TransformLike } from \"../math/TransformLike\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\n\r\n/**\r\n * The type of projection.\r\n */\r\nexport enum ProjectionType {\r\n    /**\r\n     * A type of [Projection] with zero curvature.\r\n     */\r\n    Planar,\r\n\r\n    /**\r\n     * A spherical [Projection].\r\n     */\r\n    Spherical\r\n}\r\n\r\n/**\r\n * `Projection` is used to convert positions from geo coordinates to world coordinates and vice\r\n * versa.\r\n */\r\nexport abstract class Projection {\r\n    /**\r\n     * The type of this [Projection].\r\n     */\r\n    abstract get type(): ProjectionType;\r\n\r\n    /**\r\n     * Constructs the Projection\r\n     *\r\n     * @param unitScale - How to transform the projected coordinates to world units.\r\n     */\r\n    constructor(readonly unitScale: number) {\r\n        //Prevent empty constructor error.\r\n    }\r\n\r\n    /**\r\n     * Returns the world extents in world coordinates.\r\n     *\r\n     * @param minElevation - The minimum elevation in meters.\r\n     * @param maxElevation - The maximum elevation in meters.\r\n     * @param result - The optional object that will be used to create the resulting bounding box.\r\n     */\r\n    abstract worldExtent<Bounds extends Box3Like>(\r\n        minElevation: number,\r\n        maxElevation: number,\r\n        result?: Bounds\r\n    ): Bounds;\r\n\r\n    /**\r\n     * Projects a point from geo coordinates (latitude, longitude, altitude) to world coordinates\r\n     * (x,y,z).\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const worldPos = new THREE.Vector3();\r\n     * projection.projectPoint(geoPos, worldPos);\r\n     * ```\r\n     *\r\n     * @param geoPoint - The position in geo coordinates.\r\n     * @param result - The optional object used to store the resulting world position, result must\r\n     * implement {@link Vector3Like}.\r\n     */\r\n    abstract projectPoint<WorldCoordinates extends Vector3Like>(\r\n        geoPoint: GeoCoordinatesLike,\r\n        result?: WorldCoordinates\r\n    ): WorldCoordinates;\r\n\r\n    /**\r\n     * Gets the {@link TransformLike} of the local tangent space at the given point.\r\n     *\r\n     * @param point - The geo / world coordinates.\r\n     * @param result - The {@link TransformLike}.\r\n     */\r\n    localTangentSpace(\r\n        point: GeoCoordinatesLike | Vector3Like,\r\n        result: TransformLike\r\n    ): TransformLike {\r\n        if (isGeoCoordinatesLike(point)) {\r\n            this.projectPoint(point, result.position);\r\n        } else {\r\n            MathUtils.copyVector3(point, result.position);\r\n        }\r\n        MathUtils.newVector3(1, 0, 0, result.xAxis);\r\n        MathUtils.newVector3(0, 1, 0, result.yAxis);\r\n        MathUtils.newVector3(0, 0, 1, result.zAxis);\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Returns the geo coordinates (latitude, longitude, altitude) from the given world position\r\n     * (x,y,z).\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const geoPos = projection.unprojectPoint(worldPos);\r\n     * console.log(geoPos.latitude, geoPos.longitude, geoPos.altitude);\r\n     * ```\r\n     *\r\n     * @param worldPoint - The position in world coordinates.\r\n     */\r\n    abstract unprojectPoint(worldPoint: Vector3Like): GeoCoordinates;\r\n\r\n    /**\r\n     * Returns the altitude at the given world position (x,y,z) in meters.\r\n     *\r\n     * @param worldPoint - The position in world coordinates.\r\n     */\r\n    abstract unprojectAltitude(worldPoint: Vector3Like): number;\r\n\r\n    /**\r\n     * Projects bounds in geo coordinates to a bounding box in world coordinates.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const bounds = projection.projectBox(geoBox);\r\n     * console.log(bounds.min, bounds.max);\r\n     * ```\r\n     *\r\n     * @param geoBox - The bounding box in geo coordinates.\r\n     */\r\n    abstract projectBox(geoBox: GeoBox): Box3Like;\r\n\r\n    /**\r\n     * Projects bounds in geo coordinates to a bounding box in world coordinates.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const bounds = projection.projectBox(geoBox, new THREE.Box3());\r\n     * console.log(bounds.min, bounds.max);\r\n     * ```\r\n     *\r\n     * @param geoBox - The bounding box in geo coordinates.\r\n     * @param result - The resulting {@link OrientedBox3Like}.\r\n     */\r\n    abstract projectBox<WorldBoundingBox extends Box3Like | OrientedBox3Like>(\r\n        geoBox: GeoBox,\r\n        result: WorldBoundingBox\r\n    ): WorldBoundingBox;\r\n\r\n    /**\r\n     * Converts a bounding box in world coordinates to a bounding box in geo coordinates.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const geoPos = projection.unprojectPoint(worldPos);\r\n     * console.log(geoPos.latitude, geoPos.longitude, geoPos.altitude);\r\n     * ```\r\n     *\r\n     * @param worldBox - The bounding box in world coordinates.\r\n     */\r\n    abstract unprojectBox(worldBox: Box3Like): GeoBox;\r\n\r\n    /**\r\n     * Returns the scaling factor that must be used to convert the units used by `worldPoint` to\r\n     * meters.\r\n     *\r\n     * @param worldPoint - The position in world coordinates.\r\n     */\r\n    abstract getScaleFactor(worldPoint: Vector3Like): number;\r\n\r\n    /**\r\n     * Returns the surface normal at the given world position.\r\n     *\r\n     * @param worldPoint - The position in world coordinates.\r\n     */\r\n    abstract surfaceNormal(worldPoint: Vector3Like): Vector3Like;\r\n\r\n    /**\r\n     * Returns the surface normal at the given world position.\r\n     *\r\n     * @param worldPoint - The position in world coordinates.\r\n     * @returns The resulting normal vector.\r\n     */\r\n    abstract surfaceNormal<Normal extends Vector3Like>(\r\n        worldPoint: Vector3Like,\r\n        result: Normal\r\n    ): Normal;\r\n\r\n    /**\r\n     * Returns the signed distance between the given coordinates and\r\n     * the closest point on the surface.\r\n     *\r\n     * @param worldPoint - The position in world coordinates.\r\n     */\r\n    abstract groundDistance(worldPoint: Vector3Like): number;\r\n\r\n    /**\r\n     * Scales the given world coordinates to the surface.\r\n     *\r\n     * @param worldPoint - The position in world coordinates.\r\n     */\r\n    abstract scalePointToSurface(worldPoint: Vector3Like): Vector3Like;\r\n\r\n    /**\r\n     * Reproject a world position from the given source {@link Projection}.\r\n     *\r\n     * @param sourceProjection - The source projection.\r\n     * @param worldPos - A valid world position for the given source projection.\r\n     * @returns The world position reprojected using this {@link Projection}.\r\n     */\r\n    reprojectPoint(sourceProjection: Projection, worldPos: Vector3Like): Vector3Like;\r\n\r\n    /**\r\n     * Reproject a world position from the given source {@link Projection}.\r\n     *\r\n     * @param sourceProjection - The source projection.\r\n     * @param worldPos - A valid position in the world space defined by the source projection.\r\n     * @param result - The resulting position reprojected using this {@link Projection}.\r\n     */\r\n    reprojectPoint<WorldCoordinates extends Vector3Like>(\r\n        sourceProjection: Projection,\r\n        worldPos: Vector3Like,\r\n        result: WorldCoordinates\r\n    ): WorldCoordinates;\r\n\r\n    /**\r\n     * Reproject a world position from the given source {@link Projection}.\r\n     * Implementations should be aware of worldPos and result may be one object\r\n     *\r\n     * @param sourceProjection - The source projection.\r\n     * @param worldPos - A valid position in the world space defined by the source projection.\r\n     * @param result - The resulting position reprojected using this {@link Projection}.\r\n     * @hidden\r\n     */\r\n    reprojectPoint(\r\n        sourceProjection: Projection,\r\n        worldPos: Vector3Like,\r\n        result?: Vector3Like\r\n    ): Vector3Like {\r\n        if (sourceProjection === this) {\r\n            if (result === undefined) {\r\n                return { x: worldPos.x, y: worldPos.y, z: worldPos.z };\r\n            }\r\n            result.x = worldPos.x;\r\n            result.y = worldPos.y;\r\n            result.z = worldPos.z;\r\n            return result;\r\n        }\r\n        return this.projectPoint(sourceProjection.unprojectPoint(worldPos), result);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinates } from \"../coordinates/GeoCoordinates\";\r\nimport { GeoCoordinatesLike, isGeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Box3Like, isBox3Like } from \"../math/Box3Like\";\r\nimport { MathUtils } from \"../math/MathUtils\";\r\nimport { isOrientedBox3Like, OrientedBox3Like } from \"../math/OrientedBox3Like\";\r\nimport { TransformLike } from \"../math/TransformLike\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\nimport { EarthConstants } from \"./EarthConstants\";\r\nimport { mercatorProjection, webMercatorProjection } from \"./MercatorProjection\";\r\nimport { Projection, ProjectionType } from \"./Projection\";\r\n\r\n/**\r\n * Transforms the given vector using the provided basis.\r\n */\r\nfunction apply(\r\n    xAxis: Vector3Like,\r\n    yAxis: Vector3Like,\r\n    zAxis: Vector3Like,\r\n    v: Vector3Like\r\n): Vector3Like {\r\n    const x = xAxis.x * v.x + yAxis.x * v.y + zAxis.x * v.z;\r\n    const y = xAxis.y * v.x + yAxis.y * v.y + zAxis.y * v.z;\r\n    const z = xAxis.z * v.x + yAxis.z * v.y + zAxis.z * v.z;\r\n    v.x = x;\r\n    v.y = y;\r\n    v.z = z;\r\n    return v;\r\n}\r\n\r\n/**\r\n * Returns the quadrants for the given longitude. The quadrant is defined as:\r\n *  - quadrant(+Math.PI * -1.0) = 0\r\n *  - quadrant(+Math.PI * -0.5) = 1\r\n *  - quadrant(+Math.PI *  0.0) = 2\r\n *  - quadrant(+Math.PI *  0.5) = 3\r\n *  - quadrant(+Math.PI *  1.0) = 4\r\n *\r\n * @param longitude - The longitude in radians.\r\n */\r\nfunction getLongitudeQuadrant(longitude: number) {\r\n    const oneOverPI = 1 / Math.PI;\r\n    const quadrantIndex = Math.floor(2 * (longitude * oneOverPI + 1));\r\n    return THREE.MathUtils.clamp(quadrantIndex, 0, 4);\r\n}\r\n\r\nfunction lengthOfVector3(worldPoint: Vector3Like): number {\r\n    const d = Math.sqrt(\r\n        worldPoint.x * worldPoint.x + worldPoint.y * worldPoint.y + worldPoint.z * worldPoint.z\r\n    );\r\n    return d;\r\n}\r\n\r\n/**\r\n * Creates a Box3 enclosing the geobox.\r\n *\r\n * @param geoBox - Ghe given geobox\r\n * @param worldBox - The resulting axis aligned bounding box.\r\n */\r\nfunction makeBox3<Bounds extends Box3Like>(\r\n    geoBox: GeoBox,\r\n    worldBox: Bounds,\r\n    unitScale: number\r\n): Bounds {\r\n    const halfEquatorialRadius = (unitScale + (geoBox.maxAltitude ?? 0)) * 0.5;\r\n\r\n    const minLongitude = THREE.MathUtils.degToRad(geoBox.west);\r\n    const maxLongitude = THREE.MathUtils.degToRad(geoBox.east);\r\n\r\n    const minLongitudeQuadrant = getLongitudeQuadrant(minLongitude);\r\n    const maxLongitudeQuadrant = getLongitudeQuadrant(maxLongitude);\r\n\r\n    let xMin = Math.cos(minLongitude);\r\n    let xMax = xMin;\r\n    let yMin = Math.sin(minLongitude);\r\n    let yMax = yMin;\r\n\r\n    for (\r\n        let quadrantIndex = minLongitudeQuadrant + 1;\r\n        quadrantIndex <= maxLongitudeQuadrant;\r\n        quadrantIndex++\r\n    ) {\r\n        const x = ((quadrantIndex + 1) & 1) * ((quadrantIndex & 2) - 1);\r\n        xMin = Math.min(x, xMin);\r\n        xMax = Math.max(x, xMax);\r\n\r\n        const y = (quadrantIndex & 1) * ((quadrantIndex & 2) - 1);\r\n        yMin = Math.min(y, yMin);\r\n        yMax = Math.max(y, yMax);\r\n    }\r\n\r\n    const cosMaxLongitude = Math.cos(maxLongitude);\r\n    xMin = Math.min(cosMaxLongitude, xMin);\r\n    xMax = Math.max(cosMaxLongitude, xMax);\r\n\r\n    const sinMaxLongitude = Math.sin(maxLongitude);\r\n    yMin = Math.min(sinMaxLongitude, yMin);\r\n    yMax = Math.max(sinMaxLongitude, yMax);\r\n\r\n    const xCenter = (xMax + xMin) * halfEquatorialRadius;\r\n    const xExtent = (xMax - xMin) * halfEquatorialRadius;\r\n\r\n    const yCenter = (yMax + yMin) * halfEquatorialRadius;\r\n    const yExtent = (yMax - yMin) * halfEquatorialRadius;\r\n\r\n    // Calculate Z boundaries.\r\n    const minLatitude = THREE.MathUtils.degToRad(geoBox.south);\r\n    const maxLatutide = THREE.MathUtils.degToRad(geoBox.north);\r\n\r\n    const zMax = Math.sin(maxLatutide);\r\n    const zMin = Math.sin(minLatitude);\r\n\r\n    const zCenter = (zMax + zMin) * halfEquatorialRadius;\r\n    const zExtent = (zMax - zMin) * halfEquatorialRadius;\r\n\r\n    worldBox.min.x = xCenter - xExtent;\r\n    worldBox.min.y = yCenter - yExtent;\r\n    worldBox.min.z = zCenter - zExtent;\r\n    worldBox.max.x = xCenter + xExtent;\r\n    worldBox.max.y = yCenter + yExtent;\r\n    worldBox.max.z = zCenter + zExtent;\r\n\r\n    return worldBox;\r\n}\r\n\r\n/**\r\n * Computes the spherical projection of the given geo coordinates.\r\n *\r\n * @param geoPoint - The geo coordinates.\r\n * @param worldpoint - The resulting world coordinates.\r\n */\r\nfunction project<WorldCoordinates extends Vector3Like>(\r\n    geoPoint: GeoCoordinatesLike,\r\n    worldpoint: WorldCoordinates,\r\n    unitScale: number\r\n): typeof worldpoint {\r\n    const radius = unitScale + (geoPoint.altitude ?? 0);\r\n    const latitude = THREE.MathUtils.degToRad(geoPoint.latitude);\r\n    const longitude = THREE.MathUtils.degToRad(geoPoint.longitude);\r\n    const cosLatitude = Math.cos(latitude);\r\n    worldpoint.x = radius * cosLatitude * Math.cos(longitude);\r\n    worldpoint.y = radius * cosLatitude * Math.sin(longitude);\r\n    worldpoint.z = radius * Math.sin(latitude);\r\n    return worldpoint;\r\n}\r\n\r\nclass SphereProjection extends Projection {\r\n    /** @override */\r\n    readonly type: ProjectionType = ProjectionType.Spherical;\r\n\r\n    /** @override */\r\n    worldExtent<Bounds extends Box3Like>(\r\n        _minElevation: number,\r\n        maxElevation: number,\r\n        result: Bounds = (new THREE.Box3() as Box3Like) as Bounds\r\n    ): Bounds {\r\n        const radius = this.unitScale + maxElevation;\r\n        result.min.x = -radius;\r\n        result.min.y = -radius;\r\n        result.min.z = -radius;\r\n        result.max.x = radius;\r\n        result.max.y = radius;\r\n        result.max.z = radius;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    projectPoint<WorldCoordinates extends Vector3Like>(\r\n        geoPoint: GeoCoordinatesLike,\r\n        result: WorldCoordinates = MathUtils.newVector3(0, 0, 0) as WorldCoordinates\r\n    ): WorldCoordinates {\r\n        return project(geoPoint, result, this.unitScale);\r\n    }\r\n\r\n    /** @override */\r\n    unprojectPoint(point: Vector3Like): GeoCoordinates {\r\n        const parallelRadiusSq = point.x * point.x + point.y * point.y;\r\n        const parallelRadius = Math.sqrt(parallelRadiusSq);\r\n        const v = point.z / parallelRadius;\r\n\r\n        if (isNaN(v)) {\r\n            return GeoCoordinates.fromRadians(0, 0, -this.unitScale);\r\n        }\r\n\r\n        const radius = Math.sqrt(parallelRadiusSq + point.z * point.z);\r\n\r\n        return GeoCoordinates.fromRadians(\r\n            Math.atan(v),\r\n            Math.atan2(point.y, point.x),\r\n            radius - this.unitScale\r\n        );\r\n    }\r\n\r\n    /** @override */\r\n    unprojectAltitude(point: Vector3Like): number {\r\n        const parallelRadiusSq = point.x * point.x + point.y * point.y + point.z * point.z;\r\n        return Math.sqrt(parallelRadiusSq) - EarthConstants.EQUATORIAL_RADIUS;\r\n    }\r\n\r\n    /** @override */\r\n    projectBox<Bounds extends Box3Like | OrientedBox3Like>(\r\n        geoBox: GeoBox,\r\n        result: Bounds = (new THREE.Box3() as Box3Like) as Bounds\r\n    ): Bounds {\r\n        if (isBox3Like(result)) {\r\n            return makeBox3(geoBox, result, this.unitScale);\r\n        } else if (isOrientedBox3Like(result)) {\r\n            if (geoBox.longitudeSpan >= 90) {\r\n                const bounds = makeBox3(geoBox, new THREE.Box3() as Box3Like, this.unitScale);\r\n                MathUtils.newVector3(1, 0, 0, result.xAxis);\r\n                MathUtils.newVector3(0, 1, 0, result.yAxis);\r\n                MathUtils.newVector3(0, 0, 1, result.zAxis);\r\n                result.position.x = (bounds.max.x + bounds.min.x) * 0.5;\r\n                result.position.y = (bounds.max.y + bounds.min.y) * 0.5;\r\n                result.position.z = (bounds.max.z + bounds.min.z) * 0.5;\r\n                result.extents.x = (bounds.max.x - bounds.min.x) * 0.5;\r\n                result.extents.y = (bounds.max.y - bounds.min.y) * 0.5;\r\n                result.extents.z = (bounds.max.z - bounds.min.z) * 0.5;\r\n                return result;\r\n            }\r\n\r\n            const { south, west, north, east, center: mid } = geoBox;\r\n            const midX = mid.longitude;\r\n            const midY = mid.latitude;\r\n            const cosSouth = Math.cos(THREE.MathUtils.degToRad(south));\r\n            const sinSouth = Math.sin(THREE.MathUtils.degToRad(south));\r\n            const cosWest = Math.cos(THREE.MathUtils.degToRad(west));\r\n            const sinWest = Math.sin(THREE.MathUtils.degToRad(west));\r\n            const cosNorth = Math.cos(THREE.MathUtils.degToRad(north));\r\n            const sinNorth = Math.sin(THREE.MathUtils.degToRad(north));\r\n            const cosEast = Math.cos(THREE.MathUtils.degToRad(east));\r\n            const sinEast = Math.sin(THREE.MathUtils.degToRad(east));\r\n            const cosMidX = Math.cos(THREE.MathUtils.degToRad(midX));\r\n            const sinMidX = Math.sin(THREE.MathUtils.degToRad(midX));\r\n            const cosMidY = Math.cos(THREE.MathUtils.degToRad(midY));\r\n            const sinMidY = Math.sin(THREE.MathUtils.degToRad(midY));\r\n\r\n            // Build the orientation of the OBB using the normal vector and its partial derivates.\r\n\r\n            // the sperical coordinates of the mid point of the geobox.\r\n            MathUtils.newVector3(cosMidX * cosMidY, sinMidX * cosMidY, sinMidY, result.zAxis);\r\n\r\n            // the partial derivates of the normal vector.\r\n            MathUtils.newVector3(-sinMidX, cosMidX, 0, result.xAxis);\r\n            MathUtils.newVector3(-cosMidX * sinMidY, -sinMidX * sinMidY, cosMidY, result.yAxis);\r\n\r\n            let width: number;\r\n            let minY: number;\r\n            let maxY: number;\r\n\r\n            if (south >= 0) {\r\n                // abs(dot(southWest - southEast, xAxis))\r\n                width = Math.abs(\r\n                    cosSouth * (cosMidX * (sinWest - sinEast) + sinMidX * (cosEast - cosWest))\r\n                );\r\n\r\n                // dot(south, yAxis)\r\n                minY = cosMidY * sinSouth - sinMidY * cosSouth;\r\n\r\n                // dot(northEast, zAxis)\r\n                maxY =\r\n                    cosMidY * sinNorth -\r\n                    sinMidY * cosNorth * (cosMidX * cosEast + sinMidX * sinEast);\r\n            } else {\r\n                if (north <= 0) {\r\n                    // abs(dot(northWest - northEast, xAxis))\r\n                    width = Math.abs(\r\n                        cosNorth * (cosMidX * (sinWest - sinEast) + sinMidX * (cosEast - cosWest))\r\n                    );\r\n\r\n                    // dot(north, yAxis)\r\n                    maxY = cosMidY * sinNorth - sinMidY * cosNorth;\r\n                } else {\r\n                    // abs(dot(west - east, xAxis))\r\n                    width = Math.abs(cosMidX * (sinWest - sinEast) + sinMidX * (cosEast - cosWest));\r\n\r\n                    // dot(northEast, yAxis)\r\n                    maxY =\r\n                        cosMidY * sinNorth -\r\n                        sinMidY * cosNorth * (sinMidX * sinEast + cosMidX * cosEast);\r\n                }\r\n\r\n                // dot(southEast, yAxis)\r\n                minY =\r\n                    cosMidY * sinSouth -\r\n                    sinMidY * cosSouth * (cosMidX * cosEast + sinMidX * sinEast);\r\n            }\r\n\r\n            const rMax = (this.unitScale + (geoBox.maxAltitude ?? 0)) * 0.5;\r\n            const rMin = (this.unitScale + (geoBox.minAltitude ?? 0)) * 0.5;\r\n\r\n            // min(dot(southEast, zAxis), dot(northEast, zAxis))\r\n\r\n            const d = cosMidY * (cosMidX * cosEast + sinMidX * sinEast);\r\n\r\n            const minZ = Math.min(\r\n                cosNorth * d + sinNorth * sinMidY,\r\n                cosSouth * d + sinSouth * sinMidY\r\n            );\r\n\r\n            MathUtils.newVector3(\r\n                width * rMax,\r\n                (maxY - minY) * rMax,\r\n                rMax - minZ * rMin,\r\n                result.extents\r\n            );\r\n\r\n            MathUtils.newVector3(0, (minY + maxY) * rMax, rMax + rMax, result.position);\r\n\r\n            apply(result.xAxis, result.yAxis, result.zAxis, result.position);\r\n\r\n            result.position.x = result.position.x - result.zAxis.x * result.extents.z;\r\n            result.position.y = result.position.y - result.zAxis.y * result.extents.z;\r\n            result.position.z = result.position.z - result.zAxis.z * result.extents.z;\r\n\r\n            return result;\r\n        }\r\n\r\n        throw new Error(\"Invalid bounding box\");\r\n    }\r\n\r\n    /** @override */\r\n    unprojectBox(_worldBox: Box3Like): GeoBox {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    /** @override */\r\n    getScaleFactor(_worldPoint: Vector3Like): number {\r\n        return 1;\r\n    }\r\n\r\n    /** @override */\r\n    groundDistance(worldPoint: Vector3Like): number {\r\n        return lengthOfVector3(worldPoint) - this.unitScale;\r\n    }\r\n\r\n    /** @override */\r\n    scalePointToSurface(worldPoint: Vector3Like): Vector3Like {\r\n        const scale = this.unitScale / (lengthOfVector3(worldPoint) || 1);\r\n        worldPoint.x *= scale;\r\n        worldPoint.y *= scale;\r\n        worldPoint.z *= scale;\r\n        return worldPoint;\r\n    }\r\n\r\n    /** @override */\r\n    surfaceNormal(worldPoint: Vector3Like, normal?: Vector3Like) {\r\n        if (normal === undefined) {\r\n            normal = { x: 0, y: 0, z: 0 };\r\n        }\r\n        const scale = 1 / (lengthOfVector3(worldPoint) || 1);\r\n        normal.x = worldPoint.x * scale;\r\n        normal.y = worldPoint.y * scale;\r\n        normal.z = worldPoint.z * scale;\r\n        return normal;\r\n    }\r\n\r\n    /** @override */\r\n    reprojectPoint(\r\n        sourceProjection: Projection,\r\n        worldPos: Vector3Like,\r\n        result?: Vector3Like\r\n    ): Vector3Like {\r\n        if (sourceProjection === mercatorProjection || sourceProjection === webMercatorProjection) {\r\n            const { x, y, z } = worldPos;\r\n            const r = this.unitScale;\r\n            const mx = x / r - Math.PI;\r\n            const my = y / r - Math.PI;\r\n            const w = Math.exp(my);\r\n            const d = w * w;\r\n            const gx = (2 * w) / (d + 1);\r\n            const gy = (d - 1) / (d + 1);\r\n            const scale = r + z;\r\n\r\n            if (result === undefined) {\r\n                result = {} as Vector3Like;\r\n            }\r\n\r\n            result.x = Math.cos(mx) * gx * scale;\r\n            result.y = Math.sin(mx) * gx * scale;\r\n            result.z = gy * scale;\r\n\r\n            if (sourceProjection === webMercatorProjection) {\r\n                result.z = -result.z;\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        return super.reprojectPoint(sourceProjection, worldPos, result!);\r\n    }\r\n\r\n    /** @override */\r\n    localTangentSpace(\r\n        point: GeoCoordinatesLike | Vector3Like,\r\n        result: TransformLike\r\n    ): TransformLike {\r\n        let geoPoint: GeoCoordinatesLike;\r\n        if (isGeoCoordinatesLike(point)) {\r\n            this.projectPoint(point, result.position);\r\n            geoPoint = point;\r\n        } else {\r\n            MathUtils.copyVector3(point, result.position);\r\n            geoPoint = this.unprojectPoint(point);\r\n        }\r\n\r\n        const latitude = THREE.MathUtils.degToRad(geoPoint.latitude);\r\n        const longitude = THREE.MathUtils.degToRad(geoPoint.longitude);\r\n\r\n        const cosLongitude = Math.cos(longitude);\r\n        const sinLongitude = Math.sin(longitude);\r\n        const cosLatitude = Math.cos(latitude);\r\n        const sinLatitude = Math.sin(latitude);\r\n\r\n        MathUtils.newVector3(\r\n            cosLongitude * cosLatitude,\r\n            sinLongitude * cosLatitude,\r\n            sinLatitude,\r\n            result.zAxis\r\n        );\r\n\r\n        MathUtils.newVector3(-sinLongitude, cosLongitude, 0, result.xAxis);\r\n\r\n        MathUtils.newVector3(\r\n            -cosLongitude * sinLatitude,\r\n            -sinLongitude * sinLatitude,\r\n            cosLatitude,\r\n            result.yAxis\r\n        );\r\n        return result;\r\n    }\r\n}\r\n\r\nexport const sphereProjection: Projection = new SphereProjection(EarthConstants.EQUATORIAL_RADIUS);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinates } from \"../coordinates/GeoCoordinates\";\r\nimport { GeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Box3Like, isBox3Like } from \"../math/Box3Like\";\r\nimport { MathUtils } from \"../math/MathUtils\";\r\nimport { isOrientedBox3Like, OrientedBox3Like } from \"../math/OrientedBox3Like\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\nimport { EarthConstants } from \"./EarthConstants\";\r\nimport { Projection, ProjectionType } from \"./Projection\";\r\n\r\n/**\r\n *\r\n * https://en.wikipedia.org/wiki/Transverse_Mercator_projection\r\n * http://mathworld.wolfram.com/MercatorProjection.html\r\n *\r\n */\r\nclass TransverseMercatorProjection extends Projection {\r\n    /**\r\n     * Like in regular Mercator projection, there are two points on sphere\r\n     * with radius about 5 degrees, that is out of projected space.\r\n     *\r\n     *\r\n     * in regular Mercator these points are:\r\n     *     (90, any), (-90, any)\r\n     *\r\n     * and in transverse Mercator:\r\n     *     (0, 90), (0, -90)\r\n     *\r\n     * So, in transverse we need to compute distnce to poles, and clamp if\r\n     * radius is exceeded\r\n     */\r\n    static clampGeoPoint(geoPoint: GeoCoordinatesLike, _unitScale: number) {\r\n        const lat = geoPoint.latitude;\r\n        const lon = geoPoint.longitude;\r\n\r\n        const r = TransverseMercatorUtils.POLE_RADIUS;\r\n        const rsq = TransverseMercatorUtils.POLE_RADIUS_SQ;\r\n\r\n        const nearestQuarter = Math.round(lon / 90);\r\n        const deltaLon = nearestQuarter * 90 - lon;\r\n        if (nearestQuarter % 2 === 0 || Math.abs(deltaLon) > r) {\r\n            return geoPoint;\r\n        }\r\n\r\n        const deltaLat = lat - 0;\r\n        const distanceToPoleSq = deltaLon * deltaLon + deltaLat * deltaLat;\r\n        if (distanceToPoleSq < rsq) {\r\n            const distanceToPole = Math.sqrt(distanceToPoleSq);\r\n            const scale = (r - distanceToPole) / distanceToPole;\r\n            // const quarter = ((nearestQuarter % 4) + 4) % 4;\r\n            // const dir = quarter === 1 ? -1 : quarter === 3 ? 1 : 0;\r\n            const dir = 1;\r\n            const offsetLon = deltaLon === 0 && deltaLat === 0 ? r * dir : deltaLon;\r\n            return new GeoCoordinates(lat + deltaLat * scale, lon + offsetLon * scale);\r\n        }\r\n\r\n        return geoPoint;\r\n    }\r\n\r\n    /** @override */\r\n    readonly type: ProjectionType = ProjectionType.Planar;\r\n\r\n    private readonly m_phi0: number = 0;\r\n    private readonly m_lambda0: number = 0;\r\n\r\n    constructor(readonly unitScale: number) {\r\n        super(unitScale);\r\n    }\r\n\r\n    /** @override */\r\n    getScaleFactor(worldPoint: Vector3Like): number {\r\n        return Math.cosh((worldPoint.x / this.unitScale - 0.5) * 2 * Math.PI);\r\n    }\r\n\r\n    /** @override */\r\n    worldExtent<WorldBoundingBox extends Box3Like>(\r\n        minAltitude: number,\r\n        maxAltitude: number,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        result.min.x = 0;\r\n        result.min.y = 0;\r\n        result.min.z = minAltitude;\r\n        result.max.x = this.unitScale;\r\n        result.max.y = this.unitScale;\r\n        result.max.z = maxAltitude;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    projectPoint<WorldCoordinates extends Vector3Like>(\r\n        geoPoint: GeoCoordinatesLike,\r\n        result?: WorldCoordinates\r\n    ): WorldCoordinates {\r\n        if (!result) {\r\n            result = { x: 0, y: 0, z: 0 } as WorldCoordinates;\r\n        }\r\n\r\n        const clamped = TransverseMercatorProjection.clampGeoPoint(geoPoint, this.unitScale);\r\n        const normalLon = clamped.longitude / 360 + 0.5;\r\n        const offset = normalLon === 1 ? 0 : Math.floor(normalLon);\r\n        const phi = THREE.MathUtils.degToRad(clamped.latitude);\r\n        const lambda = THREE.MathUtils.degToRad(clamped.longitude - offset * 360) - this.m_lambda0;\r\n\r\n        const B = Math.cos(phi) * Math.sin(lambda);\r\n        // result.x = 1/2 * Math.log((1 + B) / (1 - B));\r\n        result.x = Math.atanh(B);\r\n        result.y = Math.atan2(Math.tan(phi), Math.cos(lambda)) - this.m_phi0;\r\n\r\n        const outScale = 0.5 / Math.PI;\r\n        result.x =\r\n            this.unitScale * (THREE.MathUtils.clamp(result.x * outScale + 0.5, 0, 1) + offset);\r\n        result.y = this.unitScale * THREE.MathUtils.clamp(result.y * outScale + 0.5, 0, 1);\r\n\r\n        result.z = geoPoint.altitude ?? 0;\r\n        return result;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectPoint(worldPoint: Vector3Like): GeoCoordinates {\r\n        const tau = Math.PI * 2;\r\n        const nx = worldPoint.x / this.unitScale;\r\n        const ny = worldPoint.y / this.unitScale;\r\n        const offset = nx === 1 ? 0 : Math.floor(nx);\r\n        const x = tau * (nx - 0.5 - offset);\r\n        const y = tau * (ny - 0.5);\r\n        const z = worldPoint.z || 0;\r\n\r\n        const D = y + this.m_phi0;\r\n\r\n        const phi = Math.asin(Math.sin(D) / Math.cosh(x));\r\n        const lambda = this.m_lambda0 + Math.atan2(Math.sinh(x), Math.cos(D)) + offset * tau;\r\n\r\n        const geoPoint = GeoCoordinates.fromRadians(phi, lambda, z);\r\n        return geoPoint;\r\n    }\r\n\r\n    /** @override */\r\n    projectBox<WorldBoundingBox extends Box3Like | OrientedBox3Like>(\r\n        geoBox: GeoBox,\r\n        result?: WorldBoundingBox\r\n    ): WorldBoundingBox {\r\n        const { north, south, east, west } = geoBox;\r\n\r\n        const pointsToCheck = [\r\n            geoBox.center,\r\n            geoBox.northEast,\r\n            geoBox.southWest,\r\n            new GeoCoordinates(south, east),\r\n            new GeoCoordinates(north, west)\r\n        ];\r\n\r\n        const E = TransverseMercatorUtils.POLE_EDGE_DEG;\r\n\r\n        const containsWestCut = west < -90 && east > -90;\r\n        const containsEastCut = west < 90 && east > 90;\r\n        const containsCenterX = west < 0 && east > 0;\r\n        const containsCenterY = west < E && east > -E && north > 0 && south < 0;\r\n\r\n        if (containsWestCut) {\r\n            pointsToCheck.push(new GeoCoordinates(north, -90));\r\n            pointsToCheck.push(new GeoCoordinates(south, -90));\r\n        }\r\n\r\n        if (containsEastCut) {\r\n            pointsToCheck.push(new GeoCoordinates(north, 90));\r\n            pointsToCheck.push(new GeoCoordinates(south, 90));\r\n        }\r\n\r\n        if (containsCenterX) {\r\n            pointsToCheck.push(new GeoCoordinates(north, 0));\r\n            pointsToCheck.push(new GeoCoordinates(south, 0));\r\n        }\r\n\r\n        if (containsCenterY) {\r\n            pointsToCheck.push(new GeoCoordinates(0, west));\r\n            pointsToCheck.push(new GeoCoordinates(0, east));\r\n        }\r\n\r\n        TransverseMercatorUtils.alignLatitude(pointsToCheck, pointsToCheck[0]);\r\n\r\n        const projected = pointsToCheck.map(p => this.projectPoint(p));\r\n        const vx = projected.map(p => p.x);\r\n        const vy = projected.map(p => p.y);\r\n        const vz = projected.map(p => p.z);\r\n\r\n        const minX = Math.min(...vx);\r\n        const minY = Math.min(...vy);\r\n        const minZ = Math.min(...vz);\r\n        const maxX = Math.max(...vx);\r\n        const maxY = Math.max(...vy);\r\n        const maxZ = Math.max(...vz);\r\n\r\n        if (!result) {\r\n            result = (new THREE.Box3() as Box3Like) as WorldBoundingBox;\r\n        }\r\n        if (isBox3Like(result)) {\r\n            result.min.x = minX;\r\n            result.min.y = minY;\r\n            result.min.z = minZ;\r\n            result.max.x = maxX;\r\n            result.max.y = maxY;\r\n            result.max.z = maxZ;\r\n        } else if (isOrientedBox3Like(result)) {\r\n            MathUtils.newVector3(1, 0, 0, result.xAxis);\r\n            MathUtils.newVector3(0, 1, 0, result.yAxis);\r\n            MathUtils.newVector3(0, 0, 1, result.zAxis);\r\n            result.position.x = (minX + maxX) / 2;\r\n            result.position.y = (minY + maxY) / 2;\r\n            result.position.z = (minZ + maxZ) / 2;\r\n            result.extents.x = (maxX - minX) / 2;\r\n            result.extents.y = (maxY - minY) / 2;\r\n            result.extents.z = (maxZ - minZ) / 2;\r\n        } else {\r\n            throw new Error(\"invalid bounding box\");\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * There are 8 sub-regions on entire projection space\r\n     * where both longitude and latitude preserve direction.\r\n     * If bounding box hits more than one region, it should be splitted\r\n     * into sub-boxes by regions, (un)projected and then united again.\r\n     *\r\n     *\r\n     * directions in form [latitude / longitude]:\r\n     *    1 ┌─────────|─────────┐\r\n     *      │ dr / dl | dl / ul │\r\n     * 0.75 ----------|----------\r\n     *      │ ur / dr | ul / ur │\r\n     * 0.5  ----------|----------\r\n     *      │ ul / ur | ur / dr │\r\n     * 0.25 ----------|----------\r\n     *      │ dl / ul | dr / dl │\r\n     *      └─────────|─────────┘\r\n     *     0         0.5        1\r\n     *     @override\r\n     */\r\n    unprojectBox(worldBox: Box3Like): GeoBox {\r\n        const s = this.unitScale;\r\n\r\n        const min = worldBox.min;\r\n        const max = worldBox.max;\r\n        const pointsToCheck = [\r\n            { x: (min.x + max.x) / 2, y: (min.y + max.y) / 2, z: 0 },\r\n            min,\r\n            max,\r\n            { x: min.x, y: max.y, z: 0 },\r\n            { x: max.x, y: min.y, z: 0 }\r\n        ];\r\n\r\n        const center = 0.5 * s;\r\n        const lowerQ = 0.25 * s;\r\n        const upperQ = 0.75 * s;\r\n\r\n        const containsCenterX = min.x < center && max.x > center;\r\n        const containsCenterY = min.y < center && max.y > center;\r\n        const containsLowerQY = min.y < lowerQ && max.y > lowerQ;\r\n        const containsUpperQY = min.y < upperQ && max.y > upperQ;\r\n\r\n        if (containsCenterY) {\r\n            pointsToCheck.push({ x: min.x, y: center, z: 0 });\r\n            pointsToCheck.push({ x: max.x, y: center, z: 0 });\r\n\r\n            if (containsCenterX) {\r\n                pointsToCheck.push({ x: center, y: center, z: 0 });\r\n            }\r\n        }\r\n        if (containsLowerQY) {\r\n            pointsToCheck.push({ x: min.x, y: lowerQ, z: 0 });\r\n            pointsToCheck.push({ x: max.x, y: lowerQ, z: 0 });\r\n\r\n            if (containsCenterX) {\r\n                pointsToCheck.push({ x: center, y: lowerQ, z: 0 });\r\n            }\r\n        }\r\n        if (containsUpperQY) {\r\n            pointsToCheck.push({ x: min.x, y: upperQ, z: 0 });\r\n            pointsToCheck.push({ x: max.x, y: upperQ, z: 0 });\r\n\r\n            if (containsCenterX) {\r\n                pointsToCheck.push({ x: center, y: upperQ, z: 0 });\r\n            }\r\n        }\r\n\r\n        const geoPoints = pointsToCheck.map(p => this.unprojectPoint(p));\r\n        TransverseMercatorUtils.alignLongitude(geoPoints, geoPoints[0]);\r\n\r\n        const latitudes = geoPoints.map(g => g.latitude);\r\n        const longitudes = geoPoints.filter(g => Math.abs(g.latitude) < 90).map(g => g.longitude);\r\n        const altitudes = geoPoints.map(g => g.altitude ?? 0);\r\n\r\n        const minGeo = new GeoCoordinates(\r\n            Math.min(...latitudes),\r\n            Math.min(...longitudes),\r\n            Math.min(...altitudes)\r\n        );\r\n\r\n        const maxGeo = new GeoCoordinates(\r\n            Math.max(...latitudes),\r\n            Math.max(...longitudes),\r\n            Math.max(...altitudes)\r\n        );\r\n\r\n        const geoBox = GeoBox.fromCoordinates(minGeo, maxGeo);\r\n        return geoBox;\r\n    }\r\n\r\n    /** @override */\r\n    unprojectAltitude(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    groundDistance(worldPoint: Vector3Like): number {\r\n        return worldPoint.z;\r\n    }\r\n\r\n    /** @override */\r\n    scalePointToSurface(worldPoint: Vector3Like): Vector3Like {\r\n        worldPoint.z = 0;\r\n        return worldPoint;\r\n    }\r\n\r\n    /** @override */\r\n    surfaceNormal(_worldPoint: Vector3Like, normal?: Vector3Like) {\r\n        if (normal === undefined) {\r\n            normal = { x: 0, y: 0, z: -1 };\r\n        } else {\r\n            normal.x = 0;\r\n            normal.y = 0;\r\n            normal.z = -1;\r\n        }\r\n        return normal;\r\n    }\r\n}\r\n\r\nexport class TransverseMercatorUtils {\r\n    static POLE_EDGE: number = 1.4844222297453323;\r\n    static POLE_EDGE_DEG: number = THREE.MathUtils.radToDeg(TransverseMercatorUtils.POLE_EDGE);\r\n    static POLE_RADIUS: number = 90 - TransverseMercatorUtils.POLE_EDGE_DEG;\r\n    static POLE_RADIUS_SQ: number = Math.pow(TransverseMercatorUtils.POLE_RADIUS, 2);\r\n\r\n    /**\r\n     * There are two regions on projected space that have same geo coordinates,\r\n     * it's the entire lines   { x: [0..1], y: 0 } and { x: [0..1], y: 1 }\r\n     * they both have geo coordinates of   (0, [-90..+90])\r\n     * and should be aligned somehow to fall into first or second region\r\n     * to make proper bounding boxes, tile bounds, etc.\r\n     */\r\n    static alignLatitude(points: GeoCoordinatesLike[], referencePoint: GeoCoordinatesLike): void {\r\n        const EPSILON = 1e-9;\r\n\r\n        for (const point of points) {\r\n            if (point.latitude === 0) {\r\n                point.latitude = referencePoint.latitude * EPSILON;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * There are two regions on projected plane,\r\n     * { x: 0.5, y: [0..0.25] }    and    { x: 0.5, y: [0.75..1] }\r\n     * that represent longitude edge where -180 and +180 met.\r\n     * Points falling in this regions should be aligned to get proper boxes etc.\r\n     */\r\n    static alignLongitude(points: GeoCoordinatesLike[], referencePoint: GeoCoordinatesLike): void {\r\n        const bad = referencePoint.longitude < 0 ? 180 : -180;\r\n        const good = referencePoint.longitude < 0 ? -180 : 180;\r\n\r\n        for (const point of points) {\r\n            if (point.longitude === bad) {\r\n                point.longitude = good;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Transverse Mercator {@link Projection} used to convert geo coordinates to world coordinates\r\n * and vice versa.\r\n */\r\nexport const transverseMercatorProjection: Projection = new TransverseMercatorProjection(\r\n    EarthConstants.EQUATORIAL_CIRCUMFERENCE\r\n);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { Box3Like } from \"../math/Box3Like\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\nimport { Projection } from \"../projection/Projection\";\r\nimport { SubdivisionScheme } from \"./SubdivisionScheme\";\r\nimport { TileKey } from \"./TileKey\";\r\nimport { TilingScheme } from \"./TilingScheme\";\r\n\r\n/**\r\n * `FlatTileBoundingBoxGenerator` generates bounding boxes in world and geo coordinates for a given\r\n * TilingScheme.\r\n */\r\nexport class FlatTileBoundingBoxGenerator {\r\n    private readonly m_tilingScheme: TilingScheme;\r\n    private readonly m_worldDimensions: Vector3Like;\r\n    private readonly m_worldBox: Box3Like;\r\n    /**\r\n     * Creates a new `FlatTileBoundingBoxGenerator` that can generate bounding boxes for the given\r\n     * TilingScheme.\r\n     *\r\n     * @param tilingScheme - The {@link TilingScheme} used to compute bounding boxes.\r\n     * @param minElevation - The minimum elevation in meters.\r\n     * @param maxElevation - The maximum elevation in meters.\r\n     */\r\n    constructor(\r\n        readonly tilingScheme: TilingScheme,\r\n        readonly minElevation: number = 0,\r\n        readonly maxElevation: number = 0\r\n    ) {\r\n        this.m_tilingScheme = tilingScheme;\r\n        this.m_worldBox = tilingScheme.projection.worldExtent(minElevation, maxElevation);\r\n        const { min, max } = this.m_worldBox;\r\n        this.m_worldDimensions = { x: max.x - min.x, y: max.y - min.y, z: max.z - min.z };\r\n    }\r\n\r\n    /**\r\n     * Returns the {@link Projection} of the {@link TilingScheme}.\r\n     */\r\n    get projection(): Projection {\r\n        return this.m_tilingScheme.projection;\r\n    }\r\n\r\n    /**\r\n     * Returns the {@link SubdivisionScheme} of the {@link TilingScheme}.\r\n     */\r\n    get subdivisionScheme(): SubdivisionScheme {\r\n        return this.m_tilingScheme.subdivisionScheme;\r\n    }\r\n\r\n    /**\r\n     * Returns the bounding box in world coordinates of the given {@link TileKey}.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const worldBounds = new THREE.Box3();\r\n     * generator.getWorldBox(geoBox, worldBounds);\r\n     * console.log(worldBounds.getCenter());\r\n     * ```\r\n     *\r\n     * @param tileKey - The TileKey.\r\n     * @param result - The optional object used to store the resulting bounding box in world\r\n     * coordinates.\r\n     */\r\n    getWorldBox(tileKey: TileKey, result?: Box3Like): Box3Like {\r\n        const level = tileKey.level;\r\n        const levelDimensionX = this.subdivisionScheme.getLevelDimensionX(level);\r\n        const levelDimensionY = this.subdivisionScheme.getLevelDimensionY(level);\r\n        const sizeX = this.m_worldDimensions.x / levelDimensionX;\r\n        const sizeY = this.m_worldDimensions.y / levelDimensionY;\r\n        const originX = this.m_worldBox.min.x + sizeX * tileKey.column;\r\n        const originY = this.m_worldBox.min.y + sizeY * tileKey.row;\r\n\r\n        if (!result) {\r\n            result = new THREE.Box3();\r\n        }\r\n\r\n        result.min.x = originX;\r\n        result.min.y = originY;\r\n        result.min.z = this.m_worldBox.min.z;\r\n        result.max.x = originX + sizeX;\r\n        result.max.y = originY + sizeY;\r\n        result.max.z = this.m_worldBox.max.z;\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Returns the bounding box in geo coordinates for the given {@link TileKey}.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const geoBox = generator.getGeoBox(worldBounds);\r\n     * console.log(geoBox.center);\r\n     * ```\r\n     *\r\n     * @param tileKey - The {@link TileKey}.\r\n     */\r\n    getGeoBox(tileKey: TileKey): GeoBox {\r\n        const worldBox = this.getWorldBox(tileKey);\r\n        return this.projection.unprojectBox(worldBox);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { SubdivisionScheme } from \"./SubdivisionScheme\";\r\n\r\nclass HalfQuadTreeSubdivisionScheme implements SubdivisionScheme {\r\n    getSubdivisionX(): number {\r\n        return 2;\r\n    }\r\n\r\n    getSubdivisionY(level: number): number {\r\n        return level === 0 ? 1 : 2;\r\n    }\r\n\r\n    getLevelDimensionX(level: number): number {\r\n        return 1 << level;\r\n    }\r\n\r\n    getLevelDimensionY(level: number): number {\r\n        return level !== 0 ? 1 << (level - 1) : 1;\r\n    }\r\n}\r\n\r\n/**\r\n * A {@link SubdivisionScheme} used to represent half quadtrees.\r\n * This particular subdivision scheme is\r\n * used by the HERE tiling scheme.\r\n */\r\nexport const halfQuadTreeSubdivisionScheme: SubdivisionScheme = new HalfQuadTreeSubdivisionScheme();\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { normalizedEquirectangularProjection } from \"../projection/EquirectangularProjection\";\r\nimport { halfQuadTreeSubdivisionScheme } from \"./HalfQuadTreeSubdivisionScheme\";\r\nimport { TilingScheme } from \"./TilingScheme\";\r\n\r\n/**\r\n * {@link TilingScheme} used by most of the data published by HERE.\r\n *\r\n * The `hereTilingScheme` features a half quadtree subdivision scheme and an equirectangular\r\n * projection.\r\n */\r\nexport const hereTilingScheme = new TilingScheme(\r\n    halfQuadTreeSubdivisionScheme,\r\n    normalizedEquirectangularProjection\r\n);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { mercatorProjection } from \"../projection/MercatorProjection\";\r\nimport { quadTreeSubdivisionScheme } from \"./QuadTreeSubdivisionScheme\";\r\nimport { TilingScheme } from \"./TilingScheme\";\r\n\r\n/**\r\n * The {@link TilingScheme} used by the HERE web tiles.\r\n *\r\n * The `mercatorTilingScheme` features a quadtree subdivision scheme and a Mercator projection.\r\n */\r\nexport const mercatorTilingScheme = new TilingScheme(quadTreeSubdivisionScheme, mercatorProjection);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { transverseMercatorProjection } from \"../projection/TransverseMercatorProjection\";\r\nimport { quadTreeSubdivisionScheme } from \"./QuadTreeSubdivisionScheme\";\r\nimport { TilingScheme } from \"./TilingScheme\";\r\n\r\n/**\r\n * A {@link TilingScheme} featuring quadtree subdivision scheme and\r\n * transverse Mercator projection.\r\n */\r\nexport const polarTilingScheme = new TilingScheme(\r\n    quadTreeSubdivisionScheme,\r\n    transverseMercatorProjection\r\n);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { TileKey } from \"./TileKey\";\r\nimport { TilingScheme } from \"./TilingScheme\";\r\n\r\n/**\r\n * A class used to represent a quadtree.\r\n */\r\nexport class QuadTree {\r\n    /**\r\n     * Constructs a new `QuadTree` for the given {@link TilingScheme}.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const quadTree = new QuadTree(hereTilingScheme);\r\n     * const geoBox = quadTree.getGeoBox(tileKey);\r\n     * console.log(geoBox.center);\r\n     * ```\r\n     *\r\n     * @param tilingScheme - The TilingScheme used by this `QuadTree`.\r\n     */\r\n    constructor(readonly tilingScheme: TilingScheme) {}\r\n\r\n    /**\r\n     * Visits this `QuadTree` and invoke the given accept method\r\n     * with the current {@link TileKey} and\r\n     * its bounding box in geo coordinates.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const geoPos = new GeoCoordinates(latitude, longitude);\r\n     * const quadTree = new QuadTree(hereTilingScheme);\r\n     * quadTree.visit((tileKey, geoBox) => {\r\n     *     if (geoBox.contains(geoPos)) {\r\n     *         console.log(\"tile\", tileKey, \"contains\", geoPos);\r\n     *         return tileKey.level < 14; // stop visiting the quadtree if the level is >= 14.\r\n     *     }\r\n     *     return false; // stop visiting the quadtree,\r\n     *                   // the tile's geoBox doesn't contain the given coordinates.\r\n     * });\r\n     * ```\r\n     *\r\n     * @param accept - A function that takes a {@link TileKey}\r\n     * and its bounding box in geo coordinates\r\n     * and returns `true` if the visit of the `QuadTree`\r\n     * should continue; otherwise `false`.\r\n     */\r\n    visit(accept: (tileKey: TileKey, geoBox: GeoBox) => boolean) {\r\n        this.visitTileKey(TileKey.fromRowColumnLevel(0, 0, 0), accept);\r\n    }\r\n\r\n    /**\r\n     * Visits the subtree starting from the given tile.\r\n     *\r\n     * @param tileKey - The root of the subtree that should be visited.\r\n     * @param accept - A function that takes a {@link TileKey}\r\n     *                 and its bounding box in geo coordinates\r\n     *                 and returns `true` if the visit of the\r\n     *                 `QuadTree` should continue; otherwise `false`.\r\n     */\r\n    visitTileKey(tileKey: TileKey, accept: (tileKey: TileKey, geoBox: GeoBox) => boolean) {\r\n        const geoBox = this.tilingScheme.getGeoBox(tileKey);\r\n\r\n        if (!accept(tileKey, geoBox)) {\r\n            return;\r\n        }\r\n\r\n        for (const subTileKey of this.tilingScheme.getSubTileKeys(tileKey)) {\r\n            this.visitTileKey(subTileKey, accept);\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { SubdivisionScheme } from \"./SubdivisionScheme\";\r\n\r\nclass QuadTreeSubdivisionScheme implements SubdivisionScheme {\r\n    getSubdivisionX(): number {\r\n        return 2;\r\n    }\r\n\r\n    getSubdivisionY(): number {\r\n        return 2;\r\n    }\r\n\r\n    getLevelDimensionX(level: number): number {\r\n        return 1 << level;\r\n    }\r\n\r\n    getLevelDimensionY(level: number): number {\r\n        return 1 << level;\r\n    }\r\n}\r\n\r\n/**\r\n * {@link SubdivisionScheme} representing a quadtree.\r\n */\r\nexport const quadTreeSubdivisionScheme: SubdivisionScheme = new QuadTreeSubdivisionScheme();\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { TileKey } from \"./TileKey\";\r\n\r\nexport class SubTiles implements Iterable<TileKey> {\r\n    constructor(public tileKey: TileKey, public sizeX: number, public sizeY: number) {}\r\n\r\n    [Symbol.iterator](): Iterator<TileKey> {\r\n        return this.sizeX === 2 && this.sizeY === 2\r\n            ? SubTiles.ZCurveIterator(this.tileKey)\r\n            : SubTiles.RowColumnIterator(this.tileKey, this.sizeX, this.sizeY);\r\n    }\r\n}\r\n\r\nexport namespace SubTiles {\r\n    export function* RowColumnIterator(\r\n        parentKey: TileKey,\r\n        sizeX: number,\r\n        sizeY: number\r\n    ): Iterator<TileKey> {\r\n        for (let y = 0; y < sizeY; y++) {\r\n            for (let x = 0; x < sizeX; x++) {\r\n                yield TileKey.fromRowColumnLevel(\r\n                    parentKey.row * sizeY + y,\r\n                    parentKey.column * sizeX + x,\r\n                    parentKey.level + 1\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    export function* ZCurveIterator(parentKey: TileKey): Iterator<TileKey> {\r\n        for (let i = 0; i < 4; i++) {\r\n            yield TileKey.fromRowColumnLevel(\r\n                (parentKey.row << 1) | (i >> 1),\r\n                (parentKey.column << 1) | (i & 1),\r\n                parentKey.level + 1\r\n            );\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Interface representing a `SubdivisionScheme`.\r\n */\r\nexport interface SubdivisionScheme {\r\n    /**\r\n     * Returns the number of columns for the given level.\r\n     *\r\n     * @param level - The level.\r\n     */\r\n    getSubdivisionX(level: number): number;\r\n\r\n    /**\r\n     * Returns the number of rows for the given level.\r\n     *\r\n     * @param level - The level.\r\n     */\r\n    getSubdivisionY(level: number): number;\r\n\r\n    /**\r\n     * Returns the width of the partitions at the given level.\r\n     *\r\n     * @param level - The level.\r\n     */\r\n    getLevelDimensionX(level: number): number;\r\n\r\n    /**\r\n     * Returns the height of the partitions at the given level.\r\n     *\r\n     * @param level - The level.\r\n     */\r\n    getLevelDimensionY(level: number): number;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/** @hidden */\r\nconst powerOfTwo = [\r\n    0x1,\r\n    0x2,\r\n    0x4,\r\n    0x8,\r\n    0x10,\r\n    0x20,\r\n    0x40,\r\n    0x80,\r\n    0x100,\r\n    0x200,\r\n    0x400,\r\n    0x800,\r\n    0x1000,\r\n    0x2000,\r\n    0x4000,\r\n    0x8000,\r\n    0x10000,\r\n    0x20000,\r\n    0x40000,\r\n    0x80000,\r\n    0x100000,\r\n    0x200000,\r\n    0x400000,\r\n    0x800000,\r\n    0x1000000,\r\n    0x2000000,\r\n    0x4000000,\r\n    0x8000000,\r\n    0x10000000,\r\n    0x20000000,\r\n    0x40000000,\r\n    0x80000000,\r\n    0x100000000,\r\n    0x200000000,\r\n    0x400000000,\r\n    0x800000000,\r\n    0x1000000000,\r\n    0x2000000000,\r\n    0x4000000000,\r\n    0x8000000000,\r\n    0x10000000000,\r\n    0x20000000000,\r\n    0x40000000000,\r\n    0x80000000000,\r\n    0x100000000000,\r\n    0x200000000000,\r\n    0x400000000000,\r\n    0x800000000000,\r\n    0x1000000000000,\r\n    0x2000000000000,\r\n    0x4000000000000,\r\n    0x8000000000000,\r\n    0x10000000000000 // Math.pow(2, 52), highest bit that can be set correctly.\r\n];\r\n\r\n/**\r\n * The `TileKey` instances are used to address a tile in a quadtree.\r\n *\r\n * A tile key is defined by a row, a column, and a level. The tree has a root at level 0, with one\r\n * single tile. On every level, each tile is divided into four children (therefore the name\r\n * quadtree).\r\n *\r\n * Within each [[level]], any particular tile is addressed with [[row]] and [[column]]. The number\r\n * of rows and columns in each level is 2 to the power of the level. This means: On level 0, only\r\n * one tile exists, [[columnsAtLevel]]() and [[rowsAtLevel]]() are both 1. On level 1, 4 tiles\r\n * exist, in 2 rows and 2 columns. On level 2 we have 16 tiles, in 4 rows and 4 columns. And so on.\r\n *\r\n * A tile key is usually created using [[fromRowColumnLevel]]() method.\r\n *\r\n * `TileKey` instances are immutable, all members return new instances of `TileKey` and do not\r\n * modify the original object.\r\n *\r\n * Utility functions like [[parent]](), [[changedLevelBy]](), and [[changedLevelTo]]() allow for\r\n * easy vertical navigation of the tree. The number of available rows and columns in the tile's\r\n * level is given with [[rowCount]]() and [[columnCount]]().\r\n *\r\n * Tile keys can be created from and converted into various alternative formats:\r\n *\r\n *  - [[toQuadKey]]() / [[fromQuadKey]]() - string representation 4-based\r\n *  - [[toHereTile]]() / [[fromHereTile]]() - string representation 10-based\r\n *  - [[mortonCode]]() / [[fromMortonCode]]() - number representation\r\n *\r\n * Note - as JavaScript's number type can hold 53 bits in its mantissa, only levels up to 26 can be\r\n * represented in the number representation returned by [[mortonCode]]().\r\n */\r\nexport class TileKey {\r\n    /**\r\n     * Creates a tile key.\r\n     *\r\n     * @param row - The requested row. Must be less than 2 to the power of level.\r\n     * @param column - The requested column. Must be less than 2 to the power of level.\r\n     * @param level - The requested level.\r\n     */\r\n    static fromRowColumnLevel(row: number, column: number, level: number): TileKey {\r\n        return new TileKey(row, column, level);\r\n    }\r\n\r\n    /**\r\n     * Creates a tile key from a quad string.\r\n     *\r\n     * The quad string can be created with [[toQuadKey]].\r\n     *\r\n     * @param quadkey - The quadkey to convert.\r\n     * @returns A new instance of `TileKey`.\r\n     */\r\n    static fromQuadKey(quadkey: string): TileKey {\r\n        const level = quadkey.length;\r\n        let row = 0;\r\n        let column = 0;\r\n        for (let i = 0; i < quadkey.length; ++i) {\r\n            const mask = 1 << i;\r\n            const d = parseInt(quadkey.charAt(level - i - 1), 10);\r\n            if (d & 0x1) {\r\n                column |= mask;\r\n            }\r\n            if (d & 0x2) {\r\n                row |= mask;\r\n            }\r\n        }\r\n        return TileKey.fromRowColumnLevel(row, column, level);\r\n    }\r\n\r\n    /**\r\n     * Creates a tile key from a numeric Morton code representation.\r\n     *\r\n     * You can convert a tile key into a numeric Morton code with [[mortonCode]].\r\n     *\r\n     * @param quadKey64 - The Morton code to be converted.\r\n     * @returns A new instance of {@link TileKey}.\r\n     */\r\n    static fromMortonCode(quadKey64: number): TileKey {\r\n        let level = 0;\r\n        let row = 0;\r\n        let column = 0;\r\n        let quadKey = quadKey64;\r\n        while (quadKey > 1) {\r\n            const mask: number = 1 << level;\r\n\r\n            if (quadKey & 0x1) {\r\n                column |= mask;\r\n            }\r\n            if (quadKey & 0x2) {\r\n                row |= mask;\r\n            }\r\n\r\n            level++;\r\n            quadKey = (quadKey - (quadKey & 0x3)) / 4;\r\n        }\r\n        const result = TileKey.fromRowColumnLevel(row, column, level);\r\n        result.m_mortonCode = quadKey64;\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Creates a tile key from a heretile code string.\r\n     *\r\n     * The string can be created with [[toHereTile]].\r\n     *\r\n     * @param quadkey64 - The string representation of the HERE tile key.\r\n     * @returns A new instance of `TileKey`.\r\n     */\r\n    static fromHereTile(quadkey64: string): TileKey {\r\n        const result = TileKey.fromMortonCode(parseInt(quadkey64, 10));\r\n        result.m_hereTile = quadkey64;\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Returns the number of available columns at a given level.\r\n     *\r\n     * This is 2 to the power of the level.\r\n     *\r\n     * @param level - The level for which to return the number of columns.\r\n     * @returns The available columns at the given level.\r\n     */\r\n    static columnsAtLevel(level: number): number {\r\n        return Math.pow(2, level);\r\n    }\r\n\r\n    /**\r\n     * Returns the number of available rows at a given level.\r\n     *\r\n     * This is 2 to the power of the level.\r\n     *\r\n     * @param level - The level for which to return the number of rows.\r\n     * @returns The available rows at the given level.\r\n     */\r\n    static rowsAtLevel(level: number): number {\r\n        return Math.pow(2, level);\r\n    }\r\n\r\n    /**\r\n     * Returns the closest matching `TileKey` in a cartesian coordinate system.\r\n     *\r\n     * @param level - The level for the tile key.\r\n     * @param coordX - The X coordinate.\r\n     * @param coordY - The Y coordinate.\r\n     * @param totalWidth - The maximum X coordinate.\r\n     * @param totalHeight - The maximum Y coordinate.\r\n     * @returns A new tile key at the given level that includes the given coordinates.\r\n     */\r\n    static atCoords(\r\n        level: number,\r\n        coordX: number,\r\n        coordY: number,\r\n        totalWidth: number,\r\n        totalHeight: number\r\n    ): TileKey {\r\n        return TileKey.fromRowColumnLevel(\r\n            Math.floor(coordY / (totalHeight / TileKey.rowsAtLevel(level))),\r\n            Math.floor(coordX / (totalWidth / TileKey.columnsAtLevel(level))),\r\n            level\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Computes the Morton code of the parent tile key of the given Morton code.\r\n     *\r\n     * Note: The parent key of the root key is the root key itself.\r\n     *\r\n     * @param mortonCode - A Morton code, for example, obtained from [[mortonCode]].\r\n     * @returns The Morton code of the parent tile.\r\n     */\r\n    static parentMortonCode(mortonCode: number): number {\r\n        return Math.floor(mortonCode / 4);\r\n    }\r\n\r\n    private m_mortonCode?: number;\r\n    private m_hereTile?: string;\r\n\r\n    /**\r\n     * Constructs a new immutable instance of a `TileKey`.\r\n     *\r\n     * For the better readability, {@link TileKey.fromRowColumnLevel} should be preferred.\r\n     *\r\n     * Note - row and column must not be greater than the maximum rows/columns for the given level.\r\n     *\r\n     * @param row - Represents the row in the quadtree.\r\n     * @param column - Represents the column in the quadtree.\r\n     * @param level - Represents the level in the quadtree.\r\n     */\r\n    constructor(readonly row: number, readonly column: number, readonly level: number) {}\r\n\r\n    /**\r\n     * Returns a tile key representing the parent of the tile addressed by this tile key.\r\n     *\r\n     * Throws an exception is this tile is already the root.\r\n     */\r\n    parent(): TileKey {\r\n        if (this.level === 0) {\r\n            throw new Error(\"Cannot get the parent of the root tile key\");\r\n        }\r\n        return TileKey.fromRowColumnLevel(this.row >>> 1, this.column >>> 1, this.level - 1);\r\n    }\r\n\r\n    /**\r\n     * Returns a new tile key at a level that differs from this tile's level by delta.\r\n     *\r\n     * Equivalent to `changedLevelTo(level() + delta)`.\r\n     *\r\n     * Note - root key is returned if `delta` is smaller than the level of this tile key.\r\n     *\r\n     * @param delta - The numeric difference between the current level and the requested level.\r\n     */\r\n    changedLevelBy(delta: number): TileKey {\r\n        const level = Math.max(0, this.level + delta);\r\n        let row = this.row;\r\n        let column = this.column;\r\n\r\n        if (delta >= 0) {\r\n            row <<= delta;\r\n            column <<= delta;\r\n        } else {\r\n            row >>>= -delta;\r\n            column >>>= -delta;\r\n        }\r\n        return TileKey.fromRowColumnLevel(row, column, level);\r\n    }\r\n\r\n    /**\r\n     * Returns a new tile key at the requested level.\r\n     *\r\n     * If the requested level is smaller than the tile's level, then the key of an ancestor of this\r\n     * tile is returned. If the requested level is larger than the tile's level, then the key of\r\n     * first child or grandchild of this tile is returned, for example, the child with the lowest\r\n     * row and column number. If the requested level equals this tile's level, then the tile key\r\n     * itself is returned. If the requested level is negative, the root tile key is returned.\r\n     *\r\n     * @param level - The requested level.\r\n     */\r\n    changedLevelTo(level: number): TileKey {\r\n        return this.changedLevelBy(level - this.level);\r\n    }\r\n\r\n    /**\r\n     * Converts the tile key to a numeric code representation.\r\n     *\r\n     * You can create a tile key from a numeric Morton code with [[fromMortonCode]].\r\n     *\r\n     * Note - only levels <= 26 are supported.\r\n     */\r\n    mortonCode(): number {\r\n        if (this.m_mortonCode === undefined) {\r\n            let column = this.column;\r\n            let row = this.row;\r\n\r\n            let result = powerOfTwo[this.level << 1];\r\n            for (let i = 0; i < this.level; ++i) {\r\n                if (column & 0x1) {\r\n                    result += powerOfTwo[2 * i];\r\n                }\r\n                if (row & 0x1) {\r\n                    result += powerOfTwo[2 * i + 1];\r\n                }\r\n                column >>>= 1;\r\n                row >>>= 1;\r\n            }\r\n\r\n            this.m_mortonCode = result;\r\n        }\r\n        return this.m_mortonCode;\r\n    }\r\n\r\n    /**\r\n     * Converts the tile key into a string for using in REST API calls.\r\n     *\r\n     * The string is a quadkey Morton code representation as a string.\r\n     *\r\n     * You can convert back from a quadkey string with [[fromHereTile]].\r\n     */\r\n    toHereTile(): string {\r\n        if (this.m_hereTile === undefined) {\r\n            this.m_hereTile = this.mortonCode().toString();\r\n        }\r\n        return this.m_hereTile;\r\n    }\r\n\r\n    /**\r\n     * Converts the tile key into a string for using in REST API calls.\r\n     *\r\n     * If the tile is the root tile, the quadkey is '-'. Otherwise the string is a number to the\r\n     * base of 4, but without the leading 1, with the following properties:\r\n     *  1. the number of digits equals the level.\r\n     *  2. removing the last digit gives the parent tile's quadkey string, i.e. appending 0,1,2,3\r\n     *     to a quadkey string gives the tiles's children.\r\n     *\r\n     * You can convert back from a quadkey string with [[fromQuadKey]].\r\n     */\r\n    toQuadKey(): string {\r\n        let result: string = \"\";\r\n\r\n        for (let i = this.level; i > 0; --i) {\r\n            const mask = 1 << (i - 1);\r\n\r\n            const col = (this.column & mask) !== 0;\r\n            const row = (this.row & mask) !== 0;\r\n\r\n            if (col && row) {\r\n                result += \"3\";\r\n            } else if (row) {\r\n                result += \"2\";\r\n            } else if (col) {\r\n                result += \"1\";\r\n            } else {\r\n                result += \"0\";\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Equality operator.\r\n     *\r\n     * @param qnr - The tile key to compare to.\r\n     * @returns `true` if this tile key has identical row, column and level, `false` otherwise.\r\n     */\r\n    equals(qnr: TileKey): boolean {\r\n        return this.row === qnr.row && this.column === qnr.column && this.level === qnr.level;\r\n    }\r\n\r\n    /**\r\n     * Returns the absolute quadkey that is constructed from its sub quadkey.\r\n     *\r\n     * @param sub - The sub key.\r\n     * @returns The absolute tile key in the quadtree.\r\n     */\r\n    addedSubKey(sub: string): TileKey {\r\n        const subQuad = TileKey.fromQuadKey(sub.length === 0 ? \"-\" : sub);\r\n        const child = this.changedLevelBy(subQuad.level);\r\n        return TileKey.fromRowColumnLevel(\r\n            child.row + subQuad.row,\r\n            child.column + subQuad.column,\r\n            child.level\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Returns the absolute quadkey that is constructed from its sub HERE tile key.\r\n     *\r\n     * @param sub - The sub HERE key.\r\n     * @returns The absolute tile key in the quadtree.\r\n     */\r\n    addedSubHereTile(sub: string): TileKey {\r\n        const subQuad = TileKey.fromHereTile(sub);\r\n        const child = this.changedLevelBy(subQuad.level);\r\n        return TileKey.fromRowColumnLevel(\r\n            child.row + subQuad.row,\r\n            child.column + subQuad.column,\r\n            child.level\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Returns a sub quadkey that is relative to its parent.\r\n     *\r\n     * This function can be used to generate sub keys that are relative to a parent that is delta\r\n     * levels up in the quadtree.\r\n     *\r\n     * This function can be used to create shortened keys for quads on lower levels if the parent is\r\n     * known.\r\n     *\r\n     * Note - the sub quadkeys fit in a 16-bit unsigned integer if the `delta` is smaller than 8. If\r\n     * `delta` is smaller than 16, the sub quadkey fits into an unsigned 32-bit integer.\r\n     *\r\n     * Deltas larger than 16 are not supported.\r\n     *\r\n     * @param delta - The number of levels relative to its parent quadkey. Must be greater or equal\r\n     * to 0 and smaller than 16.\r\n     * @returns The quadkey relative to its parent that is `delta` levels up the tree.\r\n     */\r\n    getSubHereTile(delta: number): string {\r\n        const key = this.mortonCode();\r\n        const msb = 1 << (delta * 2);\r\n        const mask = msb - 1;\r\n        const result = (key & mask) | msb;\r\n        return result.toString();\r\n    }\r\n\r\n    /**\r\n     * Returns the number of available rows in the tile's [[level]].\r\n     *\r\n     * This is 2 to the power of the level.\r\n     */\r\n    rowCount(): number {\r\n        return TileKey.rowsAtLevel(this.level);\r\n    }\r\n\r\n    /**\r\n     * Returns the number of available columns in the tile's [[level]].\r\n     *\r\n     * This is 2 to the power of the level.\r\n     */\r\n    columnCount(): number {\r\n        return TileKey.columnsAtLevel(this.level);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinates } from \"../coordinates/GeoCoordinates\";\r\nimport { GeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Vector3Like } from \"../math/Vector3Like\";\r\nimport { TileKey } from \"./TileKey\";\r\nimport { TilingScheme } from \"./TilingScheme\";\r\n\r\nexport const powerOfTwo = (() => {\r\n    let val = 0.5;\r\n    return new Array(53).fill(0).map(() => (val *= 2));\r\n})();\r\n\r\nexport namespace TileKeyUtils {\r\n    export function geoCoordinatesToTileKey(\r\n        tilingScheme: TilingScheme,\r\n        geoPoint: GeoCoordinatesLike,\r\n        level: number\r\n    ): TileKey | null {\r\n        const projection = tilingScheme.projection;\r\n        const worldPoint = projection.projectPoint(geoPoint);\r\n\r\n        return worldCoordinatesToTileKey(tilingScheme, worldPoint, level);\r\n    }\r\n\r\n    export function worldCoordinatesToTileKey(\r\n        tilingScheme: TilingScheme,\r\n        worldPoint: Vector3Like,\r\n        level: number\r\n    ): TileKey | null {\r\n        const projection = tilingScheme.projection;\r\n        const subdivisionScheme = tilingScheme.subdivisionScheme;\r\n\r\n        const cx = subdivisionScheme.getLevelDimensionX(level);\r\n        const cy = subdivisionScheme.getLevelDimensionY(level);\r\n\r\n        const { min, max } = projection.worldExtent(0, 0);\r\n        const worldSizeX = max.x - min.x;\r\n        const worldSizeY = max.y - min.y;\r\n\r\n        if (worldPoint.x < min.x || worldPoint.x > max.x) {\r\n            return null;\r\n        }\r\n\r\n        if (worldPoint.y < min.y || worldPoint.y > max.y) {\r\n            return null;\r\n        }\r\n\r\n        const column = Math.min(cx - 1, Math.floor((cx * (worldPoint.x - min.x)) / worldSizeX));\r\n        const row = Math.min(cy - 1, Math.floor((cy * (worldPoint.y - min.y)) / worldSizeY));\r\n\r\n        return TileKey.fromRowColumnLevel(row, column, level);\r\n    }\r\n\r\n    export function geoRectangleToTileKeys(\r\n        tilingScheme: TilingScheme,\r\n        geoBox: GeoBox,\r\n        level: number\r\n    ): TileKey[] {\r\n        const wrap = (value: number, lower: number, upper: number) => {\r\n            if (value < lower) {\r\n                return upper - ((lower - value) % (upper - lower));\r\n            }\r\n\r\n            return lower + ((value - lower) % (upper - lower));\r\n        };\r\n\r\n        const clamp = (x: number, minVal: number, maxVal: number) => {\r\n            return Math.min(Math.max(x, minVal), maxVal);\r\n        };\r\n\r\n        // Clamp at the poles and wrap around the international date line.\r\n        const southWestLongitude = wrap(geoBox.southWest.longitudeInRadians, -Math.PI, Math.PI);\r\n        const southWestLatitude = clamp(\r\n            geoBox.southWest.latitudeInRadians,\r\n            -(Math.PI * 0.5),\r\n            Math.PI * 0.5\r\n        );\r\n        const northEastLongitude = wrap(geoBox.northEast.longitudeInRadians, -Math.PI, Math.PI);\r\n        const northEastLatitude = clamp(\r\n            geoBox.northEast.latitudeInRadians,\r\n            -(Math.PI * 0.5),\r\n            Math.PI * 0.5\r\n        );\r\n        const minTileKey = TileKeyUtils.geoCoordinatesToTileKey(\r\n            tilingScheme,\r\n            GeoCoordinates.fromRadians(southWestLatitude, southWestLongitude),\r\n            level\r\n        );\r\n        const maxTileKey = TileKeyUtils.geoCoordinatesToTileKey(\r\n            tilingScheme,\r\n            GeoCoordinates.fromRadians(northEastLatitude, northEastLongitude),\r\n            level\r\n        );\r\n        const columnCount = tilingScheme.subdivisionScheme.getLevelDimensionX(level);\r\n\r\n        if (!minTileKey || !maxTileKey) {\r\n            throw new Error(\"Invalid coordinates\");\r\n        }\r\n\r\n        const minColumn = minTileKey.column;\r\n        let maxColumn = maxTileKey.column;\r\n\r\n        // wrap around case\r\n        if (southWestLongitude > northEastLongitude) {\r\n            if (maxColumn !== minColumn) {\r\n                maxColumn += columnCount;\r\n            } else {\r\n                // do not duplicate\r\n                maxColumn += columnCount - 1;\r\n            }\r\n        }\r\n\r\n        const minRow = Math.min(minTileKey.row, maxTileKey.row);\r\n        const maxRow = Math.max(minTileKey.row, maxTileKey.row);\r\n\r\n        const keys = new Array<TileKey>();\r\n\r\n        for (let row = minRow; row <= maxRow; ++row) {\r\n            for (let column = minColumn; column <= maxColumn; ++column) {\r\n                keys.push(TileKey.fromRowColumnLevel(row, column % columnCount, level));\r\n            }\r\n        }\r\n\r\n        return keys;\r\n    }\r\n\r\n    /**\r\n     * Creates a unique key based on the supplied parameters. Note, the uniqueness is bounded by the\r\n     * bitshift. The [[TileKey.mortonCode()]] supports currently up to 26 levels (this is because\r\n     * 26*2 equals 52, and 2^52 is the highest bit that can be set in an integer in Javascript), the\r\n     * bitshift reduces this accordingly, so given the default bitshift of four, we support up to 24\r\n     * levels. Given the current support up to level 19 this should be fine.\r\n     *\r\n     * @param tileKey - The unique {@link @here/harp-geoutils#TileKey}\r\n     *                  from which to compute the unique key.\r\n     * @param offset - How much the given {@link @here/harp-geoutils#TileKey} is offset\r\n     * @param bitshift - How much space we have to store the offset. The default of 4 means we have\r\n     *      enough space to store 16 unique tiles in a single view.\r\n     */\r\n    export function getKeyForTileKeyAndOffset(\r\n        tileKey: TileKey,\r\n        offset: number,\r\n        bitshift: number = 4\r\n    ) {\r\n        const shiftedOffset = getShiftedOffset(offset, bitshift);\r\n        return tileKey.mortonCode() + shiftedOffset;\r\n    }\r\n\r\n    /**\r\n     * Extracts the offset and morton key from the given key (must be created by:\r\n     * [[getKeyForTileKeyAndOffset]])\r\n     *\r\n     * Note, we can't use bitshift operators in Javascript because they work on 32-bit integers, and\r\n     * would truncate the numbers, hence using powers of two.\r\n     *\r\n     * @param key - Key to extract offset and morton key.\r\n     * @param bitshift - How many bits to shift by, must be the same as was used when creating the\r\n     * key.\r\n     */\r\n    export function extractOffsetAndMortonKeyFromKey(key: number, bitshift: number = 4) {\r\n        let offset = 0;\r\n        let mortonCode = key;\r\n        let i = 0;\r\n        // Compute the offset\r\n        for (; i < bitshift; i++) {\r\n            // Note, we use 52, because 2^53-1 is the biggest value, the highest value\r\n            // that can be set is the bit in the 52th position.\r\n            const num = powerOfTwo[52 - i];\r\n            if (mortonCode >= num) {\r\n                mortonCode -= num;\r\n                offset += powerOfTwo[bitshift - 1 - i];\r\n            }\r\n        }\r\n        // We subtract half of the total amount, this undoes what is computed in getShiftedOffset\r\n        offset -= powerOfTwo[bitshift - 1];\r\n        return { offset, mortonCode };\r\n    }\r\n\r\n    /**\r\n     * Returns the key of the parent. Key must have been computed using the function\r\n     * [[getKeyForTileKeyAndOffset]].\r\n     *\r\n     * @param calculatedKey - Key to decompose\r\n     * @param bitshift - Bit shift used to create the key\r\n     */\r\n    export function getParentKeyFromKey(calculatedKey: number, bitshift: number = 4) {\r\n        const { offset, mortonCode } = extractOffsetAndMortonKeyFromKey(calculatedKey, bitshift);\r\n        const parentTileKey = TileKey.fromMortonCode(TileKey.parentMortonCode(mortonCode));\r\n        return getKeyForTileKeyAndOffset(parentTileKey, offset, bitshift);\r\n    }\r\n\r\n    /**\r\n     * Packs the supplied offset into the high bits, where the highbits are between 2^52 and\r\n     * 2^(52-bitshift).\r\n     *\r\n     * Offsets are wrapped around, to fit in the offsetBits. In practice, this doesn't really\r\n     * matter, this is primarily used to find a unique id, if there is an offset 10, which is\r\n     * wrapped to 2, it doesn't matter, because the offset of 10 is still stored in the tile.\r\n     * What can be a problem though is that the cache gets filled up and isn't emptied.\r\n     *\r\n     * Note, because bit shifting in JavaScript works on 32 bit integers, we use powers of 2 to set\r\n     * the high bits instead.\r\n     *\r\n     * @param offset - Offset to pack into the high bits.\r\n     * @param offsetBits - How many bits to use to pack the offset.\r\n     */\r\n    function getShiftedOffset(offset: number, offsetBits: number = 4) {\r\n        let result = 0;\r\n        const totalOffsetsToStore = powerOfTwo[offsetBits];\r\n        //Offsets are stored by adding half 2 ^ (bitshift - 1), i.e.half of the max amount stored,\r\n        //and then wrapped based on this value.For example, given a bitshift of 3, and an offset -\r\n        //3, it would have 4 added(half of 2 ^ 3), and be stored as 1, 3 would have 4 added and be\r\n        //stored as 7, 4 would be added with 4 and be stored as 0 (it wraps around).\r\n        offset += totalOffsetsToStore / 2;\r\n        while (offset < 0) {\r\n            offset += totalOffsetsToStore;\r\n        }\r\n        while (offset >= totalOffsetsToStore) {\r\n            offset -= totalOffsetsToStore;\r\n        }\r\n        // Offset is now a number between >= 0 and < totalOffsetsToStore\r\n        for (let i = 0; i < offsetBits && offset > 0; i++) {\r\n            // 53 is used because 2^53-1 is the biggest number that Javascript can represent as an\r\n            // integer safely.\r\n            if (offset & 0x1) {\r\n                result += powerOfTwo[53 - offsetBits + i];\r\n            }\r\n            offset >>>= 1;\r\n        }\r\n        return result;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { SubdivisionScheme } from \"./SubdivisionScheme\";\r\nimport { SubTiles } from \"./SubTiles\";\r\nimport { TileKey } from \"./TileKey\";\r\n\r\nexport class TileTreeTraverse {\r\n    private readonly m_subdivisionScheme: SubdivisionScheme;\r\n\r\n    constructor(subdivisionScheme: SubdivisionScheme) {\r\n        this.m_subdivisionScheme = subdivisionScheme;\r\n    }\r\n\r\n    subTiles(tileKey: TileKey): Iterable<TileKey> {\r\n        const divX = this.m_subdivisionScheme.getSubdivisionX(tileKey.level);\r\n        const divY = this.m_subdivisionScheme.getSubdivisionY(tileKey.level);\r\n\r\n        return new SubTiles(tileKey, divX, divY);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { GeoBox } from \"../coordinates/GeoBox\";\r\nimport { GeoCoordinatesLike } from \"../coordinates/GeoCoordinatesLike\";\r\nimport { Box3Like } from \"../math/Box3Like\";\r\nimport { Projection } from \"../projection/Projection\";\r\nimport { FlatTileBoundingBoxGenerator } from \"./FlatTileBoundingBoxGenerator\";\r\nimport { SubdivisionScheme } from \"./SubdivisionScheme\";\r\nimport { TileKey } from \"./TileKey\";\r\nimport { TileKeyUtils } from \"./TileKeyUtils\";\r\nimport { TileTreeTraverse } from \"./TileTreeTraverse\";\r\n\r\n/**\r\n * The `TilingScheme` represents how the data is tiled.\r\n */\r\nexport class TilingScheme {\r\n    readonly boundingBoxGenerator: FlatTileBoundingBoxGenerator;\r\n    readonly tileTreeTraverse: TileTreeTraverse;\r\n\r\n    /**\r\n     * Constructs a new `TilingScheme` with the given subdivision scheme and projection.\r\n     *\r\n     * @param subdivisionScheme - The subdivision scheme used by this `TilingScheme`.\r\n     * @param projection - The projection used by this `TilingScheme`.\r\n     */\r\n    constructor(readonly subdivisionScheme: SubdivisionScheme, readonly projection: Projection) {\r\n        this.boundingBoxGenerator = new FlatTileBoundingBoxGenerator(this);\r\n        this.tileTreeTraverse = new TileTreeTraverse(subdivisionScheme);\r\n    }\r\n\r\n    /**\r\n     * Returns the sub tile keys of the given tile.\r\n     *\r\n     * @param tileKey - The {@link TileKey}.\r\n     * @returns The list of the sub tile keys.\r\n     */\r\n    getSubTileKeys(tileKey: TileKey): Iterable<TileKey> {\r\n        return this.tileTreeTraverse.subTiles(tileKey);\r\n    }\r\n\r\n    /**\r\n     * Gets the {@link TileKey} from the given geo position and level.\r\n     *\r\n     * @param geoPoint - The position in geo coordinates.\r\n     * @param level - The level of the resulting `TileKey`.\r\n     */\r\n    getTileKey(geoPoint: GeoCoordinatesLike, level: number): TileKey | null {\r\n        return TileKeyUtils.geoCoordinatesToTileKey(this, geoPoint, level);\r\n    }\r\n\r\n    /**\r\n     * Gets the list of {@link TileKey}s contained in the given {@link GeoBox}.\r\n     *\r\n     * @param geoBox - The bounding box in geo coordinates.\r\n     * @param level - The level of the resulting `TileKey`.\r\n     */\r\n    getTileKeys(geoBox: GeoBox, level: number): TileKey[] {\r\n        return TileKeyUtils.geoRectangleToTileKeys(this, geoBox, level);\r\n    }\r\n\r\n    /**\r\n     * Returns the bounding box in geo coordinates for the given {@link TileKey}.\r\n     *\r\n     * @param tileKey - The `TileKey`.\r\n     */\r\n    getGeoBox(tileKey: TileKey): GeoBox {\r\n        return this.boundingBoxGenerator.getGeoBox(tileKey);\r\n    }\r\n\r\n    /**\r\n     * Returns the bounding box in world coordinates.\r\n     *\r\n     * @param tileKey - The `TileKey`.\r\n     * @param result - The optional object that will contain the resulting bounding box.\r\n     */\r\n    getWorldBox(tileKey: TileKey, result?: Box3Like): Box3Like {\r\n        return this.boundingBoxGenerator.getWorldBox(tileKey, result);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { webMercatorProjection } from \"../projection/MercatorProjection\";\r\nimport { quadTreeSubdivisionScheme } from \"./QuadTreeSubdivisionScheme\";\r\nimport { TilingScheme } from \"./TilingScheme\";\r\n\r\n/**\r\n * A {@link TilingScheme} featuring quadtree subdivision scheme and web Mercator projection.\r\n */\r\nexport const webMercatorTilingScheme = new TilingScheme(\r\n    quadTreeSubdivisionScheme,\r\n    webMercatorProjection\r\n);\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Projection } from \"@here/harp-geoutils\";\r\nimport { assert } from \"@here/harp-utils\";\r\nimport * as THREE from \"three\";\r\n\r\n// Preallocate temp variables used during line generation.\r\nconst tmpV = new THREE.Vector3();\r\nconst tmpNormal = new THREE.Vector3();\r\nconst tmpTangent0 = new THREE.Vector3();\r\nconst tmpTangent1 = new THREE.Vector3();\r\nconst tmpBitangent = new THREE.Vector3();\r\nconst SEGMENT_OFFSET = 0.1;\r\n\r\n/**\r\n * Describes vertex attribute parameters of interleaved buffer.\r\n */\r\ninterface VertexAttributeDescriptor {\r\n    name: string;\r\n    itemSize: number;\r\n    offset: number;\r\n}\r\n\r\ninterface VertexDescriptor {\r\n    attributes: VertexAttributeDescriptor[];\r\n    stride: number;\r\n}\r\n\r\n/**\r\n * Declares all the vertex attributes used for rendering a line using the [[SolidLineMaterial]].\r\n */\r\n\r\n/** Base line vertex attributes. */\r\nconst LINE_VERTEX_ATTRIBUTES: VertexDescriptor = {\r\n    attributes: [\r\n        // The \"extrusionCoord\" is a vec4 which represents:\r\n        // xy: Extrusion coordinates\r\n        // sign(xy): Extrusion direction\r\n        // z: Line length\r\n        { name: \"extrusionCoord\", itemSize: 3, offset: 0 },\r\n        { name: \"position\", itemSize: 3, offset: 3 },\r\n        { name: \"tangent\", itemSize: 3, offset: 6 },\r\n        // HARP-17373: Original uniform name 'bitangent' due to shader compilation errors with Metal\r\n        // in Safari 15 on MacOS Monterrey and iPadOS 15.\r\n        { name: \"biTangent\", itemSize: 4, offset: 9 }\r\n    ],\r\n    stride: 13\r\n};\r\n\r\n/** Optional normal and uv coordinates. */\r\nconst NORMAL_UV_VERTEX_ATTRIBUTES: VertexDescriptor = {\r\n    attributes: [\r\n        { name: \"uv\", itemSize: 2, offset: LINE_VERTEX_ATTRIBUTES.stride },\r\n        { name: \"normal\", itemSize: 3, offset: LINE_VERTEX_ATTRIBUTES.stride + 2 }\r\n    ],\r\n    stride: 5\r\n};\r\n\r\n/** Base line vertex attributes plus normals and uv coordinates. */\r\nconst LINE_VERTEX_ATTRIBUTES_NUV: VertexDescriptor = {\r\n    attributes: [...LINE_VERTEX_ATTRIBUTES.attributes, ...NORMAL_UV_VERTEX_ATTRIBUTES.attributes],\r\n    stride: LINE_VERTEX_ATTRIBUTES.stride + NORMAL_UV_VERTEX_ATTRIBUTES.stride\r\n};\r\n\r\n/**\r\n * Declares all the vertex attributes used for rendering a line using the\r\n * [[HighPrecisionLineMaterial]].\r\n */\r\nconst HP_LINE_VERTEX_ATTRIBUTES: VertexDescriptor = {\r\n    attributes: [\r\n        { name: \"extrusionCoord\", itemSize: 2, offset: 0 },\r\n        { name: \"position\", itemSize: 3, offset: 2 },\r\n        { name: \"positionLow\", itemSize: 3, offset: 5 },\r\n        { name: \"tangent\", itemSize: 3, offset: 8 },\r\n        // HARP-17373: Original uniform name 'bitangent' due to shader compilation errors with Metal\r\n        // in Safari 15 on MacOS Monterrey and iPadOS 15.\r\n        { name: \"biTangent\", itemSize: 4, offset: 11 }\r\n    ],\r\n    stride: 15\r\n};\r\n\r\n/** High precision line vertex attributes plus normals and uv coordinates. */\r\nconst HP_LINE_VERTEX_ATTRIBUTES_NUV: VertexDescriptor = {\r\n    attributes: [\r\n        ...HP_LINE_VERTEX_ATTRIBUTES.attributes,\r\n        ...NORMAL_UV_VERTEX_ATTRIBUTES.attributes\r\n    ],\r\n    stride: HP_LINE_VERTEX_ATTRIBUTES.stride + NORMAL_UV_VERTEX_ATTRIBUTES.stride\r\n};\r\n\r\n/**\r\n * Class that holds the vertex and index attributes for a [[Lines]] object.\r\n */\r\nexport class LineGeometry {\r\n    vertices: number[] = [];\r\n    vertexColors: number[] = [];\r\n    indices: number[] = [];\r\n}\r\n\r\nfunction getVertexDescriptor(hasNormalsAndUvs: boolean, highPrecision: boolean): VertexDescriptor {\r\n    if (highPrecision) {\r\n        return hasNormalsAndUvs ? HP_LINE_VERTEX_ATTRIBUTES_NUV : HP_LINE_VERTEX_ATTRIBUTES;\r\n    } else {\r\n        return hasNormalsAndUvs ? LINE_VERTEX_ATTRIBUTES_NUV : LINE_VERTEX_ATTRIBUTES;\r\n    }\r\n}\r\n\r\n/**\r\n * Creates a [[LineGeometry]] object out of a polyline.\r\n *\r\n * @param center - Center of the polyline.\r\n * @param polyline - Array of `numbers` describing a polyline.\r\n * @param offsets - Array of `numbers` representing line segment offsets.\r\n * @param uvs - Array of `numbers` representing texture coordinates.\r\n * @param colors - Array of `numbers` describing a polyline's colors.\r\n * @param geometry - [[LineGeometry]] object used to store the vertex and index attributes.\r\n * @param highPrecision - If `true` will create high-precision vertex information.\r\n */\r\nexport function createLineGeometry(\r\n    center: THREE.Vector3,\r\n    polyline: ArrayLike<number>,\r\n    projection: Projection,\r\n    offsets?: ArrayLike<number>,\r\n    uvs?: ArrayLike<number>,\r\n    colors?: ArrayLike<number>,\r\n    geometry = new LineGeometry(),\r\n    highPrecision: boolean = false\r\n): LineGeometry {\r\n    if (polyline.length === 0) {\r\n        return geometry;\r\n    }\r\n\r\n    const stride = getVertexDescriptor(uvs !== undefined, highPrecision).stride;\r\n\r\n    const pointCount = polyline.length / 3;\r\n    const segments = new Array<number>(pointCount);\r\n    const tangents = new Array<number>(polyline.length - 3);\r\n    const baseVertex = geometry.vertices.length / stride;\r\n\r\n    const hasSegmentOffsets = offsets !== undefined && offsets.length > 0;\r\n    const hasTexCoords = uvs !== undefined && uvs.length > 0;\r\n    const vertexColors = colors !== undefined && colors.length && polyline.length;\r\n\r\n    assert(!hasSegmentOffsets || offsets!.length === pointCount);\r\n    assert(!hasTexCoords || uvs!.length / 2 === pointCount);\r\n    assert(!vertexColors || colors!.length === polyline.length);\r\n\r\n    // Compute segments and tangents.\r\n    let sum = SEGMENT_OFFSET;\r\n    segments[0] = sum;\r\n    for (let i = 0; i < pointCount - 1; ++i) {\r\n        let sqrLength = 0;\r\n        for (let j = 0; j < 3; ++j) {\r\n            const d = polyline[(i + 1) * 3 + j] - polyline[i * 3 + j];\r\n            tangents[i * 3 + j] = d;\r\n            sqrLength += d * d;\r\n        }\r\n        const len = Math.sqrt(sqrLength);\r\n        sum = sum + len;\r\n        segments[i + 1] = sum;\r\n    }\r\n\r\n    const lineCoverage = hasSegmentOffsets\r\n        ? Math.abs(offsets![offsets!.length - 1] - offsets![0])\r\n        : 1.0;\r\n    const lineLength = segments[segments.length - 1] / lineCoverage;\r\n\r\n    // Override the segments if offsets are explicitly provided.\r\n    if (hasSegmentOffsets) {\r\n        for (let i = 0; i < pointCount; ++i) {\r\n            segments[i] = offsets![i] * lineLength + SEGMENT_OFFSET;\r\n        }\r\n    }\r\n\r\n    // Check if we're working with a closed line.\r\n    let isClosed = true;\r\n    for (let j = 0; j < 3; ++j) {\r\n        isClosed = isClosed && polyline[j] === polyline[polyline.length - 3 + j];\r\n    }\r\n\r\n    const tmpVertices: number[] = [];\r\n\r\n    const addVertexPair = (\r\n        i: number,\r\n        T1: number,\r\n        T2: number,\r\n        segment: number,\r\n        extrusionCoord: number\r\n    ) => {\r\n        tmpVertices.length = 0;\r\n\r\n        // Store the segment and extrusionCoord attributes.\r\n        geometry.vertices.push(segment, extrusionCoord * -1, lineLength);\r\n        tmpVertices.push(segment, extrusionCoord * 1, lineLength);\r\n\r\n        // Store the position attribute (component-dependant).\r\n        for (let j = 0; j < 3; ++j) {\r\n            if (!highPrecision) {\r\n                geometry.vertices.push(polyline[i * 3 + j]);\r\n                tmpVertices.push(polyline[i * 3 + j]);\r\n            } else {\r\n                const highComp = Math.fround(polyline[i * 3 + j]);\r\n                const lowComp = polyline[i * 3 + j] - highComp;\r\n                geometry.vertices.push(highComp, lowComp);\r\n                tmpVertices.push(highComp, lowComp);\r\n            }\r\n            tmpNormal.setComponent(j, polyline[i * 3 + j]);\r\n        }\r\n\r\n        // Store the bitangent attribute (component-dependant).\r\n        for (let j = 0; j < 3; ++j) {\r\n            tmpTangent0.setComponent(j, tangents[T1 + j]);\r\n            tmpTangent1.setComponent(j, tangents[T2 + j]);\r\n        }\r\n        tmpTangent0.normalize();\r\n        geometry.vertices.push(tmpTangent0.x, tmpTangent0.y, tmpTangent0.z);\r\n        tmpVertices.push(tmpTangent0.x, tmpTangent0.y, tmpTangent0.z);\r\n        tmpNormal.add(center); // tmpNormal contains world position\r\n        projection.surfaceNormal(tmpNormal, tmpNormal);\r\n        const angle = computeBitangent(\r\n            tmpNormal,\r\n            tmpTangent0,\r\n            tmpTangent1.normalize(),\r\n            tmpBitangent\r\n        );\r\n        geometry.vertices.push(tmpBitangent.x, tmpBitangent.y, tmpBitangent.z, angle);\r\n        tmpVertices.push(tmpBitangent.x, tmpBitangent.y, tmpBitangent.z, angle);\r\n\r\n        if (hasTexCoords) {\r\n            // uvs\r\n            geometry.vertices.push(uvs![i * 2], uvs![i * 2 + 1]);\r\n            tmpVertices.push(uvs![i * 2], uvs![i * 2 + 1]);\r\n            // normals\r\n            geometry.vertices.push(tmpNormal.x, tmpNormal.y, tmpNormal.z);\r\n            tmpVertices.push(tmpNormal.x, tmpNormal.y, tmpNormal.z);\r\n        }\r\n\r\n        geometry.vertices.push(...tmpVertices);\r\n\r\n        // Add vertex colors (if supplied).\r\n        if (vertexColors) {\r\n            geometry.vertexColors.push(colors![i * 3], colors![i * 3 + 1], colors![i * 3 + 2]);\r\n            geometry.vertexColors.push(colors![i * 3], colors![i * 3 + 1], colors![i * 3 + 2]);\r\n        }\r\n    };\r\n\r\n    for (let i = 0; i < pointCount; ++i) {\r\n        // Retrieve the per-point tangents.\r\n        const T1 = isClosed && i === 0 ? tangents.length - 3 : Math.max(0, i - 1) * 3;\r\n        const T2 = isClosed && i === pointCount - 1 ? 0 : Math.min(i * 3, tangents.length - 3);\r\n\r\n        // Process v0 and v1.\r\n        if (i > 0) {\r\n            addVertexPair(i, T1, T2, segments[i - 1], segments[i]);\r\n        }\r\n\r\n        // Process v2 and v3.\r\n        if (i + 1 < pointCount) {\r\n            addVertexPair(\r\n                i,\r\n                T1,\r\n                T2,\r\n                segments[Math.min(i, segments.length - 1)] * -1,\r\n                segments[Math.min(i + 1, segments.length - 1)]\r\n            );\r\n        }\r\n    }\r\n\r\n    // Store the triangle indices in the final index buffer.\r\n    for (let i = 0; i < pointCount - 1; ++i) {\r\n        const base = baseVertex + i * 4;\r\n        geometry.indices.push(base, base + 1, base + 2, base + 2, base + 1, base + 3);\r\n    }\r\n\r\n    return geometry;\r\n}\r\n\r\n/**\r\n * Creates a [[LineGeometry]] object out of a polyline.\r\n *\r\n * @param polyline - Array of `numbers` describing a polyline.\r\n * @param colors - Array of `numbers` describing a polyline's colors.\r\n * @param geometry - [[LineGeometry]] object used to store the vertex and index attributes.\r\n */\r\nexport function createSimpleLineGeometry(\r\n    polyline: ArrayLike<number>,\r\n    colors?: ArrayLike<number>,\r\n    geometry = new LineGeometry()\r\n): LineGeometry {\r\n    if (polyline.length === 0) {\r\n        return geometry;\r\n    }\r\n\r\n    const pointCount = polyline.length / 3;\r\n    let index = geometry.vertices.length / 3;\r\n\r\n    const vertexColors = colors !== undefined && colors.length && polyline.length;\r\n\r\n    for (let i = 0; i < pointCount; ++i, index++) {\r\n        if (i > 0) {\r\n            geometry.indices.push(index);\r\n        }\r\n        if (i < pointCount - 1) {\r\n            geometry.indices.push(index);\r\n        }\r\n        for (let j = 0; j < 3; ++j) {\r\n            geometry.vertices.push(polyline[i * 3 + j]);\r\n            if (vertexColors) {\r\n                geometry.vertexColors.push(colors![i * 3 + j]);\r\n            }\r\n        }\r\n    }\r\n\r\n    return geometry;\r\n}\r\n\r\n/**\r\n * Class used to render groups (or batches) of width-variable lines (in the same tile).\r\n */\r\nexport class LineGroup {\r\n    /**\r\n     * Adds all the attribute data needed to a [[BufferGeometry]] object for rendering `Lines`.\r\n     *\r\n     * @param vertices - Array of vertex attributes.\r\n     * @param colors - Array of vertex colors.\r\n     * @param indices - Array of vertex indices.\r\n     * @param geometry - [[BufferGeometry]] object which will store all the `Lines` attribute data.\r\n     * @param hasNormalsAnUvs - Whether vertices have normal and uv coordinates as attributes.\r\n     * @param highPrecision - If `true` will create high-precision vertex information.\r\n     * @param isSimple - `true` to create simple (nonsolid, nonextruded) lines. Defaults to `false`.\r\n     */\r\n    static createGeometry(\r\n        vertices: ArrayLike<number>,\r\n        colors: ArrayLike<number>,\r\n        indices: ArrayLike<number>,\r\n        geometry: THREE.BufferGeometry,\r\n        hasNormalsAndUvs: boolean = false,\r\n        highPrecision = false,\r\n        isSimple = false\r\n    ): THREE.BufferGeometry {\r\n        if (isSimple) {\r\n            geometry.setAttribute(\r\n                \"position\",\r\n                new THREE.BufferAttribute(new Float32Array(vertices), 3)\r\n            );\r\n            if (colors.length === vertices.length) {\r\n                geometry.setAttribute(\r\n                    \"color\",\r\n                    new THREE.BufferAttribute(new Float32Array(colors), 3)\r\n                );\r\n            }\r\n            geometry.setIndex(new THREE.BufferAttribute(new Uint32Array(indices), 1));\r\n            return geometry;\r\n        } else {\r\n            const vertexDescriptor = getVertexDescriptor(hasNormalsAndUvs, highPrecision);\r\n\r\n            const buffer = new THREE.InterleavedBuffer(\r\n                new Float32Array(vertices),\r\n                vertexDescriptor.stride\r\n            );\r\n            vertexDescriptor.attributes.forEach(descr => {\r\n                const attribute = new THREE.InterleavedBufferAttribute(\r\n                    buffer,\r\n                    descr.itemSize,\r\n                    descr.offset,\r\n                    false\r\n                );\r\n                geometry.setAttribute(descr.name, attribute);\r\n            });\r\n            if (colors.length === vertices.length) {\r\n                geometry.setAttribute(\r\n                    \"color\",\r\n                    new THREE.BufferAttribute(new Float32Array(colors), 3)\r\n                );\r\n            }\r\n\r\n            geometry.setIndex(new THREE.BufferAttribute(new Uint32Array(indices), 1));\r\n\r\n            return geometry;\r\n        }\r\n    }\r\n\r\n    private readonly m_geometry: LineGeometry;\r\n\r\n    constructor(\r\n        readonly hasNormalsAndUvs: boolean = false,\r\n        readonly highPrecision: boolean = false,\r\n        readonly isSimple: boolean = false\r\n    ) {\r\n        this.m_geometry = new LineGeometry();\r\n    }\r\n\r\n    /**\r\n     * Clears the list of line strips.\r\n     */\r\n    clear() {\r\n        this.m_geometry.vertices = [];\r\n        this.m_geometry.vertexColors = [];\r\n        this.m_geometry.indices = [];\r\n    }\r\n\r\n    /**\r\n     * Add the given points to this line group.\r\n     *\r\n     * @param center - World center of the provided points.\r\n     * @param points - Sequence of (x,y,z) coordinates.\r\n     * @param offsets - Sequence of line segment offsets.\r\n     * @param uvs - Sequence of (u,v) texture coordinates.\r\n     * @param colors - Sequence of (r,g,b) color components.\r\n     */\r\n    add(\r\n        center: THREE.Vector3,\r\n        points: ArrayLike<number>,\r\n        projection: Projection,\r\n        offsets?: ArrayLike<number>,\r\n        uvs?: ArrayLike<number>,\r\n        colors?: ArrayLike<number>\r\n    ): this {\r\n        if (!this.isSimple) {\r\n            assert(!this.hasNormalsAndUvs || uvs !== undefined);\r\n            createLineGeometry(\r\n                center,\r\n                points,\r\n                projection,\r\n                offsets,\r\n                uvs,\r\n                colors,\r\n                this.m_geometry,\r\n                this.highPrecision\r\n            );\r\n        } else {\r\n            createSimpleLineGeometry(points, colors, this.m_geometry);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns the list of vertices.\r\n     */\r\n    get vertices(): number[] {\r\n        return this.m_geometry.vertices;\r\n    }\r\n\r\n    /**\r\n     * Returns the list of vertex colors.\r\n     */\r\n    get vertexColors(): number[] {\r\n        return this.m_geometry.vertexColors;\r\n    }\r\n\r\n    /**\r\n     * Returns the list of indices.\r\n     */\r\n    get indices(): number[] {\r\n        return this.m_geometry.indices;\r\n    }\r\n\r\n    /**\r\n     * Returns the list of [[VertexAttributeDescriptor]]s.\r\n     */\r\n    get vertexAttributes(): VertexAttributeDescriptor[] {\r\n        return getVertexDescriptor(this.hasNormalsAndUvs, this.highPrecision).attributes;\r\n    }\r\n\r\n    /**\r\n     * Returns the vertex attribute stride.\r\n     */\r\n    get stride(): number {\r\n        return getVertexDescriptor(this.hasNormalsAndUvs, this.highPrecision).stride;\r\n    }\r\n\r\n    /**\r\n     * Creates a three.js geometry.\r\n     */\r\n    createGeometry(geometry?: THREE.BufferGeometry): THREE.BufferGeometry {\r\n        if (geometry === undefined) {\r\n            geometry = new THREE.BufferGeometry();\r\n        }\r\n        return LineGroup.createGeometry(\r\n            this.m_geometry.vertices,\r\n            this.m_geometry.vertexColors,\r\n            this.m_geometry.indices,\r\n            geometry,\r\n            this.hasNormalsAndUvs,\r\n            this.highPrecision\r\n        );\r\n    }\r\n}\r\n\r\nfunction computeBitangent(\r\n    n: THREE.Vector3,\r\n    t0: THREE.Vector3,\r\n    t1: THREE.Vector3,\r\n    bt: THREE.Vector3\r\n): number {\r\n    let angle = 0;\r\n    if (!t0.equals(t1)) {\r\n        angle = Math.acos(t0.dot(t1)) * Math.sign(n.dot(tmpV.copy(t0).cross(t1)));\r\n        if (Number.isNaN(angle)) {\r\n            angle = 0;\r\n        }\r\n    }\r\n    bt.copy(t0).add(t1).normalize().cross(n).normalize();\r\n    return angle;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport * as THREE from \"three\";\r\n\r\nconst UNIT_Z = new THREE.Vector3(0, 0, 1);\r\nconst POINTS = [0, 1, 2, 1, 3, 2];\r\nconst BEVEL_POINTS = [0, 1, 3, 3, 1, 2, 0, 3, 4, 5, 4, 3];\r\n\r\nconst SECTORS_IN_CIRCLE = 8;\r\nconst STEP = Math.PI / SECTORS_IN_CIRCLE;\r\n\r\n/**\r\n * Adds a half-circle geometry to original line\r\n *\r\n * @param x - The line end X (used as circle center X)\r\n * @param y - The line end Y (used as circle center Y)\r\n * @param lineAngle - The cap incline angle\r\n * @param radius - The cap (circle) radius\r\n * @param vertices - The input vertex buffer (cap vertices are added there)\r\n * @param indices - The input index buffer (cap indices are is added there)\r\n */\r\nfunction addCircle(\r\n    x: number,\r\n    y: number,\r\n    lineAngle: number,\r\n    radius: number,\r\n    vertices: number[],\r\n    indices: number[]\r\n) {\r\n    const baseVertex = vertices.length / 3;\r\n\r\n    // Add cap center to vertices directly (it doesn't need rotation)\r\n    vertices.push(x, y, 0);\r\n\r\n    for (let i = 0; i < SECTORS_IN_CIRCLE + 1; ++i) {\r\n        const angle = STEP * i + Math.PI / 2 + lineAngle; // Start angle is -90deg\r\n        vertices.push(x + radius * Math.cos(angle), y + radius * Math.sin(angle), 0);\r\n\r\n        indices.push(\r\n            baseVertex,\r\n            baseVertex + i + 1,\r\n            baseVertex + ((i + 1) % (SECTORS_IN_CIRCLE + 1)) + 1\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the number of points in circle used for caps.\r\n *\r\n * @param lineWidth - Width of line.\r\n */\r\nexport function numCirclePoints(lineWidth: number): number {\r\n    return SECTORS_IN_CIRCLE + 1;\r\n}\r\n\r\n/**\r\n * Create a triangle mesh from the given polyline.\r\n *\r\n * @param points - Sequence of (x,y,z) coordinates.\r\n * @param width - The width of the extruded line.\r\n * @param vertices - The output vertex buffer.\r\n * @param indices - The output index buffer.\r\n * @param startWithCircle - `true` if the line should start will a circle.\r\n * @param endWithCircle - `true` if the line should end with a circle.\r\n */\r\nexport function triangulateLine(\r\n    points: ArrayLike<number>,\r\n    width: number,\r\n    vertices: number[],\r\n    indices: number[],\r\n    startWithCircle = true,\r\n    endWithCircle = startWithCircle\r\n) {\r\n    if (points.length < 3) {\r\n        return;\r\n    }\r\n\r\n    // This vector is used for computing cap angle\r\n    const angleVec = new THREE.Vector2();\r\n\r\n    if (startWithCircle) {\r\n        // Define lineAngle as (direction - origin) vector angle to X axis\r\n        const lineAngle =\r\n            points.length !== 3\r\n                ? angleVec.set(points[3] - points[0], points[4] - points[1]).angle()\r\n                : 0;\r\n\r\n        addCircle(points[0], points[1], lineAngle, width, vertices, indices);\r\n    }\r\n\r\n    const baseVertex = vertices.length / 3;\r\n\r\n    // bt = Bitangent (i.e. extrusion vector)\r\n    const prevBt = new THREE.Vector3();\r\n    const p = new THREE.Vector3(); // current point\r\n    const n = new THREE.Vector3(); // next point\r\n    const bt = new THREE.Vector3();\r\n    const averageBt = new THREE.Vector3();\r\n    const p0 = new THREE.Vector3();\r\n    const p1 = new THREE.Vector3();\r\n    const p2 = new THREE.Vector3();\r\n    const p3 = new THREE.Vector3();\r\n\r\n    const N = points.length / 3;\r\n\r\n    let vertexOffset = 0;\r\n    for (let i = 0; i < N; ++i) {\r\n        let useBevel = false;\r\n        p.set(points[i * 3], points[i * 3 + 1], points[i * 3 + 2]);\r\n\r\n        if (i + 1 < N) {\r\n            n.set(points[(i + 1) * 3], points[(i + 1) * 3 + 1], points[(i + 1) * 3 + 2]);\r\n\r\n            bt.copy(n).sub(p).normalize().cross(UNIT_Z);\r\n\r\n            averageBt.copy(bt);\r\n\r\n            if (i > 0) {\r\n                averageBt.add(prevBt).multiplyScalar(1.0 - 0.5 * bt.dot(prevBt));\r\n\r\n                useBevel = prevBt.angleTo(bt) > Math.PI / 2;\r\n\r\n                if (useBevel) {\r\n                    const inclineWidth = width / Math.cos(bt.angleTo(prevBt) / 2);\r\n\r\n                    p0.copy(bt).add(prevBt).normalize().multiplyScalar(-inclineWidth).add(p);\r\n\r\n                    p1.copy(prevBt).multiplyScalar(width).add(p);\r\n\r\n                    // p2 is used for \"miter\" connections\r\n                    p2.copy(bt).add(prevBt).normalize().multiplyScalar(inclineWidth).add(p);\r\n\r\n                    p3.copy(bt).multiplyScalar(width).add(p);\r\n                }\r\n            }\r\n\r\n            if (useBevel) {\r\n                vertices.push(\r\n                    p0.x,\r\n                    p0.y,\r\n                    p0.z,\r\n                    p1.x,\r\n                    p1.y,\r\n                    p1.z,\r\n                    p2.x,\r\n                    p2.y,\r\n                    p2.z,\r\n                    p3.x,\r\n                    p3.y,\r\n                    p3.z\r\n                );\r\n            } else {\r\n                p0.copy(averageBt).multiplyScalar(-width).add(p);\r\n\r\n                p1.copy(averageBt).multiplyScalar(width).add(p);\r\n\r\n                vertices.push(p0.x, p0.y, p0.z, p1.x, p1.y, p1.z);\r\n            }\r\n\r\n            prevBt.copy(bt);\r\n        } else {\r\n            p0.copy(prevBt).multiplyScalar(-width).add(p);\r\n\r\n            p1.copy(prevBt).multiplyScalar(width).add(p);\r\n\r\n            vertices.push(p0.x, p0.y, p0.z, p1.x, p1.y, p1.z);\r\n        }\r\n\r\n        if (i !== N - 1) {\r\n            (useBevel ? BEVEL_POINTS : POINTS).forEach(o =>\r\n                indices.push(baseVertex + vertexOffset + o)\r\n            );\r\n            vertexOffset += useBevel ? 4 : 2;\r\n        }\r\n    }\r\n\r\n    if (endWithCircle) {\r\n        const lineAngle =\r\n            points.length !== 2\r\n                ? angleVec\r\n                      .set(\r\n                          points[(N - 3) * 3] - points[(N - 2) * 3],\r\n                          points[(N - 3) * 3 + 1] - points[(N - 2) * 3 + 1]\r\n                      )\r\n                      .angle()\r\n                : Math.PI;\r\n\r\n        addCircle(\r\n            points[(N - 2) * 3],\r\n            points[(N - 2) * 3 + 1],\r\n            lineAngle,\r\n            width,\r\n            vertices,\r\n            indices\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * Reconstruct the original points of a line from the vertices of the triangulated line.\r\n *\r\n * @param inBuffer - Buffer with vertices.\r\n * @param startOffset - Start index, will differ from `0` if the line has caps.\r\n * @returns Buffer containing the original points of the triangulated line.\r\n */\r\nexport function reconstructLine(inBuffer: Float32Array, startOffset: number): Float32Array {\r\n    const outBuffer = new Float32Array(inBuffer.length / 2);\r\n\r\n    for (let i = startOffset * 3, i2 = i * 2; i < outBuffer.length; i += 3, i2 += 6) {\r\n        outBuffer[i] = inBuffer[i2] + (inBuffer[i2 + 3] - inBuffer[i2]) * 0.5;\r\n        outBuffer[i + 1] = inBuffer[i2 + 1] + (inBuffer[i2 + 3 + 1] - inBuffer[i2 + 1]) * 0.5;\r\n        outBuffer[i + 2] = inBuffer[i2 + 2] + (inBuffer[i2 + 3 + 2] - inBuffer[i2 + 2]) * 0.5;\r\n    }\r\n    return outBuffer;\r\n}\r\n\r\n/**\r\n * Extract the line width from a triangulated line.\r\n *\r\n * @param inBuffer - Array of vertex elements of a triangulated line.\r\n * @param startIndex - Start index, will differ from `0` if the line has caps.\r\n */\r\nexport function reconstructLineWidth(inBuffer: Float32Array, startIndex: number): number {\r\n    const xd = inBuffer[startIndex * 2 + 3] - inBuffer[startIndex * 2];\r\n    const yd = inBuffer[startIndex * 2 + 3 + 1] - inBuffer[startIndex * 2 + 1];\r\n    const zd = inBuffer[startIndex * 2 + 3 + 2] - inBuffer[startIndex * 2 + 2];\r\n\r\n    return Math.sqrt(xd * xd + yd * yd + zd * zd) * 0.5;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport * from \"./lib/ThemedTileDecoder\";\r\nexport * from \"./lib/TileDecoderService\";\r\nexport * from \"./lib/TilerService\";\r\nexport * from \"./lib/WorkerService\";\r\nexport * from \"./lib/WorkerServiceManager\";\r\nexport * from \"./lib/GeoJsonTiler\";\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { GeoJson, isFeatureGeometry, ITiler } from \"@here/harp-datasource-protocol\";\r\nimport { TileKey } from \"@here/harp-geoutils\";\r\n// @ts-ignore\r\nimport * as geojsonvtExport from \"geojson-vt\";\r\n\r\n// to be able to run tests on nodejs\r\nconst geojsonvt = geojsonvtExport.default ?? geojsonvtExport;\r\n\r\nconst EXTENT = 4096;\r\n\r\n// the factor used to compute the size of the buffer.\r\nconst BUFFER_FACTOR = 0.05;\r\n\r\n// align the buffer to the next integer multiple of 2.\r\nconst BUFFER = -(-Math.ceil(EXTENT * BUFFER_FACTOR) & -2);\r\n\r\ninterface GeoJsonVtIndex {\r\n    geojson: GeoJson;\r\n    getTile(level: number, column: number, row: number): any;\r\n}\r\n\r\nexport class GeoJsonTiler implements ITiler {\r\n    indexes: Map<string, GeoJsonVtIndex>;\r\n\r\n    constructor() {\r\n        this.indexes = new Map();\r\n    }\r\n\r\n    dispose() {\r\n        /* */\r\n    }\r\n\r\n    async connect(): Promise<void> {\r\n        return await Promise.resolve();\r\n    }\r\n\r\n    async registerIndex(indexId: string, input: URL | GeoJson): Promise<void> {\r\n        if (this.indexes.has(indexId)) {\r\n            return;\r\n        }\r\n        return await this.updateIndex(indexId, input);\r\n    }\r\n\r\n    async updateIndex(indexId: string, input: URL | GeoJson): Promise<void> {\r\n        if (input instanceof URL) {\r\n            const response = await fetch(input.href);\r\n            if (!response.ok) {\r\n                throw new Error(\r\n                    `GeoJsonTiler: Unable to fetch ${input.href}: ${response.statusText}`\r\n                );\r\n            }\r\n            input = (await response.json()) as GeoJson;\r\n        } else {\r\n            input = input as GeoJson;\r\n        }\r\n\r\n        // Generate ids only if input doesn't have them.\r\n        const generateId =\r\n            isFeatureGeometry(input) ||\r\n            input.type === \"GeometryCollection\" ||\r\n            (input.type === \"Feature\" && input.id === undefined) ||\r\n            (input.type === \"FeatureCollection\" &&\r\n                input.features.length > 0 &&\r\n                input.features[0].id === undefined);\r\n        const index = geojsonvt(input, {\r\n            maxZoom: 20, // max zoom to preserve detail on\r\n            indexMaxZoom: 5, // max zoom in the tile index\r\n            indexMaxPoints: 100000, // max number of points per tile in the tile index\r\n            tolerance: 3, // simplification tolerance (higher means simpler)\r\n            extent: EXTENT, // tile extent\r\n            buffer: BUFFER, // tile buffer on each side\r\n            lineMetrics: false, // whether to calculate line metrics\r\n            promoteId: null, // name of a feature property to be promoted to feature.id\r\n            generateId, // whether to generate feature ids. Cannot be used with promoteId\r\n            debug: 0 // logging level (0, 1 or 2)\r\n        });\r\n        index.geojson = input;\r\n\r\n        this.indexes.set(indexId, index);\r\n    }\r\n\r\n    async getTile(indexId: string, tileKey: TileKey): Promise<{}> {\r\n        const index = this.indexes.get(indexId);\r\n        if (index === undefined) {\r\n            throw new Error(\"Tile not found\");\r\n        }\r\n        const tile = index.getTile(tileKey.level, tileKey.column, tileKey.row);\r\n        if (tile !== null) {\r\n            tile.layer = indexId;\r\n        }\r\n        return tile || {};\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport {\r\n    DecodedTile,\r\n    DecoderOptions,\r\n    ITileDecoder,\r\n    OptionsMap,\r\n    TileInfo\r\n} from \"@here/harp-datasource-protocol\";\r\nimport { StyleSetEvaluator, StyleSetOptions } from \"@here/harp-datasource-protocol/index-decoder\";\r\nimport { Projection, TileKey } from \"@here/harp-geoutils\";\r\nimport { LoggerManager } from \"@here/harp-utils\";\r\n\r\nconst logger = LoggerManager.instance.create(\"ThemedTileDecoder\");\r\n\r\n/**\r\n * `ThemedTileDecoder` implements an [[ITileDecoder]] which uses a [[Theme]] to apply styles to the\r\n * objects displayed in the map.\r\n *\r\n * By default, decoders are executed in web workers (using [[TileDecoderService]]) for performance\r\n * reasons.\r\n */\r\nexport abstract class ThemedTileDecoder implements ITileDecoder {\r\n    languages?: string[];\r\n    m_storageLevelOffset: number = 0;\r\n\r\n    protected m_styleSetEvaluator?: StyleSetEvaluator;\r\n    abstract connect(): Promise<void>;\r\n\r\n    dispose() {\r\n        // implemented in subclasses\r\n    }\r\n\r\n    decodeTile(\r\n        data: ArrayBufferLike | {},\r\n        tileKey: TileKey,\r\n        projection: Projection\r\n    ): Promise<DecodedTile | undefined> {\r\n        if (this.m_styleSetEvaluator === undefined) {\r\n            logger.info(\"cannot decode tile, as there is not style available\");\r\n            return Promise.resolve(undefined);\r\n        }\r\n\r\n        return this.decodeThemedTile(data, tileKey, this.m_styleSetEvaluator, projection);\r\n    }\r\n\r\n    getTileInfo(\r\n        data: ArrayBufferLike,\r\n        tileKey: TileKey,\r\n        projection: Projection\r\n    ): Promise<TileInfo | undefined> {\r\n        return Promise.resolve(undefined);\r\n    }\r\n\r\n    configure(options?: DecoderOptions, customOptions?: OptionsMap): void {\r\n        if (options?.styleSet !== undefined) {\r\n            this.m_styleSetEvaluator = new StyleSetEvaluator(options as StyleSetOptions);\r\n        }\r\n        if (options?.languages !== undefined) {\r\n            this.languages = options.languages;\r\n        }\r\n        if (customOptions !== undefined && customOptions.storageLevelOffset !== undefined) {\r\n            this.m_storageLevelOffset = customOptions.storageLevelOffset;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create a [[DecodedTile]] from binary tile data and a theme description in form of a\r\n     * [[StyleSetEvaluator]].\r\n     *\r\n     * @param data - Binary data in form of [[ArrayBufferLike]], or any object.\r\n     * @param tileKey - Quadtree address of tile.\r\n     * @param styleSetEvaluator - Processor of [[Theme]], identifies styling techniques applicable\r\n     *                            to individual objects.\r\n     * @param projection - Projection used by the individual data sources.\r\n     */\r\n    abstract decodeThemedTile(\r\n        data: ArrayBufferLike | {},\r\n        tileKey: TileKey,\r\n        styleSetEvaluator: StyleSetEvaluator,\r\n        projection: Projection\r\n    ): Promise<DecodedTile>;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport {\r\n    addBuffersToTransferList,\r\n    BufferAttribute,\r\n    getProjection,\r\n    InterleavedBufferAttribute,\r\n    ITileDecoder,\r\n    WorkerDecoderProtocol\r\n} from \"@here/harp-datasource-protocol\";\r\nimport { TileKey } from \"@here/harp-geoutils\";\r\nimport { LoggerManager } from \"@here/harp-utils\";\r\n\r\nimport { WorkerService, WorkerServiceResponse } from \"./WorkerService\";\r\n\r\nconst logger = LoggerManager.instance.create(\"TileDecoderService\");\r\n\r\n/**\r\n * An extension to [[WorkerService]], the `TileDecoderService` implements an asynchronous\r\n * (message based) service to decode tile content in web workers. The `TileDecoderService` itself\r\n * lives in the web worker, and communicates with messages by means of a [[ConcurrentWorkerSet]]\r\n * with the application.\r\n *\r\n * The `TileDecoderService` handles a [[DecodeTileRequest]], which contains a tile and its freshly\r\n * loaded binary data, decodes the content with the [[ITileDecoder]] that the service is configured\r\n * to use, and sends the data back in form of a [[WorkerServiceResponse]].\r\n */\r\nexport class TileDecoderService extends WorkerService {\r\n    /**\r\n     * Start a [[TileDecoderService]] with a given decoder.\r\n     *\r\n     * @param serviceId - Service id. Must be unique.\r\n     * @param decoder -   [[TileDecoder]] instance.\r\n     */\r\n    static start(serviceId: string, decoder: ITileDecoder) {\r\n        return new TileDecoderService(serviceId, decoder);\r\n    }\r\n\r\n    /**\r\n     * Set up the `TileDecoderService`. The name of the service must be unique\r\n     *\r\n     * @param serviceId - Service id. Must be unique.\r\n     * @param m_decoder - Decoder to handle the decoding and info requests.\r\n     */\r\n    constructor(readonly serviceId: string, private readonly m_decoder: ITileDecoder) {\r\n        super(serviceId);\r\n        this.m_decoder.connect();\r\n    }\r\n\r\n    /**\r\n     * Handle incoming request messages. Identifies message type and processes the request.\r\n     *\r\n     * @param request - Message that is either a DecodeTileRequest or a TileInfoRequest.\r\n     * @returns A promise which resolves to a [[WorkerServiceResponse]].\r\n     * @override\r\n     */\r\n    protected handleRequest(request: any): Promise<WorkerServiceResponse> {\r\n        if (WorkerDecoderProtocol.isDecodeTileRequest(request)) {\r\n            return this.handleDecodeTileRequest(request);\r\n        } else if (WorkerDecoderProtocol.isTileInfoRequest(request)) {\r\n            return this.handleTileInfoRequest(request);\r\n        } else {\r\n            return super.handleRequest(request);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handle incoming configuration message. Configuration message is passed on to decoder.\r\n     *\r\n     * @param request - Message of type [[ConfigurationMessage]].\r\n     * @override\r\n     */\r\n    protected handleMessage(message: any) {\r\n        if (WorkerDecoderProtocol.isConfigurationMessage(message)) {\r\n            this.handleConfigurationMessage(message);\r\n        } else {\r\n            logger.error(`[${this.serviceId}]: invalid message ${message.type}`);\r\n        }\r\n    }\r\n\r\n    private async handleDecodeTileRequest(\r\n        request: WorkerDecoderProtocol.DecodeTileRequest\r\n    ): Promise<WorkerServiceResponse> {\r\n        const tileKey = TileKey.fromMortonCode(request.tileKey);\r\n        const projection = getProjection(request.projection);\r\n\r\n        const decodedTile = await this.m_decoder.decodeTile(request.data, tileKey, projection);\r\n\r\n        const transferList: ArrayBufferLike[] = [];\r\n\r\n        const transferBufferAttribute = (\r\n            attribute?: BufferAttribute | InterleavedBufferAttribute\r\n        ) => {\r\n            if (\r\n                attribute !== undefined &&\r\n                attribute.buffer.byteLength > 0 &&\r\n                !transferList.includes(attribute.buffer)\r\n            ) {\r\n                transferList.push(attribute.buffer);\r\n            }\r\n        };\r\n\r\n        decodedTile?.geometries.forEach(geom => {\r\n            geom.vertexAttributes?.forEach(attr => transferBufferAttribute(attr));\r\n            geom.interleavedVertexAttributes?.forEach(attr => transferBufferAttribute(attr));\r\n            transferBufferAttribute(geom.index);\r\n            transferBufferAttribute(geom.edgeIndex);\r\n\r\n            if (\r\n                Array.isArray(geom.objInfos) &&\r\n                geom.objInfos.length === 1 &&\r\n                typeof geom.objInfos[0] === \"object\" &&\r\n                geom.objInfos[0]?.hasOwnProperty(\"displacementMap\")\r\n            ) {\r\n                const obj = geom.objInfos[0] as any;\r\n                transferBufferAttribute(obj.displacementMap);\r\n            }\r\n\r\n            if (Array.isArray(geom.attachments)) {\r\n                geom.attachments.forEach(attachment => {\r\n                    transferBufferAttribute(attachment.index);\r\n                    transferBufferAttribute(attachment.edgeIndex);\r\n                });\r\n            }\r\n        });\r\n\r\n        decodedTile?.techniques.forEach(technique => {\r\n            addBuffersToTransferList(technique, transferList);\r\n        });\r\n\r\n        return {\r\n            response: decodedTile,\r\n            transferList\r\n        };\r\n    }\r\n\r\n    private handleTileInfoRequest(\r\n        request: WorkerDecoderProtocol.TileInfoRequest\r\n    ): Promise<WorkerServiceResponse> {\r\n        const tileKey = TileKey.fromMortonCode(request.tileKey);\r\n        const projection = getProjection(request.projection);\r\n\r\n        return this.m_decoder.getTileInfo(request.data, tileKey, projection).then(tileInfo => {\r\n            const transferList: ArrayBuffer[] =\r\n                tileInfo !== undefined && tileInfo.transferList !== undefined\r\n                    ? tileInfo.transferList\r\n                    : [];\r\n            return {\r\n                response: tileInfo,\r\n                transferList\r\n            };\r\n        });\r\n    }\r\n\r\n    private handleConfigurationMessage(message: WorkerDecoderProtocol.ConfigurationMessage) {\r\n        this.m_decoder.configure(message, message.options);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { ITiler, WorkerTilerProtocol } from \"@here/harp-datasource-protocol\";\r\nimport { TileKey } from \"@here/harp-geoutils\";\r\n\r\nimport { GeoJsonTiler } from \"./GeoJsonTiler\";\r\nimport { WorkerService, WorkerServiceResponse } from \"./WorkerService\";\r\n\r\n/**\r\n * An extension to {@link WorkerService}, the `TilerService`\r\n * implements an asynchronous (message based)\r\n * service to tile untiled payloads in web workers.\r\n *\r\n * @remarks\r\n * The `TilerService` itself lives in the web\r\n * worker, and communicates with messages by means of a `ConcurrentWorkerSet` with the\r\n * application.\r\n *\r\n * The `TilerService` registers tile indices (parent tile to be subdivided) by handling a\r\n * `RegisterIndexRequest`, and can later retrieve tiled payloads from through the `TileRequest`.\r\n * The data is sent back in form of a {@link WorkerServiceResponse}.\r\n */\r\nexport class TilerService extends WorkerService {\r\n    /**\r\n     * Start a `TilerService`.\r\n     *\r\n     * @param serviceId - Service id. Must be unique.\r\n     */\r\n    static start(serviceId: string) {\r\n        return new TilerService(serviceId);\r\n    }\r\n\r\n    tiler: ITiler = new GeoJsonTiler();\r\n\r\n    /**\r\n     * Set up the `TilerService`. The name of the service must be unique\r\n     *\r\n     * @param serviceId - Service id. Must be unique.\r\n     */\r\n    constructor(readonly serviceId: string) {\r\n        super(serviceId);\r\n    }\r\n\r\n    /**\r\n     * Handle incoming request messages. Identifies message type and processes the request.\r\n     *\r\n     * @param request - {@link WorkerTilerProtocol} request.\r\n     * @returns A promise which resolves to a {@link WorkerServiceResponse}.\r\n     * @override\r\n     */\r\n    protected handleRequest(request: any): Promise<WorkerServiceResponse> {\r\n        if (WorkerTilerProtocol.isRegisterIndexRequest(request)) {\r\n            return this.handleRegisterIndexRequest(request);\r\n        } else if (WorkerTilerProtocol.isUpdateIndexRequest(request)) {\r\n            return this.handleUpdateIndexRequest(request);\r\n        } else if (WorkerTilerProtocol.isTileRequest(request)) {\r\n            return this.handleTileRequest(request);\r\n        } else {\r\n            return super.handleRequest(request);\r\n        }\r\n    }\r\n\r\n    private async handleTileRequest(\r\n        request: WorkerTilerProtocol.TileRequest\r\n    ): Promise<WorkerServiceResponse> {\r\n        const tileKey = TileKey.fromMortonCode(request.tileKey);\r\n        const tile = await this.tiler.getTile(request.index, tileKey);\r\n\r\n        return { response: tile || {} };\r\n    }\r\n\r\n    private async handleRegisterIndexRequest(\r\n        message: WorkerTilerProtocol.RegisterIndexRequest\r\n    ): Promise<WorkerServiceResponse> {\r\n        const input = typeof message.input === \"string\" ? new URL(message.input) : message.input;\r\n        await this.tiler.registerIndex(message.id, input);\r\n\r\n        return { response: {} };\r\n    }\r\n\r\n    private async handleUpdateIndexRequest(\r\n        message: WorkerTilerProtocol.UpdateIndexRequest\r\n    ): Promise<WorkerServiceResponse> {\r\n        const input = typeof message.input === \"string\" ? new URL(message.input) : message.input;\r\n\r\n        this.tiler.updateIndex(message.id, input);\r\n\r\n        return { response: {} };\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { WorkerServiceProtocol } from \"@here/harp-datasource-protocol\";\r\nimport { LoggerManager } from \"@here/harp-utils\";\r\n\r\nconst logger = LoggerManager.instance.create(\"WorkerService\", { enabled: true });\r\n\r\ndeclare let self: Worker;\r\n\r\n/**\r\n * Response for {@link WorkerService} procession results.\r\n */\r\nexport interface WorkerServiceResponse {\r\n    /**\r\n     * Response object.\r\n     */\r\n    response: any;\r\n\r\n    /**\r\n     * Transfer list containing a list of `ArrayBuffer` which transfer ownership from web worker\r\n     * to UI thread.\r\n     */\r\n    transferList?: ArrayBuffer[];\r\n}\r\n\r\n/**\r\n * Header information for a [[RequestMessage]].\r\n */\r\ninterface RequestEntry {\r\n    /**\r\n     * ID of service.\r\n     */\r\n    service: string;\r\n\r\n    /**\r\n     * Unique ID of message.\r\n     */\r\n    messageId: number;\r\n\r\n    /**\r\n     * Contains `true` if message has been processed, and response has been sent.\r\n     */\r\n    responseSent: boolean;\r\n}\r\n\r\n/**\r\n * Worker Service communication helper.\r\n *\r\n * @remarks\r\n * Listens to Web Worker messages from `entWorkerSet` and implements:\r\n *  - worker service initialization\r\n *  - request/response scheme\r\n *  - error handling.\r\n *\r\n * This class should be subclassed to provide concrete like `TileDecoderService`.\r\n *\r\n * Communication peer for `ConcurrentWorkerSet`.\r\n */\r\nexport abstract class WorkerService {\r\n    private readonly m_pendingRequests: Map<number, RequestEntry> = new Map();\r\n\r\n    /**\r\n     * Sets up the `WorkerService` with the specified name, and starts processing messages.\r\n     *\r\n     * @param serviceId - The service id.\r\n     */\r\n    constructor(readonly serviceId: string) {\r\n        self.addEventListener(\"message\", this.onMessage);\r\n\r\n        const isInitializedMessage: WorkerServiceProtocol.InitializedMessage = {\r\n            service: serviceId,\r\n            type: WorkerServiceProtocol.ServiceMessageName.Initialized\r\n        };\r\n        self.postMessage(isInitializedMessage);\r\n    }\r\n\r\n    /**\r\n     * Destroy the `WorkerService`. Cancels all pending requests ad removes itself from the message\r\n     * queue.\r\n     */\r\n    destroy() {\r\n        this.cancelAllPendingRequests();\r\n\r\n        self.removeEventListener(\"message\", this.onMessage);\r\n    }\r\n\r\n    /**\r\n     * Message handler to be overridden by implementation.\r\n     *\r\n     * @param message - `MessageEvent.data` as received by `WorkerService`.\r\n     */\r\n    protected handleMessage(message: any): void {\r\n        logger.error(`[${this.serviceId}]: Invalid message ${message.type}`);\r\n    }\r\n\r\n    /**\r\n     * Call request handler to be overridden by implementation.\r\n     *\r\n     * @param request - `RequestMessage.request` as received by `WorkerService`.\r\n     */\r\n    protected handleRequest(request: any): Promise<WorkerServiceResponse> {\r\n        throw new Error(`ServiceAdapter[${this.serviceId}]: Invalid request '${request.type}'`);\r\n    }\r\n\r\n    /**\r\n     * Central message handler for this service.\r\n     *\r\n     * Responsible for filtering message target and managing request/response sequence.\r\n     *\r\n     * @param message - Message to be dispatched.\r\n     */\r\n    private readonly onMessage = (message: MessageEvent) => {\r\n        if (typeof message.data.service !== \"string\" || message.data.service !== this.serviceId) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            if (WorkerServiceProtocol.isRequestMessage(message.data)) {\r\n                const request = message.data;\r\n                const requestEntry = {\r\n                    service: request.service,\r\n                    messageId: request.messageId,\r\n                    responseSent: false\r\n                };\r\n                this.m_pendingRequests.set(request.messageId, requestEntry);\r\n                this.tryHandleRequest(request.request)\r\n                    .then(response => {\r\n                        this.doSendResponse(\r\n                            requestEntry,\r\n                            {\r\n                                service: this.serviceId,\r\n                                type: WorkerServiceProtocol.ServiceMessageName.Response,\r\n                                messageId: request.messageId,\r\n                                response: response.response\r\n                            },\r\n                            response.transferList\r\n                        );\r\n                    })\r\n                    .catch(error => {\r\n                        this.doSendResponse(requestEntry, {\r\n                            service: this.serviceId,\r\n                            type: WorkerServiceProtocol.ServiceMessageName.Response,\r\n                            messageId: request.messageId,\r\n                            errorMessage: error.toString(),\r\n                            errorStack: error.stack\r\n                        });\r\n                    });\r\n            } else {\r\n                this.tryHandleMessage(message.data);\r\n            }\r\n        } catch (err) {\r\n            logger.error(`[${this.serviceId}]: Unhandled exception when handling ${message.type}`);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Safety belt over `handleMessage` for correct exception handling & logging.\r\n     */\r\n    private tryHandleMessage(message: any): void {\r\n        try {\r\n            this.handleMessage(message);\r\n        } catch (error) {\r\n            logger.error(`[${this.serviceId}]: Failed, handling message ${message.type}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Safety belt over `handleRequest` for correct exception handling in promise chain.\r\n     */\r\n    private tryHandleRequest(request: any): Promise<WorkerServiceResponse> {\r\n        try {\r\n            return this.handleRequest(request);\r\n        } catch (error) {\r\n            // we don't log exceptions here as they are propagated to client as responses\r\n            logger.error(`[${this.serviceId}]: Failure`, error);\r\n            return Promise.reject(error);\r\n        }\r\n    }\r\n\r\n    private doSendResponse(\r\n        requestEntry: RequestEntry,\r\n        response: WorkerServiceProtocol.ResponseMessage,\r\n        transferList?: ArrayBuffer[]\r\n    ) {\r\n        if (requestEntry.responseSent) {\r\n            return;\r\n        }\r\n\r\n        if (transferList !== undefined) {\r\n            self.postMessage(response, transferList);\r\n        } else {\r\n            self.postMessage(response);\r\n        }\r\n\r\n        requestEntry.responseSent = true;\r\n        this.m_pendingRequests.delete(requestEntry.messageId);\r\n    }\r\n\r\n    private cancelAllPendingRequests() {\r\n        this.m_pendingRequests.forEach(requestEntry => {\r\n            this.doSendResponse(requestEntry, {\r\n                service: this.serviceId,\r\n                type: WorkerServiceProtocol.ServiceMessageName.Response,\r\n                messageId: requestEntry.messageId,\r\n                errorMessage: \"cancelled\"\r\n            });\r\n        });\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { WorkerServiceProtocol } from \"@here/harp-datasource-protocol\";\r\n\r\nimport { WorkerService, WorkerServiceResponse } from \"./WorkerService\";\r\n\r\n/**\r\n * Factory function that creates [[WorkerService]].\r\n */\r\nexport type WorkerServiceFactory = (serviceId: string) => WorkerService;\r\n\r\n/**\r\n * Worker service class definition as needed by [[WorkerServiceManager.register]].\r\n */\r\nexport interface WorkerServiceDescriptor {\r\n    serviceType: string;\r\n    factory: WorkerServiceFactory;\r\n}\r\n\r\n/**\r\n * Manages dynamic worker services in Web Worker context.\r\n *\r\n * Handles `CreateService` and `DestroyService` messages sent to Web Worker. Singleton (in scope of\r\n * one worker runtime!), starts automatically with first [[getInstance]] call.\r\n */\r\nexport class WorkerServiceManager extends WorkerService {\r\n    /**\r\n     * Gets the default instance of `WorkerServiceManager`. Starts the service when first called.\r\n     */\r\n    static getInstance() {\r\n        if (this.m_service === undefined) {\r\n            this.m_service = new WorkerServiceManager(\r\n                WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID\r\n            );\r\n        }\r\n        return this.m_service;\r\n    }\r\n\r\n    /**\r\n     * Default instance of `WorkerServiceManager`.\r\n     */\r\n    private static m_service: WorkerServiceManager;\r\n\r\n    /**\r\n     * Contains all registered service factories indexed by `serviceType`.\r\n     */\r\n    private readonly m_factories = new Map<string, WorkerServiceFactory>();\r\n\r\n    /**\r\n     * Contains all managed worker services indexed by their `serviceId`.\r\n     */\r\n    private readonly m_services = new Map<string, WorkerService>();\r\n\r\n    private constructor(\r\n        serviceId: string = WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID\r\n    ) {\r\n        super(serviceId);\r\n    }\r\n\r\n    /**\r\n     * Register [[WorkerService]] class to this manager.\r\n     *\r\n     * @param workerServiceDescriptor - service type and factory\r\n     */\r\n    register(workerServiceDescriptor: WorkerServiceDescriptor): void {\r\n        this.m_factories.set(workerServiceDescriptor.serviceType, workerServiceDescriptor.factory);\r\n    }\r\n\r\n    /** @override */\r\n    protected handleRequest(request: any): Promise<WorkerServiceResponse> {\r\n        if (request.type === WorkerServiceProtocol.Requests.CreateService) {\r\n            const existingService = this.m_services.get(request.targetServiceId);\r\n            if (existingService !== undefined) {\r\n                throw Error(\r\n                    `error - service with targetServiceId='${request.targetServiceId}' already running, ignoring CreateService request`\r\n                );\r\n            }\r\n\r\n            const factory = this.m_factories.get(request.targetServiceType);\r\n\r\n            if (factory === undefined) {\r\n                throw Error(`unknown targetServiceType requested: '${request.targetServiceType}'`);\r\n            }\r\n\r\n            const service = factory(request.targetServiceId);\r\n            this.m_services.set(request.targetServiceId, service);\r\n        }\r\n        if (request.type === WorkerServiceProtocol.Requests.DestroyService) {\r\n            const service = this.m_services.get(request.targetServiceId);\r\n            if (service === undefined) {\r\n                throw Error(`unknown targetServiceId '${request.targetServiceId}'`);\r\n            }\r\n            service.destroy();\r\n            this.m_services.delete(request.targetServiceId);\r\n        }\r\n\r\n        return Promise.resolve({\r\n            response: {}\r\n        });\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Message sent by web worker that requests to resolve actual\r\n * URLs of it's dependencies.\r\n *\r\n * Main thread is expected.\r\n */\r\nexport interface WorkerBootstrapRequest {\r\n    type: \"worker-bootstrap-request\";\r\n\r\n    /// Names of dependencies, usually NPM package names.\r\n    dependencies: string[];\r\n}\r\n\r\nexport interface WorkerBootstrapResponse {\r\n    type: \"worker-bootstrap-response\";\r\n\r\n    /// Actual URL scripts requested in [[WorkerBootstrapRequest]].\r\n    resolvedDependencies: string[];\r\n}\r\n\r\nexport function isWorkerBootstrapRequest(message: any): message is WorkerBootstrapRequest {\r\n    return (\r\n        message &&\r\n        message.type === \"worker-bootstrap-request\" &&\r\n        Array.isArray(message.dependencies)\r\n    );\r\n}\r\n\r\nexport function isWorkerBootstrapResponse(message: any): message is WorkerBootstrapResponse {\r\n    return (\r\n        message &&\r\n        message.type === \"worker-bootstrap-response\" &&\r\n        Array.isArray(message.resolvedDependencies)\r\n    );\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport namespace ExtrusionFeatureDefs {\r\n    /**\r\n     * Minimum ratio value for extrusion effect\r\n     */\r\n    export const DEFAULT_RATIO_MIN: number = 0.0;\r\n    /**\r\n     * Maximum ratio value for extrusion effect\r\n     */\r\n    export const DEFAULT_RATIO_MAX: number = 1;\r\n\r\n    /**\r\n     * Buildings height used whenever no height-data is present or height is very small.\r\n     *\r\n     * Used to avoid z-fighting between ground plane and building.\r\n     */\r\n    export const MIN_BUILDING_HEIGHT = 0.1;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport * from \"./lib/DOMUtils\";\r\nexport * from \"./lib/GroupedPriorityList\";\r\nexport * from \"./lib/Logger\";\r\nexport * from \"./lib/Math2D\";\r\nexport * from \"./lib/MathUtils\";\r\nexport * from \"./lib/Mixins\";\r\nexport * from \"./lib/assert\";\r\nexport * from \"./lib/CachedResource\";\r\nexport * from \"./lib/ContextLogger\";\r\nexport * from \"./lib/PerformanceTimer\";\r\nexport * from \"./lib/ObjectUtils\";\r\nexport * from \"./lib/OptionsUtils\";\r\nexport * from \"./lib/TaskQueue\";\r\nexport * from \"./lib/UriResolver\";\r\nexport * from \"./lib/UrlUtils\";\r\nexport * from \"./lib/Functions\";\r\nexport * from \"./lib/SampleBilinear\";\r\nexport * from \"./lib/AuthenticationUtils\";\r\nexport * from \"./lib/GlslUtils\";\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Provides utilities: logging and debugging.\r\n *\r\n * @remarks\r\n *\r\n * @packageDocumentation\r\n */\r\n\r\nexport * from \"./index-common\";\r\nexport * from \"./lib/UrlPlatformUtils\";\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Authentification token/code provider.\r\n */\r\nexport type AuthenticationProvider = () => Promise<string>;\r\n\r\n/**\r\n * Options for authentication with [[apikey]].\r\n */\r\nexport interface ApiKeyAuthentication {\r\n    /**\r\n     * The `apikey` for the access of the Web Tile Data.\r\n     * @note Will not be used if [[authenticationCode]] is defined as well.\r\n     */\r\n    apikey: string;\r\n}\r\n\r\n/**\r\n * Options for authentication with [[appId]] and [[appCode]].\r\n */\r\nexport interface AppIdAuthentication {\r\n    /**\r\n     * The `appId` for the access of the Web Tile Data.\r\n     * @note Will not be used if [[apiKey]] or [[authenticationCode]] is defined as well.\r\n     */\r\n    appId: string;\r\n\r\n    /**\r\n     * The `appCode` for the access of the Web Tile Data.\r\n     * @note Will not be used if [[apiKey]] or [[authenticationCode]] is defined as well.\r\n     */\r\n    appCode: string;\r\n}\r\n\r\n/**\r\n * Options for authentication with [[authenticationCode]].\r\n */\r\nexport interface TokenAuthentication {\r\n    /**\r\n     * Authentication code used for the different APIs.\r\n     *\r\n     * When [[AuthenticationProvider]] is is used as value, the provider is called before each\r\n     * to get currently valid authentication code/token.\r\n     */\r\n    authenticationCode: string | AuthenticationProvider;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport interface CachedResource {\r\n    memoryUsage: number;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Refinement of `console` interface only for important information i.e `info`, `warn` and `errors`.\r\n */\r\nexport interface ISimpleChannel {\r\n    info(message?: any, ...optionalParams: any[]): void;\r\n    warn(message?: any, ...optionalParams: any[]): void;\r\n    error(message?: any, ...optionalParams: any[]): void;\r\n}\r\n\r\n/**\r\n * Extension of {@link ISimpleChannel} to support contextual logging by adding stack of prefixes.\r\n */\r\nexport interface IContextLogger extends ISimpleChannel {\r\n    /**\r\n     * Push \"attribute-like\" context.\r\n     */\r\n    pushAttr(name: string): void;\r\n\r\n    /**\r\n     * Push \"index-like\" context.\r\n     *\r\n     * Following log messages will be prefixed with `[index]`.\r\n     */\r\n    pushIndex(index: string | number): void;\r\n\r\n    /**\r\n     * Remove current context from top of stack.\r\n     */\r\n    pop(): void;\r\n}\r\n\r\n/**\r\n * Context-aware logger that decorates log message with stack-based prefix, emits `headerMessage`\r\n * before first actual log message.\r\n */\r\nexport class ContextLogger implements IContextLogger {\r\n    private readonly context: string[] = [];\r\n    private m_headerLogged = false;\r\n\r\n    /**\r\n     * Construct a context-aware logger that logs to `m_logger`.\r\n     */\r\n    constructor(readonly m_logger: ISimpleChannel, readonly headerMessage: string) {}\r\n\r\n    /**\r\n     * Push \"attribute-like\" context.\r\n     *\r\n     * Following log messages will be prefixed with `name` or `.name` depending on current context.\r\n     */\r\n    pushAttr(name: string) {\r\n        this.context.push(`${this.context.length > 0 ? \".\" : \"\"}${name}`);\r\n    }\r\n\r\n    /**\r\n     * Push \"index-like\" context.\r\n     *\r\n     * Following log messages will be prefixed with `[index]`.\r\n     */\r\n    pushIndex(index: string | number) {\r\n        this.context.push(`[${index}]`);\r\n    }\r\n\r\n    pop() {\r\n        this.context.pop();\r\n    }\r\n\r\n    // They, are public member functions it's just tslint who doesn't understand this.\r\n\r\n    warn = this.createLogMethod(\"warn\");\r\n    info = this.createLogMethod(\"info\");\r\n    error = this.createLogMethod(\"error\");\r\n\r\n    private createLogMethod(severity: \"warn\" | \"info\" | \"error\") {\r\n        return (message: string, ...rest: any[]) => {\r\n            if (!this.m_headerLogged) {\r\n                this.m_logger.info(this.headerMessage);\r\n                this.m_headerLogged = true;\r\n            }\r\n            this.m_logger[severity](`${this.context.join(\"\")}: ${message}`, ...rest);\r\n        };\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport namespace DOMUtils {\r\n    /**\r\n     * Gets language list used by the browser\r\n     *\r\n     * @returns Array of iso language codes\r\n     */\r\n    export function getBrowserLanguages(): string[] | undefined {\r\n        if (navigator.languages !== undefined && navigator.languages.length > 0) {\r\n            const languageList = [];\r\n            for (const lang of navigator.languages) {\r\n                languageList.push(getIsoLanguageCode(lang));\r\n            }\r\n            return languageList;\r\n        }\r\n        if (navigator.language !== undefined) {\r\n            return [getIsoLanguageCode(navigator.language)];\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Gets ISO-639-1 language code from browser's code (ex. en for en-US)\r\n     */\r\n    function getIsoLanguageCode(language: string) {\r\n        return language.substring(0, 2);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Chains two functions for further assigning as one wrapped callback function\r\n */\r\nexport function chainCallbacks<T extends (this: unknown, ...args: any[]) => any>(\r\n    f1: T | null | undefined,\r\n    f2: T\r\n): T {\r\n    return function (this: any, ...args: any[]): ReturnType<T> {\r\n        if (f1) {\r\n            f1.apply(this, args);\r\n        }\r\n        return f2.apply(this, args);\r\n    } as T;\r\n}\r\n","/*\r\n * Copyright (C) 2020 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Converts webgl1-compatible vertex shader glsl code to webgl2.\r\n *\r\n * @param vertexShader - String containing the vertex shader glsl code.\r\n * @returns the converted glsl code.\r\n */\r\nexport function convertVertexShaderToWebGL2(vertexShader: string): string {\r\n    return (\r\n        [\"#define attribute in\", \"#define varying out\", \"#define texture2D texture\"].join(\"\\n\") +\r\n        \"\\n\" +\r\n        vertexShader\r\n    );\r\n}\r\n\r\n/**\r\n * Converts webgl1-compatible fragment shader glsl code to webgl2.\r\n *\r\n * @param fragmentShader - String containing the fragment shader glsl code.\r\n * @returns the converted glsl code.\r\n */\r\nexport function convertFragmentShaderToWebGL2(fragmentShader: string): string {\r\n    return (\r\n        [\r\n            \"#define varying in\",\r\n            \"out highp vec4 pc_fragColor;\",\r\n            \"#define gl_FragColor pc_fragColor\",\r\n            \"#define gl_FragDepthEXT gl_FragDepth\",\r\n            \"#define texture2D texture\",\r\n            \"#define textureCube texture\",\r\n            \"#define texture2DProj textureProj\",\r\n            \"#define texture2DLodEXT textureLod\",\r\n            \"#define texture2DProjLodEXT textureProjLod\",\r\n            \"#define textureCubeLodEXT textureLod\",\r\n            \"#define texture2DGradEXT textureGrad\",\r\n            \"#define texture2DProjGradEXT textureProjGrad\",\r\n            \"#define textureCubeGradEXT textureGrad\"\r\n        ].join(\"\\n\") +\r\n        \"\\n\" +\r\n        fragmentShader\r\n    );\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * A `PriorityListElement` has a priority to assist in sorting. The idea is that the items in a\r\n * grouped priority list will not modify their priority during processing to such an amount, that\r\n * they will change into another group. Smaller lists are smaller to sort, and in case of resource\r\n * limitation (maximum number of rendered objects reached), not all items have to be sorted at all.\r\n */\r\nexport interface PriorityListElement {\r\n    /**\r\n     * The integer value of this priority is used to group objects of \"same\" priority.\r\n     */\r\n    priority: number;\r\n}\r\n\r\n/**\r\n * The `PriorityListGroup` contains a list of {@link PriorityListElement}s that all have the same\r\n * (integer) priority.\r\n */\r\nexport class PriorityListGroup<T extends PriorityListElement> {\r\n    constructor(readonly priority: number, public elements: T[] = new Array()) {}\r\n\r\n    /**\r\n     * Create and return a deep copy of the `PriorityListGroup<T>`.\r\n     *\r\n     * @returns A clone of the `PriorityListGroup<T>`.\r\n     */\r\n    clone(): PriorityListGroup<T> {\r\n        return new PriorityListGroup<T>(this.priority, this.elements.slice());\r\n    }\r\n\r\n    /**\r\n     * Removes an element from the group.\r\n     * @param element - The element to remove.\r\n     * @returns true if the element was removed, false if it was not found in the group.\r\n     */\r\n    remove(element: T): boolean {\r\n        const foundIndex = this.elements.indexOf(element);\r\n        if (foundIndex === -1) {\r\n            return false;\r\n        }\r\n        this.elements.splice(foundIndex, 1);\r\n        return true;\r\n    }\r\n}\r\n\r\n/**\r\n * The `PriorityListGroupMap` is a map to map the (integer) priority to a {@link PriorityListGroup}.\r\n */\r\nexport type PriorityListGroupMap<T extends PriorityListElement> = Map<number, PriorityListGroup<T>>;\r\n\r\n/**\r\n * The `GroupedPriorityList` contains a [[PriorityListGroupMap]] to manage a larger number of items\r\n * in priority groups.\r\n */\r\nexport class GroupedPriorityList<T extends PriorityListElement> {\r\n    readonly groups: PriorityListGroupMap<T> = new Map();\r\n    /**\r\n     * Add an element to the `GroupedPriorityList`. Selects group based on the elements priority.\r\n     *\r\n     * @param element - Element to be added.\r\n     */\r\n    add(element: T): void {\r\n        this.getGroup(element.priority).elements.push(element);\r\n    }\r\n\r\n    /**\r\n     * Remove an element from the `GroupedPriorityList`.\r\n     *\r\n     * Note: It is required that the priority is the same as it was when the element has been added.\r\n     * Otherwise, the removal will fail.\r\n     *\r\n     * @param element - Element to be removed.\r\n     * @returns `True` if the element was removed, `false` otherwise.\r\n     */\r\n    remove(element: T): boolean {\r\n        const group = this.findGroup(element.priority);\r\n        if (group !== undefined && group.remove(element)) {\r\n            if (group.elements.length === 0) {\r\n                this.groups.delete(group.priority);\r\n            }\r\n\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Remove all internal {@link PriorityListGroup}s.\r\n     */\r\n    clear(): void {\r\n        this.groups.clear();\r\n    }\r\n\r\n    /**\r\n     * Merge another {@link GroupedPriorityList} into this one.\r\n     *\r\n     * @param other - Other group to merge.\r\n     */\r\n    merge(other: GroupedPriorityList<T>): GroupedPriorityList<T> {\r\n        for (const otherGroup of other.groups) {\r\n            const group = this.findGroup(otherGroup[1].priority);\r\n            if (group === undefined) {\r\n                this.groups.set(Math.floor(otherGroup[1].priority), otherGroup[1].clone());\r\n                continue;\r\n            }\r\n            group.elements = group.elements.concat(otherGroup[1].elements);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    clone(): GroupedPriorityList<T> {\r\n        const clone = new GroupedPriorityList<T>();\r\n        for (const [priority, group] of this.groups) {\r\n            clone.groups.set(priority, group.clone());\r\n        }\r\n        return clone;\r\n    }\r\n\r\n    /**\r\n     * Apply function to all elements in this `GroupedPriorityList`.\r\n     *\r\n     * @param {(element: T) => void} fun Function to apply.\r\n     */\r\n    forEach(fun: (element: T) => void): void {\r\n        for (const group of this.groups) {\r\n            group[1].elements.forEach(fun);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Count the number of elements in this `GroupedPriorityList`.\r\n     */\r\n    count(): number {\r\n        let n = 0;\r\n        for (const group of this.groups) {\r\n            n += group[1].elements.length;\r\n        }\r\n        return n;\r\n    }\r\n\r\n    /**\r\n     * Get group of elements that have the same (integer) priority.\r\n     *\r\n     * @param priority - The priority to retrieve all elements from.\r\n     */\r\n    private findGroup(priority: number): PriorityListGroup<T> | undefined {\r\n        const normalizedPriority = Math.floor(priority);\r\n        const group = this.groups.get(normalizedPriority);\r\n        return group;\r\n    }\r\n\r\n    /**\r\n     * Get group of elements that have the same (integer) priority.\r\n     *\r\n     * @param priority - The priority to retrieve all elements from.\r\n     */\r\n    private getGroup(priority: number): PriorityListGroup<T> {\r\n        let group = this.findGroup(priority);\r\n\r\n        if (group === undefined) {\r\n            const normalizedPriority = Math.floor(priority);\r\n            group = new PriorityListGroup<T>(normalizedPriority);\r\n            this.groups.set(group.priority, group);\r\n        }\r\n\r\n        return group;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/* eslint-disable no-console */\r\n\r\nimport { IChannel } from \"./IChannel\";\r\n\r\n/**\r\n * Class for the default console channel.\r\n */\r\n\r\nexport class ConsoleChannel implements IChannel {\r\n    error(message?: any, ...optionalParams: any[]) {\r\n        console.error(message, ...optionalParams);\r\n    }\r\n\r\n    debug(message?: any, ...optionalParams: any[]) {\r\n        console.debug(message, ...optionalParams);\r\n    }\r\n\r\n    info(message?: any, ...optionalParams: any[]) {\r\n        console.info(message, ...optionalParams);\r\n    }\r\n\r\n    log(message?: any, ...optionalParams: any[]) {\r\n        console.log(message, ...optionalParams);\r\n    }\r\n\r\n    trace(message?: any, ...optionalParams: any[]) {\r\n        console.trace(message, ...optionalParams);\r\n    }\r\n\r\n    warn(message?: any, ...optionalParams: any[]) {\r\n        console.warn(message, ...optionalParams);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Interface for the Channel classes.\r\n */\r\nexport interface IChannel {\r\n    trace(message?: any, ...optionalParams: any[]): void;\r\n    debug(message?: any, ...optionalParams: any[]): void;\r\n    log(message?: any, ...optionalParams: any[]): void;\r\n    info(message?: any, ...optionalParams: any[]): void;\r\n    warn(message?: any, ...optionalParams: any[]): void;\r\n    error(message?: any, ...optionalParams: any[]): void;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { IChannel } from \"./IChannel\";\r\n\r\n/**\r\n * Enum log levels\r\n */\r\nexport enum LogLevel {\r\n    Trace,\r\n    Debug,\r\n    Log,\r\n    Info,\r\n    Warn,\r\n    Error,\r\n    None\r\n}\r\n\r\n/**\r\n * Logger options to configure logger\r\n */\r\nexport class LoggerOptions {\r\n    enabled?: boolean;\r\n    level?: LogLevel;\r\n}\r\n\r\n/**\r\n * Public interface for Logger class.\r\n */\r\nexport interface ILogger extends IChannel {\r\n    readonly name: string;\r\n\r\n    enabled: boolean;\r\n\r\n    level: LogLevel;\r\n\r\n    /**\r\n     * Update logger options\r\n     *\r\n     * @param  {LoggerOptions} options Set logger options and configure internal logger.\r\n     */\r\n    update(options: LoggerOptions): void;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { IChannel } from \"./IChannel\";\r\nimport { ILogger, LoggerOptions, LogLevel } from \"./ILogger\";\r\n\r\n/**\r\n * Logger class.\r\n */\r\nexport class Logger implements ILogger {\r\n    enabled: boolean = true;\r\n    level: LogLevel = LogLevel.Trace;\r\n\r\n    constructor(\r\n        readonly name: string,\r\n        private readonly m_channel: IChannel,\r\n        options?: LoggerOptions\r\n    ) {\r\n        if (options !== undefined) {\r\n            this.update(options);\r\n        }\r\n    }\r\n\r\n    error(message?: any, ...optionalParams: any[]) {\r\n        if (this.enabled && this.level <= LogLevel.Error) {\r\n            this.m_channel.error(this.prefix, message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    debug(message?: any, ...optionalParams: any[]) {\r\n        if (this.enabled && this.level <= LogLevel.Debug) {\r\n            this.m_channel.debug(this.prefix, message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    info(message?: any, ...optionalParams: any[]) {\r\n        if (this.enabled && this.level <= LogLevel.Info) {\r\n            this.m_channel.info(this.prefix, message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    log(message?: any, ...optionalParams: any[]) {\r\n        if (this.enabled && this.level <= LogLevel.Log) {\r\n            this.m_channel.log(this.prefix, message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    trace(message?: any, ...optionalParams: any[]) {\r\n        if (this.enabled && this.level <= LogLevel.Trace) {\r\n            this.m_channel.trace(this.prefix, message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    warn(message?: any, ...optionalParams: any[]) {\r\n        if (this.enabled && this.level <= LogLevel.Warn) {\r\n            this.m_channel.warn(this.prefix, message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    update(options: LoggerOptions) {\r\n        this.enabled = options.enabled === undefined ? this.enabled : options.enabled;\r\n        this.level = options.level === undefined ? this.level : options.level;\r\n    }\r\n\r\n    private get prefix(): string {\r\n        return this.name + \":\";\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { ILoggerManager } from \"./ILoggerManager\";\r\nimport { LoggerManagerImpl } from \"./LoggerManagerImpl\";\r\n\r\n/**\r\n * The LoggerManager class implements a singleton object that handles logging.\r\n *\r\n * Example:\r\n *\r\n * ```typescript\r\n *\r\n * const logger = LoggerManager.instance.create(\"MyFontLoaderClass\");\r\n * if (missingFonts.length > 0) {\r\n *     logger.error(\"These fonts can not be loaded: \", missingFonts);\r\n * } else {\r\n *     logger.log(\"All fonts have been loaded.\");\r\n * }\r\n * ```\r\n */\r\nexport class LoggerManager {\r\n    private static m_instance: ILoggerManager;\r\n\r\n    static get instance(): ILoggerManager {\r\n        return this.m_instance || (this.m_instance = new LoggerManagerImpl());\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { ConsoleChannel } from \"./ConsoleChannel\";\r\nimport { IChannel } from \"./IChannel\";\r\nimport { ILogger, LoggerOptions, LogLevel } from \"./ILogger\";\r\nimport { ILoggerManager } from \"./ILoggerManager\";\r\nimport { Logger } from \"./Logger\";\r\nimport { WorkerChannel } from \"./WorkerChannel\";\r\n\r\n/**\r\n * LoggerManagerImpl is the class for the singleton instance of the logger manager.\r\n * It handles channels and loggers.\r\n */\r\n\r\nexport class LoggerManagerImpl implements ILoggerManager {\r\n    channel: IChannel;\r\n    private readonly m_loggers: ILogger[] = [];\r\n    private m_levelSetForAll?: LogLevel;\r\n\r\n    constructor() {\r\n        this.channel =\r\n            typeof self === \"undefined\" || typeof self.document !== \"undefined\"\r\n                ? new ConsoleChannel()\r\n                : new WorkerChannel();\r\n    }\r\n\r\n    getLoggerNames(): string[] {\r\n        return this.m_loggers.map(logger => logger.name);\r\n    }\r\n\r\n    getLogger(name: string): ILogger | undefined {\r\n        return this.m_loggers.find(logger => logger.name === name);\r\n    }\r\n\r\n    create(loggerName: string, options: LoggerOptions = {}): ILogger {\r\n        if (\r\n            this.m_levelSetForAll !== undefined &&\r\n            (options.level === undefined || options.level < this.m_levelSetForAll)\r\n        ) {\r\n            options.level = this.m_levelSetForAll;\r\n        }\r\n        const logger = new Logger(loggerName, this.channel, options);\r\n        this.m_loggers.push(logger);\r\n        return logger;\r\n    }\r\n\r\n    dispose(logger: ILogger) {\r\n        const found = this.m_loggers.indexOf(logger);\r\n        if (found < 0) {\r\n            throw new Error(`Cannot unregister \"${logger}\" : no such logger registered.`);\r\n        }\r\n        this.m_loggers.splice(found, 1);\r\n    }\r\n\r\n    updateAll(options: LoggerOptions) {\r\n        for (const logger of this.m_loggers) {\r\n            logger.update(options);\r\n        }\r\n    }\r\n\r\n    update(loggerName: string, config: LoggerOptions) {\r\n        for (const logger of this.m_loggers) {\r\n            if (logger.name === loggerName) {\r\n                logger.update(config);\r\n            }\r\n        }\r\n    }\r\n\r\n    enableAll(enabled: boolean) {\r\n        for (const logger of this.m_loggers) {\r\n            logger.enabled = enabled;\r\n        }\r\n    }\r\n\r\n    enable(loggerName: string, value: boolean) {\r\n        this.update(loggerName, { enabled: value });\r\n    }\r\n\r\n    setLogLevelForAll(level: LogLevel) {\r\n        this.m_levelSetForAll = level;\r\n        for (const logger of this.m_loggers) {\r\n            logger.level = level;\r\n        }\r\n    }\r\n\r\n    setLogLevel(loggerName: string, level: LogLevel) {\r\n        this.update(loggerName, { level });\r\n    }\r\n\r\n    setChannel(channel: IChannel) {\r\n        this.channel = channel;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { IChannel } from \"./IChannel\";\r\n\r\n/**\r\n * Class allowing mixing several channels.\r\n */\r\nexport class MultiChannel implements IChannel {\r\n    private readonly channels: IChannel[] = [];\r\n    constructor(...channels: IChannel[]) {\r\n        this.channels = channels;\r\n    }\r\n\r\n    error(message?: any, ...optionalParams: any[]) {\r\n        for (const channel of this.channels) {\r\n            channel.error(message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    debug(message?: any, ...optionalParams: any[]) {\r\n        for (const channel of this.channels) {\r\n            channel.debug(message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    info(message?: any, ...optionalParams: any[]) {\r\n        for (const channel of this.channels) {\r\n            channel.info(message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    log(message?: any, ...optionalParams: any[]) {\r\n        for (const channel of this.channels) {\r\n            channel.log(message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    trace(message?: any, ...optionalParams: any[]) {\r\n        for (const channel of this.channels) {\r\n            channel.trace(message, ...optionalParams);\r\n        }\r\n    }\r\n\r\n    warn(message?: any, ...optionalParams: any[]) {\r\n        for (const channel of this.channels) {\r\n            channel.warn(message, ...optionalParams);\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { IChannel } from \"./IChannel\";\r\nimport { LogLevel } from \"./ILogger\";\r\n\r\ndeclare let self: Worker;\r\n\r\nexport const WORKERCHANNEL_MSG_TYPE = \"worker-channel-message\";\r\n\r\n/**\r\n * The interface for the messages of the WorkerChannel.\r\n */\r\nexport interface IWorkerChannelMessage {\r\n    message: any[];\r\n    type: \"worker-channel-message\";\r\n    level: LogLevel;\r\n}\r\n\r\n/**\r\n * The class for the worker channel.\r\n */\r\nexport class WorkerChannel implements IChannel {\r\n    error(message?: any, ...optionalParams: any[]) {\r\n        const workerMessage: IWorkerChannelMessage = {\r\n            message: [message, ...optionalParams],\r\n            type: WORKERCHANNEL_MSG_TYPE,\r\n            level: LogLevel.Error\r\n        };\r\n        self.postMessage(workerMessage);\r\n    }\r\n\r\n    debug(message?: any, ...optionalParams: any[]) {\r\n        const workerMessage: IWorkerChannelMessage = {\r\n            message: [message, ...optionalParams],\r\n            type: WORKERCHANNEL_MSG_TYPE,\r\n            level: LogLevel.Debug\r\n        };\r\n        self.postMessage(workerMessage);\r\n    }\r\n\r\n    info(message?: any, ...optionalParams: any[]) {\r\n        const workerMessage: IWorkerChannelMessage = {\r\n            message: [message, ...optionalParams],\r\n            type: WORKERCHANNEL_MSG_TYPE,\r\n            level: LogLevel.Info\r\n        };\r\n        self.postMessage(workerMessage);\r\n    }\r\n\r\n    log(message?: any, ...optionalParams: any[]) {\r\n        const workerMessage: IWorkerChannelMessage = {\r\n            message: [message, ...optionalParams],\r\n            type: WORKERCHANNEL_MSG_TYPE,\r\n            level: LogLevel.Log\r\n        };\r\n        self.postMessage(workerMessage);\r\n    }\r\n\r\n    trace(message?: any, ...optionalParams: any[]) {\r\n        const workerMessage: IWorkerChannelMessage = {\r\n            message: [message, ...optionalParams],\r\n            type: WORKERCHANNEL_MSG_TYPE,\r\n            level: LogLevel.Trace\r\n        };\r\n        self.postMessage(workerMessage);\r\n    }\r\n\r\n    warn(message?: any, ...optionalParams: any[]) {\r\n        const workerMessage: IWorkerChannelMessage = {\r\n            message: [message, ...optionalParams],\r\n            type: WORKERCHANNEL_MSG_TYPE,\r\n            level: LogLevel.Warn\r\n        };\r\n        self.postMessage(workerMessage);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport * from \"./ConsoleChannel\";\r\nexport * from \"./IChannel\";\r\nexport * from \"./ILogger\";\r\nexport * from \"./Logger\";\r\nexport * from \"./LoggerManager\";\r\nexport * from \"./MultiChannel\";\r\nexport * from \"./WorkerChannel\";\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\ninterface Vec2Like {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport namespace Math2D {\r\n    /**\r\n     * Alternative 2D box object with less memory impact (four numbers instead of two min/max\r\n     * objects with two numbers each). Should be faster.\r\n     */\r\n    export class Box {\r\n        /**\r\n         * Alternative 2D box object with less memory impact (four numbers instead of two min/max\r\n         * objects with two numbers each). Should be faster.\r\n         *\r\n         * @param x - New X value.\r\n         * @param y - New y value.\r\n         * @param w - New w value.\r\n         * @param h - New h value.\r\n         */\r\n        constructor(public x = 0, public y = 0, public w = 0, public h = 0) {}\r\n\r\n        /**\r\n         * Set new values to all properties of the box.\r\n         *\r\n         * @param x - New X value.\r\n         * @param y - New y value.\r\n         * @param w - New w value.\r\n         * @param h - New h value.\r\n         */\r\n        set(x: number, y: number, w: number, h: number) {\r\n            this.x = x;\r\n            this.y = y;\r\n            this.w = w;\r\n            this.h = h;\r\n        }\r\n\r\n        /**\r\n         * Copy values from another box.\r\n         *\r\n         * @param box - Another box.\r\n         */\r\n        copy(box: Box) {\r\n            this.x = box.x;\r\n            this.y = box.y;\r\n            this.w = box.w;\r\n            this.h = box.h;\r\n        }\r\n\r\n        /**\r\n         * Test box for inclusion of point.\r\n         *\r\n         * @param x - X coordinate of point.\r\n         * @param y - Y coordinate of point.\r\n         */\r\n        contains(x: number, y: number): boolean {\r\n            return this.x <= x && this.x + this.w >= x && this.y <= y && this.y + this.h >= y;\r\n        }\r\n\r\n        /**\r\n         * Test box for inclusion of another box.\r\n         *\r\n         * @param other - Box 2 to test for inclusion.\r\n         */\r\n        containsBox(other: Box): boolean {\r\n            const xmax = other.x + other.w;\r\n            const ymax = other.y + other.h;\r\n            return (\r\n                this.contains(other.x, other.y) &&\r\n                this.contains(xmax, other.y) &&\r\n                this.contains(other.x, ymax) &&\r\n                this.contains(xmax, ymax)\r\n            );\r\n        }\r\n\r\n        /**\r\n         * Test two boxes for intersection.\r\n         *\r\n         * @param other - Box 2 to test for intersection.\r\n         */\r\n        intersects(other: Box): boolean {\r\n            return (\r\n                this.x <= other.x + other.w &&\r\n                this.x + this.w >= other.x &&\r\n                this.y <= other.y + other.h &&\r\n                this.y + this.h >= other.y\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Box to store UV coordinates.\r\n     */\r\n    export interface UvBox {\r\n        s0: number;\r\n        t0: number;\r\n        s1: number;\r\n        t1: number;\r\n    }\r\n\r\n    /**\r\n     * Compute squared distance between two 2D points `a` and `b`.\r\n     *\r\n     * @param ax - Point a.x\r\n     * @param ay - Point a.y\r\n     * @param bx - Point b.x\r\n     * @param by - Point b.y\r\n     * @returns Squared distance between the two points\r\n     */\r\n    export function distSquared(ax: number, ay: number, bx: number, by: number): number {\r\n        return (ax - bx) * (ax - bx) + (ay - by) * (ay - by);\r\n    }\r\n\r\n    /**\r\n     * Computes the squared length of a line.\r\n     *\r\n     * @param line - An array of that forms a line via [x,y,z,x,y,z,...] tuples.\r\n     */\r\n    export function computeSquaredLineLength(line: number[]): number {\r\n        let squaredLineLength: number = 0;\r\n\r\n        const length = line.length - 4;\r\n        for (let i = 0; i < length; i += 3) {\r\n            const xDiff = line[i + 3] - line[i];\r\n            const yDiff = line[i + 4] - line[i + 1];\r\n            squaredLineLength += xDiff * xDiff + yDiff * yDiff;\r\n        }\r\n        return squaredLineLength;\r\n    }\r\n\r\n    /**\r\n     * Compute squared distance between a 2D point and a 2D line segment.\r\n     *\r\n     * @param px - Test point X\r\n     * @param py - Test point y\r\n     * @param l0x - Line segment start X\r\n     * @param l0y - Line segment start Y\r\n     * @param l1x - Line segment end X\r\n     * @param l1y - Line segment end Y\r\n     * @returns Squared distance between point and line segment\r\n     */\r\n    export function distToSegmentSquared(\r\n        px: number,\r\n        py: number,\r\n        l0x: number,\r\n        l0y: number,\r\n        l1x: number,\r\n        l1y: number\r\n    ): number {\r\n        const lineLengthSuared = distSquared(l0x, l0y, l1x, l1y);\r\n        if (lineLengthSuared === 0) {\r\n            return distSquared(px, py, l0x, l0y);\r\n        }\r\n        let t = ((px - l0x) * (l1x - l0x) + (py - l0y) * (l1y - l0y)) / lineLengthSuared;\r\n        t = Math.max(0, Math.min(1, t));\r\n        return distSquared(px, py, l0x + t * (l1x - l0x), l0y + t * (l1y - l0y));\r\n    }\r\n\r\n    /**\r\n     * Finds the intersections of a line and a circle.\r\n     *\r\n     * @param xLine1 - abscissa of first line point.\r\n     * @param yLine1 - ordinate of second line point.\r\n     * @param xLine2 - abscissa of second line point.\r\n     * @param yLine2 - ordinate of second line point.\r\n     * @param radius - circle radius.\r\n     * @param xCenter - abscissa of circle center.\r\n     * @param yCenter - ordinate of circle center.\r\n     * @returns coordinates of the intersections (1 if the line is tangent to the circle, 2\r\n     * if it's secant) or undefined if there's no intersection.\r\n     */\r\n    export function intersectLineAndCircle(\r\n        xLine1: number,\r\n        yLine1: number,\r\n        xLine2: number,\r\n        yLine2: number,\r\n        radius: number,\r\n        xCenter: number = 0,\r\n        yCenter: number = 0\r\n    ): { x1: number; y1: number; x2?: number; y2?: number } | undefined {\r\n        // Line equation: dy*x - dx*y = c, c = dy*x1 - dx*y1 = x1*y2 - x2*y1\r\n        // Circle equation: (x-xCenter)^2 + (y-yCenter)^2 = r^2\r\n\r\n        // 1. Translate circle center to origin of coordinates:\r\n        // u = x - xCenter\r\n        // v = y - yCenter\r\n        // circle: u^2 + v^2 = r^2\r\n        // line: dy*u - dx*v = cp, cp = c - dy*xCenter - dx*yCenter\r\n\r\n        // 2. Intersections are solutions of a quadratic equation:\r\n        // ui = (cp*dy +/- sign(dy)*dx*discriminant / dSq\r\n        // vi = (-cp*dx +/- |dy|*discriminant / dSq\r\n        // discriminant = r^2*dSq - cp^2, dSq = dx^2 + dy^2\r\n        // The sign of the discriminant indicates the number of intersections.\r\n\r\n        // 3. Translate intersection coordinates back to original space:\r\n        // xi = xCenter + ui\r\n        // yi = yCenter + yi\r\n\r\n        const epsilon = 1e-10;\r\n        const dx = xLine2 - xLine1;\r\n        const dy = yLine2 - yLine1;\r\n        const dSq = dx * dx + dy * dy;\r\n        const rSq = radius * radius;\r\n        const c = xLine1 * yLine2 - xLine2 * yLine1;\r\n        const cp = c - dy * xCenter + dx * yCenter;\r\n        const discriminantSquared = rSq * dSq - cp * cp;\r\n\r\n        if (discriminantSquared < -epsilon) {\r\n            // no intersection\r\n            return undefined;\r\n        }\r\n\r\n        const xMid = cp * dy;\r\n        const yMid = -cp * dx;\r\n\r\n        if (discriminantSquared < epsilon) {\r\n            // 1 intersection (tangent line)\r\n            return { x1: xCenter + xMid / dSq, y1: yCenter + yMid / dSq };\r\n        }\r\n\r\n        const discriminant = Math.sqrt(discriminantSquared);\r\n\r\n        // 2 intersections (secant line)\r\n        const signDy = dy < 0 ? -1 : 1;\r\n        const absDy = Math.abs(dy);\r\n\r\n        const xDist = signDy * dx * discriminant;\r\n        const yDist = absDy * discriminant;\r\n\r\n        return {\r\n            x1: xCenter + (xMid + xDist) / dSq,\r\n            y1: yCenter + (yMid + yDist) / dSq,\r\n            x2: xCenter + (xMid - xDist) / dSq,\r\n            y2: yCenter + (yMid - yDist) / dSq\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Computes the intersection point between two lines.\r\n     *\r\n     * @remarks\r\n     * This functions computes the\r\n     * {@link https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection\r\n     *    | line-line intersection} of two lines given two points on each line.\r\n     *\r\n     * @param x1 - x coordinate of the first point of the first line.\r\n     * @param y1 - y coordinate of the first point of the first line.\r\n     * @param x2 - x coordinate of the second point of the first line.\r\n     * @param y2 - y coordinate of the second point of the first line.\r\n     * @param x3 - x coordinate of the first point of the second line.\r\n     * @param y3 - y coordinate of the first point of the second line.\r\n     * @param x4 - x coordinate of the second point of the second line.\r\n     * @param y4 - y coordinate of the second point of the second line.\r\n     * @param result - The resulting point.\r\n     */\r\n    export function intersectLines(\r\n        x1: number,\r\n        y1: number,\r\n        x2: number,\r\n        y2: number,\r\n        x3: number,\r\n        y3: number,\r\n        x4: number,\r\n        y4: number,\r\n        result: Vec2Like = { x: 0, y: 0 }\r\n    ): Vec2Like | undefined {\r\n        const d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\r\n        if (d === 0) {\r\n            return undefined;\r\n        }\r\n        const px = ((x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4)) / d;\r\n        const py = ((x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4)) / d;\r\n        result.x = px;\r\n        result.y = py;\r\n        return result;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport namespace MathUtils {\r\n    /**\r\n     * Ensures that input value fits in a given range.\r\n     *\r\n     * @param value - The value to be clamped.\r\n     * @param min - Minimum value.\r\n     * @param max - Maximum value.\r\n     *\r\n     * @returns Clamped value.\r\n     */\r\n    export function clamp(value: number, min: number, max: number): number {\r\n        return value < min ? min : value > max ? max : value;\r\n    }\r\n\r\n    /**\r\n     * Returns a smooth interpolation between the values edge0 and edge1 based on the interpolation\r\n     * factor x. `0 <= x <= 1`.\r\n     * @see https://en.wikipedia.org/wiki/Smoothstep\r\n     *\r\n     * @param edge0 -\r\n     * @param edge1 -\r\n     * @param x -\r\n     */\r\n    export function smoothStep(edge0: number, edge1: number, x: number) {\r\n        // Scale, bias and saturate x to 0..1 range\r\n        x = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\r\n        // Evaluate polynomial\r\n        return x * x * (3 - 2 * x);\r\n    }\r\n\r\n    /**\r\n     * Returns a smooth interpolation between the values edge0 and edge1 based on the interpolation\r\n     * factor x. `0 <= x <= 1`.\r\n     *\r\n     * Improved version by Ken Perlin, which has zero 1st- and 2nd-order derivatives at `x = 0` and\r\n     * `x = 1`:\r\n     *\r\n     * @see https://en.wikipedia.org/wiki/Smoothstep\r\n     *\r\n     * @param edge0 -\r\n     * @param edge1 -\r\n     * @param x -\r\n     */\r\n    export function smootherStep(edge0: number, edge1: number, x: number) {\r\n        // Scale, and clamp x to 0..1 range\r\n        x = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\r\n        // Evaluate polynomial\r\n        return x * x * x * (x * (x * 6 - 15) + 10);\r\n    }\r\n\r\n    /**\r\n     * Maps a number from one range to another.\r\n     *\r\n     * @param val - The incoming value to be converted.\r\n     * @param inMin - Lower bound of the value's current range.\r\n     * @param inMax - Upper bound of the value's current range.\r\n     * @param outMin - Lower bound of the value's target range.\r\n     * @param outMax - Upper bound of the value's target range.\r\n     */\r\n    export function map(val: number, inMin: number, inMax: number, outMin: number, outMax: number) {\r\n        return ((val - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin;\r\n    }\r\n\r\n    /**\r\n     * Returns the smaller of the two given numbers. Both numbers may be undefined, in which case\r\n     * the result is undefined. If only one of the numbers is undefined, the other number is\r\n     * returned.\r\n     *\r\n     * @param a - First number.\r\n     * @param b - Second number.\r\n     */\r\n    export function min2(a: number | undefined, b: number | undefined): number | undefined {\r\n        let result: number | undefined;\r\n\r\n        if (a !== undefined) {\r\n            result = a;\r\n        }\r\n        if (b !== undefined) {\r\n            result = result === undefined ? b : Math.min(result, b);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Returns the larger of the two given numbers. Both numbers may be undefined, in which case\r\n     * the result is undefined. If only one of the numbers is undefined, the other number is\r\n     * returned.\r\n     *\r\n     * @param a - First number.\r\n     * @param b - Second number.\r\n     */\r\n    export function max2(a: number | undefined, b: number | undefined): number | undefined {\r\n        let result: number | undefined;\r\n\r\n        if (a !== undefined) {\r\n            result = a;\r\n        }\r\n        if (b !== undefined) {\r\n            result = result === undefined ? b : Math.max(result, b);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Checks if the value of a given number is inside an upper or lower bound. The bounds may be\r\n     * undefined, in which case their value is ignored.\r\n     *\r\n     * @param value - Value to check.\r\n     * @param lowerBound - The lower bound to check the value against.\r\n     * @param upperBound - The upper bound to check the value against.\r\n     *\r\n     * @returns `true` if value is inside the bounds or if the bounds are `undefined`, `false`\r\n     *          otherwise.\r\n     */\r\n    export function isClamped(\r\n        value: number,\r\n        lowerBound: number | undefined,\r\n        upperBound: number | undefined\r\n    ): boolean {\r\n        if (lowerBound !== undefined && value < lowerBound) {\r\n            return false;\r\n        }\r\n        if (upperBound !== undefined && value > upperBound) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Smoothly interpolates between two values using cubic formula\r\n     *\r\n     * @param startValue -\r\n     * @param endValue -\r\n     * @param time -\r\n     * @returns Result of the interpolation within the range of `[startValue, endValue]`\r\n     */\r\n    export function easeInOutCubic(startValue: number, endValue: number, time: number): number {\r\n        const timeValue =\r\n            time < 0.5 ? 4 * time * time * time : (time - 1) * (2 * time - 2) * (2 * time - 2) + 1;\r\n        return startValue + (endValue - startValue) * timeValue;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Copy methods and properties from one prototype into another.\r\n *\r\n * @see https://www.typescriptlang.org/docs/handbook/mixins.html\r\n *\r\n * @param derivedCtor - Class to mix methods and properties into.\r\n * @param baseCtors - Class to take all methods and properties from.\r\n */\r\nexport function applyMixins(derivedCtor: any, baseCtors: any[]) {\r\n    baseCtors.forEach(baseCtor => {\r\n        Object.getOwnPropertyNames(baseCtor.prototype).forEach(name => {\r\n            derivedCtor.prototype[name] = baseCtor.prototype[name];\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Copy methods from one prototype into another.\r\n *\r\n * @see https://www.typescriptlang.org/docs/handbook/mixins.html\r\n *\r\n * @param derivedCtor - Class to mix methods into.\r\n * @param baseCtors - Class to take all methods from.\r\n */\r\nexport function applyMixinsWithoutProperties(derivedCtor: any, baseCtors: any[]) {\r\n    baseCtors.forEach(baseCtor => {\r\n        Object.getOwnPropertyNames(baseCtor.prototype).forEach(name => {\r\n            const descriptor = Object.getOwnPropertyDescriptor(baseCtor.prototype, name);\r\n            if (\r\n                descriptor !== undefined &&\r\n                descriptor.get === undefined &&\r\n                name !== \"constructor\"\r\n            ) {\r\n                derivedCtor.prototype[name] = baseCtor.prototype[name];\r\n            }\r\n        });\r\n    });\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Deep clone of object.\r\n *\r\n * Like `JSON.parse(JSON.stringify(obj))`, but supports basic javascript types (string, number,\r\n * object), `Date` and `RegExp`s and cycles.\r\n *\r\n * Throws error if enounters object with `prototype` assuming that in general class instances\r\n * cannot be reliably cloned by generic algorithm.\r\n */\r\nexport function cloneDeep<T>(obj: T): T {\r\n    const cache: Map<object, object> = new Map();\r\n    function cloneInternal(src: any): any {\r\n        if (src === null) {\r\n            return null;\r\n        } else if (typeof src === \"object\") {\r\n            const cached = cache.get(src);\r\n            if (cached !== undefined) {\r\n                return cached;\r\n            }\r\n\r\n            if (Array.isArray(src)) {\r\n                const result: any[] = [];\r\n                cache.set(src, result);\r\n                result.length = src.length;\r\n                for (let i = 0; i < result.length; ++i) {\r\n                    result[i] = cloneInternal(src[i]);\r\n                }\r\n                return result;\r\n            } else if (src instanceof Date) {\r\n                const result = new Date(src.getTime());\r\n                cache.set(src, result);\r\n                return result;\r\n            } else if (src instanceof RegExp) {\r\n                const result = new RegExp(src.source, src.flags);\r\n                cache.set(src, result);\r\n                return result;\r\n            } else if (src.constructor !== Object) {\r\n                throw new Error(\"cloneDeep doesn't support objects with custom prototypes\");\r\n            } else {\r\n                const result: typeof src = {};\r\n                cache.set(src, result);\r\n                for (const key in src) {\r\n                    if (src.hasOwnProperty(key)) {\r\n                        result[key] = cloneInternal(src[key]);\r\n                    }\r\n                }\r\n                return result;\r\n            }\r\n        } else {\r\n            // string, number, boolean, undefined and functions are returned as is\r\n            return src;\r\n        }\r\n    }\r\n\r\n    const r = cloneInternal(obj);\r\n    cache.clear();\r\n    return r;\r\n}\r\n\r\n/**\r\n * Pick `props` from `object.\r\n *\r\n * Runtime version of `Pick<T,K>`.\r\n */\r\nexport function pick<T extends object, K extends keyof T>(object: T, props: K[]): Pick<T, K> {\r\n    const result: any = {};\r\n    for (const propName of props) {\r\n        if (object.hasOwnProperty(propName)) {\r\n            result[propName] = object[propName];\r\n        }\r\n    }\r\n    return result;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Get first defined value.\r\n *\r\n * Specialized \"replacement\" for `a || b || c` used frequently to get value from various sources\r\n * (defaults, configs  constants).\r\n * In contrast to `||`, this function provides proper typing for usual use cases (constant as last\r\n * argument) and correct treatment of `null` and `undefined`.\r\n *\r\n * If last parameter is \"defined\" then return type is `T`, otherwise return type is `T | undefined`.\r\n *\r\n * Usage example:\r\n *\r\n *     interface Config {\r\n *         x?: number;\r\n *     }\r\n *     const someConfig: Config = {};\r\n *     const val: number | undefined = undefined;\r\n *     const DEFAULT = 5;\r\n *     const x = getOptionValue(val, someConfig.x, DEFAULT);\r\n *         // typeof x === 'number' because DEFAULT is defined\r\n *     const y = getOptionValue(val, someConfig.x);\r\n *         // typeof y === 'number | undefined' because someConfig.x is possibly undefined\r\n */\r\n// specialized overloads with last param defined params overload\r\nexport function getOptionValue<T>(a: T): T;\r\nexport function getOptionValue<T>(a: T | undefined, b: T): T;\r\nexport function getOptionValue<T>(a: T | undefined, b: T | undefined, c: T): T;\r\nexport function getOptionValue<T>(a: T | undefined, b: T | undefined, c: T | undefined, d: T): T;\r\nexport function getOptionValue<T>(...values: Array<T | undefined>): T | undefined;\r\n\r\nexport function getOptionValue<T>(...values: Array<T | undefined>): T | undefined {\r\n    for (const candidate of values) {\r\n        if (candidate !== undefined && candidate !== null) {\r\n            return candidate;\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * See:\r\n * https://developers.google.com/web/updates/2012/08/When-milliseconds-are-not-enough-performance-now\r\n */\r\n\r\nexport class PerformanceTimer {\r\n    /**\r\n     * Returns timestamp in milliseconds since page load.\r\n     *\r\n     * If the [[DOMHighResTimeStamp]] is supported, the resolution is up to 5 microseconds,\r\n     * otherwise it is in milliseconds. Timespans are computed by taking the difference between two\r\n     * samples.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const now = PerformanceTimer.now();\r\n     * // call some expensive function for which you want to check the duration.\r\n     * const end = PerformanceTimer.now();\r\n     * const elapsedTime = end - now;\r\n     * ```\r\n     */\r\n    static now(): number {\r\n        return PerformanceTimer.nowFunc();\r\n    }\r\n\r\n    private static readonly instance = new PerformanceTimer();\r\n\r\n    private static readonly nowFunc: () => number = PerformanceTimer.getNowFunc();\r\n\r\n    private static getNowFunc() {\r\n        if (typeof performance !== \"undefined\" && typeof performance.now !== \"undefined\") {\r\n            return () => performance.now();\r\n        }\r\n\r\n        // fall back to Date.getTime()\r\n        return () => {\r\n            return new Date().getTime();\r\n        };\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\ntype TypedArray =\r\n    | Int8Array\r\n    | Uint8Array\r\n    | Int16Array\r\n    | Uint16Array\r\n    | Int32Array\r\n    | Uint32Array\r\n    | Uint8ClampedArray\r\n    | Float32Array\r\n    | Float64Array;\r\n\r\n/**\r\n * Returns a bilinear-interpolated texture sample for a given texture.\r\n * @param texture - Two-dimensional texture to sample.\r\n * @param width - Texture width.\r\n * @param height - Texture height.\r\n * @param u - Number between 0 and 1 representing the location to sample in the width dimension.\r\n * @param v - Number between 0 and 1 representing the location to sample in the height dimension.\r\n */\r\nexport function sampleBilinear(\r\n    texture: TypedArray,\r\n    width: number,\r\n    height: number,\r\n    u: number,\r\n    v: number\r\n): number {\r\n    const maxXIndex = width - 1;\r\n    const maxYIndex = height - 1;\r\n    // Compute the x and y coordinates relative to the mesh size.\r\n    const xIndex = u * maxXIndex;\r\n    const xIndexFloor = Math.floor(xIndex);\r\n    const yIndex = v * maxYIndex;\r\n    const yIndexFloor = Math.floor(yIndex);\r\n    const swIndex = yIndexFloor * width + xIndexFloor;\r\n    const seIndex = xIndexFloor < maxXIndex ? swIndex + 1 : swIndex;\r\n    const nwIndex = yIndexFloor < maxYIndex ? swIndex + width : swIndex;\r\n    const neIndex = xIndexFloor < maxXIndex ? nwIndex + 1 : nwIndex;\r\n    const swElevation = texture[swIndex];\r\n    const seElevation = texture[seIndex];\r\n    const nwElevation = texture[nwIndex];\r\n    const neElevation = texture[neIndex];\r\n    // Get the fractional components to do bilinear interpolation.\r\n    const xFrac = Number.isInteger(xIndex) ? 0 : xIndex - xIndexFloor;\r\n    const xFracInverse = 1 - xFrac;\r\n    const yFrac = Number.isInteger(yIndex) ? 0 : yIndex - yIndexFloor;\r\n    const yFracInverse = 1 - yFrac;\r\n    // The interpolation is the sum of the four closest neighbours each\r\n    // multiplied by the diagonal areas.\r\n    const result =\r\n        swElevation * xFracInverse * yFracInverse +\r\n        seElevation * xFrac * yFracInverse +\r\n        nwElevation * xFracInverse * yFrac +\r\n        neElevation * xFrac * yFrac;\r\n    return result;\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Task that can be added to the [[TaskQueue]]\r\n */\r\nexport interface Task {\r\n    /**\r\n     * The Function that will be executed when the [[Task]] is processed\r\n     */\r\n    execute: () => void;\r\n\r\n    /**\r\n     * The group by which similar tasks in the TaskQueue are combined\r\n     */\r\n    group: string;\r\n\r\n    /**\r\n     * A function to retrieve the priority of the [[Task]], with 0 being\r\n     * the highest priority, and the first to be executed\r\n     */\r\n    getPriority: () => number;\r\n\r\n    /**\r\n     * An optional function that defines if a [[Task]] is alread expired\r\n     * and therefore can be removed from the [[TaskQueue]]\r\n     */\r\n    isExpired?: () => boolean;\r\n\r\n    /**\r\n     * An optional function that returns an estimated process time,\r\n     * this is not directly used by the [[TaskQueue]] but can be used\r\n     * by an Task Scheduler to schedule the processing\r\n     */\r\n    estimatedProcessTime?: () => number;\r\n}\r\n\r\nexport interface TaskQueueOptions {\r\n    //TODO: Use the max length\r\n    //maxLength?: number;\r\n    /**\r\n     * Groups to combine specific [[Task]]s in the [[TaskQueue]],\r\n     * [[Task]]s can only be added to the [[TaskQueue]] if their group is available\r\n     */\r\n    groups: string[];\r\n\r\n    /**\r\n     * Optional function to sort the priority, if set, i will override the internal TaskQueue.sort\r\n     * function.\r\n     *\r\n     * @remarks\r\n     * Caution, the {@link TaskQueue} uses the last element in the Arrays first, so the\r\n     * highest priorities should be ordered to the end\r\n     */\r\n    prioSortFn?: (a: Task, b: Task) => number;\r\n}\r\n\r\n/**\r\n * A Pull-TaskQueue sorted by priority and group-able {@link Task}s by {@link Task.group}.\r\n *\r\n * @remarks\r\n *\r\n * @example\r\n * Sample Usage\r\n * ```\r\n *  const taskQueue = new TaskQueue({\r\n *      group: [\"group1\"]\r\n *  })\r\n *  taskQueue.add({\r\n *     group: \"group1\",\r\n *     execute: () => {\r\n *         console.log(\"task of group1 executed\");\r\n *     },\r\n *     getPrio: () => {\r\n *         return 0;\r\n *     }\r\n *   });\r\n *\r\n * taskQueue.update();\r\n * taskQueue.processNext(\"group1\");\r\n *\r\n *  ```\r\n */\r\nexport class TaskQueue {\r\n    private readonly m_taskLists: Map<string, Task[]> = new Map();\r\n\r\n    constructor(private readonly m_options: TaskQueueOptions) {\r\n        this.m_options.groups?.forEach(group => {\r\n            this.m_taskLists.set(group, []);\r\n        });\r\n        if (this.m_options.prioSortFn) {\r\n            this.sort = this.m_options.prioSortFn;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Updates the lists in the queue depending on their priority functions and removes\r\n     * expired Tasks, based on their isExpired functions result.\r\n     *\r\n     * @param group The Group to update, if not set all groups will be updated.\r\n     */\r\n    update(group?: string) {\r\n        if (group === undefined) {\r\n            this.m_taskLists.forEach(taskList => {\r\n                this.updateTaskList(taskList);\r\n            });\r\n        } else {\r\n            const taskList = this.getTaskList(group);\r\n            if (taskList) {\r\n                this.updateTaskList(taskList);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds a Task to the Queue\r\n     *\r\n     * @param task\r\n     * @returns true if succesfully added, otherwise false\r\n     */\r\n    add(task: Task): boolean {\r\n        if (this.m_taskLists.has(task.group)) {\r\n            const taskList = this.m_taskLists.get(task.group);\r\n            if (!taskList?.includes(task)) {\r\n                this.m_taskLists.get(task.group)?.push(task);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Removes a Task from the Queue\r\n     *\r\n     * @param task\r\n     * @returns true if succesfully removed, otherwise false\r\n     */\r\n    remove(task: Task): boolean {\r\n        if (this.m_taskLists.has(task.group)) {\r\n            const index = this.m_taskLists.get(task.group)?.indexOf(task);\r\n            if (index !== -1) {\r\n                this.m_taskLists.get(task.group)?.splice(index as number, 1);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Returns the number of remaining tasks.\r\n     *\r\n     * @param group if group is set, it will return only the remaining tasks for this group,\r\n     * otherwise it will return the complete amount of tasks left.\r\n     */\r\n    numItemsLeft(group?: string): number {\r\n        let numLeft: number = 0;\r\n        if (group === undefined) {\r\n            this.m_taskLists.forEach(tasklist => {\r\n                numLeft += tasklist.length;\r\n            });\r\n        } else {\r\n            numLeft += this.getTaskList(group)?.length ?? 0;\r\n        }\r\n        return numLeft;\r\n    }\r\n\r\n    /**\r\n     * Processes the next Tasks for a group\r\n     *\r\n     * @param group The group the Tasks are pulled from.\r\n     * @param shouldProcess A condition that, if set will be executed before the task is processed,\r\n     * if returns true, the task will run\r\n     * @param n The amount of tasks that should be pulled, @defaults to 1\r\n     * @returns false if thte list was empty\r\n     */\r\n    processNext(group: string, shouldProcess?: (task: Task) => boolean, n: number = 1): boolean {\r\n        if (!this.getTaskList(group) || this.numItemsLeft(group) <= 0) {\r\n            return false;\r\n        }\r\n        for (let i = 0; i < n && this.numItemsLeft(group) > 0; i++) {\r\n            const nextTask = this.pull(group, true);\r\n            if (nextTask !== undefined) {\r\n                //if a condition is set, execute it\r\n                if (!shouldProcess || shouldProcess?.(nextTask)) {\r\n                    nextTask.execute();\r\n                } else {\r\n                    //as the task was not executed but already pulled, add it back\r\n                    //TODO: dont even pull it if it will not execute, this currently\r\n                    // interferes with the skipping and removal of expired tasks on this.pull\r\n                    this.add(nextTask);\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    clear() {\r\n        this.m_taskLists.clear();\r\n    }\r\n\r\n    private pull(group: string, checkIfExpired: boolean = false): Task | undefined {\r\n        const taskList = this.getTaskList(group);\r\n        let nextTask;\r\n        if (taskList) {\r\n            nextTask = this.getTaskList(group)?.pop();\r\n            if (checkIfExpired && nextTask && nextTask.isExpired?.()) {\r\n                return this.pull(group, checkIfExpired);\r\n            }\r\n        }\r\n        return nextTask;\r\n    }\r\n\r\n    private sort(a: Task, b: Task): number {\r\n        // the highest number in the beginning as the last in the array with\r\n        // highest priority which equals 0 will start to be processed\r\n        return b.getPriority() - a.getPriority();\r\n    }\r\n\r\n    private getTaskList(group: string): Task[] | undefined {\r\n        return this.m_taskLists.get(group);\r\n    }\r\n\r\n    private updateTaskList(taskList: Task[]) {\r\n        for (let i = 0; i < taskList.length; i++) {\r\n            const task = taskList[i];\r\n            if (task?.isExpired?.()) {\r\n                taskList.splice(i, 1);\r\n                i--;\r\n            }\r\n        }\r\n        taskList.sort(this.sort);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { resolveReferenceUri } from \"./UrlUtils\";\r\n\r\n/**\r\n * Custom, app-specific URI resolver interface.\r\n */\r\nexport interface UriResolver {\r\n    /**\r\n     * Attempt to resolve `URI` to `URL`.\r\n     *\r\n     * If given resolver doesn't know about this specific kind of `URI`, it should return string as\r\n     * received.\r\n     *\r\n     * @param input - `URI`\r\n     * @returns actual `URL` if this handler knows how locate given `uri` or original `uri`\r\n     */\r\n    resolveUri(uri: string): string;\r\n}\r\n\r\nexport interface PrefixUriResolverDefinition {\r\n    [prefix: string]: string;\r\n}\r\n\r\n/**\r\n * Basic, import-map like {@link UriResolver}.\r\n *\r\n * Resolves `uris` basing on exact or prefix match of `key` from `definitions`.\r\n *\r\n * In definitions, `key` is matched against input uri with following strategy:\r\n *  - `key` without trailing `/` -> `key` and input `uri` must be identical\r\n *  - `key` with trailing `/`, -> `key` is treated as \"package prefix\", so `uri` must start with\r\n *    `key`\r\n *\r\n * Example:\r\n * ```\r\n * {\r\n *     \"local://poiMasterList\": \"/assets/poiMasterList.json\"\r\n *        // will match only 'local://poiMasterList' and resolve `/assets/poiMasterList.json`\r\n *     \"local://icons/\": \"/assets/icons/\"\r\n *        // will match only 'local://icons/ANYPATH' (and similar) and resolve to\r\n *        // `/assets/icons/ANYPATH\r\n * }\r\n * ```\r\n * Inspired by [`WICG` import maps proposal](https://github.com/WICG/import-maps#the-import-map).\r\n */\r\nexport class PrefixMapUriResolver implements UriResolver {\r\n    constructor(readonly definitions: PrefixUriResolverDefinition) {}\r\n\r\n    resolveUri(uri: string) {\r\n        return Object.keys(this.definitions).reduce((r, key) => {\r\n            if (key.endsWith(\"/\") && r.startsWith(key)) {\r\n                const newPrefix = this.definitions[key];\r\n                return newPrefix + r.substr(key.length);\r\n            } else if (r === key) {\r\n                return this.definitions[key];\r\n            }\r\n            return r;\r\n        }, uri);\r\n    }\r\n}\r\n\r\n/**\r\n * [UriResolver] that resolve relative `uri`s against to parent resource `uri`.\r\n */\r\nexport class RelativeUriResolver implements UriResolver {\r\n    constructor(readonly parentUri: string) {}\r\n\r\n    resolveUri(uri: string) {\r\n        return resolveReferenceUri(this.parentUri, uri);\r\n    }\r\n}\r\n\r\n/**\r\n * Compose URI resolvers.\r\n *\r\n * Creates new {@link UriResolver} that applies resolvers in orders or arguments.\r\n *\r\n * Example:\r\n *\r\n *     const themeUrl = ...; // url of parent object\r\n *     const childUrlResolver = composeUrlResolvers(\r\n *           new RelativeUriResolver(themeUrl),\r\n *           defaultUrlResolver\r\n *     );\r\n */\r\nexport function composeUriResolvers(...resolvers: Array<UriResolver | undefined>): UriResolver {\r\n    return {\r\n        resolveUri(originalUrl: string) {\r\n            return resolvers.reduce((url, resolver) => {\r\n                if (resolver !== undefined) {\r\n                    return resolver.resolveUri(url);\r\n                } else {\r\n                    return url;\r\n                }\r\n            }, originalUrl);\r\n        }\r\n    };\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { baseUrl } from \"./UrlUtils\";\r\n\r\n/**\r\n * Get base URL for from where relative URLs will be loaded.\r\n *\r\n * * In browser, it resolves to `baseUrl(location.href)` i.e document's base URL\r\n * (see: https://www.w3.org/TR/WD-html40-970917/htmlweb.html#h-5.1.2).\r\n *\r\n * * In node, it resolves to `file://${process.cwd()}`.\r\n */\r\nexport function getAppBaseUrl() {\r\n    if (typeof window === \"undefined\") {\r\n        return `file://${process.cwd()}/`;\r\n    }\r\n    return baseUrl(window.location.href);\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n/**\r\n * Resolve URI of referenced object w.r.t parent URI.\r\n *\r\n * Resolves `childUri` as it would be loaded from location specified by `parentUri`.\r\n *\r\n * If `childUri` is absolute, then it is returned unchanged.\r\n * If `childUri` is origin-absolute path, then only origin path is taken from `parentUri`.\r\n *\r\n * See [[baseUri]] for reference how base URL of `parentUri` is determined.\r\n *\r\n * Supports `http:`, `https:`, `file:`, `data:` schemes.\r\n *\r\n * Examples:\r\n *\r\n *     // normal case, child is sibling\r\n *     https://foo.com/themes/day.json + images/foo.png -> https://foo.com/themes/images/foo.png\r\n *\r\n *     // parent is \"folder\", so child is just located in this folder\r\n *     https://foo.com/themes/ + images/foo.png -> https://foo.com/themes/images/foo.png\r\n *\r\n *     // parent looks like leaf, so last component is stripped\r\n *     https://foo.com/themes + images/foo.png -> https://foo.com/images/foo.png\r\n *\r\n *     // origin-absolute URL, takes only origin from parent\r\n *     https://foo.com/themes/day.json + /fonts/foo.json -> https://foo.com/fonts/foo.json\r\n *\r\n * @param parentUri - URI of parent resource\r\n * @param childUri - URI of child as referenced from parent resource\r\n * @return `childUrl` as if anchored in location of `parentUrl`\r\n */\r\nexport function resolveReferenceUri(parentUri: string | undefined, childUri: string): string {\r\n    if (absoluteUrlWithOriginRe.test(childUri)) {\r\n        return childUri;\r\n    } else if (childUri.startsWith(\"/\")) {\r\n        const origin = getUrlOrigin(parentUri);\r\n        return origin + childUri;\r\n    } else {\r\n        if (childUri.startsWith(\"./\")) {\r\n            childUri = childUri.substr(2);\r\n        }\r\n        const parentBaseUrl = baseUrl(parentUri);\r\n        return parentBaseUrl + childUri;\r\n    }\r\n}\r\n\r\nconst absoluteUrlWithOriginRe = new RegExp(\"^(((?:[a-z]+:)?//)|(file:/)|(data:))\", \"i\");\r\n\r\n/**\r\n * Returns base URL of given resource URL.\r\n *\r\n * `Url` with trailing slash are considered genuine 'locations', they are returned as is, however if\r\n * `url` ends with name component it is treated as \"leaf\", so last path component is removed.\r\n *\r\n * Standalone files (without any folder structure) are considered relative to `./`.\r\n *\r\n * Examples:\r\n * ```\r\n *     https://foo.com/themes/a.json -> https://foo.com/themes/\r\n *     https://foo.com/themes/ -> https://foo.com/themes/\r\n *     https://foo.com/themes -> https://foo.com/ // note, themes is treated as leaf\r\n *     themes/day.json -> themes/\r\n *     themes -> ./\r\n * ```\r\n */\r\nexport function baseUrl(url: string | undefined) {\r\n    if (url === undefined) {\r\n        return \"./\";\r\n    }\r\n    let idx = url.indexOf(\"#\");\r\n    if (idx !== -1) {\r\n        url = url.slice(0, idx);\r\n    }\r\n    idx = url.indexOf(\"?\");\r\n    if (idx !== -1) {\r\n        url = url.slice(0, idx);\r\n    }\r\n    idx = url.lastIndexOf(\"/\");\r\n    if (idx === -1) {\r\n        return \"./\";\r\n    } else {\r\n        return url.substring(0, idx + 1);\r\n    }\r\n}\r\n\r\n/**\r\n * Get `origin` part of URL.\r\n *\r\n * @example\r\n *    https://example.com/foo -> https://example.com\r\n *    //example.com:8080/ -> //example.com:8080\r\n *    file:///etc/hosts ->\r\n *\r\n * @param url - input URL\r\n * @return origin of given URL\r\n */\r\nexport function getUrlOrigin(url: string | undefined): string {\r\n    if (url === undefined) {\r\n        return \"\";\r\n    }\r\n    const parsed = getUrlHostAndProtocol(url);\r\n    if (parsed.protocol === \"file:\") {\r\n        return \"file://\";\r\n    } else if (parsed.host && parsed.protocol) {\r\n        return parsed.protocol + \"//\" + parsed.host;\r\n    } else if (parsed.host) {\r\n        return \"//\" + parsed.host;\r\n    } else if (parsed.protocol) {\r\n        return parsed.protocol + \"//\";\r\n    } else {\r\n        return \"\";\r\n    }\r\n}\r\n\r\n/**\r\n * Parse `host` and `protocol` part from URL.\r\n */\r\nexport function getUrlHostAndProtocol(\r\n    url: string\r\n): {\r\n    protocol: string;\r\n    host: string;\r\n} {\r\n    const urlOriginRe = new RegExp(/^(?:([a-z]+:))?\\/\\/([^\\/]*)/, \"i\");\r\n\r\n    const match = url.match(urlOriginRe);\r\n    if (!match) {\r\n        throw new Error(`getUrlHostAndProtocol: unable to parse URL '${url}'`);\r\n    }\r\n    return {\r\n        protocol: match[1],\r\n        host: match[2]\r\n    };\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\ndeclare const process: any;\r\n\r\n// cache value, because access to process.env.NODE_ENV is SLOW!\r\nconst isProduction = process.env.NODE_ENV === \"production\";\r\n\r\n//TODO: Make assertHandler configurable\r\n\r\n/**\r\n * Implementation of assert as a development help\r\n *\r\n * Note - this is deliberately a global function so that minimizers remove the\r\n * entire call when building for production.\r\n *\r\n * @hidden\r\n * @param condition - Condition to match, if false, throws an Error(message)\r\n * @param message - Optional message, defaults to \"ASSERTION failed\"\r\n */\r\nexport function assert(condition: boolean, message?: string): void {\r\n    if (!isProduction) {\r\n        if (!condition) {\r\n            throw new Error(message !== undefined ? message : \"ASSERTION failed\");\r\n        }\r\n    }\r\n}\r\n\r\nexport function assertExists<T>(element: T | undefined, message?: string): T {\r\n    if (!isProduction) {\r\n        if (element === undefined || element === null) {\r\n            throw new Error(\r\n                message !== undefined ? message : \"ASSERTION failed: Element is undefined or null\"\r\n            );\r\n        }\r\n    }\r\n    return element!;\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nexport * from \"./lib/VectorTileDecoder\";\r\nexport * from \"./lib/GeoJsonTilerService\";\r\nexport * from \"./lib/OmvDecoderDefs\";\r\nexport * from \"./lib/DataAdapter\";\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { DecodeInfo } from \"./DecodeInfo\";\r\nimport { IGeometryProcessor } from \"./IGeometryProcessor\";\r\n\r\n/**\r\n * The class `DataAdapter` prepares vector data so it\r\n * can be processed by the vector tile decoder.\r\n */\r\nexport interface DataAdapter {\r\n    /**\r\n     * Checks if the given data can be processed by this `DataAdapter`.\r\n     *\r\n     * @param data - The raw data to adapt.\r\n     */\r\n    canProcess(data: ArrayBufferLike | {}): boolean;\r\n\r\n    /**\r\n     * Process the given raw data.\r\n     *\r\n     * @param data - The raw data to process.\r\n     * @param decodeInfo - The `DecodeInfo` of the tile to process.\r\n     * @param geometryProcessor - Must be called for every feature providing its geometry\r\n     * (point,line or polygon) and properties. @see {@link IGeometryProcessor} for more details.\r\n     */\r\n    process(\r\n        data: ArrayBufferLike | {},\r\n        decodeInfo: DecodeInfo,\r\n        geometryProcessor: IGeometryProcessor\r\n    ): void;\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport {\r\n    GeoBox,\r\n    OrientedBox3,\r\n    Projection,\r\n    TileKey,\r\n    TilingScheme,\r\n    webMercatorTilingScheme\r\n} from \"@here/harp-geoutils\";\r\nimport * as THREE from \"three\";\r\n\r\nimport { WorldTileProjectionCookie } from \"./OmvUtils\";\r\n\r\nexport class DecodeInfo {\r\n    /**\r\n     * The [[GeoBox]] of the Tile to decode.\r\n     */\r\n    readonly geoBox: GeoBox;\r\n\r\n    readonly projectedBoundingBox = new OrientedBox3();\r\n\r\n    /**\r\n     * The tile bounds in the OMV tile space [[webMercatorTilingScheme]].\r\n     */\r\n    readonly tileBounds = new THREE.Box3();\r\n\r\n    /**\r\n     * The tile size in the OMV tile space [[webMercatorTilingScheme]].\r\n     */\r\n    readonly tileSize = new THREE.Vector3();\r\n\r\n    /**\r\n     * The center of the Tile in the target [[Projection]] space.\r\n     * Geometries generated by decoding the OMV tile must be relative\r\n     * to this position.\r\n     */\r\n    readonly center = new THREE.Vector3();\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    worldTileProjectionCookie?: WorldTileProjectionCookie;\r\n\r\n    /**\r\n     * Estimated tile size in pixels.\r\n     */\r\n    readonly tileSizeOnScreen: number;\r\n\r\n    /**\r\n     * The maximum number of columns.\r\n     */\r\n    readonly columnCount: number;\r\n\r\n    /**\r\n     * The maximum number of rows.\r\n     */\r\n    readonly rowCount: number;\r\n\r\n    /**\r\n     * Constructs a new [[DecodeInfo]].\r\n     *\r\n     * @param targetProjection - The [[Projection]]\r\n     * @param tileKey - The [[TileKey]] of the Tile to decode.\r\n     * @param storageLevelOffset - The storage level offset.\r\n     */\r\n    constructor(\r\n        readonly targetProjection: Projection,\r\n        readonly tileKey: TileKey,\r\n        readonly storageLevelOffset: number = 0\r\n    ) {\r\n        this.geoBox = this.tilingScheme.getGeoBox(tileKey);\r\n        this.targetProjection.projectBox(this.geoBox, this.projectedBoundingBox);\r\n        this.projectedBoundingBox.getCenter(this.center);\r\n        this.tilingScheme.getWorldBox(tileKey, this.tileBounds);\r\n        this.tileBounds.getSize(this.tileSize);\r\n        this.tileSizeOnScreen = 256 * Math.pow(2, -this.storageLevelOffset);\r\n\r\n        this.columnCount = webMercatorTilingScheme.subdivisionScheme.getLevelDimensionX(\r\n            this.tileKey.level\r\n        );\r\n\r\n        this.rowCount = webMercatorTilingScheme.subdivisionScheme.getLevelDimensionY(\r\n            this.tileKey.level\r\n        );\r\n    }\r\n\r\n    /**\r\n     * The [[TilingScheme]] of the OMV data, currenly it is defined\r\n     * to be [[webMercatorTilingScheme]].\r\n     */\r\n    get tilingScheme(): TilingScheme {\r\n        return webMercatorTilingScheme;\r\n    }\r\n\r\n    /**\r\n     * The [[Projection]] of OMV tiled data, currenly it is defined\r\n     * to be [[webMercatorProjection]].\r\n     */\r\n    get sourceProjection(): Projection {\r\n        return this.tilingScheme.projection;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { TilerService, WorkerServiceManager } from \"@here/harp-mapview-decoder/index-worker\";\r\n\r\nimport { GEOJSON_TILER_SERVICE_TYPE } from \"./OmvDecoderDefs\";\r\n\r\n/**\r\n * GeoJson tiler service.\r\n *\r\n * @remarks\r\n * This services instantiates the geojson-vt based tiler\r\n * service that is responsible to create small tiles from\r\n * large GeoJson datasets.\r\n *\r\n * @example\r\n * ```typescript\r\n * // decoder.ts\r\n * GeoJsonTilerService.start();\r\n * ```\r\n */\r\nexport class GeoJsonTilerService {\r\n    /**\r\n     * Register a vector data tiler service with\r\n     * {@link @here/harp-mapview-decoder#WorkerServiceManager}.\r\n     *\r\n     * @remarks\r\n     * Has to be called during initialization of decoder bundle.\r\n     */\r\n    static start() {\r\n        WorkerServiceManager.getInstance().register({\r\n            serviceType: GEOJSON_TILER_SERVICE_TYPE,\r\n            factory: (serviceId: string) => TilerService.start(serviceId)\r\n        });\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { GeometryKind, GeometryKindSet } from \"@here/harp-datasource-protocol\";\r\nimport { MapEnv } from \"@here/harp-datasource-protocol/index-decoder\";\r\n\r\nimport {\r\n    OmvFeatureFilterDescription,\r\n    OmvFilterDescription,\r\n    OmvFilterFeatureAttribute,\r\n    OmvFilterString,\r\n    OmvGeometryType,\r\n    OmvLayerFilterDescription\r\n} from \"./OmvDecoderDefs\";\r\n\r\n/**\r\n * The `OmvFeatureFilter` is designed to work in an `OmvVisitor`/`visitOmv` combination (for\r\n * example, `OmvDecoder`).\r\n *\r\n * @remarks\r\n * Returning `false` from any of the calls terminates processing of that\r\n * layer or feature.\r\n *\r\n * The `OmvFeatureFilter` is an \"early-opt-out\" filter, which cannot filter individual features,\r\n * because at that point the features are not really decoded. Use the [[OmvFeatureModifier]] to\r\n * filter for individual features.\r\n */\r\nexport interface OmvFeatureFilter {\r\n    /**\r\n     * Returns `true` if the filter contains rules for specific kinds.\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    hasKindFilter: boolean;\r\n\r\n    /**\r\n     * Return `false` if the layer should not be processed.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param level - Level of tile.\r\n     */\r\n    wantsLayer(layer: string, level: number): boolean;\r\n\r\n    /**\r\n     * Return `false` if the point feature should not be processed.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param feature - Current feature.\r\n     * @param level - Level of tile.\r\n     */\r\n    wantsPointFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean;\r\n\r\n    /**\r\n     * Return `false` if the line feature should not be processed.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param feature - Current feature.\r\n     * @param level - Level of tile.\r\n     */\r\n    wantsLineFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean;\r\n\r\n    /**\r\n     * Return `false` if the polygon feature should not be processed.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param feature - Current feature.\r\n     * @param level - Level of tile.\r\n     */\r\n    wantsPolygonFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean;\r\n\r\n    /**\r\n     * Return `false` if kind of object is not enabled and the geometry should not be created.\r\n     *\r\n     * @param {(string | string[])} kind Tag \"kind\" of the tag.\r\n     * @returns {boolean}\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    wantsKind(kind: string | string[]): boolean;\r\n}\r\n\r\n/**\r\n * The `OmvFeatureModifier` can be used to filter individual features.\r\n *\r\n * @remarks\r\n * It gets passed in the `Env`\r\n * of the feature, which contains all the values that can be searched for in a style. If a filter\r\n * function returns false, the feature is ignored, and no geometry is being created.\r\n *\r\n * In addition to pure filtering, the `OmvFeatureModifier` can also modify the [[Env]] of the\r\n * feature, or even add new properties to the feature, for example, traffic states. The\r\n * `OmvFeatureModifier` is executed before the styles are selected, so the geometry is created with\r\n * the modified feature properties.\r\n */\r\nexport interface OmvFeatureModifier {\r\n    /**\r\n     * Check if the point feature described by `env` should be processed. The properties can be\r\n     * modified or added to.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param env - Properties of point feature.\r\n     * @param level - Level of tile.\r\n     * @returns `false` to ignore feature.\r\n     */\r\n    doProcessPointFeature(layer: string, env: MapEnv, level: number): boolean;\r\n\r\n    /**\r\n     * Check if the line feature described by `env` should be processed. The properties can be\r\n     * modified or added to.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param env - Properties of line feature.\r\n     * @param level - Level of tile.\r\n     * @returns `false` to ignore feature.\r\n     */\r\n    doProcessLineFeature(layer: string, env: MapEnv, level: number): boolean;\r\n\r\n    /**\r\n     * Check if the polygon feature described by `env` should be processed. The properties can be\r\n     * modified or added to.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param env - Properties of polygon feature.\r\n     * @param level - Level of tile.\r\n     * @returns `false` to ignore feature.\r\n     */\r\n    doProcessPolygonFeature(layer: string, env: MapEnv, level: number): boolean;\r\n}\r\n\r\n/**\r\n * Builds an `OmvFilterDescription` (internal type) that specifies an [[OmvFeatureFilter]] as well\r\n * as an [[OmvFeatureModifier]].\r\n *\r\n */\r\nexport class OmvFeatureFilterDescriptionBuilder {\r\n    private readonly m_processLayersDefault: boolean = true;\r\n    private readonly m_processPointsDefault: boolean = true;\r\n    private readonly m_processLinesDefault: boolean = true;\r\n    private readonly m_processPolygonsDefault: boolean = true;\r\n\r\n    private readonly m_layersToProcess = new Array<OmvLayerFilterDescription>();\r\n    private readonly m_layersToIgnore = new Array<OmvLayerFilterDescription>();\r\n    private readonly m_pointsToProcess = new Array<OmvFilterDescription>();\r\n    private readonly m_ignoredPoints = new Array<OmvFilterDescription>();\r\n    private readonly m_linesToProcess = new Array<OmvFilterDescription>();\r\n    private readonly m_linesToIgnore = new Array<OmvFilterDescription>();\r\n    private readonly m_polygonsToProcess = new Array<OmvFilterDescription>();\r\n    private readonly m_polygonsToIgnore = new Array<OmvFilterDescription>();\r\n\r\n    private m_kindsToProcess: string[] = [];\r\n    private m_kindsToIgnore: string[] = [];\r\n\r\n    /**\r\n     * Builds an `OmvFilterDescription` (internal type) that specifies an [[OmvFeatureFilter]] as\r\n     * well as an [[OmvFeatureModifier]].\r\n     *\r\n     * @param processLayersDefault - If `true`, all unspecified layers will be processed.\r\n     * If `false`, all unspecified layers will be ignored.\r\n     * @param processPointsDefault - If `true`, all unspecified point features will be processed. If\r\n     * `false`, all unspecified point features will be ignored.\r\n     * @param processLinesDefault - If `true`, all unspecified line features will be processed. If\r\n     * `false`, all unspecified line features will be ignored.\r\n     * @param processPolygonsDefault - If `true`, all unspecified polygon features will be\r\n     * processed. If `false`, all unspecified polygon features will be ignored.\r\n     */\r\n    constructor(\r\n        options?: OmvFeatureFilterDescriptionBuilder.OmvFeatureFilterDescriptionBuilderOptions\r\n    ) {\r\n        if (options) {\r\n            this.m_processLayersDefault =\r\n                options.processLayersDefault !== undefined ? options.processLayersDefault : true;\r\n            this.m_processPointsDefault =\r\n                options.processPointsDefault !== undefined ? options.processPointsDefault : true;\r\n            this.m_processLinesDefault =\r\n                options.processLinesDefault !== undefined ? options.processLinesDefault : true;\r\n            this.m_processPolygonsDefault =\r\n                options.processPolygonsDefault !== undefined\r\n                    ? options.processPolygonsDefault\r\n                    : true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a layer that should be processed.\r\n     *\r\n     * @param layer - Layer name to be matched.\r\n     * @param match - Match condition.\r\n     */\r\n    processLayer(\r\n        layer: string,\r\n        match = OmvFilterString.StringMatch.Match,\r\n        minLevel: number = 0,\r\n        maxLevel: number = Infinity\r\n    ) {\r\n        this.m_layersToProcess.push({\r\n            name: { value: layer, match },\r\n            minLevel,\r\n            maxLevel\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Add a layer that should be ignored.\r\n     *\r\n     * @param layer - Layer name to be matched.\r\n     * @param match - Match condition.\r\n     */\r\n    ignoreLayer(\r\n        layer: string,\r\n        match = OmvFilterString.StringMatch.Match,\r\n        minLevel: number = 0,\r\n        maxLevel: number = Infinity\r\n    ) {\r\n        this.m_layersToIgnore.push({\r\n            name: { value: layer, match },\r\n            minLevel,\r\n            maxLevel\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Add a valid point feature.\r\n     *\r\n     * @param options - Feature options.\r\n     */\r\n    processPoint(options: OmvFeatureFilterDescriptionBuilder.FeatureOption) {\r\n        this.addItem(this.m_pointsToProcess, options);\r\n    }\r\n\r\n    /**\r\n     * Add valid point features.\r\n     *\r\n     * @param options - Multi feature options.\r\n     */\r\n    processPoints(options: OmvFeatureFilterDescriptionBuilder.MultiFeatureOption) {\r\n        this.addItems(this.m_pointsToProcess, options);\r\n    }\r\n\r\n    /**\r\n     * Add a point feature that should be ignored.\r\n     *\r\n     * @param options - Feature options.\r\n     */\r\n    ignorePoint(options: OmvFeatureFilterDescriptionBuilder.FeatureOption) {\r\n        this.addItem(this.m_ignoredPoints, options);\r\n    }\r\n\r\n    /**\r\n     * Add point features that should be ignored.\r\n     *\r\n     * @param options - Multi feature options.\r\n     */\r\n    ignorePoints(options: OmvFeatureFilterDescriptionBuilder.MultiFeatureOption) {\r\n        this.addItems(this.m_ignoredPoints, options);\r\n    }\r\n\r\n    /**\r\n     * Add a valid line feature.\r\n     *\r\n     * @param options - Feature options.\r\n     */\r\n    processLine(options: OmvFeatureFilterDescriptionBuilder.FeatureOption) {\r\n        this.addItem(this.m_linesToProcess, options);\r\n    }\r\n\r\n    /**\r\n     * Add valid line features.\r\n     *\r\n     * @param options - Multi feature options.\r\n     */\r\n    processLines(options: OmvFeatureFilterDescriptionBuilder.MultiFeatureOption) {\r\n        this.addItems(this.m_linesToProcess, options);\r\n    }\r\n\r\n    /**\r\n     * Ignore a line feature.\r\n     *\r\n     * @param options - Feature options.\r\n     */\r\n    ignoreLine(options: OmvFeatureFilterDescriptionBuilder.FeatureOption) {\r\n        this.addItem(this.m_linesToIgnore, options);\r\n    }\r\n\r\n    /**\r\n     * Ignore line features.\r\n     *\r\n     * @param options - Multi feature options.\r\n     */\r\n    ignoreLines(options: OmvFeatureFilterDescriptionBuilder.MultiFeatureOption) {\r\n        this.addItems(this.m_linesToIgnore, options);\r\n    }\r\n\r\n    /**\r\n     * Add a valid polygon feature.\r\n     *\r\n     * @param options - Feature options.\r\n     */\r\n    processPolygon(options: OmvFeatureFilterDescriptionBuilder.FeatureOption) {\r\n        this.addItem(this.m_polygonsToProcess, options);\r\n    }\r\n\r\n    /**\r\n     * Add valid polygon features.\r\n     *\r\n     * @param options - Multi feature options.\r\n     */\r\n    processPolygons(options: OmvFeatureFilterDescriptionBuilder.MultiFeatureOption) {\r\n        this.addItems(this.m_polygonsToProcess, options);\r\n    }\r\n\r\n    /**\r\n     * Ignore a valid polygon feature.\r\n     *\r\n     * @param options - Feature options.\r\n     */\r\n    ignorePolygon(options: OmvFeatureFilterDescriptionBuilder.FeatureOption) {\r\n        this.addItem(this.m_polygonsToIgnore, options);\r\n    }\r\n\r\n    /**\r\n     * Ignore polygon features.\r\n     *\r\n     * @param options - Multi feature options.\r\n     */\r\n    ignorePolygons(options: OmvFeatureFilterDescriptionBuilder.MultiFeatureOption) {\r\n        this.addItems(this.m_polygonsToIgnore, options);\r\n    }\r\n\r\n    /**\r\n     * Add all the specified strings as \"enabledKinds\".\r\n     *\r\n     * @param {string[]} enabledKinds List of kinds that should be generated.\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    processKinds(enabledKinds: string[]) {\r\n        this.m_kindsToProcess = this.m_kindsToProcess.concat(enabledKinds);\r\n    }\r\n\r\n    /**\r\n     * Add all the specified strings as \"disabledKinds\".\r\n     *\r\n     * @param {string[]} disabledKinds List of kinds that should _not_ be generated.\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    ignoreKinds(disabledKinds: string[]) {\r\n        this.m_kindsToIgnore = this.m_kindsToIgnore.concat(disabledKinds);\r\n    }\r\n\r\n    /**\r\n     * Create a filter description that can be passed as an option to the [[OmvDataSource]].\r\n     */\r\n    createDescription(): OmvFeatureFilterDescription {\r\n        return {\r\n            processLayersDefault: this.m_processLayersDefault,\r\n            processPointsDefault: this.m_processPointsDefault,\r\n            processLinesDefault: this.m_processLinesDefault,\r\n            processPolygonsDefault: this.m_processPolygonsDefault,\r\n\r\n            layersToProcess: this.m_layersToProcess,\r\n            layersToIgnore: this.m_layersToIgnore,\r\n            pointsToProcess: this.m_pointsToProcess,\r\n            pointsToIgnore: this.m_ignoredPoints,\r\n            linesToProcess: this.m_linesToProcess,\r\n            linesToIgnore: this.m_linesToIgnore,\r\n            polygonsToProcess: this.m_polygonsToProcess,\r\n            polygonsToIgnore: this.m_polygonsToIgnore,\r\n\r\n            kindsToProcess: this.m_kindsToProcess,\r\n            kindsToIgnore: this.m_kindsToIgnore\r\n        };\r\n    }\r\n\r\n    private addItem(\r\n        items: OmvFilterDescription[],\r\n        options: OmvFeatureFilterDescriptionBuilder.FeatureOption\r\n    ) {\r\n        if (options.minLevel === undefined || isNaN(options.minLevel)) {\r\n            options.minLevel = 0;\r\n        }\r\n        if (options.maxLevel === undefined || isNaN(options.maxLevel)) {\r\n            options.maxLevel = Infinity;\r\n        }\r\n\r\n        const item: OmvFilterDescription = {\r\n            layerName: {\r\n                value: options.layer,\r\n                match:\r\n                    options.matchLayer === undefined\r\n                        ? OmvFilterString.StringMatch.Match\r\n                        : options.matchLayer\r\n            },\r\n            geometryTypes:\r\n                options.geomType !== undefined\r\n                    ? Array.isArray(options.geomType)\r\n                        ? options.geomType\r\n                        : [options.geomType]\r\n                    : undefined,\r\n            classes: [\r\n                {\r\n                    value: options.featureClass,\r\n                    match:\r\n                        options.matchClass === undefined\r\n                            ? OmvFilterString.StringMatch.Match\r\n                            : options.matchClass\r\n                }\r\n            ],\r\n            minLevel: options.minLevel,\r\n            maxLevel: options.maxLevel,\r\n            featureAttribute: options.featureAttribute\r\n        };\r\n\r\n        items.push(item);\r\n    }\r\n\r\n    private addItems(\r\n        items: OmvFilterDescription[],\r\n        options: OmvFeatureFilterDescriptionBuilder.MultiFeatureOption\r\n    ) {\r\n        if (options.minLevel === undefined || isNaN(options.minLevel)) {\r\n            options.minLevel = 0;\r\n        }\r\n        if (options.maxLevel === undefined || isNaN(options.maxLevel)) {\r\n            options.maxLevel = Infinity;\r\n        }\r\n\r\n        const item: OmvFilterDescription = {\r\n            layerName: {\r\n                value: options.layer,\r\n                match:\r\n                    options.matchLayer === undefined\r\n                        ? OmvFilterString.StringMatch.Match\r\n                        : options.matchLayer\r\n            },\r\n            geometryTypes:\r\n                options.geomTypes !== undefined\r\n                    ? Array.isArray(options.geomTypes)\r\n                        ? options.geomTypes\r\n                        : [options.geomTypes]\r\n                    : undefined,\r\n            classes: options.featureClasses,\r\n            minLevel: options.minLevel,\r\n            maxLevel: options.maxLevel,\r\n            featureAttribute: options.featureAttribute\r\n        };\r\n\r\n        items.push(item);\r\n    }\r\n}\r\n\r\nexport namespace OmvFeatureFilterDescriptionBuilder {\r\n    /**\r\n     * Options for `OmvFeatureFilterDescriptionBuilder`.\r\n     */\r\n    export interface OmvFeatureFilterDescriptionBuilderOptions {\r\n        /**\r\n         * If `true`, all unspecified layers will be processed. If `false`, all unspecified layers\r\n         * will be ignored.\r\n         */\r\n        processLayersDefault?: boolean;\r\n        /**\r\n         * If `true`, all unspecified point features will be processed. If `false`, all unspecified\r\n         * point features will be ignored.\r\n         */\r\n        processPointsDefault?: boolean;\r\n        /**\r\n         * If `true`, all unspecified line features will be processed. If `false`, all unspecified\r\n         * line\r\n         * features will be ignored.\r\n         */\r\n        processLinesDefault?: boolean;\r\n        /**\r\n         * If `true`, all unspecified polygon features will be processed. If `false`, all\r\n         * unspecified polygon features will be ignored.\r\n         */\r\n        processPolygonsDefault?: boolean;\r\n    }\r\n\r\n    /**\r\n     * Description of a single feature.\r\n     */\r\n    export interface FeatureOption {\r\n        /**\r\n         * Layer name to be matched.\r\n         */\r\n        layer: string;\r\n        /**\r\n         * Optional geometry type to be limited to. If specified, but does not match, the feature is\r\n         * ignored.\r\n         */\r\n        geomType: OmvGeometryType | OmvGeometryType[] | undefined;\r\n        /**\r\n         * Optional class to match. If specified, but does not match, the feature is ignored.\r\n         */\r\n        featureClass: string;\r\n        /**\r\n         * Match condition for the layer name.\r\n         */\r\n        matchLayer?: OmvFilterString.StringMatch;\r\n        /**\r\n         * Match condition for `featureClass`.\r\n         */\r\n        matchClass?: OmvFilterString.StringMatch;\r\n        /**\r\n         * Minimum tile level to match.\r\n         */\r\n        minLevel?: number;\r\n        /**\r\n         * Maximum tile level to match.\r\n         */\r\n        maxLevel?: number;\r\n        /**\r\n         * Feature attribute to match.\r\n         */\r\n        featureAttribute?: OmvFilterFeatureAttribute;\r\n    }\r\n\r\n    /**\r\n     * Description for multiple features.\r\n     */\r\n    export interface MultiFeatureOption {\r\n        /**\r\n         * Layer name to be matched.\r\n         */\r\n        layer: string;\r\n        /**\r\n         * Optional geometry type to be limited to. If specified, but does not match, the feature is\r\n         * ignored.\r\n         */\r\n        geomTypes?: OmvGeometryType | OmvGeometryType[] | undefined;\r\n        /**\r\n         * Optional classes to match. If specified, but does not match, the feature is ignored.\r\n         */\r\n        featureClasses?: OmvFilterString[];\r\n        /**\r\n         * Match condition for the layer name.\r\n         */\r\n        matchLayer?: OmvFilterString.StringMatch;\r\n        /**\r\n         * Minimum tile level to match.\r\n         */\r\n        minLevel?: number;\r\n        /**\r\n         * Maximum tile level to match.\r\n         */\r\n        maxLevel?: number;\r\n        /**\r\n         * Feature attribute to match.\r\n         */\r\n        featureAttribute?: OmvFilterFeatureAttribute;\r\n    }\r\n}\r\n\r\n/**\r\n * `OmvFeatureFilter` implementation that uses a `OmvFeatureFilterDescription` to filter `TileData`\r\n * features before they are completely decoded.\r\n *\r\n * @internal\r\n */\r\nexport class OmvGenericFeatureFilter implements OmvFeatureFilter {\r\n    private static matchLayer(\r\n        layer: string,\r\n        layerItems: OmvLayerFilterDescription[],\r\n        level: number\r\n    ): boolean {\r\n        for (const layerItem of layerItems) {\r\n            if (level < layerItem.minLevel || level > layerItem.maxLevel) {\r\n                continue;\r\n            }\r\n\r\n            if (OmvFilterString.matchString(layer, layerItem.name)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private readonly disabledKinds: GeometryKindSet | undefined;\r\n    private readonly enabledKinds: GeometryKindSet | undefined;\r\n\r\n    constructor(private readonly description: OmvFeatureFilterDescription) {\r\n        if (this.description.kindsToProcess.length > 0) {\r\n            this.enabledKinds = new GeometryKindSet(\r\n                this.description.kindsToProcess as GeometryKind[]\r\n            );\r\n        }\r\n        if (this.description.kindsToIgnore.length > 0) {\r\n            this.disabledKinds = new GeometryKindSet(\r\n                this.description.kindsToIgnore as GeometryKind[]\r\n            );\r\n        }\r\n    }\r\n\r\n    wantsLayer(layer: string, level: number): boolean {\r\n        if (OmvGenericFeatureFilter.matchLayer(layer, this.description.layersToProcess, level)) {\r\n            return true;\r\n        }\r\n\r\n        if (OmvGenericFeatureFilter.matchLayer(layer, this.description.layersToIgnore, level)) {\r\n            return false;\r\n        }\r\n\r\n        return this.description.processLayersDefault;\r\n    }\r\n\r\n    wantsPointFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean {\r\n        return this.wantsFeature(\r\n            this.description.pointsToProcess,\r\n            this.description.pointsToIgnore,\r\n            layer,\r\n            geometryType,\r\n            level,\r\n            this.description.processPointsDefault\r\n        );\r\n    }\r\n\r\n    wantsLineFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean {\r\n        return this.wantsFeature(\r\n            this.description.linesToProcess,\r\n            this.description.linesToIgnore,\r\n            layer,\r\n            geometryType,\r\n            level,\r\n            this.description.processLinesDefault\r\n        );\r\n    }\r\n\r\n    wantsPolygonFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean {\r\n        return this.wantsFeature(\r\n            this.description.polygonsToProcess,\r\n            this.description.polygonsToIgnore,\r\n            layer,\r\n            geometryType,\r\n            level,\r\n            this.description.processPolygonsDefault\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    wantsKind(kind: string | string[]): boolean {\r\n        // undefined -> no way to filter\r\n        if (kind === undefined) {\r\n            return true;\r\n        }\r\n\r\n        return (\r\n            !(\r\n                this.disabledKinds !== undefined &&\r\n                this.disabledKinds.hasOrIntersects(kind as GeometryKind)\r\n            ) ||\r\n            (this.enabledKinds !== undefined &&\r\n                this.enabledKinds.hasOrIntersects(kind as GeometryKind))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    get hasKindFilter(): boolean {\r\n        return this.enabledKinds !== undefined || this.disabledKinds !== undefined;\r\n    }\r\n\r\n    private wantsFeature(\r\n        itemsToProcess: OmvFilterDescription[],\r\n        itemsToIgnore: OmvFilterDescription[],\r\n        layer: string,\r\n        geometryType: OmvGeometryType,\r\n        level: number,\r\n        defaultResult: boolean\r\n    ): boolean {\r\n        for (const item of itemsToProcess) {\r\n            if (level < item.minLevel || level > item.maxLevel) {\r\n                continue;\r\n            }\r\n\r\n            if (!OmvFilterString.matchString(layer, item.layerName)) {\r\n                // this rule is not for this layer\r\n                continue;\r\n            }\r\n\r\n            if (item.geometryTypes !== undefined && item.geometryTypes.includes(geometryType)) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        for (const item of itemsToIgnore) {\r\n            if (!OmvFilterString.matchString(layer, item.layerName)) {\r\n                // this rule is not for this layer\r\n                continue;\r\n            }\r\n\r\n            if (item.geometryTypes !== undefined && item.geometryTypes.includes(geometryType)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return defaultResult;\r\n    }\r\n}\r\n\r\n/**\r\n * An [[OmvFeatureFilter]] implementation that delegates all filter decision\r\n * returning `true` for any predicate if all delegates return `true`.\r\n *\r\n * @internal\r\n */\r\nexport class ComposedDataFilter implements OmvFeatureFilter {\r\n    constructor(readonly filters: OmvFeatureFilter[]) {}\r\n\r\n    /**\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    get hasKindFilter() {\r\n        return this.filters.reduce<boolean>(\r\n            (result, filter) => result || filter.hasKindFilter,\r\n            true\r\n        );\r\n    }\r\n\r\n    wantsLayer(layer: string, level: number): boolean {\r\n        return this.filters.reduce<boolean>(\r\n            (result, filter) => result && filter.wantsLayer(layer, level),\r\n            true\r\n        );\r\n    }\r\n\r\n    wantsPointFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean {\r\n        return this.filters.reduce<boolean>(\r\n            (result, filter) => result && filter.wantsPointFeature(layer, geometryType, level),\r\n            true\r\n        );\r\n    }\r\n\r\n    wantsLineFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean {\r\n        return this.filters.reduce<boolean>(\r\n            (result, filter) => result && filter.wantsLineFeature(layer, geometryType, level),\r\n            true\r\n        );\r\n    }\r\n\r\n    wantsPolygonFeature(layer: string, geometryType: OmvGeometryType, level: number): boolean {\r\n        return this.filters.reduce<boolean>(\r\n            (result, filter) => result && filter.wantsPolygonFeature(layer, geometryType, level),\r\n            true\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @deprecated See {@link @here/here-datasource-protocol/BaseTechniqueParams.kind}.\r\n     */\r\n    wantsKind(kind: string | string[]): boolean {\r\n        return this.filters.reduce<boolean>(\r\n            (result, filter) => result && filter.wantsKind(kind),\r\n            true\r\n        );\r\n    }\r\n}\r\n/**\r\n * `OmvFeatureModifier` implementation that uses a `OmvFeatureFilterDescription` to filter\r\n * `TileData` features before they are completely decoded.\r\n *\r\n * @internal\r\n */\r\nexport class OmvGenericFeatureModifier implements OmvFeatureModifier {\r\n    static matchItems(\r\n        layerName: string,\r\n        featureClass: string,\r\n        items: OmvFilterDescription[]\r\n    ): boolean {\r\n        for (const item of items) {\r\n            if (item.classes !== undefined) {\r\n                if (!OmvFilterString.matchString(layerName, item.layerName)) {\r\n                    continue;\r\n                }\r\n                for (const matchClass of item.classes) {\r\n                    if (OmvFilterString.matchString(featureClass, matchClass)) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    static matchAttribute(layerName: string, env: MapEnv, items: OmvFilterDescription[]): boolean {\r\n        for (const item of items) {\r\n            if (item.featureAttribute !== undefined) {\r\n                if (\r\n                    OmvFilterString.matchString(layerName, item.layerName) &&\r\n                    env.lookup(item.featureAttribute.key) === item.featureAttribute.value\r\n                ) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    constructor(private readonly description: OmvFeatureFilterDescription) {}\r\n\r\n    doProcessPointFeature(layer: string, env: MapEnv): boolean {\r\n        return this.doProcessFeature(\r\n            this.description.pointsToProcess,\r\n            this.description.pointsToIgnore,\r\n            layer,\r\n            env,\r\n            this.description.processPointsDefault\r\n        );\r\n    }\r\n\r\n    doProcessLineFeature(layer: string, env: MapEnv): boolean {\r\n        return this.doProcessFeature(\r\n            this.description.linesToProcess,\r\n            this.description.linesToIgnore,\r\n            layer,\r\n            env,\r\n            this.description.processLinesDefault\r\n        );\r\n    }\r\n\r\n    doProcessPolygonFeature(layer: string, env: MapEnv): boolean {\r\n        return this.doProcessFeature(\r\n            this.description.polygonsToProcess,\r\n            this.description.polygonsToIgnore,\r\n            layer,\r\n            env,\r\n            this.description.processPolygonsDefault\r\n        );\r\n    }\r\n\r\n    protected doProcessFeature(\r\n        itemsToProcess: OmvFilterDescription[],\r\n        itemsToIgnore: OmvFilterDescription[],\r\n        layer: string,\r\n        env: MapEnv,\r\n        defaultResult: boolean\r\n    ): boolean {\r\n        if (layer === undefined || (itemsToProcess.length === 0 && itemsToIgnore.length === 0)) {\r\n            return defaultResult;\r\n        }\r\n\r\n        let featureClass: string | undefined;\r\n        const featureClassThing = env.lookup(\"class\");\r\n\r\n        if (featureClassThing !== undefined && featureClassThing !== null) {\r\n            featureClass = featureClassThing.toString();\r\n        }\r\n\r\n        if (\r\n            featureClass &&\r\n            OmvGenericFeatureModifier.matchItems(layer, featureClass, itemsToProcess)\r\n        ) {\r\n            return true;\r\n        }\r\n\r\n        if (\r\n            featureClass &&\r\n            OmvGenericFeatureModifier.matchItems(layer, featureClass, itemsToIgnore)\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        if (OmvGenericFeatureModifier.matchAttribute(layer, env, itemsToProcess)) {\r\n            return true;\r\n        }\r\n\r\n        if (OmvGenericFeatureModifier.matchAttribute(layer, env, itemsToIgnore)) {\r\n            return false;\r\n        }\r\n\r\n        return defaultResult;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport { Value } from \"@here/harp-datasource-protocol/index-decoder\";\r\n\r\n/**\r\n * Feature Modifier ids to choose which OmvFeatureModifer should be used in OmvDecoder.\r\n */\r\nexport enum FeatureModifierId {\r\n    /**\r\n     * Generic feature modifier used when no other modifiers are defined.\r\n     *\r\n     * @note You do not need to specify it in [[OmvDataSourceParameters]] as it is added by default\r\n     * if no other feature modifier is used.\r\n     */\r\n    default\r\n}\r\n\r\n/**\r\n * Definition of a filter.\r\n */\r\nexport interface OmvFilterString {\r\n    /**  String value */\r\n    value: string;\r\n    /** Match condition */\r\n    match: OmvFilterString.StringMatch;\r\n}\r\n\r\n/**\r\n * Adding the match condition type and the matching function to the namespace of `OmvFilterString`.\r\n */\r\nexport namespace OmvFilterString {\r\n    /**\r\n     * Match condition.\r\n     */\r\n    export enum StringMatch {\r\n        /** Matches any. */\r\n        Any,\r\n        /** Exact match. */\r\n        Match,\r\n        /** Matches if a test string starts with a filter string. */\r\n        StartsWith,\r\n        /** Matches if a test string contains a filter string. */\r\n        Contains,\r\n        /** Matches if a test string ends with a filter string. */\r\n        EndsWith\r\n    }\r\n\r\n    /**\r\n     * Check for a string against a filter.\r\n     *\r\n     * @param str - The string to check against a filter.\r\n     * @param filterString - The filter containing the match condition.\r\n     * @returns `true` if the match condition is satisfied.\r\n     *\r\n     * @internal\r\n     */\r\n    export function matchString(str: string, filterString: OmvFilterString): boolean {\r\n        switch (filterString.match) {\r\n            case OmvFilterString.StringMatch.Any:\r\n                return true;\r\n            case OmvFilterString.StringMatch.Match:\r\n                return str === filterString.value;\r\n            case OmvFilterString.StringMatch.StartsWith:\r\n                return filterString.value.startsWith(str);\r\n            case OmvFilterString.StringMatch.EndsWith:\r\n                return filterString.value.endsWith(str);\r\n            default:\r\n                return str.includes(filterString.value);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Definition of a filter for a feature attribute\r\n */\r\nexport interface OmvFilterFeatureAttribute {\r\n    key: string;\r\n    value: Value;\r\n}\r\n\r\nexport enum OmvGeometryType {\r\n    UNKNOWN = 0,\r\n    POINT = 1,\r\n    LINESTRING = 2,\r\n    POLYGON = 3\r\n}\r\n\r\n/**\r\n * Internal type of a layer filter description, Should not be publicly available.\r\n *\r\n * @hidden\r\n */\r\nexport interface OmvLayerFilterDescription {\r\n    name: OmvFilterString;\r\n    minLevel: number;\r\n    maxLevel: number;\r\n}\r\n\r\n/**\r\n * Internal type of a single filter description, Should not be publicly available.\r\n *\r\n * @hidden\r\n */\r\nexport interface OmvFilterDescription {\r\n    layerName: OmvFilterString;\r\n    geometryTypes?: OmvGeometryType[];\r\n    classes?: OmvFilterString[];\r\n    minLevel: number;\r\n    maxLevel: number;\r\n    featureAttribute?: OmvFilterFeatureAttribute;\r\n}\r\n\r\n/**\r\n * Internal type of a complete [[OmvFeatureFilter]] description, should not be publicly available.\r\n *\r\n * @hidden\r\n */\r\nexport interface OmvFeatureFilterDescription {\r\n    processLayersDefault: boolean;\r\n    processPointsDefault: boolean;\r\n    processLinesDefault: boolean;\r\n    processPolygonsDefault: boolean;\r\n\r\n    layersToProcess: OmvLayerFilterDescription[];\r\n    layersToIgnore: OmvLayerFilterDescription[];\r\n    pointsToProcess: OmvFilterDescription[];\r\n    pointsToIgnore: OmvFilterDescription[];\r\n    linesToProcess: OmvFilterDescription[];\r\n    linesToIgnore: OmvFilterDescription[];\r\n    polygonsToProcess: OmvFilterDescription[];\r\n    polygonsToIgnore: OmvFilterDescription[];\r\n\r\n    // enabledKinds and disabledKinds\r\n    kindsToProcess: string[];\r\n    kindsToIgnore: string[];\r\n}\r\n\r\n/**\r\n * Internal interface for options passed from the [[OmvDataSource]] to the decoder.\r\n *\r\n * @internal\r\n */\r\nexport interface OmvDecoderOptions {\r\n    /**\r\n     * If true, features that have no technique in the theme will be printed to the console (can be\r\n     * excessive!).\r\n     */\r\n    showMissingTechniques?: boolean;\r\n\r\n    /**\r\n     * Gather feature attributes from [[OmvData]]. Defaults to false.\r\n     */\r\n    gatherFeatureAttributes?: boolean;\r\n\r\n    /**\r\n     * @deprecated Tile info is not decoded anymore. The same information can be generated\r\n     * implementing a [[IGeometryProcessor]] and using [[OmvProtobufDataAdapter]] to decode OMV\r\n     * data.\r\n     */\r\n    createTileInfo?: boolean;\r\n\r\n    /**\r\n     * @deprecated Tile info is not decoded anymore. The same information can be generated\r\n     * implementing a [[IGeometryProcessor]] and using [[OmvProtobufDataAdapter]] to decode OMV\r\n     * data.\r\n     */\r\n    gatherRoadSegments?: boolean;\r\n\r\n    /**\r\n     * Optional storage level offset for [[Tile]]s. Default is -2.\r\n     */\r\n    storageLevelOffset?: number;\r\n\r\n    /**\r\n     * If not set to `false` very short text labels will be skipped during decoding based on a\r\n     * heuristic.\r\n     */\r\n    skipShortLabels?: boolean;\r\n\r\n    /**\r\n     * A description for the feature filter which can be safely passed down to the web workers.\r\n     * It has to be generated with the help of the [[OmvFeatureFilterDescriptionBuilder]] (to\r\n     * guarantee the correctness).\r\n     */\r\n    filterDescription?: OmvFeatureFilterDescription | null;\r\n\r\n    // NOTE: Consider using OmvFeatureModifiers objects already instead of ids, this way we could\r\n    // get rid of politicalView property as properly configured feature modifier (with country\r\n    // code), would be already defined here.\r\n    /**\r\n     * List of user specified [[OmvFeatureModifier]]s, list order declares the order of processing.\r\n     *\r\n     * Each identifier is used to choose corresponding OmvFeatureModifier, if undefined at least\r\n     * [[OmvGenericFeatureModifier]] is added to decoder.\r\n     */\r\n    featureModifiers?: FeatureModifierId[];\r\n\r\n    /**\r\n     * Country code (lower-case ISO 3166-1 alpha-2) defining optional point of view to be used.\r\n     * Set to empty string (\"\") if you want to use default (widely accepted) point of view.\r\n     * If set to `undefined` leaves current political view decoder configuration.\r\n     */\r\n    politicalView?: string;\r\n\r\n    enableElevationOverlay?: boolean;\r\n\r\n    roundUpCoordinatesIfNeeded?: boolean;\r\n}\r\n\r\n/**\r\n * Vector tile decoder service type id.\r\n *\r\n * @remarks\r\n * Used for requesting decoder services using `WorkerServiceManager`.\r\n *\r\n * @internal\r\n */\r\nexport const VECTOR_TILE_DECODER_SERVICE_TYPE = \"vector-tile-decoder\";\r\n\r\n/**\r\n * GeoJson tiler service type id.\r\n *\r\n * @remarks\r\n * Used for requesting tiler services using `WorkerServiceManager`.\r\n *\r\n * @internal\r\n */\r\nexport const GEOJSON_TILER_SERVICE_TYPE = \"geojson-tiler\";\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { MapEnv } from \"@here/harp-datasource-protocol/index-decoder\";\r\nimport { LoggerManager } from \"@here/harp-utils\";\r\n\r\nimport { OmvFeatureModifier } from \"./OmvDataFilter\";\r\n\r\nconst logger = LoggerManager.instance.create(\"OmvPoliticalViewFeatureModifier\");\r\n\r\n/**\r\n * Modifies the MapEnv of the Vector Tiles in Tilezen format with different POV.\r\n *\r\n * This feature modifier updates feature properties according to different political\r\n * point of view.\r\n * Political views (or alternate point of views) are supported in Tilezen by adding\r\n * country posix (lower-case ISO 3166-1 alpha-2 compliant) to __default__ property name.\r\n * For example country borders (__boundaries__ layer) may have both __kind__ property for\r\n * default (commonly accepted point of view) and __kind:xx__ for alternate points of view.\r\n * This way disputed borders may be visible or not for certain regions and different\r\n * users (clients).\r\n *\r\n * @hidden\r\n */\r\nexport class OmvPoliticalViewFeatureModifier implements OmvFeatureModifier {\r\n    private readonly m_countryCode: string;\r\n\r\n    /**\r\n     * C-tor.\r\n     *\r\n     * @param pov - The code of the country (in lower-case ISO 3166-1 alpha-2 format) which\r\n     * point of view should be taken into account.\r\n     */\r\n    constructor(pov: string) {\r\n        this.m_countryCode = pov;\r\n    }\r\n\r\n    /**\r\n     * Simply passes all points to rendering, points features does not support PoliticalView.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param env - Properties of point feature.\r\n     * @param level - Level of tile.\r\n     * @returns always `true` to pass feature.\r\n     */\r\n    doProcessPointFeature(layer: string, env: MapEnv, level: number): boolean {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Implements line features processing changing \"kind\" attribute depending on point of view.\r\n     *\r\n     * Currently only line features support different point of view.\r\n     * @param layer - The name of the layer.\r\n     * @param env - The environment to use.\r\n     * @returns always `true` to pass lines for rendering.\r\n     */\r\n    doProcessLineFeature(layer: string, env: MapEnv, level: number): boolean {\r\n        this.rewriteEnvironment(layer, env);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Simply pass all polygons to rendering, this feature does not support PoliticalView yet.\r\n     *\r\n     * @param layer - Current layer.\r\n     * @param env - Properties of polygon feature.\r\n     * @param level - Level of tile.\r\n     * @returns `true` to pass feature.\r\n     */\r\n    doProcessPolygonFeature(layer: string, env: MapEnv, level: number): boolean {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Rewrites the Environment to match the different points of view.\r\n     *\r\n     * @param layer - The layer name.\r\n     * @param env - The environment to use.\r\n     */\r\n    private rewriteEnvironment(layer: string, env: MapEnv) {\r\n        // For now we need to rewrite \"boundaries\" layer only.\r\n        if (this.isPoliticalViewLayer(layer)) {\r\n            this.updateEnvironment(env, this.m_countryCode, \"kind\");\r\n        }\r\n    }\r\n\r\n    private updateEnvironment(env: MapEnv, countryCode: string, propName: string): void {\r\n        const value = this.getAlternativePov(env, countryCode, propName);\r\n        if (value !== undefined) {\r\n            env.entries[propName] = value;\r\n        }\r\n    }\r\n\r\n    private getAlternativePov(env: MapEnv, countryCode: string, propName: string) {\r\n        logger.log(\"Get alternate POV: \", JSON.stringify(env));\r\n        const cc = countryCode;\r\n        const value = env.lookup(`${propName}:${cc}`);\r\n        logger.log(\"Lookup POV: \", `${propName}:${cc}`, value);\r\n        if (typeof value === \"string\" && value.length > 0) {\r\n            logger.log(\"Found POV: \", `${propName}:${cc}`, value);\r\n            return value;\r\n        } else {\r\n            return undefined;\r\n        }\r\n    }\r\n\r\n    private isPoliticalViewLayer(layer: string): boolean {\r\n        return layer === \"boundaries\";\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport {\r\n    EarthConstants,\r\n    isVector3Like,\r\n    Vector2Like,\r\n    Vector3Like,\r\n    webMercatorProjection\r\n} from \"@here/harp-geoutils\";\r\nimport * as THREE from \"three\";\r\n\r\nimport { DecodeInfo } from \"./DecodeInfo\";\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function isArrayBufferLike(data: any): data is ArrayBufferLike {\r\n    if (typeof SharedArrayBuffer !== \"undefined\") {\r\n        return data instanceof ArrayBuffer || data instanceof SharedArrayBuffer;\r\n    } else {\r\n        return data instanceof ArrayBuffer;\r\n    }\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function lat2tile(lat: number, zoom: number): number {\r\n    return Math.round(\r\n        ((1 -\r\n            Math.log(Math.tan((lat * Math.PI) / 180) + 1 / Math.cos((lat * Math.PI) / 180)) /\r\n                Math.PI) /\r\n            2) *\r\n            Math.pow(2, zoom)\r\n    );\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function tile2lat(y: number, level: number): number {\r\n    const n = Math.PI - (2 * Math.PI * y) / Math.pow(2, level);\r\n    return (180 / Math.PI) * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)));\r\n}\r\n\r\nexport interface WorldTileProjectionCookie {\r\n    extents: number;\r\n    top: number;\r\n    left: number;\r\n    scale: number;\r\n}\r\n\r\nexport function createWorldTileTransformationCookie(extents: number, decodeInfo: DecodeInfo) {\r\n    const { north, west } = decodeInfo.geoBox;\r\n    const N = Math.log2(extents);\r\n    const scale = Math.pow(2, decodeInfo.tileKey.level + N);\r\n    return {\r\n        extents,\r\n        scale,\r\n        top: lat2tile(north, decodeInfo.tileKey.level + N),\r\n        left: Math.round(((west + 180) / 360) * scale)\r\n    };\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function tile2world<VectorType extends Vector3Like>(\r\n    extents: number,\r\n    decodeInfo: DecodeInfo,\r\n    position: Vector2Like,\r\n    flipY: boolean = false,\r\n    target: VectorType\r\n): VectorType {\r\n    if (\r\n        decodeInfo.worldTileProjectionCookie === undefined ||\r\n        decodeInfo.worldTileProjectionCookie.extents !== extents\r\n    ) {\r\n        decodeInfo.worldTileProjectionCookie = createWorldTileTransformationCookie(\r\n            extents,\r\n            decodeInfo\r\n        );\r\n    }\r\n\r\n    const { top, left, scale } = decodeInfo.worldTileProjectionCookie;\r\n    const R = EarthConstants.EQUATORIAL_CIRCUMFERENCE;\r\n\r\n    target.x = ((left + position.x) / scale) * R;\r\n    target.y = ((top + (flipY ? -position.y : position.y)) / scale) * R;\r\n    target.z = isVector3Like(position) ? position.z : 0;\r\n\r\n    return target;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function world2tile<VectorType extends Vector2Like>(\r\n    extents: number,\r\n    decodeInfo: DecodeInfo,\r\n    position: Vector3Like,\r\n    flipY: boolean = false,\r\n    target: VectorType\r\n): VectorType {\r\n    if (\r\n        decodeInfo.worldTileProjectionCookie === undefined ||\r\n        decodeInfo.worldTileProjectionCookie.extents !== extents\r\n    ) {\r\n        decodeInfo.worldTileProjectionCookie = createWorldTileTransformationCookie(\r\n            extents,\r\n            decodeInfo\r\n        );\r\n    }\r\n    const { top, left, scale } = decodeInfo.worldTileProjectionCookie;\r\n    const R = EarthConstants.EQUATORIAL_CIRCUMFERENCE;\r\n\r\n    target.x = Math.round((position.x / R) * scale - left);\r\n    target.y = Math.round((flipY ? -1 : 1) * ((position.y / R) * scale - top));\r\n    if (isVector3Like(target)) {\r\n        target.z = position.z;\r\n    }\r\n    return target;\r\n}\r\n\r\nexport function webMercatorTile2TargetWorld(\r\n    extents: number,\r\n    decodeInfo: DecodeInfo,\r\n    position: THREE.Vector2 | THREE.Vector3,\r\n    target: THREE.Vector3,\r\n    scaleHeight: boolean,\r\n    flipY: boolean = false\r\n) {\r\n    tile2world(extents, decodeInfo, position, flipY, target);\r\n    decodeInfo.targetProjection.reprojectPoint(webMercatorProjection, target, target);\r\n    if (position instanceof THREE.Vector3 && scaleHeight) {\r\n        target.z *= decodeInfo.targetProjection.getScaleFactor(target);\r\n    }\r\n}\r\n\r\nexport function webMercatorTile2TargetTile(\r\n    extents: number,\r\n    decodeInfo: DecodeInfo,\r\n    position: THREE.Vector2 | THREE.Vector3,\r\n    target: THREE.Vector3,\r\n    scaleHeight: boolean,\r\n    flipY: boolean = false\r\n) {\r\n    webMercatorTile2TargetWorld(extents, decodeInfo, position, target, scaleHeight, flipY);\r\n    target.sub(decodeInfo.center);\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { ClippedVertex } from \"@here/harp-geometry/lib/ClipPolygon\";\r\nimport { ShapeUtils, Vector2 } from \"three\";\r\n\r\n/**\r\n * A class representing a ring of a polygon geometry.\r\n */\r\nexport class Ring {\r\n    /**\r\n     * The signed area of this `Ring`.\r\n     *\r\n     * @remarks\r\n     * The sign of the area depends on the projection and the axis orientation\r\n     * of the ring coordinates.\r\n     * For example, given a ring with `CW winding`: `area > 0` with Y-axis that grows downwards and `area < 0` otherwise.\r\n     */\r\n    readonly area: number;\r\n\r\n    /**\r\n     * The winding of this `Ring`.\r\n     *\r\n     * @remarks\r\n     * Derived from the sign of the `area` of this Ring.\r\n     */\r\n    readonly winding: boolean;\r\n\r\n    /**\r\n     * The vertex stride.\r\n     */\r\n    readonly vertexStride: number;\r\n\r\n    /**\r\n     * Creates a new `Ring`.\r\n     *\r\n     * @param points The coordinates of the rings.\r\n     * @param textureCoords The optional `Array` of texture coordinates.\r\n     * @param extents The extents of the tile bounds.\r\n     * @param hasClipInfo A flag indicating that vertices of this `Ring` may be clipped.\r\n     */\r\n    constructor(\r\n        readonly points: Vector2[],\r\n        readonly textureCoords?: Vector2[],\r\n        readonly extents: number = 4 * 1024,\r\n        readonly hasClipInfo: boolean = false\r\n    ) {\r\n        if (textureCoords !== undefined && textureCoords.length !== points.length) {\r\n            throw new Error(\r\n                `the array of texture coordinates must have the same number of elements of the array of points`\r\n            );\r\n        }\r\n\r\n        this.vertexStride = 2;\r\n\r\n        if (textureCoords !== undefined) {\r\n            this.vertexStride = this.vertexStride + 2;\r\n        }\r\n\r\n        this.area = ShapeUtils.area(this.points);\r\n        this.winding = this.area < 0;\r\n    }\r\n\r\n    /**\r\n     * Returns a flattened `Array` containing the position and texture coordinates of this `Ring`.\r\n     *\r\n     * @param array The target `Array`.\r\n     * @param offset Optional offset into the array.\r\n     */\r\n    toArray(array: number[] = [], offset: number = 0): number[] {\r\n        this.points.forEach((p, i) => p.toArray(array, offset + this.vertexStride * i));\r\n        this.textureCoords?.forEach((p, i) => p.toArray(array, offset + this.vertexStride * i + 2));\r\n        return array;\r\n    }\r\n\r\n    /**\r\n     * Tests if the edge connecting the vertex at `index` with\r\n     * the vertex at `index+1` should be connected by a line\r\n     * when stroking the polygon.\r\n     *\r\n     * @param index The index of the first vertex of the outline edge.\r\n     */\r\n    isProperEdge(index: number): boolean {\r\n        const extents = this.extents;\r\n        const nextIdx = (index + 1) % this.points.length;\r\n        const curr: ClippedVertex = this.points[index];\r\n        const next: ClippedVertex = this.points[nextIdx];\r\n\r\n        if (this.hasClipInfo) {\r\n            if (curr.x !== next.x && curr.y !== next.y) {\r\n                // `curr` and `next` must be connected with a line\r\n                // because they don't form a vertical or horizontal lines.\r\n                return true;\r\n            }\r\n\r\n            const currAtEdge = curr.x % this.extents === 0 || curr.y % this.extents === 0;\r\n\r\n            if (!currAtEdge) {\r\n                // the points are connected with a line\r\n                // because at least one of the points is not on\r\n                // the tile boundary.\r\n                return true;\r\n            }\r\n\r\n            const nextAtEdge = next.x % this.extents === 0 || next.y % this.extents === 0;\r\n\r\n            if (!nextAtEdge) {\r\n                // the points are connected with a line\r\n                // because at least one of the points is not on\r\n                // the tile boundary.\r\n                return true;\r\n            }\r\n\r\n            const currWasClipped = curr.isClipped === true;\r\n            const nextWasClipped = next.isClipped === true;\r\n\r\n            return !currWasClipped && !nextWasClipped;\r\n        }\r\n\r\n        return !(\r\n            (curr.x <= 0 && next.x <= 0) ||\r\n            (curr.x >= extents && next.x >= extents) ||\r\n            (curr.y <= 0 && next.y <= 0) ||\r\n            (curr.y >= extents && next.y >= extents)\r\n        );\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { StyleSetEvaluator } from \"@here/harp-datasource-protocol/index-decoder\";\r\n\r\nimport { OmvFeatureFilter } from \"./OmvDataFilter\";\r\n\r\n/**\r\n * An [[OmvFeatureFilter]] implementation that queries [[StyleSetEvaluator]]\r\n * if given layers/features should be processed.\r\n *\r\n * Used in [[OmvDecoder]] to skip processing of layers/features that doesn't\r\n * have associated rules in style.\r\n *\r\n * @see [[StyleSetEvaluator.wantsFeature]]\r\n * @see [[StyleSetEvaluator.wantsLayer]]\r\n */\r\nexport class StyleSetDataFilter implements OmvFeatureFilter {\r\n    hasKindFilter: boolean = false;\r\n\r\n    constructor(readonly styleSetEvaluator: StyleSetEvaluator) {}\r\n\r\n    wantsLayer(layer: string, level: number): boolean {\r\n        return this.styleSetEvaluator.wantsLayer(layer);\r\n    }\r\n\r\n    wantsPointFeature(layer: string): boolean {\r\n        return this.styleSetEvaluator.wantsFeature(layer, \"point\");\r\n    }\r\n\r\n    wantsLineFeature(layer: string): boolean {\r\n        return this.styleSetEvaluator.wantsFeature(layer, \"line\");\r\n    }\r\n\r\n    wantsPolygonFeature(layer: string): boolean {\r\n        return this.styleSetEvaluator.wantsFeature(layer, \"polygon\");\r\n    }\r\n\r\n    wantsKind(): boolean {\r\n        return true;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport {\r\n    AttributeMap,\r\n    BufferAttribute,\r\n    composeTechniqueTextureName,\r\n    DecodedTile,\r\n    ExtrudedPolygonTechnique,\r\n    FillTechnique,\r\n    Geometry,\r\n    GeometryType,\r\n    getFeatureId,\r\n    getFeatureText,\r\n    Group,\r\n    IndexedTechnique,\r\n    InterleavedBufferAttribute,\r\n    isExtrudedLineTechnique,\r\n    isExtrudedPolygonTechnique,\r\n    isFillTechnique,\r\n    isLabelRejectionLineTechnique,\r\n    isLineMarkerTechnique,\r\n    isLineTechnique,\r\n    isPoiTechnique,\r\n    isShaderTechnique,\r\n    isSolidLineTechnique,\r\n    isSpecialDashesLineTechnique,\r\n    isStandardTechnique,\r\n    isTextTechnique,\r\n    LineMarkerTechnique,\r\n    PathGeometry,\r\n    PoiGeometry,\r\n    PoiTechnique,\r\n    scaleHeight,\r\n    StyleColor,\r\n    Technique,\r\n    TextGeometry,\r\n    TextPathGeometry,\r\n    TextTechnique,\r\n    TextureCoordinateType,\r\n    textureCoordinateType\r\n} from \"@here/harp-datasource-protocol\";\r\nimport {\r\n    Env,\r\n    IMeshBuffers,\r\n    StyleSetEvaluator,\r\n    Value\r\n} from \"@here/harp-datasource-protocol/index-decoder\";\r\nimport {\r\n    AttrEvaluationContext,\r\n    evaluateTechniqueAttr\r\n} from \"@here/harp-datasource-protocol/lib/TechniqueAttr\";\r\nimport { clipPolygon } from \"@here/harp-geometry/lib/ClipPolygon\";\r\nimport {\r\n    EdgeLengthGeometrySubdivisionModifier,\r\n    SubdivisionMode\r\n} from \"@here/harp-geometry/lib/EdgeLengthGeometrySubdivisionModifier\";\r\nimport { SphericalGeometrySubdivisionModifier } from \"@here/harp-geometry/lib/SphericalGeometrySubdivisionModifier\";\r\nimport {\r\n    GeoBox,\r\n    GeoCoordinates,\r\n    normalizedEquirectangularProjection,\r\n    ProjectionType,\r\n    Vector3Like,\r\n    webMercatorProjection\r\n} from \"@here/harp-geoutils\";\r\nimport { LineGroup } from \"@here/harp-lines/lib/Lines\";\r\nimport { triangulateLine } from \"@here/harp-lines/lib/TriangulateLines\";\r\nimport { ExtrusionFeatureDefs } from \"@here/harp-materials/lib/MapMeshMaterialsDefs\";\r\nimport { assert, getOptionValue, LoggerManager, Math2D } from \"@here/harp-utils\";\r\nimport earcut from \"earcut\";\r\nimport * as THREE from \"three\";\r\n\r\nimport { DecodeInfo } from \"./DecodeInfo\";\r\nimport { ILineGeometry, IPolygonGeometry } from \"./IGeometryProcessor\";\r\nimport {\r\n    tile2world,\r\n    webMercatorTile2TargetTile,\r\n    webMercatorTile2TargetWorld,\r\n    world2tile\r\n} from \"./OmvUtils\";\r\nimport { Ring } from \"./Ring\";\r\n\r\nconst logger = LoggerManager.instance.create(\"OmvDecodedTileEmitter\");\r\n\r\nconst tempTileOrigin = new THREE.Vector3();\r\nconst tempVertNormal = new THREE.Vector3();\r\nconst tempFootDisp = new THREE.Vector3();\r\nconst tempRoofDisp = new THREE.Vector3();\r\n\r\nconst tmpV2 = new THREE.Vector2();\r\nconst tmpV2r = new THREE.Vector2();\r\nconst tmpV3 = new THREE.Vector3();\r\nconst tmpV3r = new THREE.Vector3();\r\nconst tmpV4 = new THREE.Vector3();\r\n\r\nconst tempP0 = new THREE.Vector2();\r\nconst tempP1 = new THREE.Vector2();\r\nconst tempPreviousTangent = new THREE.Vector2();\r\n\r\nconst tmpPointA = new THREE.Vector3();\r\nconst tmpPointB = new THREE.Vector3();\r\nconst tmpPointC = new THREE.Vector3();\r\nconst tmpPointD = new THREE.Vector3();\r\nconst tmpPointE = new THREE.Vector3();\r\nconst tmpLine = new THREE.Line3();\r\n\r\n/**\r\n * Minimum number of pixels per character. Used during estimation if there is enough screen space\r\n * available to render a text. Based on the estimated screen size of a tile.\r\n */\r\nconst MIN_AVERAGE_CHAR_WIDTH = 5;\r\n\r\n/**\r\n * Estimation \"fudge factor\", tweaking the size estimation to\r\n *\r\n * a) allow room for zooming in to the tile, and\r\n *\r\n * b) allow for some tilting, where the edge of a tile closer to the camera has more space.\r\n *\r\n * Useful values are between 0 (allow all labels), 0.5 (allow labels at twice the default display\r\n * size of the tile) and 1.0 (skip labels that would normally not be displayed at default tile\r\n * size).\r\n */\r\nconst SIZE_ESTIMATION_FACTOR = 0.5;\r\n\r\n/**\r\n * Maximum allowed corner angle inside a label path.\r\n */\r\nconst MAX_CORNER_ANGLE = Math.PI / 8;\r\n\r\n/**\r\n * Used to identify an invalid (or better: unused) array index.\r\n */\r\nconst INVALID_ARRAY_INDEX = -1;\r\n\r\nfunction createIndexBufferAttribute(\r\n    elements: ArrayLike<number>,\r\n    maxValue: number,\r\n    name: string = \"index\"\r\n): BufferAttribute {\r\n    const type = maxValue > 65535 ? \"uint32\" : \"uint16\";\r\n    const storage = type === \"uint32\" ? new Uint32Array(elements) : new Uint16Array(elements);\r\n    const buffer = storage.buffer;\r\n    return {\r\n        itemCount: 1,\r\n        name,\r\n        buffer,\r\n        type\r\n    };\r\n}\r\n\r\ninterface LinesGeometry {\r\n    type: GeometryType;\r\n    lines: LineGroup;\r\n    technique: number;\r\n\r\n    /**\r\n     * Optional array of objects. It can be used to pass user data from the geometry to the mesh.\r\n     */\r\n    objInfos?: AttributeMap[];\r\n\r\n    /**\r\n     * Optional list of feature start indices. The indices point into the index attribute.\r\n     */\r\n    featureStarts?: number[];\r\n}\r\n\r\n// for tilezen by default extrude all buildings even those without height data\r\nclass MeshBuffers implements IMeshBuffers {\r\n    readonly positions: number[] = [];\r\n    readonly normals: number[] = [];\r\n    readonly textureCoordinates: number[] = [];\r\n    readonly colors: number[] = [];\r\n    readonly extrusionAxis: number[] = [];\r\n    readonly indices: number[] = [];\r\n    readonly edgeIndices: number[] = [];\r\n    readonly groups: Group[] = [];\r\n    readonly texts: number[] = [];\r\n    readonly pathLengths: number[] = [];\r\n    readonly stringCatalog: Array<string | undefined> = [];\r\n    readonly imageTextures: number[] = [];\r\n\r\n    /**\r\n     * Optional list of feature start indices. The indices point into the index attribute.\r\n     */\r\n    readonly featureStarts: number[] = [];\r\n\r\n    /**\r\n     * Optional list of edge feature start indices. The indices point into the edge index attribute.\r\n     */\r\n    readonly edgeFeatureStarts: number[] = [];\r\n\r\n    /**\r\n     * An optional list of additional data that can be used as additional data for the object\r\n     * picking.\r\n     */\r\n    readonly objInfos: AttributeMap[] = [];\r\n\r\n    /**\r\n     * Angle in degrees from north clockwise which represents the direction the icons can be\r\n     * shifted.\r\n     */\r\n    readonly offsetDirections: number[] = [];\r\n\r\n    constructor(readonly type: GeometryType) {}\r\n\r\n    addText(text: string) {\r\n        let index = this.stringCatalog.indexOf(text);\r\n\r\n        if (index < 0) {\r\n            index = this.stringCatalog.length;\r\n            this.stringCatalog.push(text);\r\n        }\r\n        return index;\r\n    }\r\n}\r\n\r\nenum LineType {\r\n    Simple,\r\n    Complex\r\n}\r\n\r\ntype TexCoordsFunction = (tilePos: THREE.Vector2, tileExtents: number) => THREE.Vector2;\r\nconst tmpColor = new THREE.Color();\r\n\r\n/**\r\n * Options for VectorTileDataEmitter, see {@link DecoderOptions} and {@link OmvDecoderOptions}.\r\n * @internal\r\n */\r\nexport interface VectorTileDataEmitterOptions {\r\n    gatherFeatureAttributes?: boolean;\r\n    skipShortLabels?: boolean;\r\n    enableElevationOverlay?: boolean;\r\n    languages?: string[];\r\n}\r\n\r\nexport class VectorTileDataEmitter {\r\n    // mapping from style index to mesh buffers\r\n    private readonly m_meshBuffers = new Map<number, MeshBuffers>();\r\n\r\n    private readonly m_geometries: Geometry[] = [];\r\n    private readonly m_textGeometries: TextGeometry[] = [];\r\n    private readonly m_textPathGeometries: TextPathGeometry[] = [];\r\n    private readonly m_pathGeometries: PathGeometry[] = [];\r\n    private readonly m_poiGeometries: PoiGeometry[] = [];\r\n    private readonly m_simpleLines: LinesGeometry[] = [];\r\n    private readonly m_solidLines: LinesGeometry[] = [];\r\n\r\n    private readonly m_sources: string[] = [];\r\n    private m_maxGeometryHeight: number = 0;\r\n    private m_minGeometryHeight: number = 0;\r\n\r\n    constructor(\r\n        private readonly m_decodeInfo: DecodeInfo,\r\n        private readonly m_styleSetEvaluator: StyleSetEvaluator,\r\n        private readonly m_options: VectorTileDataEmitterOptions = {}\r\n    ) {\r\n        this.m_options.gatherFeatureAttributes = m_options.gatherFeatureAttributes ?? false;\r\n        this.m_options.skipShortLabels = m_options.skipShortLabels ?? true;\r\n        this.m_options.enableElevationOverlay = m_options.enableElevationOverlay ?? false;\r\n    }\r\n\r\n    get projection() {\r\n        return this.m_decodeInfo.targetProjection;\r\n    }\r\n\r\n    get center() {\r\n        return this.m_decodeInfo.center;\r\n    }\r\n\r\n    /**\r\n     * Creates the Point of Interest geometries for the given feature.\r\n     *\r\n     * @param layer - Tile's layer to be processed.\r\n     * @param extents - Tile's layer extents.\r\n     * @param geometry - The feature geometry in local webMercator coordinates.\r\n     * @param env - The [[MapEnv]] containing the environment information for the map.\r\n     * @param techniques - The array of [[Technique]] that will be applied to the geometry.\r\n     */\r\n    processPointFeature(\r\n        layer: string,\r\n        extents: number,\r\n        geometry: THREE.Vector3[],\r\n        context: AttrEvaluationContext,\r\n        techniques: IndexedTechnique[]\r\n    ): void {\r\n        const env = context.env;\r\n        this.processFeatureCommon(env);\r\n\r\n        const { tileKey, columnCount, rowCount } = this.m_decodeInfo;\r\n\r\n        // adjust the extents to ensure that points on the right and bottom edges\r\n        // of the tile are discarded.\r\n        const xExtent = tileKey.column + 1 < columnCount ? extents - 1 : extents;\r\n        const yExtent = tileKey.row + 1 < rowCount ? extents - 1 : extents;\r\n\r\n        // get the point positions (in tile space) that are inside the tile bounds.\r\n        const tilePositions = geometry.filter(p => {\r\n            return p.x >= 0 && p.x <= xExtent && p.y >= 0 && p.y <= yExtent;\r\n        });\r\n\r\n        if (tilePositions.length === 0) {\r\n            // nothing to do, no geometry within the tile bound.\r\n            return;\r\n        }\r\n\r\n        for (const technique of techniques) {\r\n            if (technique === undefined) {\r\n                continue;\r\n            }\r\n\r\n            const techniqueIndex = technique._index;\r\n            const meshBuffers = this.findOrCreateMeshBuffers(techniqueIndex, GeometryType.Point);\r\n\r\n            if (meshBuffers === undefined) {\r\n                continue;\r\n            }\r\n\r\n            const { positions, texts, imageTextures, objInfos, offsetDirections } = meshBuffers;\r\n\r\n            const shouldCreateTextGeometries =\r\n                isTextTechnique(technique) || isPoiTechnique(technique);\r\n\r\n            let imageTexture: string | undefined;\r\n            const wantsPoi = isPoiTechnique(technique);\r\n\r\n            if (wantsPoi) {\r\n                const poiTechnique = technique as PoiTechnique;\r\n                imageTexture = evaluateTechniqueAttr(context, poiTechnique.imageTexture);\r\n\r\n                // TODO: Move to decoder independent parts of code.\r\n                if (poiTechnique.poiName !== undefined) {\r\n                    imageTexture = evaluateTechniqueAttr(context, poiTechnique.poiName);\r\n                } else if (typeof poiTechnique.poiNameField === \"string\") {\r\n                    const poiNameFieldValue = env.lookup(poiTechnique.poiNameField) as string;\r\n                    imageTexture = poiNameFieldValue;\r\n                } else if (typeof poiTechnique.imageTextureField === \"string\") {\r\n                    const imageTextureValue = env.lookup(poiTechnique.imageTextureField) as string;\r\n                    imageTexture = composeTechniqueTextureName(imageTextureValue, poiTechnique);\r\n                }\r\n            }\r\n\r\n            const scaleHeights = scaleHeight(context, technique, this.m_decodeInfo.tileKey.level);\r\n            const featureId = getFeatureId(env.entries);\r\n            for (const pos of tilePositions) {\r\n                if (shouldCreateTextGeometries) {\r\n                    const textTechnique = technique as TextTechnique;\r\n                    const text = getFeatureText(context, textTechnique, this.m_options.languages);\r\n\r\n                    if (text !== undefined && text.length > 0) {\r\n                        texts.push(meshBuffers.addText(text));\r\n                    } else {\r\n                        texts.push(INVALID_ARRAY_INDEX);\r\n                    }\r\n                }\r\n\r\n                // Always store the position, otherwise the following POIs will be\r\n                // misplaced.\r\n                if (shouldCreateTextGeometries) {\r\n                    webMercatorTile2TargetWorld(\r\n                        extents,\r\n                        this.m_decodeInfo,\r\n                        pos,\r\n                        tmpV3,\r\n                        scaleHeights\r\n                    );\r\n                } else {\r\n                    webMercatorTile2TargetTile(\r\n                        extents,\r\n                        this.m_decodeInfo,\r\n                        pos,\r\n                        tmpV3,\r\n                        scaleHeights\r\n                    );\r\n                }\r\n\r\n                // For planar projection the world z coordinate (potentially scaled) is taken,\r\n                // for spherical projection the z coordinate in the source projection (no scaling needed) is taken:\r\n                const height = this.projection.type === ProjectionType.Planar ? tmpV3.z : pos.z;\r\n                if (height > this.m_maxGeometryHeight) {\r\n                    this.m_maxGeometryHeight = height;\r\n                } else if (height < this.m_minGeometryHeight) {\r\n                    this.m_minGeometryHeight = height;\r\n                }\r\n\r\n                positions.push(tmpV3.x, tmpV3.y, tmpV3.z);\r\n                objInfos.push(this.m_options.gatherFeatureAttributes ? env.entries : featureId);\r\n                offsetDirections.push((env.lookup(\"offset_direction\") as number) ?? 0);\r\n\r\n                if (wantsPoi) {\r\n                    if (imageTexture === undefined) {\r\n                        imageTextures.push(INVALID_ARRAY_INDEX);\r\n                    } else {\r\n                        imageTextures.push(meshBuffers.addText(imageTexture));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * Creates the line geometries for the given feature.\r\n     *\r\n     * @param layer - Tile's layer to be processed.\r\n     * @param extents - Tile's layer extents.\r\n     * @param geometry - The current feature containing the main geometry.\r\n     * @param env - The [[MapEnv]] containing the environment information for the map.\r\n     * @param techniques - The array of [[Technique]] that will be applied to the geometry.\r\n     */\r\n    processLineFeature(\r\n        layer: string,\r\n        extents: number,\r\n        geometry: ILineGeometry[],\r\n        context: AttrEvaluationContext,\r\n        techniques: IndexedTechnique[]\r\n    ): void {\r\n        const env = context.env;\r\n        this.processFeatureCommon(env);\r\n\r\n        const localLines: number[][] = []; // lines in target tile space.\r\n        const worldLines: number[][] = []; // lines in world space.\r\n        const uvs: number[][] = [];\r\n        const offsets: number[][] = [];\r\n        const projectedBoundingBox = this.m_decodeInfo.projectedBoundingBox;\r\n\r\n        let localLineSegments: number[][]; // lines in target tile space for special dashes.\r\n\r\n        const tileWidth = projectedBoundingBox.extents.x * 2;\r\n        const tileHeight = projectedBoundingBox.extents.y * 2;\r\n        const tileSizeWorld = Math.max(tileWidth, tileHeight);\r\n\r\n        let computeTexCoords: TexCoordsFunction | undefined;\r\n        let texCoordinateType: TextureCoordinateType | undefined;\r\n\r\n        const hasUntiledLines = geometry[0].untiledPositions !== undefined;\r\n        const scaleHeights = false; // No need to scale height, source data is 2D.\r\n\r\n        // If true, special handling for dashes is required (round and diamond shaped dashes).\r\n        let hasIndividualLineSegments = false;\r\n        let hasContinuousLineSegments = false;\r\n\r\n        // Check if any of the techniques needs texture coordinates\r\n        for (const technique of techniques) {\r\n            if (technique === undefined) {\r\n                continue;\r\n            }\r\n            if (!computeTexCoords) {\r\n                computeTexCoords = this.getComputeTexCoordsFunc(technique);\r\n                texCoordinateType = this.getTextureCoordinateType(technique);\r\n            } else {\r\n                // Support generation of only one type of texture coordinates.\r\n                const otherTexCoordType = this.getTextureCoordinateType(technique);\r\n                assert(otherTexCoordType === undefined || texCoordinateType === otherTexCoordType);\r\n            }\r\n\r\n            hasIndividualLineSegments =\r\n                hasIndividualLineSegments || isSpecialDashesLineTechnique(technique);\r\n\r\n            hasContinuousLineSegments = hasContinuousLineSegments || !hasIndividualLineSegments;\r\n        }\r\n\r\n        for (const polyline of geometry) {\r\n            // Compute the world position of the untiled line and its distance to the origin of the\r\n            // line to properly join lines.\r\n            const untiledLine: number[] = [];\r\n            let lineDist = 0;\r\n            if (hasUntiledLines) {\r\n                this.m_decodeInfo.targetProjection.projectPoint(\r\n                    polyline.untiledPositions![0],\r\n                    tmpV3r\r\n                );\r\n                polyline.untiledPositions!.forEach(pos => {\r\n                    // Calculate the distance to the next un-normalized point.\r\n                    this.m_decodeInfo.targetProjection.projectPoint(pos, tmpV3);\r\n                    lineDist += tmpV3.distanceTo(tmpV3r);\r\n                    tmpV3r.copy(tmpV3);\r\n\r\n                    // Pushed the normalized point for line matching.\r\n                    this.m_decodeInfo.targetProjection.projectPoint(pos.normalized(), tmpV3);\r\n                    untiledLine.push(tmpV3.x, tmpV3.y, tmpV3.z, lineDist);\r\n                });\r\n            }\r\n\r\n            // Add continuous line as individual segments to improve special dashes by overlapping\r\n            // their connecting vertices. The technique/style should defined round or rectangular\r\n            // caps.\r\n            if (hasIndividualLineSegments) {\r\n                localLineSegments = [];\r\n\r\n                // Compute length of whole line and offsets of individual segments.\r\n                let lineLength = 0;\r\n                const pointCount = polyline.positions.length;\r\n                if (pointCount > 1) {\r\n                    let lastSegmentOffset = 0;\r\n\r\n                    for (let i = 0; i < pointCount - 1; i++) {\r\n                        const localLine: number[] = [];\r\n                        const worldLine: number[] = [];\r\n                        const lineUvs: number[] = [];\r\n                        const segmentOffsets: number[] = [];\r\n\r\n                        const pos1 = polyline.positions[i];\r\n                        const pos2 = polyline.positions[i + 1];\r\n                        webMercatorTile2TargetWorld(\r\n                            extents,\r\n                            this.m_decodeInfo,\r\n                            pos1,\r\n                            tmpV3,\r\n                            scaleHeights\r\n                        );\r\n                        worldLine.push(tmpV3.x, tmpV3.y, tmpV3.z);\r\n                        webMercatorTile2TargetWorld(\r\n                            extents,\r\n                            this.m_decodeInfo,\r\n                            pos2,\r\n                            tmpV4,\r\n                            scaleHeights\r\n                        );\r\n                        worldLine.push(tmpV4.x, tmpV4.y, tmpV4.z);\r\n\r\n                        if (computeTexCoords) {\r\n                            computeTexCoords(pos1, extents).toArray(lineUvs, lineUvs.length);\r\n                            computeTexCoords(pos2, extents).toArray(lineUvs, lineUvs.length);\r\n                        }\r\n                        if (hasUntiledLines) {\r\n                            // Find where in the [0...1] range relative to the line our current\r\n                            // vertex lies.\r\n                            let offset =\r\n                                this.findRelativePositionInLine(tmpV3, untiledLine) / lineDist;\r\n                            segmentOffsets.push(offset);\r\n                            offset = this.findRelativePositionInLine(tmpV4, untiledLine) / lineDist;\r\n                            segmentOffsets.push(offset);\r\n                        } else {\r\n                            segmentOffsets.push(lastSegmentOffset);\r\n\r\n                            // Compute length of segment and whole line to scale down later.\r\n                            const segmentLength = tmpV3.distanceTo(tmpV4);\r\n                            lineLength += segmentLength;\r\n                            lastSegmentOffset += segmentLength;\r\n                            segmentOffsets.push(lastSegmentOffset);\r\n                        }\r\n\r\n                        tmpV3.sub(this.m_decodeInfo.center);\r\n                        localLine.push(tmpV3.x, tmpV3.y, tmpV3.z);\r\n                        tmpV4.sub(this.m_decodeInfo.center);\r\n                        localLine.push(tmpV4.x, tmpV4.y, tmpV4.z);\r\n\r\n                        localLineSegments!.push(localLine);\r\n                        worldLines.push(worldLine);\r\n                        uvs.push(lineUvs);\r\n                        offsets.push(segmentOffsets);\r\n                    }\r\n                }\r\n\r\n                if (!hasUntiledLines && lineLength > 0) {\r\n                    // Scale down each individual segment to range [0..1] for whole line.\r\n                    for (const segOffsets of offsets) {\r\n                        segOffsets.forEach((offs, index) => {\r\n                            segOffsets[index] = offs / lineLength;\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Add continuous lines\r\n            if (hasContinuousLineSegments) {\r\n                const localLine: number[] = [];\r\n                const worldLine: number[] = [];\r\n                const lineUvs: number[] = [];\r\n                const lineOffsets: number[] = [];\r\n                polyline.positions.forEach(pos => {\r\n                    webMercatorTile2TargetWorld(\r\n                        extents,\r\n                        this.m_decodeInfo,\r\n                        pos,\r\n                        tmpV3,\r\n                        scaleHeights\r\n                    );\r\n                    worldLine.push(tmpV3.x, tmpV3.y, tmpV3.z);\r\n\r\n                    if (computeTexCoords) {\r\n                        computeTexCoords(pos, extents).toArray(lineUvs, lineUvs.length);\r\n                    }\r\n                    if (hasUntiledLines) {\r\n                        // Find where in the [0...1] range relative to the line our current vertex\r\n                        // lines.\r\n                        const offset =\r\n                            this.findRelativePositionInLine(tmpV3, untiledLine) / lineDist;\r\n                        lineOffsets.push(offset);\r\n                    }\r\n                    tmpV3.sub(this.m_decodeInfo.center);\r\n                    localLine.push(tmpV3.x, tmpV3.y, tmpV3.z);\r\n                });\r\n                localLines.push(localLine);\r\n                worldLines.push(worldLine);\r\n                uvs.push(lineUvs);\r\n                offsets.push(lineOffsets);\r\n            }\r\n        }\r\n\r\n        const wantCircle = this.m_decodeInfo.tileKey.level >= 11;\r\n\r\n        for (const technique of techniques) {\r\n            if (technique === undefined) {\r\n                continue;\r\n            }\r\n            const techniqueIndex = technique._index;\r\n            const techniqueName = technique.name;\r\n\r\n            if (isLineTechnique(technique) || isSolidLineTechnique(technique)) {\r\n                const lineGeometry = isLineTechnique(technique)\r\n                    ? this.m_simpleLines\r\n                    : this.m_solidLines;\r\n\r\n                const lineType = isLineTechnique(technique) ? LineType.Simple : LineType.Complex;\r\n\r\n                if (hasIndividualLineSegments) {\r\n                    assert(\r\n                        localLineSegments! !== undefined,\r\n                        \"OmvDecodedTileEmitter#processLineFeature: \" +\r\n                            \"Internal error - No localLineSegments\"\r\n                    );\r\n\r\n                    this.applyLineTechnique(\r\n                        lineGeometry,\r\n                        technique,\r\n                        techniqueIndex,\r\n                        lineType,\r\n                        env.entries,\r\n                        localLineSegments!,\r\n                        context,\r\n                        this.getTextureCoordinateType(technique) ? uvs : undefined,\r\n                        offsets\r\n                    );\r\n                }\r\n                if (localLines.length > 0) {\r\n                    this.applyLineTechnique(\r\n                        lineGeometry,\r\n                        technique,\r\n                        techniqueIndex,\r\n                        lineType,\r\n                        env.entries,\r\n                        localLines,\r\n                        context,\r\n                        this.getTextureCoordinateType(technique) ? uvs : undefined,\r\n                        hasUntiledLines ? offsets : undefined\r\n                    );\r\n                }\r\n            } else if (\r\n                isTextTechnique(technique) ||\r\n                isPoiTechnique(technique) ||\r\n                isLineMarkerTechnique(technique)\r\n            ) {\r\n                const textTechnique = technique as TextTechnique;\r\n                const text = getFeatureText(context, textTechnique, this.m_options.languages);\r\n\r\n                if (text === undefined || text.length === 0) {\r\n                    continue;\r\n                }\r\n                let validLines: number[][] = [];\r\n\r\n                if (this.m_options.skipShortLabels) {\r\n                    // Filter the lines, keep only those that are long enough for labelling. Also,\r\n                    // split jagged label paths to keep processing and rendering only those that\r\n                    // have no sharp corners, which would not be rendered anyway.\r\n\r\n                    const worldUnitsPerPixel = tileSizeWorld / this.m_decodeInfo.tileSizeOnScreen;\r\n                    const minEstimatedLabelLength =\r\n                        MIN_AVERAGE_CHAR_WIDTH *\r\n                        text.length *\r\n                        worldUnitsPerPixel *\r\n                        SIZE_ESTIMATION_FACTOR;\r\n                    const minEstimatedLabelLengthSqr =\r\n                        minEstimatedLabelLength * minEstimatedLabelLength;\r\n\r\n                    validLines = this.splitJaggyLines(\r\n                        worldLines,\r\n                        minEstimatedLabelLengthSqr,\r\n                        MAX_CORNER_ANGLE\r\n                    );\r\n                } else {\r\n                    validLines = worldLines;\r\n                }\r\n\r\n                if (validLines.length === 0) {\r\n                    continue;\r\n                }\r\n\r\n                if (isTextTechnique(technique)) {\r\n                    if (text === undefined) {\r\n                        continue;\r\n                    }\r\n                    for (const path of validLines) {\r\n                        const pathLengthSqr = Math2D.computeSquaredLineLength(path);\r\n                        this.m_textPathGeometries.push({\r\n                            technique: techniqueIndex,\r\n                            path,\r\n                            pathLengthSqr,\r\n                            text: String(text),\r\n                            objInfos: this.m_options.gatherFeatureAttributes\r\n                                ? env.entries\r\n                                : getFeatureId(env.entries)\r\n                        });\r\n                    }\r\n                } else {\r\n                    const lineMarkerTechnique = technique as LineMarkerTechnique;\r\n\r\n                    let imageTexture = evaluateTechniqueAttr(\r\n                        context,\r\n                        lineMarkerTechnique.imageTexture\r\n                    );\r\n\r\n                    // TODO: `imageTextureField` and `imageTexturePrefix` and `imageTexturePostfix`\r\n                    // are now deprecated\r\n\r\n                    // TODO: Move to decoder independent parts of code.\r\n                    if (typeof lineMarkerTechnique.imageTextureField === \"string\") {\r\n                        const imageTextureValue = env.lookup(lineMarkerTechnique.imageTextureField);\r\n                        imageTexture = imageTextureValue as string;\r\n                        if (typeof lineMarkerTechnique.imageTexturePrefix === \"string\") {\r\n                            imageTexture = lineMarkerTechnique.imageTexturePrefix + imageTexture;\r\n                        }\r\n                        if (typeof lineMarkerTechnique.imageTexturePostfix === \"string\") {\r\n                            imageTexture = imageTexture + lineMarkerTechnique.imageTexturePostfix;\r\n                        }\r\n                    }\r\n\r\n                    for (const aLine of validLines) {\r\n                        this.m_poiGeometries.push({\r\n                            technique: techniqueIndex,\r\n                            positions: {\r\n                                name: \"position\",\r\n                                type: \"float\",\r\n                                buffer: new Float64Array(aLine).buffer,\r\n                                itemCount: 3\r\n                            },\r\n                            texts: [0],\r\n                            stringCatalog: [text, imageTexture],\r\n                            imageTextures: [1],\r\n                            objInfos: this.m_options.gatherFeatureAttributes\r\n                                ? [env.entries]\r\n                                : [getFeatureId(env.entries)]\r\n                        });\r\n                    }\r\n                }\r\n            } else if (isLabelRejectionLineTechnique(technique)) {\r\n                for (const path of worldLines) {\r\n                    const worldPath: Vector3Like[] = [];\r\n                    for (let i = 0; i < path.length; i += 3) {\r\n                        worldPath.push(new THREE.Vector3().fromArray(path, i) as Vector3Like);\r\n                    }\r\n                    this.m_pathGeometries.push({\r\n                        path: worldPath\r\n                    });\r\n                }\r\n            } else if (isExtrudedLineTechnique(technique)) {\r\n                const meshBuffers = this.findOrCreateMeshBuffers(\r\n                    techniqueIndex,\r\n                    GeometryType.ExtrudedLine\r\n                );\r\n                if (meshBuffers === undefined) {\r\n                    continue;\r\n                }\r\n                const { positions, indices, groups, featureStarts, objInfos } = meshBuffers;\r\n                const start = indices.length;\r\n\r\n                const lineWidth = evaluateTechniqueAttr<number>(context, technique.lineWidth);\r\n\r\n                if (lineWidth === undefined) {\r\n                    continue;\r\n                }\r\n\r\n                const techniqueCaps = evaluateTechniqueAttr<string>(\r\n                    context,\r\n                    technique.caps,\r\n                    \"Circle\"\r\n                );\r\n\r\n                const addCircle = wantCircle && techniqueCaps === \"Circle\";\r\n\r\n                localLines.forEach(aLine => {\r\n                    triangulateLine(aLine, lineWidth, positions, indices, addCircle);\r\n                    featureStarts.push(start);\r\n                    objInfos.push(\r\n                        this.m_options.gatherFeatureAttributes\r\n                            ? env.entries\r\n                            : getFeatureId(env.entries)\r\n                    );\r\n                });\r\n\r\n                const count = indices.length - start;\r\n                groups.push({ start, count, technique: techniqueIndex });\r\n            } else {\r\n                logger.warn(\r\n                    `OmvDecodedTileEmitter#processLineFeature: Invalid line technique\r\n                     ${techniqueName} for layer: ${env.entries.$layer} `\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates the polygons geometries for the given feature.\r\n     *\r\n     * @param layer - Tile's layer to be processed.\r\n     * @param extents - Tile's layer extents.\r\n     * @param geometry - The current feature containing the main geometry.\r\n     * @param feature - The [[MapEnv]] containing the environment information for the map.\r\n     * @param techniques - The array of [[Technique]] that will be applied to the geometry.\r\n     */\r\n    processPolygonFeature(\r\n        layer: string,\r\n        extents: number,\r\n        geometry: IPolygonGeometry[],\r\n        context: AttrEvaluationContext,\r\n        techniques: IndexedTechnique[]\r\n    ): void {\r\n        const env = context.env;\r\n        this.processFeatureCommon(env);\r\n\r\n        const scaleHeights = false; // No need to scale height, source data is 2D.\r\n\r\n        techniques.forEach(technique => {\r\n            if (technique === undefined) {\r\n                return;\r\n            }\r\n\r\n            const techniqueIndex = technique._index;\r\n\r\n            if (techniqueIndex === undefined) {\r\n                throw new Error(\r\n                    \"OmvDecodedTileEmitter#processPolygonFeature: \" +\r\n                        \"Internal error - No technique index\"\r\n                );\r\n            }\r\n\r\n            let objectBounds: THREE.Box3 | undefined;\r\n\r\n            const bbox = env.lookup(\"bbox\");\r\n            if (Array.isArray(bbox)) {\r\n                const [west, south, east, north] = bbox;\r\n                const geoBox = new GeoBox(\r\n                    new GeoCoordinates(south, west),\r\n                    new GeoCoordinates(north, east)\r\n                );\r\n                objectBounds = new THREE.Box3();\r\n                webMercatorProjection.projectBox(geoBox, objectBounds);\r\n            }\r\n\r\n            const polygons: Ring[][] = [];\r\n\r\n            const isExtruded = isExtrudedPolygonTechnique(technique);\r\n            const isFilled = isFillTechnique(technique);\r\n            const isStandard = isStandardTechnique(technique);\r\n\r\n            const isPolygon =\r\n                isExtruded ||\r\n                isFilled ||\r\n                isStandard ||\r\n                (isShaderTechnique(technique) && technique.primitive === \"mesh\");\r\n\r\n            const computeTexCoords = this.getComputeTexCoordsFunc(technique, objectBounds);\r\n\r\n            const shouldClipPolygons = isPolygon && !isExtruded;\r\n\r\n            for (const polygon of geometry) {\r\n                const rings: Ring[] = [];\r\n                for (let i = 0; i < polygon.rings.length; i++) {\r\n                    const isExterior = i === 0;\r\n                    let ringCoords: THREE.Vector2[] = polygon.rings[i];\r\n\r\n                    // Disable clipping for the polygon geometries\r\n                    // rendered using the extruded-polygon technique.\r\n                    // We can't clip these polygons for now because\r\n                    // otherwise we could break the current assumptions\r\n                    // used to add oultines around the extruded geometries.\r\n                    if (shouldClipPolygons) {\r\n                        // Quick test to avoid clipping if all the coords\r\n                        // of the current polygon are inside the tile bounds.\r\n                        const hasCoordsOutsideTileBounds = ringCoords.some(\r\n                            p => p.x < 0 || p.x > extents || p.y < 0 || p.y > extents\r\n                        );\r\n                        if (hasCoordsOutsideTileBounds) {\r\n                            ringCoords = clipPolygon(ringCoords, extents);\r\n                        }\r\n                    }\r\n\r\n                    const area = THREE.ShapeUtils.area(ringCoords);\r\n\r\n                    // According to MVT spec, the rings defining a polygon follow this layout:\r\n                    // [[ext-ring], seq([int-ring])]\r\n                    //\r\n                    // For example:\r\n                    // ┌───────ext1───────┐\r\n                    // │                  │\r\n                    // │  ┌────hole────┐  │\r\n                    // │  │            │  │\r\n                    // │  │            │  │    w:CW     w:CCW\r\n                    // │  │            │  │   [[ext1], [hole]]\r\n                    // │  │            │  │\r\n                    // │  │            │  │\r\n                    // │  │            │  │\r\n                    // │  └──────>─────┘  │\r\n                    // │                  │\r\n                    // └─────────<────────┘\r\n                    // So, if one exterior ring get clipped to a zero-area polygon we\r\n                    // can imply that all the inner rings collapsed as well.\r\n                    // As per spec, all the inner rings must enclosed within the exterior ring.\r\n                    // Using this assumption, we can skip the whole polygon.\r\n                    if (isExterior && area === 0) {\r\n                        break;\r\n                    }\r\n\r\n                    // For holes, push the current ring only if it has a non-zero area\r\n                    if (area !== 0) {\r\n                        let textureCoords: THREE.Vector2[] | undefined;\r\n\r\n                        if (computeTexCoords !== undefined) {\r\n                            textureCoords = ringCoords.map(coord =>\r\n                                computeTexCoords(coord, extents)\r\n                            );\r\n                        }\r\n\r\n                        rings.push(\r\n                            new Ring(ringCoords, textureCoords, extents, shouldClipPolygons)\r\n                        );\r\n                    }\r\n                }\r\n\r\n                if (rings.length > 0) {\r\n                    polygons.push(rings);\r\n                }\r\n            }\r\n\r\n            const isLine = isSolidLineTechnique(technique) || isLineTechnique(technique);\r\n            if (isPolygon) {\r\n                this.applyPolygonTechnique(polygons, technique, techniqueIndex, context, extents);\r\n            } else if (isLine) {\r\n                const lineGeometry =\r\n                    technique.name === \"line\" ? this.m_simpleLines : this.m_solidLines;\r\n\r\n                const lineType = technique.name === \"line\" ? LineType.Simple : LineType.Complex;\r\n\r\n                // Use individual line segments instead of a continuous line in special cases (round\r\n                // and diamond shaped dashes).\r\n                const needIndividualLineSegments = isSpecialDashesLineTechnique(technique);\r\n\r\n                polygons.forEach(rings => {\r\n                    const lines: number[][] = [];\r\n                    const offsets: number[][] | undefined = needIndividualLineSegments\r\n                        ? []\r\n                        : undefined;\r\n                    rings.forEach(ring => {\r\n                        const length = ring.points.length;\r\n                        let line: number[] = [];\r\n\r\n                        // Compute length of whole line and offsets of individual segments.\r\n                        let ringLength = 0;\r\n                        let lastSegmentOffset = 0;\r\n                        let segmentOffsets: number[] | undefined = needIndividualLineSegments\r\n                            ? []\r\n                            : undefined;\r\n\r\n                        for (let i = 0; i < length; ++i) {\r\n                            if (needIndividualLineSegments && line.length > 0) {\r\n                                // Allocate a line for every segment.\r\n                                line = [];\r\n                                segmentOffsets = [];\r\n                            }\r\n\r\n                            const nextIdx = (i + 1) % length;\r\n                            const curr = ring.points[i];\r\n                            const next = ring.points[nextIdx];\r\n\r\n                            const properEdge = ring.isProperEdge(i);\r\n\r\n                            if (!properEdge && line.length !== 0) {\r\n                                lines.push(line);\r\n                                line = [];\r\n                            } else if (properEdge && line.length === 0) {\r\n                                webMercatorTile2TargetTile(\r\n                                    extents,\r\n                                    this.m_decodeInfo,\r\n                                    tmpV2.copy(curr),\r\n                                    tmpV3,\r\n                                    scaleHeights\r\n                                );\r\n                                line.push(tmpV3.x, tmpV3.y, tmpV3.z);\r\n\r\n                                if (needIndividualLineSegments) {\r\n                                    // Add next point as the end point of this line segment.\r\n                                    webMercatorTile2TargetTile(\r\n                                        extents,\r\n                                        this.m_decodeInfo,\r\n                                        tmpV2.copy(next),\r\n                                        tmpV4,\r\n                                        scaleHeights\r\n                                    );\r\n                                    line.push(tmpV4.x, tmpV4.y, tmpV4.z);\r\n\r\n                                    segmentOffsets!.push(lastSegmentOffset);\r\n\r\n                                    // Compute length of segment and whole line to scale down later.\r\n                                    const segmentLength = tmpV3.distanceTo(tmpV4);\r\n                                    ringLength += segmentLength;\r\n                                    lastSegmentOffset += segmentLength;\r\n                                    segmentOffsets!.push(lastSegmentOffset);\r\n                                }\r\n                            }\r\n                            if (properEdge && !needIndividualLineSegments) {\r\n                                webMercatorTile2TargetTile(\r\n                                    extents,\r\n                                    this.m_decodeInfo,\r\n                                    tmpV2.copy(next),\r\n                                    tmpV3,\r\n                                    scaleHeights\r\n                                );\r\n                                line.push(tmpV3.x, tmpV3.y, tmpV3.z);\r\n                            }\r\n\r\n                            if (needIndividualLineSegments && line.length > 0 && ringLength > 0) {\r\n                                // Scale down each individual segment to range [0..1] for the whole\r\n                                // line.\r\n                                segmentOffsets!.forEach((offs, index) => {\r\n                                    segmentOffsets![index] = offs / ringLength;\r\n                                });\r\n\r\n                                // Close the line segment as a single line.\r\n                                lines.push(line);\r\n                                offsets!.push(segmentOffsets!);\r\n                            }\r\n                        }\r\n\r\n                        if (!needIndividualLineSegments && line.length > 0) {\r\n                            lines.push(line);\r\n                        }\r\n                    });\r\n\r\n                    if (lines.length === 0) {\r\n                        return;\r\n                    }\r\n\r\n                    this.applyLineTechnique(\r\n                        lineGeometry,\r\n                        technique,\r\n                        techniqueIndex,\r\n                        lineType,\r\n                        env.entries,\r\n                        lines,\r\n                        context,\r\n                        undefined,\r\n                        offsets!\r\n                    );\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Creates the geometries that belongs to the [[Tile].\r\n     *\r\n     * @returns The [[DecodedTile]]\r\n     */\r\n    getDecodedTile(): DecodedTile {\r\n        this.createGeometries();\r\n        this.processSimpleLines(this.m_simpleLines);\r\n        this.processLines(this.m_solidLines);\r\n\r\n        const decodedTile: DecodedTile = {\r\n            techniques: this.m_styleSetEvaluator.decodedTechniques,\r\n            geometries: this.m_geometries,\r\n            decodeTime: undefined\r\n        };\r\n        if (this.m_textGeometries.length > 0) {\r\n            decodedTile.textGeometries = this.m_textGeometries;\r\n        }\r\n        if (this.m_poiGeometries.length > 0) {\r\n            decodedTile.poiGeometries = this.m_poiGeometries;\r\n        }\r\n        if (this.m_textPathGeometries.length > 0) {\r\n            decodedTile.textPathGeometries = this.m_textPathGeometries;\r\n        }\r\n        if (this.m_pathGeometries.length > 0) {\r\n            decodedTile.pathGeometries = this.m_pathGeometries;\r\n        }\r\n        if (this.m_sources.length !== 0) {\r\n            decodedTile.copyrightHolderIds = this.m_sources;\r\n        }\r\n        decodedTile.maxGeometryHeight = this.m_maxGeometryHeight;\r\n        decodedTile.minGeometryHeight = this.m_minGeometryHeight;\r\n        return decodedTile;\r\n    }\r\n\r\n    /**\r\n     * Split the lines array into multiple parts if there are sharp corners. Reject parts that are\r\n     * too short to display the label text.\r\n     *\r\n     * @param {number[][]} lines Array containing the points of the paths.\r\n     * @param {number} minEstimatedLabelLengthSqr Minimum label size squared.\r\n     * @param {number} maxCornerAngle Maximum angle between consecutive path segments in radians.\r\n     * @returns The split and filtered lines array.\r\n     */\r\n    protected splitJaggyLines(\r\n        lines: number[][],\r\n        minEstimatedLabelLengthSqr: number,\r\n        maxCornerAngle: number\r\n    ): number[][] {\r\n        const validLines: number[][] = [];\r\n\r\n        const computeBoundingBoxSizeSqr = (\r\n            aLine: number[],\r\n            startIndex: number,\r\n            endIndex: number\r\n        ): number => {\r\n            let minX = Number.MAX_SAFE_INTEGER;\r\n            let maxX = Number.MIN_SAFE_INTEGER;\r\n            let minY = Number.MAX_SAFE_INTEGER;\r\n            let maxY = Number.MIN_SAFE_INTEGER;\r\n            for (let i = startIndex; i < endIndex; i += 3) {\r\n                const x = aLine[i];\r\n                const y = aLine[i + 1];\r\n                if (x < minX) {\r\n                    minX = x;\r\n                }\r\n                if (x > maxX) {\r\n                    maxX = x;\r\n                }\r\n                if (y < minY) {\r\n                    minY = y;\r\n                }\r\n                if (y > maxY) {\r\n                    maxY = y;\r\n                }\r\n            }\r\n\r\n            return (maxX - minX) * (maxX - minX) + (maxY - minY) * (maxY - minY);\r\n        };\r\n\r\n        // Work on a copy of the path.\r\n        const pathsToCheck = lines.slice();\r\n\r\n        while (pathsToCheck.length > 0) {\r\n            const path = pathsToCheck.pop();\r\n\r\n            if (path === undefined || path.length < 6) {\r\n                continue;\r\n            }\r\n\r\n            let splitIndex = -1;\r\n\r\n            for (let i = 0; i < path.length - 3; i += 3) {\r\n                tempP0.set(path[i], path[i + 1]);\r\n                tempP1.set(path[i + 3], path[i + 4]);\r\n                const tangent = tempP1.sub(tempP0).normalize();\r\n\r\n                if (i > 0) {\r\n                    const theta = Math.atan2(\r\n                        tempPreviousTangent.x * tangent.y - tangent.x * tempPreviousTangent.y,\r\n                        tangent.dot(tempPreviousTangent)\r\n                    );\r\n\r\n                    if (Math.abs(theta) > maxCornerAngle) {\r\n                        splitIndex = i;\r\n                        break;\r\n                    }\r\n                }\r\n                tempPreviousTangent.set(tangent.x, tangent.y);\r\n            }\r\n\r\n            if (splitIndex > 0) {\r\n                // Estimate if the first part of the path is long enough for the label.\r\n                const firstPathLengthSqr = computeBoundingBoxSizeSqr(path, 0, splitIndex + 3);\r\n                // Estimate if the second part of the path is long enough for the label.\r\n                const secondPathLengthSqr = computeBoundingBoxSizeSqr(\r\n                    path,\r\n                    splitIndex,\r\n                    path.length\r\n                );\r\n\r\n                if (firstPathLengthSqr > minEstimatedLabelLengthSqr) {\r\n                    // Split off the valid first path points with a clone of the path.\r\n                    validLines.push(path.slice(0, splitIndex + 3));\r\n                }\r\n\r\n                if (secondPathLengthSqr > minEstimatedLabelLengthSqr) {\r\n                    // Now process the second part of the path, it may have to be split\r\n                    // again.\r\n                    pathsToCheck.push(path.slice(splitIndex));\r\n                }\r\n            } else {\r\n                // Estimate if the path is long enough for the label, otherwise ignore\r\n                // it for rendering text. First, compute the bounding box in world\r\n                // coordinates.\r\n                const pathLengthSqr = computeBoundingBoxSizeSqr(path, 0, path.length);\r\n\r\n                if (pathLengthSqr > minEstimatedLabelLengthSqr) {\r\n                    validLines.push(path);\r\n                }\r\n            }\r\n        }\r\n\r\n        return validLines;\r\n    }\r\n\r\n    private getTextureCoordinateType(technique: Technique): TextureCoordinateType | undefined {\r\n        // Set TileSpace coordinate type to generate texture coordinates for the displacement map\r\n        // used in elevation overlay.\r\n        if (\r\n            (isFillTechnique(technique) ||\r\n                isSolidLineTechnique(technique) ||\r\n                isExtrudedPolygonTechnique(technique)) &&\r\n            this.m_options.enableElevationOverlay\r\n        ) {\r\n            return TextureCoordinateType.TileSpace;\r\n        }\r\n\r\n        return textureCoordinateType(technique);\r\n    }\r\n\r\n    private getComputeTexCoordsFunc(\r\n        technique: Technique,\r\n        objectBounds?: THREE.Box3\r\n    ): TexCoordsFunction | undefined {\r\n        const texCoordType = this.getTextureCoordinateType(technique);\r\n\r\n        switch (texCoordType) {\r\n            case TextureCoordinateType.TileSpace:\r\n                return (tilePos: THREE.Vector2, tileExtents: number): THREE.Vector2 => {\r\n                    const uv = tilePos.clone().divideScalar(tileExtents);\r\n                    uv.y = 1 - uv.y;\r\n                    return uv;\r\n                };\r\n\r\n            case TextureCoordinateType.EquirectangularSpace:\r\n                return (tilePos: THREE.Vector2, extents: number): THREE.Vector2 => {\r\n                    const worldPos = tile2world(extents, this.m_decodeInfo, tilePos, false, tmpV3r);\r\n                    const uv = normalizedEquirectangularProjection.reprojectPoint(\r\n                        webMercatorProjection,\r\n                        worldPos\r\n                    );\r\n                    return new THREE.Vector2(uv.x, uv.y);\r\n                };\r\n\r\n            case TextureCoordinateType.FeatureSpace:\r\n                if (!objectBounds) {\r\n                    return undefined;\r\n                }\r\n                return (tilePos: THREE.Vector2, extents: number): THREE.Vector2 => {\r\n                    const worldPos = tile2world(extents, this.m_decodeInfo, tilePos, false, tmpV3r);\r\n                    const uv = new THREE.Vector2(worldPos.x, worldPos.y);\r\n                    if (objectBounds) {\r\n                        uv.x -= objectBounds.min.x;\r\n                        uv.y -= objectBounds.min.y;\r\n                        uv.x /= objectBounds.max.x - objectBounds.min.x;\r\n                        uv.y /= objectBounds.max.y - objectBounds.min.y;\r\n                    }\r\n                    uv.y = 1 - uv.y;\r\n                    return uv;\r\n                };\r\n\r\n            default:\r\n                return undefined;\r\n        }\r\n    }\r\n\r\n    private applyLineTechnique(\r\n        linesGeometry: LinesGeometry[],\r\n        technique: IndexedTechnique,\r\n        techniqueIndex: number,\r\n        lineType = LineType.Complex,\r\n        featureAttributes: AttributeMap,\r\n        lines: number[][],\r\n        context: AttrEvaluationContext,\r\n        uvs?: number[][],\r\n        offsets?: number[][]\r\n    ): void {\r\n        let lineGroup: LineGroup;\r\n        const lineGroupGeometries = linesGeometry.find(aLine => aLine.technique === techniqueIndex);\r\n        const hasNormalsAndUvs = uvs !== undefined;\r\n        if (lineGroupGeometries === undefined) {\r\n            lineGroup = new LineGroup(hasNormalsAndUvs, undefined, lineType === LineType.Simple);\r\n            const aLine: LinesGeometry = {\r\n                type: lineType === LineType.Complex ? GeometryType.SolidLine : GeometryType.Line,\r\n                technique: techniqueIndex,\r\n                lines: lineGroup\r\n            };\r\n\r\n            if (this.m_options.gatherFeatureAttributes) {\r\n                aLine.objInfos = [featureAttributes];\r\n                aLine.featureStarts = [0];\r\n            }\r\n\r\n            linesGeometry.push(aLine);\r\n        } else {\r\n            lineGroup = lineGroupGeometries.lines;\r\n\r\n            if (\r\n                this.m_options.gatherFeatureAttributes &&\r\n                lineGroupGeometries.objInfos &&\r\n                lineGroupGeometries.featureStarts\r\n            ) {\r\n                // Add ID to tag the geometry, also provide the current length of the index\r\n                // attribute\r\n                lineGroupGeometries.objInfos.push(featureAttributes);\r\n                lineGroupGeometries.featureStarts.push(lineGroup.indices.length);\r\n            }\r\n        }\r\n        let i = 0;\r\n        lines.forEach(aLine => {\r\n            lineGroup.add(\r\n                this.m_decodeInfo.center,\r\n                aLine,\r\n                this.projection,\r\n                offsets ? offsets[i] : undefined,\r\n                uvs ? uvs[i] : undefined\r\n            );\r\n            i++;\r\n        });\r\n    }\r\n\r\n    private applyPolygonTechnique(\r\n        polygons: Ring[][],\r\n        technique: Technique,\r\n        techniqueIndex: number,\r\n        context: AttrEvaluationContext,\r\n        extents: number\r\n    ): void {\r\n        if (polygons.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const isExtruded = isExtrudedPolygonTechnique(technique);\r\n\r\n        const geometryType = isExtruded ? GeometryType.ExtrudedPolygon : GeometryType.Polygon;\r\n        const meshBuffers = this.findOrCreateMeshBuffers(techniqueIndex, geometryType);\r\n\r\n        if (meshBuffers === undefined) {\r\n            return;\r\n        }\r\n\r\n        const extrudedPolygonTechnique = technique as ExtrudedPolygonTechnique;\r\n        const fillTechnique = technique as FillTechnique;\r\n        const boundaryWalls = extrudedPolygonTechnique.boundaryWalls === true;\r\n\r\n        const isFilled = isFillTechnique(technique);\r\n        const texCoordType = this.getTextureCoordinateType(technique);\r\n\r\n        let height = evaluateTechniqueAttr<number>(context, extrudedPolygonTechnique.height);\r\n\r\n        let floorHeight = evaluateTechniqueAttr<number>(\r\n            context,\r\n            extrudedPolygonTechnique.floorHeight\r\n        );\r\n\r\n        if (height === undefined) {\r\n            // Get the height values for the footprint and extrusion.\r\n            const featureHeight = context.env.lookup(\"height\") as number;\r\n            const styleSetDefaultHeight = evaluateTechniqueAttr<number>(\r\n                context,\r\n                extrudedPolygonTechnique.defaultHeight\r\n            );\r\n            height =\r\n                featureHeight !== undefined\r\n                    ? featureHeight\r\n                    : styleSetDefaultHeight !== undefined\r\n                    ? styleSetDefaultHeight\r\n                    : 0;\r\n        }\r\n\r\n        if (floorHeight === undefined) {\r\n            const featureMinHeight = context.env.lookup(\"min_height\") as number;\r\n            floorHeight = featureMinHeight !== undefined && !isFilled ? featureMinHeight : 0;\r\n        }\r\n\r\n        // Prevent that extruded buildings are completely flat (can introduce errors in normal\r\n        // computation and extrusion).\r\n        height = Math.max(floorHeight + ExtrusionFeatureDefs.MIN_BUILDING_HEIGHT, height);\r\n\r\n        const tileLevel = this.m_decodeInfo.tileKey.level;\r\n\r\n        const scaleHeights =\r\n            isExtruded && scaleHeight(context, extrudedPolygonTechnique, tileLevel);\r\n\r\n        this.m_decodeInfo.tileBounds.getCenter(tempTileOrigin);\r\n\r\n        const {\r\n            positions,\r\n            normals,\r\n            textureCoordinates,\r\n            colors,\r\n            extrusionAxis,\r\n            indices,\r\n            edgeIndices,\r\n            groups\r\n        } = meshBuffers;\r\n\r\n        const isSpherical = this.m_decodeInfo.targetProjection.type === ProjectionType.Spherical;\r\n\r\n        const edgeWidth = isExtruded\r\n            ? extrudedPolygonTechnique.lineWidth ?? 0.0\r\n            : isFilled\r\n            ? fillTechnique.lineWidth ?? 0.0\r\n            : 0.0;\r\n        const hasEdges = typeof edgeWidth === \"number\" ? edgeWidth > 0.0 : true;\r\n\r\n        let color: THREE.Color | undefined;\r\n        if (isExtrudedPolygonTechnique(technique)) {\r\n            if (getOptionValue(technique.vertexColors, false)) {\r\n                let colorValue = evaluateTechniqueAttr<StyleColor>(context, technique.color);\r\n                if (colorValue === undefined) {\r\n                    const featureColor = context.env.lookup(\"color\");\r\n                    if (this.isColorStringValid(featureColor)) {\r\n                        colorValue = String(featureColor);\r\n                    }\r\n                }\r\n                if (colorValue === undefined) {\r\n                    colorValue = evaluateTechniqueAttr<number | string>(\r\n                        context,\r\n                        technique.defaultColor,\r\n                        0x000000\r\n                    );\r\n                }\r\n\r\n                if (colorValue === undefined) {\r\n                    colorValue = 0x000000;\r\n                }\r\n                tmpColor.set(colorValue as any);\r\n\r\n                color = tmpColor;\r\n            }\r\n        }\r\n\r\n        for (const polygon of polygons) {\r\n            const startIndexCount = indices.length;\r\n            const edgeStartIndexCount = edgeIndices.length;\r\n\r\n            // Iterate over the exterior ring of the current polygon\r\n            const vertices: number[] = [];\r\n            const polygonBaseVertex = positions.length / 3;\r\n            const exteriorRing = polygon[0];\r\n\r\n            const featureStride = exteriorRing.vertexStride;\r\n            const vertexStride = featureStride + 2;\r\n\r\n            // The exterior ring is always the first\r\n            for (let i = 0; i < exteriorRing.points.length; ++i) {\r\n                const point = exteriorRing.points[i];\r\n\r\n                // Invert the Y component to preserve the correct winding without transforming\r\n                // from webMercator's local to global space.\r\n                vertices.push(point.x, -point.y);\r\n\r\n                if (exteriorRing.textureCoords !== undefined) {\r\n                    vertices.push(exteriorRing.textureCoords[i].x, exteriorRing.textureCoords[i].y);\r\n                }\r\n\r\n                const nextIdx = (i + 1) % exteriorRing.points.length;\r\n\r\n                const properEdge = exteriorRing.isProperEdge(i);\r\n\r\n                // Calculate nextEdge and nextWall.\r\n                vertices.push(\r\n                    properEdge ? nextIdx : -1,\r\n                    boundaryWalls || properEdge ? nextIdx : -1\r\n                );\r\n            }\r\n\r\n            // Iterate over the inner rings - if any\r\n            const holes: number[] = [];\r\n            let ringIndex = 1;\r\n            while (ringIndex < polygon.length) {\r\n                const vertexOffset = vertices.length / vertexStride;\r\n                holes.push(vertexOffset);\r\n\r\n                const hole = polygon[ringIndex++];\r\n                for (let i = 0; i < hole.points.length; ++i) {\r\n                    const nextIdx = (i + 1) % hole.points.length;\r\n                    const point = hole.points[i];\r\n\r\n                    // Invert the Y component to preserve the correct winding without\r\n                    // transforming from webMercator's local to global space.\r\n                    vertices.push(point.x, -point.y);\r\n\r\n                    if (hole.textureCoords !== undefined) {\r\n                        vertices.push(hole.textureCoords[i].x, hole.textureCoords[i].y);\r\n                    }\r\n\r\n                    // Calculate nextEdge and nextWall.\r\n                    const insideExtents = hole.isProperEdge(i);\r\n\r\n                    vertices.push(\r\n                        insideExtents ? vertexOffset + nextIdx : -1,\r\n                        boundaryWalls || insideExtents ? vertexOffset + nextIdx : -1\r\n                    );\r\n                }\r\n            }\r\n\r\n            try {\r\n                // Triangulate the footprint polyline.\r\n                const triangles = earcut(vertices, holes, vertexStride);\r\n                const originalVertexCount = vertices.length / vertexStride;\r\n\r\n                // Subdivide for spherical projections if needed.\r\n                if (isSpherical) {\r\n                    const geom = new THREE.BufferGeometry();\r\n\r\n                    const positionArray = [];\r\n                    const uvArray = [];\r\n                    const edgeArray = [];\r\n                    const wallArray = [];\r\n\r\n                    // Transform to global webMercator coordinates to be able to reproject to\r\n                    // sphere.\r\n                    for (let i = 0; i < vertices.length; i += vertexStride) {\r\n                        const worldPos = tile2world(\r\n                            extents,\r\n                            this.m_decodeInfo,\r\n                            tmpV2.set(vertices[i], vertices[i + 1]),\r\n                            true,\r\n                            tmpV3r\r\n                        );\r\n                        positionArray.push(worldPos.x, worldPos.y, 0);\r\n                        if (texCoordType !== undefined) {\r\n                            uvArray.push(vertices[i + 2], vertices[i + 3]);\r\n                        }\r\n                        edgeArray.push(vertices[i + featureStride]);\r\n                        wallArray.push(vertices[i + featureStride + 1]);\r\n                    }\r\n\r\n                    // Create the temporary geometry used for subdivision.\r\n                    const posAttr = new THREE.BufferAttribute(new Float32Array(positionArray), 3);\r\n                    geom.setAttribute(\"position\", posAttr);\r\n                    let uvAttr: THREE.BufferAttribute | undefined;\r\n                    if (texCoordType !== undefined) {\r\n                        uvAttr = new THREE.BufferAttribute(new Float32Array(uvArray), 2);\r\n                        geom.setAttribute(\"uv\", uvAttr);\r\n                    }\r\n                    const edgeAttr = new THREE.BufferAttribute(new Float32Array(edgeArray), 1);\r\n                    geom.setAttribute(\"edge\", edgeAttr);\r\n                    const wallAttr = new THREE.BufferAttribute(new Float32Array(wallArray), 1);\r\n                    geom.setAttribute(\"wall\", edgeAttr);\r\n                    const index = createIndexBufferAttribute(triangles, posAttr.count - 1);\r\n                    const indexAttr =\r\n                        index.type === \"uint32\"\r\n                            ? new THREE.Uint32BufferAttribute(index.buffer, 1)\r\n                            : new THREE.Uint16BufferAttribute(index.buffer, 1);\r\n                    geom.setIndex(indexAttr);\r\n\r\n                    // Increase tesselation of polygons for certain zoom levels\r\n                    // to remove mixed LOD cracks\r\n                    const zoomLevel = this.m_decodeInfo.tileKey.level;\r\n                    if (zoomLevel >= 3 && zoomLevel < 9) {\r\n                        const subdivision = Math.pow(2, 9 - zoomLevel);\r\n                        const { geoBox } = this.m_decodeInfo;\r\n                        const edgeModifier = new EdgeLengthGeometrySubdivisionModifier(\r\n                            subdivision,\r\n                            geoBox,\r\n                            SubdivisionMode.NoDiagonals,\r\n                            webMercatorProjection\r\n                        );\r\n                        edgeModifier.modify(geom);\r\n                    }\r\n\r\n                    // FIXME(HARP-5700): Subdivision modifier ignores texture coordinates.\r\n                    const modifier = new SphericalGeometrySubdivisionModifier(\r\n                        THREE.MathUtils.degToRad(10),\r\n                        webMercatorProjection\r\n                    );\r\n                    modifier.modify(geom);\r\n\r\n                    // Reassemble the vertex buffer, transforming the subdivided global\r\n                    // webMercator points back to local space.\r\n                    vertices.length = 0;\r\n                    triangles.length = 0;\r\n                    for (let i = 0; i < posAttr.array.length; i += 3) {\r\n                        const tilePos = world2tile(\r\n                            extents,\r\n                            this.m_decodeInfo,\r\n                            tmpV3.set(posAttr.array[i], posAttr.array[i + 1], 0),\r\n                            true,\r\n                            tmpV2r\r\n                        );\r\n                        vertices.push(tilePos.x, tilePos.y);\r\n                        if (texCoordType !== undefined) {\r\n                            vertices.push(uvAttr!.array[(i / 3) * 2]);\r\n                            vertices.push(uvAttr!.array[(i / 3) * 2 + 1]);\r\n                        }\r\n                        vertices.push(edgeAttr.array[i / 3]);\r\n                        vertices.push(wallAttr.array[i / 3]);\r\n                    }\r\n\r\n                    const geomIndex = geom.getIndex();\r\n                    if (geomIndex !== null) {\r\n                        triangles.push(...(geomIndex.array as Float32Array));\r\n                    }\r\n                }\r\n\r\n                // Add the footprint/roof vertices to the position buffer.\r\n                tempVertNormal.set(0, 0, 1);\r\n\r\n                // Assemble the vertex buffer.\r\n                for (let i = 0; i < vertices.length; i += vertexStride) {\r\n                    webMercatorTile2TargetWorld(\r\n                        extents,\r\n                        this.m_decodeInfo,\r\n                        tmpV2.set(vertices[i], vertices[i + 1]),\r\n                        tmpV3,\r\n                        false, // no need to scale height (source data is 2D).\r\n                        true\r\n                    );\r\n\r\n                    const scaleFactor = scaleHeights\r\n                        ? this.m_decodeInfo.targetProjection.getScaleFactor(tmpV3)\r\n                        : 1.0;\r\n                    this.m_maxGeometryHeight = Math.max(\r\n                        this.m_maxGeometryHeight,\r\n                        scaleFactor * height\r\n                    );\r\n                    this.m_minGeometryHeight = Math.min(\r\n                        this.m_minGeometryHeight,\r\n                        scaleFactor * height\r\n                    );\r\n\r\n                    if (isSpherical) {\r\n                        tempVertNormal.set(tmpV3.x, tmpV3.y, tmpV3.z).normalize();\r\n                    }\r\n                    tmpV3.sub(this.center);\r\n\r\n                    tempFootDisp.copy(tempVertNormal).multiplyScalar(floorHeight * scaleFactor);\r\n                    positions.push(\r\n                        tmpV3.x + tempFootDisp.x,\r\n                        tmpV3.y + tempFootDisp.y,\r\n                        tmpV3.z + tempFootDisp.z\r\n                    );\r\n                    if (texCoordType !== undefined) {\r\n                        textureCoordinates.push(vertices[i + 2], vertices[i + 3]);\r\n                    }\r\n                    if (this.m_options.enableElevationOverlay) {\r\n                        normals.push(...tempVertNormal.toArray());\r\n                    }\r\n                    if (isExtruded) {\r\n                        tempRoofDisp.copy(tempVertNormal).multiplyScalar(height * scaleFactor);\r\n                        positions.push(\r\n                            tmpV3.x + tempRoofDisp.x,\r\n                            tmpV3.y + tempRoofDisp.y,\r\n                            tmpV3.z + tempRoofDisp.z\r\n                        );\r\n                        extrusionAxis.push(\r\n                            0.0,\r\n                            0.0,\r\n                            0.0,\r\n                            0.0,\r\n                            tempRoofDisp.x - tempFootDisp.x,\r\n                            tempRoofDisp.y - tempFootDisp.y,\r\n                            tempRoofDisp.z - tempFootDisp.z,\r\n                            1.0\r\n                        );\r\n                        if (texCoordType !== undefined) {\r\n                            textureCoordinates.push(vertices[i + 2], vertices[i + 3]);\r\n                        }\r\n                        if (this.m_options.enableElevationOverlay) {\r\n                            normals.push(...tempVertNormal.toArray());\r\n                        }\r\n                        if (color !== undefined) {\r\n                            colors.push(color.r, color.g, color.b, color.r, color.g, color.b);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Add the footprint/roof indices to the index buffer.\r\n                for (let i = 0; i < triangles.length; i += 3) {\r\n                    if (isExtruded) {\r\n                        // When extruding we duplicate the vertices, so that all even vertices\r\n                        // belong to the bottom and all odd vertices belong to the top.\r\n                        const i0 = polygonBaseVertex + triangles[i + 0] * 2 + 1;\r\n                        const i1 = polygonBaseVertex + triangles[i + 1] * 2 + 1;\r\n                        const i2 = polygonBaseVertex + triangles[i + 2] * 2 + 1;\r\n                        indices.push(i0, i1, i2);\r\n                    } else {\r\n                        const i0 = polygonBaseVertex + triangles[i + 0];\r\n                        const i1 = polygonBaseVertex + triangles[i + 1];\r\n                        const i2 = polygonBaseVertex + triangles[i + 2];\r\n                        indices.push(i0, i1, i2);\r\n                    }\r\n                }\r\n\r\n                // Assemble the index buffer for edges (follow vertices as linked list).\r\n                if (hasEdges) {\r\n                    this.addEdges(\r\n                        polygonBaseVertex,\r\n                        originalVertexCount,\r\n                        vertexStride,\r\n                        featureStride,\r\n                        positions,\r\n                        vertices,\r\n                        edgeIndices,\r\n                        isExtruded,\r\n                        extrudedPolygonTechnique.footprint,\r\n                        extrudedPolygonTechnique.maxSlope\r\n                    );\r\n                }\r\n                if (isExtruded) {\r\n                    this.addWalls(\r\n                        polygonBaseVertex,\r\n                        originalVertexCount,\r\n                        vertexStride,\r\n                        featureStride,\r\n                        vertices,\r\n                        indices\r\n                    );\r\n                }\r\n            } catch (err) {\r\n                logger.error(`cannot triangulate geometry`, err);\r\n            }\r\n\r\n            if (this.m_options.gatherFeatureAttributes) {\r\n                meshBuffers.objInfos.push(context.env.entries);\r\n                meshBuffers.featureStarts.push(startIndexCount);\r\n                meshBuffers.edgeFeatureStarts.push(edgeStartIndexCount);\r\n            }\r\n\r\n            const count = indices.length - startIndexCount;\r\n            if (count > 0) {\r\n                groups.push({\r\n                    start: startIndexCount,\r\n                    count,\r\n                    technique: techniqueIndex\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private createGeometries() {\r\n        this.m_meshBuffers.forEach((meshBuffers, techniqueIdx) => {\r\n            if (meshBuffers.positions.length === 0) {\r\n                return;\r\n            } // nothing to do\r\n\r\n            if (\r\n                !this.m_styleSetEvaluator.techniques ||\r\n                this.m_styleSetEvaluator.techniques.length <= techniqueIdx\r\n            ) {\r\n                throw new Error(\"Invalid technique index\");\r\n            }\r\n\r\n            const technique = this.m_styleSetEvaluator.techniques[techniqueIdx];\r\n            if (technique === undefined) {\r\n                return;\r\n            }\r\n            if (meshBuffers.texts.length > 0) {\r\n                const geometry: TextGeometry = {\r\n                    positions: {\r\n                        name: \"position\",\r\n                        type: \"float\",\r\n                        buffer: new Float64Array(meshBuffers.positions).buffer,\r\n                        itemCount: 3\r\n                    },\r\n                    texts: meshBuffers.texts,\r\n                    technique: techniqueIdx,\r\n                    stringCatalog: meshBuffers.stringCatalog,\r\n                    objInfos: meshBuffers.objInfos\r\n                };\r\n\r\n                if (isTextTechnique(technique)) {\r\n                    this.m_textGeometries.push(geometry);\r\n                } else {\r\n                    assert(isPoiTechnique(technique));\r\n                    const poiGeometry = geometry as PoiGeometry;\r\n                    poiGeometry.imageTextures = meshBuffers.imageTextures;\r\n                    poiGeometry.offsetDirections = meshBuffers.offsetDirections;\r\n                    this.m_poiGeometries.push(poiGeometry);\r\n                }\r\n                return;\r\n            }\r\n\r\n            const positionElements = new Float32Array(meshBuffers.positions);\r\n\r\n            if (meshBuffers.groups.length === 0) {\r\n                // create a default group containing all the vertices in the position attribute.\r\n\r\n                meshBuffers.groups.push({\r\n                    start: 0,\r\n                    count: positionElements.length / 3,\r\n                    technique: techniqueIdx\r\n                });\r\n            }\r\n\r\n            const vertexAttributes: BufferAttribute[] = [\r\n                {\r\n                    name: \"position\",\r\n                    buffer: positionElements.buffer,\r\n                    itemCount: 3,\r\n                    type: \"float\"\r\n                }\r\n            ];\r\n\r\n            const geometry: Geometry = {\r\n                type: meshBuffers.type,\r\n                vertexAttributes,\r\n                groups: meshBuffers.groups\r\n            };\r\n\r\n            if (meshBuffers.normals.length > 0) {\r\n                const normals = new Float32Array(meshBuffers.normals);\r\n                assert(\r\n                    normals.length === positionElements.length,\r\n                    \"length of normals buffer is different than the length of the \" +\r\n                        \"position buffer\"\r\n                );\r\n\r\n                vertexAttributes.push({\r\n                    name: \"normal\",\r\n                    buffer: normals.buffer,\r\n                    itemCount: 3,\r\n                    type: \"float\"\r\n                });\r\n            }\r\n\r\n            if (meshBuffers.colors.length > 0) {\r\n                const colors = new Float32Array(meshBuffers.colors);\r\n                assert(\r\n                    colors.length === positionElements.length,\r\n                    \"length of colors buffer is different than the length of the \" +\r\n                        \"position buffer\"\r\n                );\r\n\r\n                vertexAttributes.push({\r\n                    name: \"color\",\r\n                    buffer: colors.buffer,\r\n                    itemCount: 3,\r\n                    type: \"float\"\r\n                });\r\n            }\r\n\r\n            const positionCount = meshBuffers.positions.length / 3;\r\n\r\n            if (meshBuffers.textureCoordinates.length > 0) {\r\n                const texCoordCount = meshBuffers.textureCoordinates.length / 2;\r\n                assert(\r\n                    texCoordCount === positionCount,\r\n                    \"length of textureCoordinates buffer is different than the length of the\" +\r\n                        \"position buffer\"\r\n                );\r\n\r\n                const textureCoordinates = new Float32Array(meshBuffers.textureCoordinates);\r\n                vertexAttributes.push({\r\n                    name: \"uv\",\r\n                    buffer: textureCoordinates.buffer as ArrayBuffer,\r\n                    itemCount: 2,\r\n                    type: \"float\"\r\n                });\r\n            }\r\n\r\n            if (meshBuffers.extrusionAxis.length > 0) {\r\n                const extrusionAxis = new Float32Array(meshBuffers.extrusionAxis);\r\n                assert(\r\n                    extrusionAxis.length / 4 === positionElements.length / 3,\r\n                    \"length of extrusionAxis buffer is different than the length of the \" +\r\n                        \"position buffer\"\r\n                );\r\n\r\n                vertexAttributes.push({\r\n                    name: \"extrusionAxis\",\r\n                    buffer: extrusionAxis.buffer as ArrayBuffer,\r\n                    itemCount: 4,\r\n                    type: \"float\"\r\n                });\r\n            }\r\n\r\n            if (meshBuffers.indices.length > 0) {\r\n                geometry.index = createIndexBufferAttribute(meshBuffers.indices, positionCount - 1);\r\n            }\r\n\r\n            if (meshBuffers.edgeIndices.length > 0) {\r\n                geometry.edgeIndex = createIndexBufferAttribute(\r\n                    meshBuffers.edgeIndices,\r\n                    positionCount - 1,\r\n                    \"edgeIndex\"\r\n                );\r\n            }\r\n\r\n            geometry.featureStarts = meshBuffers.featureStarts;\r\n            geometry.edgeFeatureStarts = meshBuffers.edgeFeatureStarts;\r\n            geometry.objInfos = meshBuffers.objInfos;\r\n\r\n            this.m_geometries.push(geometry);\r\n        });\r\n    }\r\n\r\n    private processLines(linesArray: LinesGeometry[]) {\r\n        linesArray.forEach(linesGeometry => {\r\n            const { vertices, indices } = linesGeometry.lines;\r\n            const technique = linesGeometry.technique;\r\n            const buffer = new Float32Array(vertices).buffer as ArrayBuffer;\r\n            const index = createIndexBufferAttribute(\r\n                indices,\r\n                vertices.length / linesGeometry.lines.stride - 1\r\n            );\r\n            const attr: InterleavedBufferAttribute = {\r\n                type: \"float\",\r\n                stride: linesGeometry.lines.stride,\r\n                buffer,\r\n                attributes: linesGeometry.lines.vertexAttributes\r\n            };\r\n            const geometry: Geometry = {\r\n                type: GeometryType.SolidLine,\r\n                index,\r\n                interleavedVertexAttributes: [attr],\r\n                groups: [{ start: 0, count: indices.length, technique }],\r\n                vertexAttributes: [],\r\n                featureStarts: linesGeometry.featureStarts,\r\n                objInfos: linesGeometry.objInfos\r\n            };\r\n\r\n            this.m_geometries.push(geometry);\r\n        });\r\n    }\r\n\r\n    private processSimpleLines(linesArray: LinesGeometry[]) {\r\n        linesArray.forEach(linesGeometry => {\r\n            const { vertices, indices } = linesGeometry.lines;\r\n            const technique = linesGeometry.technique;\r\n            const buffer = new Float32Array(vertices).buffer as ArrayBuffer;\r\n            const attr: BufferAttribute = {\r\n                buffer,\r\n                itemCount: 3,\r\n                type: \"float\",\r\n                name: \"position\"\r\n            };\r\n            const geometry: Geometry = {\r\n                type: GeometryType.Line,\r\n                index: createIndexBufferAttribute(indices, vertices.length / attr.itemCount - 1),\r\n                vertexAttributes: [attr],\r\n                groups: [{ start: 0, count: indices.length, technique }],\r\n                featureStarts: linesGeometry.featureStarts,\r\n                objInfos: linesGeometry.objInfos\r\n            };\r\n\r\n            this.m_geometries.push(geometry);\r\n        });\r\n    }\r\n\r\n    private findOrCreateMeshBuffers(index: number, type: GeometryType): MeshBuffers | undefined {\r\n        let buffers = this.m_meshBuffers.get(index);\r\n\r\n        if (buffers !== undefined) {\r\n            if (buffers.type !== type) {\r\n                logger.error(`MeshBuffer has been created with wrong type \"${GeometryType[type]}\"\r\n                instead of \"${GeometryType[buffers.type]}\"`);\r\n                return undefined;\r\n            }\r\n            return buffers;\r\n        }\r\n        buffers = new MeshBuffers(type);\r\n        this.m_meshBuffers.set(index, buffers);\r\n        return buffers;\r\n    }\r\n\r\n    private processFeatureCommon(env: Env) {\r\n        const source = env.lookup(\"source\");\r\n        if (typeof source === \"string\" && source !== \"\") {\r\n            if (!this.m_sources.includes(source)) {\r\n                this.m_sources.push(source);\r\n            }\r\n        }\r\n    }\r\n\r\n    private isColorStringValid(color: Value | undefined): color is string {\r\n        return typeof color === \"string\" && color.length > 0;\r\n    }\r\n\r\n    private addEdges(\r\n        featureBaseVertex: number,\r\n        featureVertexCount: number,\r\n        vertexStride: number,\r\n        featureStride: number,\r\n        positions: number[],\r\n        vertices: number[],\r\n        indices: number[],\r\n        isExtruded: boolean,\r\n        hasFootprint?: boolean,\r\n        maxSlope?: number\r\n    ) {\r\n        const tmpEdgeA = new THREE.Vector3();\r\n        const tmpEdgeB = new THREE.Vector3();\r\n        let firstRingVertex: number | undefined;\r\n        let prevRingVertex: number | undefined;\r\n        let currRingVertex = 0;\r\n        let maxRingVertex = 0;\r\n\r\n        while (currRingVertex < featureVertexCount) {\r\n            while (currRingVertex !== firstRingVertex) {\r\n                if (firstRingVertex === undefined) {\r\n                    firstRingVertex = currRingVertex;\r\n                }\r\n                if (currRingVertex < featureVertexCount) {\r\n                    maxRingVertex = Math.max(maxRingVertex, currRingVertex);\r\n                }\r\n\r\n                const nextRingVertex = vertices[currRingVertex * vertexStride + featureStride];\r\n                if (nextRingVertex < 0) {\r\n                    break;\r\n                } else {\r\n                    if (!isExtruded) {\r\n                        indices.push(\r\n                            featureBaseVertex + currRingVertex,\r\n                            featureBaseVertex + nextRingVertex\r\n                        );\r\n                    } else {\r\n                        if (hasFootprint === true) {\r\n                            indices.push(\r\n                                featureBaseVertex + currRingVertex * 2,\r\n                                featureBaseVertex + nextRingVertex * 2\r\n                            );\r\n                        }\r\n                        indices.push(\r\n                            featureBaseVertex + currRingVertex * 2 + 1,\r\n                            featureBaseVertex + nextRingVertex * 2 + 1\r\n                        );\r\n\r\n                        if (maxSlope !== undefined) {\r\n                            if (prevRingVertex !== undefined) {\r\n                                const prevPos = (featureBaseVertex + prevRingVertex * 2) * 3;\r\n                                const currPos = (featureBaseVertex + currRingVertex * 2) * 3;\r\n                                const nextPos = (featureBaseVertex + nextRingVertex * 2) * 3;\r\n                                tmpEdgeA\r\n                                    .set(\r\n                                        positions[currPos] - positions[prevPos],\r\n                                        positions[currPos + 1] - positions[prevPos + 1],\r\n                                        positions[currPos + 2] - positions[prevPos + 2]\r\n                                    )\r\n                                    .normalize();\r\n                                tmpEdgeB\r\n                                    .set(\r\n                                        positions[nextPos] - positions[currPos],\r\n                                        positions[nextPos + 1] - positions[currPos + 1],\r\n                                        positions[nextPos + 2] - positions[currPos + 2]\r\n                                    )\r\n                                    .normalize();\r\n                                if (tmpEdgeA.dot(tmpEdgeB) <= maxSlope) {\r\n                                    indices.push(\r\n                                        featureBaseVertex + currRingVertex * 2,\r\n                                        featureBaseVertex + currRingVertex * 2 + 1\r\n                                    );\r\n                                }\r\n                            }\r\n                        } else {\r\n                            indices.push(\r\n                                featureBaseVertex + currRingVertex * 2,\r\n                                featureBaseVertex + currRingVertex * 2 + 1\r\n                            );\r\n                        }\r\n                    }\r\n                    prevRingVertex = currRingVertex;\r\n                    currRingVertex = nextRingVertex;\r\n                }\r\n            }\r\n            currRingVertex = maxRingVertex + 1;\r\n            firstRingVertex = undefined;\r\n            prevRingVertex = undefined;\r\n        }\r\n    }\r\n\r\n    private addWalls(\r\n        featureBaseVertex: number,\r\n        featureVertexCount: number,\r\n        vertexStride: number,\r\n        featureStride: number,\r\n        vertices: number[],\r\n        indices: number[]\r\n    ) {\r\n        let firstRingVertex: number | undefined;\r\n        let currRingVertex = 0;\r\n        let maxRingVertex = 0;\r\n\r\n        while (currRingVertex < featureVertexCount) {\r\n            while (currRingVertex !== firstRingVertex) {\r\n                if (firstRingVertex === undefined) {\r\n                    firstRingVertex = currRingVertex;\r\n                }\r\n                if (currRingVertex < featureVertexCount) {\r\n                    maxRingVertex = Math.max(maxRingVertex, currRingVertex);\r\n                }\r\n\r\n                const nextRingVertex = vertices[currRingVertex * vertexStride + featureStride + 1];\r\n                if (nextRingVertex < 0) {\r\n                    break;\r\n                } else {\r\n                    indices.push(\r\n                        featureBaseVertex + currRingVertex * 2,\r\n                        featureBaseVertex + currRingVertex * 2 + 1,\r\n                        featureBaseVertex + nextRingVertex * 2 + 1,\r\n                        featureBaseVertex + nextRingVertex * 2 + 1,\r\n                        featureBaseVertex + nextRingVertex * 2,\r\n                        featureBaseVertex + currRingVertex * 2\r\n                    );\r\n                }\r\n                currRingVertex = nextRingVertex;\r\n            }\r\n            currRingVertex = maxRingVertex + 1;\r\n            firstRingVertex = undefined;\r\n        }\r\n    }\r\n\r\n    private findRelativePositionInLine(p: THREE.Vector3, line: number[]): number {\r\n        let lineDist = Infinity;\r\n        let lineOffset = 0;\r\n        for (let i = 0; i < line.length; i += 4) {\r\n            // Find the closest point C in segment AB to point P.\r\n            tmpLine.set(\r\n                tmpPointA.set(line[i], line[i + 1], line[i + 2]),\r\n                tmpPointB.set(line[i + 4], line[i + 5], line[i + 6])\r\n            );\r\n            tmpLine.closestPointToPoint(p, true, tmpPointC);\r\n\r\n            // If P is in AB (or really close), save A as anchor point and C (to estimate distance\r\n            // from segment origin).\r\n            const dist = tmpPointC.distanceTo(p);\r\n            if (dist < lineDist) {\r\n                tmpPointD.copy(tmpPointC);\r\n                tmpPointE.copy(tmpPointA);\r\n                lineDist = dist;\r\n                lineOffset = line[i + 3];\r\n            }\r\n        }\r\n        // Return the relative position of P inside the line.\r\n        return lineOffset + tmpPointD.distanceTo(tmpPointE);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2022 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\nimport {\r\n    DecodedTile,\r\n    DecoderOptions,\r\n    GeometryKind,\r\n    IndexedTechnique,\r\n    OptionsMap,\r\n    ValueMap\r\n} from \"@here/harp-datasource-protocol\";\r\nimport { MapEnv, StyleSetEvaluator } from \"@here/harp-datasource-protocol/index-decoder\";\r\nimport { AttrEvaluationContext } from \"@here/harp-datasource-protocol/lib/TechniqueAttr\";\r\nimport { Projection, TileKey } from \"@here/harp-geoutils\";\r\nimport {\r\n    ThemedTileDecoder,\r\n    TileDecoderService,\r\n    WorkerServiceManager\r\n} from \"@here/harp-mapview-decoder/index-worker\";\r\nimport { assert, LoggerManager, PerformanceTimer } from \"@here/harp-utils\";\r\nimport * as THREE from \"three\";\r\n\r\nimport { GeoJsonDataAdapter } from \"./adapters/geojson/GeoJsonDataAdapter\";\r\nimport { GeoJsonVtDataAdapter } from \"./adapters/geojson-vt/GeoJsonVtDataAdapter\";\r\nimport { OmvDataAdapter } from \"./adapters/omv/OmvDataAdapter\";\r\nimport { DataAdapter } from \"./DataAdapter\";\r\nimport { DecodeInfo } from \"./DecodeInfo\";\r\nimport { IGeometryProcessor, ILineGeometry, IPolygonGeometry } from \"./IGeometryProcessor\";\r\nimport { OmvFeatureFilter } from \"./OmvDataFilter\";\r\nimport { OmvDecoderOptions, VECTOR_TILE_DECODER_SERVICE_TYPE } from \"./OmvDecoderDefs\";\r\nimport { VectorTileDataEmitter, VectorTileDataEmitterOptions } from \"./VectorTileDataEmitter\";\r\n\r\nconst logger = LoggerManager.instance.create(\"VectorTileDecoder\", { enabled: false });\r\n\r\n/**\r\n * Options for VectorTileDataProcessor, @see {@link OmvDecoderOptions}.\r\n * @internal\r\n */\r\nexport interface VectorTileDataProcessorOptions extends VectorTileDataEmitterOptions {\r\n    storageLevelOffset?: number;\r\n    showMissingTechniques?: boolean;\r\n}\r\n\r\n/**\r\n * Geometry processor for vector tiles.\r\n * @internal\r\n */\r\nexport class VectorTileDataProcessor implements IGeometryProcessor {\r\n    private m_decodedTileEmitter: VectorTileDataEmitter | undefined;\r\n\r\n    constructor(\r\n        private readonly m_tileKey: TileKey,\r\n        private readonly m_projection: Projection,\r\n        private readonly m_styleSetEvaluator: StyleSetEvaluator,\r\n        private readonly m_dataAdapter: DataAdapter,\r\n        private readonly m_options: VectorTileDataProcessorOptions = {},\r\n        private readonly m_dataFilter?: OmvFeatureFilter\r\n    ) {\r\n        m_options.storageLevelOffset = m_options.storageLevelOffset ?? 0;\r\n        m_options.showMissingTechniques = m_options.showMissingTechniques ?? false;\r\n    }\r\n\r\n    /**\r\n     * Decodes the given tile data.\r\n     *\r\n     * @param data - The tile data to decode.\r\n     * @returns A [[DecodedTile]]\r\n     */\r\n    getDecodedTile(data: ArrayBufferLike | {}): DecodedTile {\r\n        this.m_styleSetEvaluator.resetTechniques();\r\n\r\n        const decodeInfo = new DecodeInfo(\r\n            this.m_projection,\r\n            this.m_tileKey,\r\n            this.m_options.storageLevelOffset!\r\n        );\r\n\r\n        this.m_decodedTileEmitter = new VectorTileDataEmitter(\r\n            decodeInfo,\r\n            this.m_styleSetEvaluator,\r\n            this.m_options\r\n        );\r\n\r\n        this.m_dataAdapter.process(data, decodeInfo, this);\r\n        return this.m_decodedTileEmitter.getDecodedTile();\r\n    }\r\n\r\n    /** @override */\r\n    processPointFeature(\r\n        layer: string,\r\n        extents: number,\r\n        geometry: THREE.Vector3[],\r\n        properties: ValueMap,\r\n        featureId: string | number | undefined\r\n    ): void {\r\n        assert(this.m_decodedTileEmitter !== undefined);\r\n        this.processFeature(\r\n            layer,\r\n            extents,\r\n            geometry,\r\n            \"point\",\r\n            properties,\r\n            featureId,\r\n            this.m_decodedTileEmitter!.processPointFeature,\r\n            GeometryKind.Label\r\n        );\r\n    }\r\n\r\n    /** @override */\r\n    processLineFeature(\r\n        layer: string,\r\n        extents: number,\r\n        geometry: ILineGeometry[],\r\n        properties: ValueMap,\r\n        featureId: string | number | undefined\r\n    ): void {\r\n        assert(this.m_decodedTileEmitter !== undefined);\r\n        this.processFeature(\r\n            layer,\r\n            extents,\r\n            geometry,\r\n            \"line\",\r\n            properties,\r\n            featureId,\r\n            this.m_decodedTileEmitter!.processLineFeature,\r\n            GeometryKind.Line\r\n        );\r\n    }\r\n\r\n    /** @override */\r\n    processPolygonFeature(\r\n        layer: string,\r\n        extents: number,\r\n        geometry: IPolygonGeometry[],\r\n        properties: ValueMap,\r\n        featureId: string | number | undefined\r\n    ): void {\r\n        assert(this.m_decodedTileEmitter !== undefined);\r\n        this.processFeature(\r\n            layer,\r\n            extents,\r\n            geometry,\r\n            \"polygon\",\r\n            properties,\r\n            featureId,\r\n            this.m_decodedTileEmitter!.processPolygonFeature,\r\n            GeometryKind.Area\r\n        );\r\n    }\r\n\r\n    private processFeature(\r\n        layer: string,\r\n        extents: number,\r\n        geometry: THREE.Vector3[] | ILineGeometry[] | IPolygonGeometry[],\r\n        geometryType: string,\r\n        properties: ValueMap,\r\n        featureId: string | number | undefined,\r\n        emitterFunc: (...args: any[]) => void,\r\n        geometryKind: GeometryKind\r\n    ) {\r\n        const env = this.createMapEnv(properties, featureId, layer, geometryType);\r\n        const techniques = this.applyKindFilter(\r\n            this.m_styleSetEvaluator.getMatchingTechniques(env, layer, geometryType),\r\n            geometryKind\r\n        );\r\n\r\n        if (techniques.length === 0) {\r\n            if (this.m_options.showMissingTechniques) {\r\n                logger.log(\r\n                    \"VectorTileDataProcessor#processFeature: no techniques for object:\",\r\n                    JSON.stringify(env.unmap())\r\n                );\r\n            }\r\n            return;\r\n        }\r\n        const context: AttrEvaluationContext = {\r\n            env,\r\n            cachedExprResults: new Map()\r\n        };\r\n\r\n        if (this.m_decodedTileEmitter) {\r\n            emitterFunc.apply(this.m_decodedTileEmitter, [\r\n                layer,\r\n                extents,\r\n                geometry,\r\n                context,\r\n                techniques\r\n            ]);\r\n        }\r\n    }\r\n\r\n    private createMapEnv(\r\n        properties: ValueMap,\r\n        featureId: string | number | undefined,\r\n        layer: string,\r\n        geometryType: string\r\n    ): MapEnv {\r\n        const level = this.m_tileKey.level;\r\n        return new MapEnv({\r\n            $layer: layer,\r\n            $id: featureId ?? null,\r\n            $level: level,\r\n            $zoom: Math.max(0, level - this.m_options.storageLevelOffset!),\r\n            $geometryType: geometryType,\r\n            ...properties\r\n        });\r\n    }\r\n\r\n    private applyKindFilter(\r\n        techniques: IndexedTechnique[],\r\n        defaultKind: GeometryKind\r\n    ): IndexedTechnique[] {\r\n        if (this.m_dataFilter !== undefined && this.m_dataFilter.hasKindFilter) {\r\n            techniques = techniques.filter(technique => {\r\n                const kind =\r\n                    technique.kind === undefined ? defaultKind : (technique.kind as GeometryKind);\r\n                return this.m_dataFilter!.wantsKind(kind);\r\n            });\r\n        }\r\n        return techniques;\r\n    }\r\n}\r\n\r\n/**\r\n * The vector tile decoder.\r\n */\r\nexport class VectorTileDecoder extends ThemedTileDecoder {\r\n    private m_featureFilter?: OmvFeatureFilter;\r\n    private readonly m_roundUpCoordinatesIfNeeded: boolean = false;\r\n    private m_dataAdapter?: DataAdapter;\r\n    private m_options: { map: OptionsMap; changed: boolean } = { map: {}, changed: false };\r\n    private readonly m_defaultDataAdapters: DataAdapter[] = [];\r\n\r\n    constructor() {\r\n        super();\r\n        this.m_defaultDataAdapters.push(\r\n            new OmvDataAdapter(),\r\n            new GeoJsonVtDataAdapter(),\r\n            new GeoJsonDataAdapter()\r\n        );\r\n    }\r\n\r\n    /** @override */\r\n    connect(): Promise<void> {\r\n        return Promise.resolve();\r\n    }\r\n\r\n    /** @override */\r\n    decodeThemedTile(\r\n        data: ArrayBufferLike | {},\r\n        tileKey: TileKey,\r\n        styleSetEvaluator: StyleSetEvaluator,\r\n        projection: Projection\r\n    ): Promise<DecodedTile> {\r\n        const startTime = PerformanceTimer.now();\r\n        if (!this.m_dataAdapter) {\r\n            this.m_dataAdapter = this.getDataAdapter(data);\r\n            if (!this.m_dataAdapter) {\r\n                return Promise.reject(new Error(\"Unsupported data format.\"));\r\n            }\r\n        }\r\n        const dataAdapter = this.m_dataAdapter!;\r\n        assert(dataAdapter.canProcess(data));\r\n        if (this.m_options.changed) {\r\n            if (dataAdapter instanceof OmvDataAdapter) {\r\n                const omvOptions = this.m_options.map as OmvDecoderOptions;\r\n                dataAdapter.configure(omvOptions, styleSetEvaluator);\r\n                this.m_featureFilter = dataAdapter.dataFilter;\r\n            }\r\n            this.m_options.changed = false;\r\n        }\r\n\r\n        const decoder = new VectorTileDataProcessor(\r\n            tileKey,\r\n            projection,\r\n            styleSetEvaluator,\r\n            dataAdapter,\r\n            this.m_options.map as VectorTileDataProcessorOptions,\r\n            this.m_featureFilter\r\n        );\r\n        const decodedTile = decoder.getDecodedTile(data);\r\n\r\n        decodedTile.decodeTime = PerformanceTimer.now() - startTime;\r\n\r\n        return Promise.resolve(decodedTile);\r\n    }\r\n\r\n    /** @override */\r\n    configure(options?: DecoderOptions, customOptions?: OptionsMap): void {\r\n        super.configure(options, customOptions);\r\n        this.m_options.map = {\r\n            ...this.m_options.map,\r\n            ...options,\r\n            ...customOptions\r\n        };\r\n        this.m_options.changed = true;\r\n    }\r\n\r\n    /**\r\n     * Returns the appropiate data adapter to convert the given data into the format expected by\r\n     * VectorTileDecoder.\r\n     * @note Default adapters are available for GeoJson and OMV formats.\r\n     * Child classes may override this function to support additional formats.\r\n     *\r\n     * @param data - The input data to be coverted.\r\n     * @returns The DataAdapter to convert the data, or undefined if there's no adapter for that\r\n     * data format.\r\n     */\r\n    protected getDataAdapter(data: ArrayBufferLike | {}): DataAdapter | undefined {\r\n        for (const adapter of this.m_defaultDataAdapters) {\r\n            if (adapter.canProcess(data)) {\r\n                return adapter;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\n\r\n/**\r\n * Vector Tile Decoder Service.\r\n */\r\nexport class VectorTileDecoderService {\r\n    /**\r\n     * Register a vector tile decoder service.\r\n     *\r\n     * @remarks\r\n     * Has to be called during initialization of decoder bundle.\r\n     */\r\n    static start() {\r\n        WorkerServiceManager.getInstance().register({\r\n            serviceType: VECTOR_TILE_DECODER_SERVICE_TYPE,\r\n            factory: (serviceId: string) =>\r\n                TileDecoderService.start(serviceId, new VectorTileDecoder())\r\n        });\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { ValueMap } from \"@here/harp-datasource-protocol/index-decoder\";\r\nimport { webMercatorProjection } from \"@here/harp-geoutils\";\r\nimport { ShapeUtils, Vector2, Vector3 } from \"three\";\r\n\r\nimport { DataAdapter } from \"../../DataAdapter\";\r\nimport { DecodeInfo } from \"../../DecodeInfo\";\r\nimport { IGeometryProcessor, ILineGeometry, IPolygonGeometry } from \"../../IGeometryProcessor\";\r\nimport { isArrayBufferLike, tile2world } from \"../../OmvUtils\";\r\n\r\nconst VT_JSON_EXTENTS = 4096;\r\n\r\ntype VTJsonPosition = [number, number];\r\n\r\nenum VTJsonGeometryType {\r\n    Unknown,\r\n    Point,\r\n    LineString,\r\n    Polygon\r\n}\r\n\r\ninterface VTJsonFeatureInterface {\r\n    geometry: VTJsonPosition[] | VTJsonPosition[][];\r\n    id: string;\r\n    tags: ValueMap;\r\n    type: VTJsonGeometryType;\r\n}\r\n\r\ninterface VTJsonSourceInterface {\r\n    geometry: number[];\r\n    length: number;\r\n    id: string;\r\n    maxX: number;\r\n    maxY: number;\r\n    minX: number;\r\n    minY: number;\r\n    tags: ValueMap;\r\n    type: string;\r\n}\r\n\r\ninterface VTJsonTileInterface {\r\n    features: VTJsonFeatureInterface[];\r\n    maxX: number;\r\n    maxY: number;\r\n    minX: number;\r\n    minY: number;\r\n    numFeatures: number;\r\n    numPoints: number;\r\n    numSimplified: number;\r\n    source: VTJsonSourceInterface[];\r\n    transformed: boolean;\r\n    x: number;\r\n    y: number;\r\n    z: number;\r\n    layer: string;\r\n}\r\n\r\nconst worldPos = new Vector3();\r\n\r\n/**\r\n * The class `GeoJsonVtDataAdapter` converts VT-json data to geometries for the given\r\n * {@link IGeometryProcessor}.\r\n */\r\nexport class GeoJsonVtDataAdapter implements DataAdapter {\r\n    /**\r\n     * @override\r\n     */\r\n    canProcess(data: ArrayBufferLike | {}): boolean {\r\n        if (isArrayBufferLike(data)) {\r\n            return false;\r\n        }\r\n\r\n        const tile = data as VTJsonTileInterface;\r\n        if (\r\n            tile.features === undefined ||\r\n            tile.source === undefined ||\r\n            tile.x === undefined ||\r\n            tile.y === undefined ||\r\n            tile.z === undefined\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    process(\r\n        tile: VTJsonTileInterface,\r\n        decodeInfo: DecodeInfo,\r\n        geometryProcessor: IGeometryProcessor\r\n    ) {\r\n        for (const feature of tile.features) {\r\n            switch (feature.type) {\r\n                case VTJsonGeometryType.Point: {\r\n                    for (const pointGeometry of feature.geometry) {\r\n                        const x = (pointGeometry as VTJsonPosition)[0];\r\n                        const y = (pointGeometry as VTJsonPosition)[1];\r\n\r\n                        const position = new Vector3(x, y, 0);\r\n\r\n                        geometryProcessor.processPointFeature(\r\n                            tile.layer,\r\n                            VT_JSON_EXTENTS,\r\n                            [position],\r\n                            feature.tags,\r\n                            feature.id\r\n                        );\r\n                    }\r\n                    break;\r\n                }\r\n                case VTJsonGeometryType.LineString: {\r\n                    const lineGeometries = feature.geometry as VTJsonPosition[][];\r\n\r\n                    let lastLine: ILineGeometry | undefined;\r\n                    const lines: ILineGeometry[] = [];\r\n\r\n                    lineGeometries.forEach(lineGeometry => {\r\n                        const lastPos = lastLine?.positions[lastLine.positions.length - 1];\r\n                        const [startx, starty] = lineGeometry[0];\r\n                        if (lastPos?.x === startx && lastPos?.y === starty) {\r\n                            // continue the last line\r\n                            for (let i = 1; i < lineGeometry.length; ++i) {\r\n                                const [x, y] = lineGeometry[i];\r\n                                lastLine?.positions.push(new Vector2(x, y));\r\n                            }\r\n                        } else {\r\n                            // start a new line\r\n                            const positions = lineGeometry.map(([x, y]) => new Vector2(x, y));\r\n                            lines.push({ positions });\r\n\r\n                            lastLine = lines[lines.length - 1];\r\n                        }\r\n                    });\r\n\r\n                    lines.forEach(line => {\r\n                        (line as any).untiledPositions = line.positions.map(tilePos => {\r\n                            tile2world(VT_JSON_EXTENTS, decodeInfo, tilePos, false, worldPos);\r\n                            return webMercatorProjection.unprojectPoint(worldPos);\r\n                        });\r\n                    });\r\n\r\n                    geometryProcessor.processLineFeature(\r\n                        tile.layer,\r\n                        VT_JSON_EXTENTS,\r\n                        lines,\r\n                        feature.tags,\r\n                        feature.id\r\n                    );\r\n\r\n                    break;\r\n                }\r\n                case VTJsonGeometryType.Polygon: {\r\n                    const polygons: IPolygonGeometry[] = [];\r\n                    let polygon: IPolygonGeometry | undefined;\r\n                    for (const outline of feature.geometry as VTJsonPosition[][]) {\r\n                        const ring: Vector2[] = [];\r\n                        for (const [currX, currY] of outline) {\r\n                            const position = new Vector2(currX, currY);\r\n                            ring.push(position);\r\n                        }\r\n                        // MVT spec defines that each exterior ring signals the beginning of a new polygon.\r\n                        // See https://github.com/mapbox/vector-tile-spec/tree/master/2.1\r\n                        if (ShapeUtils.area(ring) > 0) {\r\n                            // Create a new polygon and push it into the collection of polygons\r\n                            polygon = { rings: [] };\r\n                            polygons.push(polygon);\r\n                        }\r\n                        // Push the ring into the current polygon\r\n                        polygon?.rings.push(ring);\r\n                    }\r\n\r\n                    geometryProcessor.processPolygonFeature(\r\n                        tile.layer,\r\n                        VT_JSON_EXTENTS,\r\n                        polygons,\r\n                        feature.tags,\r\n                        feature.id\r\n                    );\r\n\r\n                    break;\r\n                }\r\n                case VTJsonGeometryType.Unknown: {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { ValueMap } from \"@here/harp-datasource-protocol/lib/Env\";\r\nimport { clipLineString } from \"@here/harp-geometry/lib/ClipLineString\";\r\nimport { GeoCoordinates, GeoPointLike, webMercatorProjection } from \"@here/harp-geoutils\";\r\nimport { Vector2Like } from \"@here/harp-geoutils/lib/math/Vector2Like\";\r\nimport { ShapeUtils, Vector2, Vector3 } from \"three\";\r\n\r\nimport { DataAdapter } from \"../../DataAdapter\";\r\nimport { DecodeInfo } from \"../../DecodeInfo\";\r\nimport { IGeometryProcessor, ILineGeometry, IPolygonGeometry } from \"../../IGeometryProcessor\";\r\nimport { world2tile } from \"../../OmvUtils\";\r\n\r\nconst DEFAULT_EXTENTS = 4 * 1024;\r\n\r\ntype GeoJsonGeometry =\r\n    | GeoJsonLineStringGeometry\r\n    | GeoJsonMultiLineStringGeometry\r\n    | GeoJsonPolygonGeometry\r\n    | GeoJsonMultiPolygonGeometry\r\n    | GeoJsonPointGeometry\r\n    | GeoJsonMultiPointGeometry;\r\n\r\ninterface GeoJsonLineStringGeometry {\r\n    type: \"LineString\";\r\n    coordinates: GeoPointLike[];\r\n}\r\n\r\ninterface GeoJsonMultiLineStringGeometry {\r\n    type: \"MultiLineString\";\r\n    coordinates: GeoPointLike[][];\r\n}\r\n\r\ninterface GeoJsonPointGeometry {\r\n    type: \"Point\";\r\n    coordinates: GeoPointLike;\r\n}\r\n\r\ninterface GeoJsonMultiPointGeometry {\r\n    type: \"MultiPoint\";\r\n    coordinates: GeoPointLike[];\r\n}\r\n\r\ninterface GeoJsonPolygonGeometry {\r\n    type: \"Polygon\";\r\n    coordinates: GeoPointLike[][];\r\n}\r\n\r\ninterface GeoJsonMultiPolygonGeometry {\r\n    type: \"MultiPolygon\";\r\n    coordinates: GeoPointLike[][][];\r\n}\r\n\r\ninterface GeoJsonFeature {\r\n    id?: string;\r\n    type: \"Feature\";\r\n    properties: ValueMap;\r\n    geometry: GeoJsonGeometry;\r\n}\r\n\r\nexport interface GeoJsonFeatureCollection {\r\n    type: \"FeatureCollection\";\r\n    features: GeoJsonFeature[];\r\n}\r\n\r\nconst worldP = new Vector3();\r\n\r\n/**\r\n * Converts a `geoPoint` to local tile space.\r\n *\r\n * @param geoPoint - The input [[GeoPointLike]].\r\n * @param decodeInfo - The [[DecodeInfo]].\r\n * @param target - A [[VectorLike]] used as target of the converted coordinates.\r\n * @return A [[VectorLike]] with the converted point.\r\n * @hidden\r\n */\r\nfunction convertPoint<VectorType extends Vector2Like>(\r\n    geoPoint: GeoPointLike,\r\n    decodeInfo: DecodeInfo,\r\n    target: VectorType\r\n): VectorType {\r\n    webMercatorProjection.projectPoint(GeoCoordinates.fromGeoPoint(geoPoint), worldP);\r\n    return world2tile(DEFAULT_EXTENTS, decodeInfo, worldP, false, target);\r\n}\r\n\r\nfunction convertLineStringGeometry(\r\n    coordinates: GeoPointLike[],\r\n    decodeInfo: DecodeInfo\r\n): ILineGeometry {\r\n    const untiledPositions = coordinates.map(geoPoint => {\r\n        return GeoCoordinates.fromGeoPoint(geoPoint);\r\n    });\r\n\r\n    const positions = coordinates.map(geoPoint =>\r\n        convertPoint(geoPoint, decodeInfo, new Vector2())\r\n    );\r\n\r\n    return { untiledPositions, positions };\r\n}\r\n\r\nfunction convertLineGeometry(\r\n    geometry: GeoJsonLineStringGeometry | GeoJsonMultiLineStringGeometry,\r\n    decodeInfo: DecodeInfo\r\n): ILineGeometry[] {\r\n    if (geometry.type === \"LineString\") {\r\n        return [convertLineStringGeometry(geometry.coordinates, decodeInfo)];\r\n    }\r\n\r\n    return geometry.coordinates.map(lineString =>\r\n        convertLineStringGeometry(lineString, decodeInfo)\r\n    );\r\n}\r\nfunction convertRings(coordinates: GeoPointLike[][], decodeInfo: DecodeInfo): IPolygonGeometry {\r\n    const rings = coordinates.map((ring, i) => {\r\n        const isOuterRing = i === 0;\r\n        const { positions } = convertLineStringGeometry(ring, decodeInfo);\r\n        const isClockWise = ShapeUtils.area(positions) > 0;\r\n        if ((isOuterRing && !isClockWise) || (!isOuterRing && isClockWise)) {\r\n            positions.reverse();\r\n        }\r\n        return positions;\r\n    });\r\n    return { rings };\r\n}\r\n\r\nfunction convertPolygonGeometry(\r\n    geometry: GeoJsonPolygonGeometry | GeoJsonMultiPolygonGeometry,\r\n    decodeInfo: DecodeInfo\r\n): IPolygonGeometry[] {\r\n    if (geometry.type === \"Polygon\") {\r\n        return [convertRings(geometry.coordinates, decodeInfo)];\r\n    }\r\n\r\n    return geometry.coordinates.map(polygon => convertRings(polygon, decodeInfo));\r\n}\r\n\r\nfunction convertPointGeometry(\r\n    geometry: GeoJsonPointGeometry | GeoJsonMultiPointGeometry,\r\n    decodeInfo: DecodeInfo\r\n): Vector3[] {\r\n    if (geometry.type === \"Point\") {\r\n        return [convertPoint(geometry.coordinates, decodeInfo, new Vector3())];\r\n    }\r\n\r\n    return geometry.coordinates.map(geoPoint => convertPoint(geoPoint, decodeInfo, new Vector3()));\r\n}\r\n\r\nexport class GeoJsonDataAdapter implements DataAdapter {\r\n    /**\r\n     * @override\r\n     */\r\n    canProcess(featureCollection: Partial<GeoJsonFeatureCollection>): boolean {\r\n        return (\r\n            featureCollection &&\r\n            featureCollection.type === \"FeatureCollection\" &&\r\n            Array.isArray(featureCollection.features)\r\n        );\r\n    }\r\n\r\n    /** @override */\r\n    process(\r\n        featureCollection: GeoJsonFeatureCollection,\r\n        decodeInfo: DecodeInfo,\r\n        geometryProcessor: IGeometryProcessor,\r\n        layer: string = \"geojson\"\r\n    ): void {\r\n        if (!Array.isArray(featureCollection.features) || featureCollection.features.length === 0) {\r\n            return;\r\n        }\r\n\r\n        for (const feature of featureCollection.features) {\r\n            switch (feature.geometry.type) {\r\n                case \"LineString\":\r\n                case \"MultiLineString\": {\r\n                    let geometry = convertLineGeometry(feature.geometry, decodeInfo);\r\n\r\n                    const clippedGeometries: ILineGeometry[] = [];\r\n\r\n                    const DEFAULT_BORDER = 100;\r\n\r\n                    geometry.forEach(g => {\r\n                        const clipped = clipLineString(\r\n                            g.positions,\r\n                            -DEFAULT_BORDER,\r\n                            -DEFAULT_BORDER,\r\n                            DEFAULT_EXTENTS + DEFAULT_BORDER,\r\n                            DEFAULT_EXTENTS + DEFAULT_BORDER\r\n                        );\r\n                        clipped.forEach(positions => {\r\n                            clippedGeometries.push({ positions });\r\n                        });\r\n                    });\r\n\r\n                    geometry = clippedGeometries;\r\n\r\n                    if (geometry.length > 0) {\r\n                        geometryProcessor.processLineFeature(\r\n                            layer,\r\n                            DEFAULT_EXTENTS,\r\n                            clippedGeometries,\r\n                            feature.properties,\r\n                            feature.id\r\n                        );\r\n                    }\r\n                    break;\r\n                }\r\n                case \"Polygon\":\r\n                case \"MultiPolygon\": {\r\n                    const geometry = convertPolygonGeometry(feature.geometry, decodeInfo);\r\n                    geometryProcessor.processPolygonFeature(\r\n                        layer,\r\n                        DEFAULT_EXTENTS,\r\n                        geometry,\r\n                        feature.properties,\r\n                        feature.id\r\n                    );\r\n                    break;\r\n                }\r\n                case \"Point\":\r\n                case \"MultiPoint\": {\r\n                    const geometry = convertPointGeometry(feature.geometry, decodeInfo);\r\n                    geometryProcessor.processPointFeature(\r\n                        layer,\r\n                        DEFAULT_EXTENTS,\r\n                        geometry,\r\n                        feature.properties,\r\n                        feature.id\r\n                    );\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2020-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { Vector2 } from \"three\";\r\n\r\nimport { com } from \"./proto/vector_tile\";\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport enum CommandKind {\r\n    MoveTo = 1,\r\n    LineTo = 2,\r\n    ClosePath = 7\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport interface BaseCommand {\r\n    kind: CommandKind;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport interface PositionCommand extends BaseCommand {\r\n    position: Vector2;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport type GeometryCommand = BaseCommand | PositionCommand;\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function isMoveToCommand(command: GeometryCommand): command is PositionCommand {\r\n    return command.kind === CommandKind.MoveTo;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function isLineToCommand(command: GeometryCommand): command is PositionCommand {\r\n    return command.kind === CommandKind.LineTo;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function isClosePathCommand(command: GeometryCommand): command is PositionCommand {\r\n    return command.kind === CommandKind.ClosePath;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport interface OmvVisitor {\r\n    visitLayer?(layer: com.mapbox.pb.Tile.ILayer): boolean;\r\n    endVisitLayer?(layer: com.mapbox.pb.Tile.ILayer): void;\r\n    visitPointFeature?(feature: com.mapbox.pb.Tile.IFeature): void;\r\n    visitLineFeature?(feature: com.mapbox.pb.Tile.IFeature): void;\r\n    visitPolygonFeature?(feature: com.mapbox.pb.Tile.IFeature): void;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function visitOmv(vectorTile: com.mapbox.pb.Tile, visitor: OmvVisitor) {\r\n    if (!vectorTile.layers) {\r\n        return;\r\n    }\r\n\r\n    for (const layer of vectorTile.layers) {\r\n        if (!visitor.visitLayer || visitor.visitLayer(layer)) {\r\n            visitOmvLayer(layer, visitor);\r\n        }\r\n        if (visitor.endVisitLayer) {\r\n            visitor.endVisitLayer(layer);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport function visitOmvLayer(layer: com.mapbox.pb.Tile.ILayer, visitor: OmvVisitor) {\r\n    if (!visitor.visitLayer || visitor.visitLayer(layer)) {\r\n        if (layer.features) {\r\n            for (const feature of layer.features) {\r\n                switch (feature.type) {\r\n                    case com.mapbox.pb.Tile.GeomType.UNKNOWN:\r\n                        break;\r\n\r\n                    case com.mapbox.pb.Tile.GeomType.POINT:\r\n                        if (visitor.visitPointFeature) {\r\n                            visitor.visitPointFeature(feature);\r\n                        }\r\n                        break;\r\n\r\n                    case com.mapbox.pb.Tile.GeomType.LINESTRING:\r\n                        if (visitor.visitLineFeature) {\r\n                            visitor.visitLineFeature(feature);\r\n                        }\r\n                        break;\r\n\r\n                    case com.mapbox.pb.Tile.GeomType.POLYGON:\r\n                        if (visitor.visitPolygonFeature) {\r\n                            visitor.visitPolygonFeature(feature);\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if (visitor.endVisitLayer) {\r\n        visitor.endVisitLayer(layer);\r\n    }\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport interface FeatureAttributesVisitor {\r\n    visitAttribute(name: string, value: com.mapbox.pb.Tile.IValue): boolean;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport class FeatureAttributes {\r\n    accept(\r\n        layer: com.mapbox.pb.Tile.ILayer,\r\n        feature: com.mapbox.pb.Tile.IFeature,\r\n        visitor: FeatureAttributesVisitor\r\n    ): void {\r\n        const { keys, values } = layer;\r\n        const tags = feature.tags;\r\n\r\n        if (!tags || !keys || !values) {\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < tags.length; i += 2) {\r\n            const key = keys[tags[i]];\r\n            const value = values[tags[i + 1]];\r\n            if (!visitor.visitAttribute(key, value)) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport interface GeometryCommandsVisitor {\r\n    type: \"Point\" | \"Line\" | \"Polygon\";\r\n    visitCommand(command: GeometryCommand): void;\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport class GeometryCommands {\r\n    accept(geometry: number[] | null, visitor: GeometryCommandsVisitor) {\r\n        if (!geometry) {\r\n            return;\r\n        }\r\n\r\n        const geometryCount = geometry.length;\r\n\r\n        let currX = 0;\r\n        let currY = 0;\r\n\r\n        const xCoords: number[] = [];\r\n        const yCoords: number[] = [];\r\n        const commands: GeometryCommand[] = [];\r\n        for (let cmdIndex = 0; cmdIndex < geometryCount; ) {\r\n            const kind = (geometry[cmdIndex] & 0x7) as CommandKind;\r\n            const count = geometry[cmdIndex] >> 0x3;\r\n            ++cmdIndex;\r\n\r\n            if (kind === CommandKind.MoveTo || kind === CommandKind.LineTo) {\r\n                for (let n = 0; n < count; ++n) {\r\n                    const xx = geometry[cmdIndex++];\r\n                    const yy = geometry[cmdIndex++];\r\n\r\n                    currX += (xx >> 1) ^ -(xx & 1);\r\n                    currY += (yy >> 1) ^ -(yy & 1);\r\n                    if (visitor.type === \"Polygon\") {\r\n                        xCoords.push(currX);\r\n                        yCoords.push(currY);\r\n                    }\r\n\r\n                    const position = new Vector2(currX, currY);\r\n                    commands.push({ kind, position });\r\n                }\r\n            } else {\r\n                for (const command of commands) {\r\n                    visitor.visitCommand(command);\r\n                }\r\n                visitor.visitCommand({ kind });\r\n                xCoords.length = 0;\r\n                yCoords.length = 0;\r\n                commands.length = 0;\r\n            }\r\n        }\r\n\r\n        if (commands.length > 0) {\r\n            for (const command of commands) {\r\n                visitor.visitCommand(command);\r\n            }\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport {\r\n    MapEnv,\r\n    StyleSetEvaluator,\r\n    Value,\r\n    ValueMap\r\n} from \"@here/harp-datasource-protocol/index-decoder\";\r\nimport { TileKey } from \"@here/harp-geoutils\";\r\nimport { assert, ILogger, LoggerManager } from \"@here/harp-utils\";\r\nimport * as Long from \"long\";\r\nimport { ShapeUtils, Vector2, Vector3 } from \"three\";\r\n\r\nimport { DataAdapter } from \"../../DataAdapter\";\r\nimport { DecodeInfo } from \"../../DecodeInfo\";\r\nimport { IGeometryProcessor, ILineGeometry, IPolygonGeometry } from \"../../IGeometryProcessor\";\r\nimport {\r\n    ComposedDataFilter,\r\n    OmvFeatureFilter,\r\n    OmvFeatureModifier,\r\n    OmvGenericFeatureFilter,\r\n    OmvGenericFeatureModifier\r\n} from \"../../OmvDataFilter\";\r\nimport {\r\n    FeatureModifierId,\r\n    OmvDecoderOptions,\r\n    OmvFeatureFilterDescription,\r\n    OmvGeometryType\r\n} from \"../../OmvDecoderDefs\";\r\nimport { OmvPoliticalViewFeatureModifier } from \"../../OmvPoliticalViewFeatureModifier\";\r\nimport { isArrayBufferLike } from \"../../OmvUtils\";\r\nimport { StyleSetDataFilter } from \"../../StyleSetDataFilter\";\r\nimport {\r\n    FeatureAttributes,\r\n    GeometryCommands,\r\n    isClosePathCommand,\r\n    isLineToCommand,\r\n    isMoveToCommand,\r\n    OmvVisitor,\r\n    visitOmv\r\n} from \"./OmvData\";\r\nimport { com } from \"./proto/vector_tile\";\r\n\r\nconst propertyCategories = [\r\n    \"stringValue\",\r\n    \"floatValue\",\r\n    \"doubleValue\",\r\n    \"intValue\",\r\n    \"uintValue\",\r\n    \"sintValue\",\r\n    \"boolValue\"\r\n];\r\n\r\nconst logger = LoggerManager.instance.create(\"OmvDataAdapter\", { enabled: false });\r\n\r\nfunction simplifiedValue(value: com.mapbox.pb.Tile.IValue): Value {\r\n    const hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\n    for (const category of propertyCategories) {\r\n        if (hasOwnProperty.call(value, category)) {\r\n            const v = value[category as keyof com.mapbox.pb.Tile.IValue];\r\n\r\n            if (v === undefined) {\r\n                throw new Error(\"unpexted undefined value\");\r\n            }\r\n\r\n            return Long.isLong(v) ? (v as any).toNumber() : v;\r\n        }\r\n    }\r\n\r\n    throw new Error(\"not happening\");\r\n}\r\n\r\nfunction decodeFeatureId(\r\n    feature: com.mapbox.pb.Tile.IFeature,\r\n    properties: ValueMap,\r\n    logger?: ILogger\r\n): number | string | undefined {\r\n    if (properties.id !== undefined && properties.id !== null) {\r\n        return properties.id as number | string;\r\n    }\r\n    if (feature.hasOwnProperty(\"id\")) {\r\n        const id = feature.id;\r\n        if (typeof id === \"number\") {\r\n            return id;\r\n        } else if (id) {\r\n            if (logger !== undefined && id.greaterThan(Number.MAX_SAFE_INTEGER)) {\r\n                logger.error(\r\n                    \"Invalid ID: Larger than largest available Number in feature: \",\r\n                    feature\r\n                );\r\n            }\r\n            return id.toNumber();\r\n        }\r\n    }\r\n\r\n    return undefined;\r\n}\r\n\r\nfunction readAttributes(\r\n    layer: com.mapbox.pb.Tile.ILayer,\r\n    feature: com.mapbox.pb.Tile.IFeature\r\n): ValueMap {\r\n    const attrs = new FeatureAttributes();\r\n\r\n    const attributes: ValueMap = {};\r\n\r\n    attrs.accept(layer, feature, {\r\n        visitAttribute: (name, value) => {\r\n            attributes[name] = simplifiedValue(value);\r\n            return true;\r\n        }\r\n    });\r\n\r\n    return attributes;\r\n}\r\n\r\nexport function asGeometryType(feature: com.mapbox.pb.Tile.IFeature | undefined): OmvGeometryType {\r\n    if (feature === undefined) {\r\n        return OmvGeometryType.UNKNOWN;\r\n    }\r\n\r\n    switch (feature.type) {\r\n        case com.mapbox.pb.Tile.GeomType.UNKNOWN:\r\n            return OmvGeometryType.UNKNOWN;\r\n        case com.mapbox.pb.Tile.GeomType.POINT:\r\n            return OmvGeometryType.POINT;\r\n        case com.mapbox.pb.Tile.GeomType.LINESTRING:\r\n            return OmvGeometryType.LINESTRING;\r\n        case com.mapbox.pb.Tile.GeomType.POLYGON:\r\n            return OmvGeometryType.POLYGON;\r\n        default:\r\n            return OmvGeometryType.UNKNOWN;\r\n    } // switch\r\n}\r\n\r\n// Ensures ring winding follows Mapbox Vector Tile specification: outer rings must be clockwise,\r\n// inner rings counter-clockwise.\r\n// See https://docs.mapbox.com/vector-tiles/specification/\r\nfunction checkWinding(multipolygon: IPolygonGeometry[]) {\r\n    const firstPolygon = multipolygon[0];\r\n\r\n    if (firstPolygon === undefined || firstPolygon.rings.length === 0) {\r\n        return;\r\n    }\r\n\r\n    // Opposite sign to ShapeUtils.isClockWise, since webMercator tile space has top-left origin.\r\n    // For example:\r\n    // Given the ring = [(1,2), (2,2), (2,1), (1,1)]\r\n    // ShapeUtils.area(ring) > 0    -> false\r\n    // ShapeUtils.isClockWise(ring) -> true\r\n    // ^\r\n    // |  1,2 -> 2,2\r\n    // |          |\r\n    // |  1,1 <- 2,1\r\n    // |_______________>\r\n    //\r\n    // Tile space axis\r\n    //  ______________>\r\n    // |  1,1 <- 2,1\r\n    // |          |\r\n    // |  1,2 ->  2,2\r\n    // V\r\n    const isOuterRingClockWise = ShapeUtils.area(firstPolygon.rings[0]) > 0;\r\n\r\n    if (!isOuterRingClockWise) {\r\n        for (const polygon of multipolygon) {\r\n            for (const ring of polygon.rings) {\r\n                ring.reverse();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction roundUpCoordinates(coordinates: Vector2[], layerExtents: number) {\r\n    coordinates.forEach(p => {\r\n        if (p.x === layerExtents - 1) {\r\n            p.x = layerExtents;\r\n        }\r\n    });\r\n}\r\n\r\nfunction roundUpPolygonCoordinates(geometry: IPolygonGeometry[], layerExtents: number) {\r\n    geometry.forEach(polygon => polygon.rings.forEach(r => roundUpCoordinates(r, layerExtents)));\r\n}\r\n\r\nfunction roundUpLineCoordinates(geometry: ILineGeometry[], layerExtents: number) {\r\n    geometry.forEach(line => roundUpCoordinates(line.positions, layerExtents));\r\n}\r\nfunction createFeatureModifier(\r\n    filterDescription: OmvFeatureFilterDescription,\r\n    featureModifierId?: FeatureModifierId\r\n): OmvFeatureModifier {\r\n    switch (featureModifierId) {\r\n        case FeatureModifierId.default:\r\n            return new OmvGenericFeatureModifier(filterDescription);\r\n        default:\r\n            assert(!\"Unrecognized feature modifier id, using default!\");\r\n            return new OmvGenericFeatureModifier(filterDescription);\r\n    }\r\n}\r\n\r\n/**\r\n * The class `OmvDataAdapter` converts OMV protobuf geo data\r\n * to geometries for the given `IGeometryProcessor`.\r\n */\r\n\r\nexport class OmvDataAdapter implements DataAdapter, OmvVisitor {\r\n    private readonly m_geometryCommands = new GeometryCommands();\r\n\r\n    private m_tileKey!: TileKey;\r\n    private m_layer!: com.mapbox.pb.Tile.ILayer;\r\n    private m_dataFilter?: OmvFeatureFilter;\r\n    private m_featureModifiers?: OmvFeatureModifier[];\r\n    private m_processor!: IGeometryProcessor;\r\n    private m_roundUpCoordinatesIfNeeded: boolean = false;\r\n\r\n    /**\r\n     * The [[OmvFeatureFilter]] used to filter features.\r\n     */\r\n    get dataFilter(): OmvFeatureFilter | undefined {\r\n        return this.m_dataFilter;\r\n    }\r\n\r\n    /**\r\n     * Configures the OMV adapter.\r\n     *\r\n     * @param options - Configuration options.\r\n     * @param styleSetEvaluator - Style set evaluator instance, used for filtering.\r\n     */\r\n    configure(options: OmvDecoderOptions, styleSetEvaluator: StyleSetEvaluator) {\r\n        if (options.filterDescription !== undefined) {\r\n            if (options.filterDescription !== null) {\r\n                // TODO: Feature modifier is always used only with feature filter.\r\n                // At best the filtering feature should be excluded from other feature\r\n                // modifiers and be performed solely via OmvGenericFeature modifier or filter.\r\n                const filterDescription = options.filterDescription;\r\n                const featureModifiersIds = options.featureModifiers;\r\n\r\n                // Create new filter from description.\r\n                this.m_dataFilter = new OmvGenericFeatureFilter(filterDescription);\r\n                // Create feature modifiers.\r\n                const featureModifiers: OmvFeatureModifier[] = [];\r\n                if (featureModifiersIds !== undefined) {\r\n                    featureModifiersIds.forEach(fmId => {\r\n                        featureModifiers.push(createFeatureModifier(filterDescription, fmId));\r\n                    });\r\n                } else {\r\n                    featureModifiers.push(\r\n                        createFeatureModifier(filterDescription, FeatureModifierId.default)\r\n                    );\r\n                }\r\n                this.m_featureModifiers = featureModifiers;\r\n            } else {\r\n                // null is the signal to clear the filter/modifier\r\n                this.m_dataFilter = undefined;\r\n                this.m_featureModifiers = undefined;\r\n            }\r\n            const styleSetDataFilter = new StyleSetDataFilter(styleSetEvaluator);\r\n            this.m_dataFilter = this.m_dataFilter\r\n                ? new ComposedDataFilter([styleSetDataFilter, this.m_dataFilter])\r\n                : styleSetDataFilter;\r\n        }\r\n\r\n        if (options.politicalView !== undefined) {\r\n            const politicalView = options.politicalView;\r\n            let featureModifiers = this.m_featureModifiers;\r\n            // Remove existing political view modifiers, this actually setups default,\r\n            // commonly accepted point of view - without feature modifier.\r\n            if (featureModifiers) {\r\n                featureModifiers = featureModifiers.filter(\r\n                    fm => !(fm instanceof OmvPoliticalViewFeatureModifier)\r\n                );\r\n            }\r\n            // If political view is indeed requested append feature modifier at the end of list.\r\n            if (politicalView.length !== 0) {\r\n                assert(\r\n                    politicalView.length === 2,\r\n                    \"The political view must be specified as two letters ISO 3166-1 standard!\"\r\n                );\r\n                const povFeatureModifier = new OmvPoliticalViewFeatureModifier(politicalView);\r\n                if (featureModifiers) {\r\n                    featureModifiers.push(povFeatureModifier);\r\n                } else {\r\n                    featureModifiers = [povFeatureModifier];\r\n                }\r\n            }\r\n            // Reset modifiers if nothing was added.\r\n            this.m_featureModifiers =\r\n                featureModifiers && featureModifiers.length > 0 ? featureModifiers : undefined;\r\n        }\r\n        this.m_roundUpCoordinatesIfNeeded = options.roundUpCoordinatesIfNeeded ?? false;\r\n    }\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    canProcess(data: ArrayBufferLike | {}): boolean {\r\n        return isArrayBufferLike(data);\r\n    }\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    process(data: ArrayBufferLike, decodeInfo: DecodeInfo, geometryProcessor: IGeometryProcessor) {\r\n        const { tileKey } = decodeInfo;\r\n        const payload = new Uint8Array(data);\r\n        const proto = com.mapbox.pb.Tile.decode(payload);\r\n\r\n        this.m_tileKey = tileKey;\r\n        this.m_processor = geometryProcessor;\r\n\r\n        visitOmv(proto, this);\r\n    }\r\n\r\n    /**\r\n     * Visits the OMV layer.\r\n     *\r\n     * @param layer - The OMV layer to process.\r\n     */\r\n    visitLayer(layer: com.mapbox.pb.Tile.ILayer): boolean {\r\n        this.m_layer = layer;\r\n\r\n        const storageLevel = this.m_tileKey.level;\r\n        const layerName = layer.name;\r\n\r\n        if (\r\n            this.m_dataFilter !== undefined &&\r\n            !this.m_dataFilter.wantsLayer(layerName, storageLevel)\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Visits point features.\r\n     *\r\n     * @param feature - The OMV point features to process.\r\n     */\r\n    visitPointFeature(feature: com.mapbox.pb.Tile.IFeature): void {\r\n        if (feature.geometry === undefined) {\r\n            return;\r\n        }\r\n\r\n        // Pass feature modifier method to processFeature if there's any modifier. Get it from any\r\n        // modifier, processFeature will later apply it to all using Function.apply().\r\n        const modifierFunc = this.m_featureModifiers?.[0].doProcessPointFeature;\r\n\r\n        const properties = this.filterAndModifyFeature(\r\n            feature,\r\n            this.m_dataFilter?.wantsPointFeature,\r\n            modifierFunc\r\n        );\r\n        if (!properties) {\r\n            return;\r\n        }\r\n\r\n        const layerName = this.m_layer.name;\r\n        const layerExtents = this.m_layer.extent ?? 4096;\r\n\r\n        const geometry: Vector3[] = [];\r\n        this.m_geometryCommands.accept(feature.geometry, {\r\n            type: \"Point\",\r\n            visitCommand: command => {\r\n                if (isMoveToCommand(command)) {\r\n                    geometry.push(new Vector3(command.position.x, command.position.y, 0));\r\n                }\r\n            }\r\n        });\r\n\r\n        if (geometry.length === 0) {\r\n            return;\r\n        }\r\n\r\n        this.m_processor.processPointFeature(\r\n            layerName,\r\n            layerExtents,\r\n            geometry,\r\n            properties,\r\n            decodeFeatureId(feature, properties, logger)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Visits the line features.\r\n     *\r\n     * @param feature - The line features to process.\r\n     */\r\n    visitLineFeature(feature: com.mapbox.pb.Tile.IFeature): void {\r\n        if (feature.geometry === undefined) {\r\n            return;\r\n        }\r\n\r\n        // Pass feature modifier method to processFeature if there's any modifier. Get it from any\r\n        // modifier, processFeature will later apply it to all using Function.apply().\r\n        const modifierFunc = this.m_featureModifiers?.[0].doProcessLineFeature;\r\n\r\n        const properties = this.filterAndModifyFeature(\r\n            feature,\r\n            this.m_dataFilter?.wantsLineFeature,\r\n            modifierFunc\r\n        );\r\n        if (!properties) {\r\n            return;\r\n        }\r\n\r\n        const layerName = this.m_layer.name;\r\n        const layerExtents = this.m_layer.extent ?? 4096;\r\n\r\n        const geometry: ILineGeometry[] = [];\r\n        let positions: Vector2[];\r\n        this.m_geometryCommands.accept(feature.geometry, {\r\n            type: \"Line\",\r\n            visitCommand: command => {\r\n                if (isMoveToCommand(command)) {\r\n                    positions = [command.position];\r\n                    geometry.push({ positions });\r\n                } else if (isLineToCommand(command)) {\r\n                    positions.push(command.position);\r\n                }\r\n            }\r\n        });\r\n\r\n        if (geometry.length === 0) {\r\n            return;\r\n        }\r\n\r\n        if (this.mustRoundUpCoordinates) {\r\n            roundUpLineCoordinates(geometry, layerExtents);\r\n        }\r\n        this.m_processor.processLineFeature(\r\n            layerName,\r\n            layerExtents,\r\n            geometry,\r\n            properties,\r\n            decodeFeatureId(feature, properties, logger)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Visits the polygon features.\r\n     *\r\n     * @param feature - The polygon features to process.\r\n     */\r\n    visitPolygonFeature(feature: com.mapbox.pb.Tile.IFeature): void {\r\n        if (feature.geometry === undefined) {\r\n            return;\r\n        }\r\n\r\n        // Pass feature modifier method to processFeature if there's any modifier. Get it from any\r\n        // modifier, processFeature will later apply it to all using Function.apply().\r\n        const modifierFunc = this.m_featureModifiers?.[0].doProcessPolygonFeature;\r\n\r\n        const properties = this.filterAndModifyFeature(\r\n            feature,\r\n            this.m_dataFilter?.wantsPolygonFeature,\r\n            modifierFunc\r\n        );\r\n        if (!properties) {\r\n            return;\r\n        }\r\n\r\n        const layerName = this.m_layer.name;\r\n        const layerExtents = this.m_layer.extent ?? 4096;\r\n\r\n        const geometry: IPolygonGeometry[] = [];\r\n        let currentPolygon: IPolygonGeometry | undefined;\r\n        let currentRing: Vector2[];\r\n        let exteriorWinding: number | undefined;\r\n        this.m_geometryCommands.accept(feature.geometry, {\r\n            type: \"Polygon\",\r\n            visitCommand: command => {\r\n                if (isMoveToCommand(command)) {\r\n                    currentRing = [command.position];\r\n                } else if (isLineToCommand(command)) {\r\n                    currentRing.push(command.position);\r\n                } else if (isClosePathCommand(command)) {\r\n                    if (currentRing !== undefined && currentRing.length > 0) {\r\n                        const currentRingWinding = Math.sign(ShapeUtils.area(currentRing));\r\n                        // Winding order from XYZ spaces might be not MVT spec compliant, see HARP-11151.\r\n                        // We take the winding of the very first ring as reference.\r\n                        if (exteriorWinding === undefined) {\r\n                            exteriorWinding = currentRingWinding;\r\n                        }\r\n                        // MVT spec defines that each exterior ring signals the beginning of a new polygon.\r\n                        // see https://github.com/mapbox/vector-tile-spec/tree/master/2.1\r\n                        if (currentRingWinding === exteriorWinding) {\r\n                            // Create a new polygon and push it into the collection of polygons\r\n                            currentPolygon = { rings: [] };\r\n                            geometry.push(currentPolygon);\r\n                        }\r\n                        // Push the ring into the current polygon\r\n                        currentRing.push(currentRing[0].clone());\r\n                        currentPolygon?.rings.push(currentRing);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        if (geometry.length === 0) {\r\n            return;\r\n        }\r\n\r\n        if (this.mustRoundUpCoordinates) {\r\n            roundUpPolygonCoordinates(geometry, layerExtents);\r\n        }\r\n\r\n        checkWinding(geometry);\r\n\r\n        this.m_processor.processPolygonFeature(\r\n            layerName,\r\n            layerExtents,\r\n            geometry,\r\n            properties,\r\n            decodeFeatureId(feature, properties, logger)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Applies any filter and modifiers to a given feature.\r\n     *\r\n     * @param feature - The feature to filter and modify.\r\n     * @param filterFunc - The filtering function.\r\n     * @param modifierFunc - The modifier function.\r\n     * @returns The modified feature properties or `undefined` if feature is filtered out.\r\n     */\r\n    private filterAndModifyFeature(\r\n        feature: com.mapbox.pb.Tile.IFeature,\r\n        filterFunc?: (...args: any[]) => boolean,\r\n        modifierFunc?: (...args: any[]) => boolean\r\n    ): ValueMap | undefined {\r\n        const storageLevel = this.m_tileKey.level;\r\n        const layerName = this.m_layer.name;\r\n        const geometryType = asGeometryType(feature);\r\n\r\n        if (\r\n            this.m_dataFilter &&\r\n            filterFunc!.apply(this.m_dataFilter, [layerName, geometryType, storageLevel]) === false\r\n        ) {\r\n            return undefined;\r\n        }\r\n\r\n        const properties = readAttributes(this.m_layer, feature);\r\n        const env = new MapEnv(properties);\r\n        if (\r\n            this.m_featureModifiers?.find(fm => {\r\n                // TODO: The logic of feature ignore should be actually in the feature filtering\r\n                // mechanism - see OmvFeatureFilter.\r\n                assert(modifierFunc !== undefined);\r\n                return !modifierFunc!.apply(fm, [layerName, env, this.m_tileKey.level]);\r\n            }) !== undefined\r\n        ) {\r\n            return undefined;\r\n        }\r\n\r\n        return properties;\r\n    }\r\n\r\n    private get mustRoundUpCoordinates(): boolean {\r\n        return (\r\n            this.m_roundUpCoordinatesIfNeeded &&\r\n            this.m_tileKey.level < 5 &&\r\n            this.m_tileKey.column === this.m_tileKey.columnCount() - 1\r\n        );\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport { isWorkerBootstrapResponse } from \"@here/harp-mapview/lib/workers/WorkerBootstrapDefs\";\r\n\r\ndeclare let self: Worker & {\r\n    importScripts(..._scripts: string[]): void;\r\n};\r\n\r\n/**\r\n * Async bootstrap using \"worker bootstrap protocol\" defined in [[WorkerBootstrapDefs]] and\r\n * supported by `WorkerLoader`\r\n *\r\n * Resolves, when all the dependencies are loaded.\r\n * Rejects after timeout (1000ms) and in case error while loading dependencies.\r\n */\r\nfunction asyncWorkerBootstrap(dependencies: string[]): Promise<void> {\r\n    return new Promise<void>((resolve, reject) => {\r\n        self.postMessage({\r\n            type: \"worker-bootstrap-request\",\r\n            dependencies\r\n        });\r\n\r\n        let timeoutHit = false;\r\n        const warnTimeout = setTimeout(() => {\r\n            timeoutHit = true;\r\n            reject(\r\n                new Error(\"#asyncWorkerBootstrap: Timeout waiting for `worker-bootstrap-response`.\")\r\n            );\r\n        }, 1000);\r\n\r\n        function bootstrapEventHandler(event: MessageEvent) {\r\n            if (timeoutHit) {\r\n                return;\r\n            }\r\n            try {\r\n                const message = event.data;\r\n                if (isWorkerBootstrapResponse(message)) {\r\n                    clearTimeout(warnTimeout);\r\n\r\n                    self.removeEventListener(\"message\", bootstrapEventHandler);\r\n\r\n                    const resolvedDependencies = message.resolvedDependencies;\r\n                    for (const initScript of resolvedDependencies) {\r\n                        self.importScripts(initScript);\r\n                    }\r\n\r\n                    resolve();\r\n                }\r\n            } catch (error) {\r\n                reject(error);\r\n            }\r\n        }\r\n\r\n        self.addEventListener(\"message\", bootstrapEventHandler);\r\n    });\r\n}\r\n\r\nif ((self as any).THREE) {\r\n    import(\"./DecoderBundleMain\");\r\n} else {\r\n    asyncWorkerBootstrap([\"three\"])\r\n        .then(() => {\r\n            import(\"./DecoderBundleMain\");\r\n        })\r\n        .catch(error => {\r\n            // eslint-disable-next-line no-console\r\n            console.error(`harp-decoders.js: failed to bootstrap: ${error}`, error);\r\n        });\r\n}\r\n","/*\r\n * Copyright (C) 2019-2021 HERE Europe B.V.\r\n * Licensed under Apache 2.0, see full license in LICENSE\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nif (!(self as any).THREE) {\r\n    // eslint-disable-next-line no-console\r\n    console.warn(\r\n        \"harp-decoders.js: It looks like 'Three.js' is not loaded. This script requires 'THREE' \" +\r\n            \"object to be defined. See https://github.com/heremaps/harp.gl/@here/harp.gl.\"\r\n    );\r\n}\r\n\r\nimport {\r\n    GeoJsonTilerService,\r\n    VectorTileDecoderService\r\n} from \"@here/harp-vectortile-datasource/index-worker\";\r\n\r\nGeoJsonTilerService.start();\r\nVectorTileDecoderService.start();\r\n","module.exports = THREE;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module\n__webpack_require__(\"./lib/DecoderBootstrap.ts\");\n// This entry module used 'exports' so it can't be inlined\n"],"sourceRoot":""}